ORG $9000

DEVEPR  EQU $08 ;Y1 EPROM WR SIGNAL ON/OFF 1/0 BIT 0
DEVKBD  EQU $08 ;Y1 USB KEYB ON/OFF ON/OFF 2/0 BIT 1
DEVKBI  EQU $18 ;00;Y0 INPUT FROM DEVICES: DEV1=USB KEYB ON BITS 7=DATA & 6=CLOCK,DEV2=XXX
            ;TEMP

GET_CHAR EQU $02DC;
SOUTAS   EQU $03EF
MENU     EQU $0003;
RS_TXT   EQU $0896;
RS_TX    EQU $0887;
LCD_MSG  EQU $0EB2
DELAYMICRO EQU $12D5

JP AGN

INTCNT DB 0


AGN: EI    
 LD HL,MS3
 CALL RS_TXT
 CALL GET_CHAR	;TAKE A CHAR FROM RS232 OR PS2 KEYB

CP 'M'
JP Z,MENU
CP 'T'
CALL Z,TESTIS
CP 'I'
CALL Z,GETISROUTINE

JR AGN

MS3 DEFM "M:MENU, T:TEST I.S."
    DEFB 10,13,0

TESTIS:
  LD HL,INTCNT
  LD A,(HL)
  CALL SOUTAS  
RET

GETISROUTINE:
 LD HL,$A000
 LD B,20
LL1: LD A,(HL)
  INC HL
 PUSH HL
 PUSH BC
 CALL SOUTAS
 POP BC
 POP HL
 DJNZ LL1
RET

