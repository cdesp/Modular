 14)   0000 CD 4D 0C    					CALL    TELL	;
 15)   0003 43 44 45 53 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   0007 50 20 4D 6F 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   000B 64 75 6C 61 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   000F 72 20 43 6F 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   0013 6D 70 75 74 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   0017 65 72 20 31 					DEFM	"CDESP Modular Computer 1.0"	;
 15)   001B 2E 30       					DEFM	"CDESP Modular Computer 1.0"	;
 16)   001D 0A 0D 0A 0D 					DEFB	0AH,0DH,0AH,0DH	;
 17)   0021 00          					DEFB    0	;
 53)   0022 21 00 62    		COLD:			LD      HL,STAVAR       ;COLD START	;COLD START
 54)   0025 F9          					LD      SP,HL	;
 55)   0026 36 0A       					LD      (HL),10	;
 56)   0028 2C          					INC     L	;
 57)   0029 36 09       					LD      (HL),9	;
 58)   002B 2C          					INC     L	;
 59)   002C AF          					XOR     A	;
 60)   002D 77          		PURGE:			LD      (HL),A          ;CLEAR SCRATCHPAD	;CLEAR SCRATCHPAD
 61)   002E 2C          					INC     L	;
 62)   002F 20 FC       					JR      NZ,PURGE	;
 63)   0031 3E 37       					LD      A,37H           ;V3.0	;V3.0
 64)   0033 32 FE 62    					LD      (LISTON),A	;
 65)   0036 21 6D 00    					LD      HL,NOTICE	;
 66)   0039 22 EE 62    					LD      (ERRTXT),HL	;
 67)   003C CD 1B 40    					CALL    OSINIT	;
 68)   003F ED 53 E4 62 					LD      (HIMEM),DE	;
 69)   0043 22 DC 62    					LD      (PAGE),HL	;
 70)   0046 CD E6 07    					CALL    NEWIT	;
 71)   0049 C2 D2 0C    					JP      NZ,CHAIN0       ;AUTO-RUN	;AUTO-RUN
 72)   004C CD 4D 0C    					CALL    TELL	;
 73)   004F 42 42 43 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   0053 42 41 53 49 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   0057 43 20 28 5A 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   005B 38 30 29 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   005F 56 65 72 73 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   0063 69 6F 6E 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   0067 33 2E 30 30 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 74)   006B 0A 0D       					DEFB	0AH,0DH	;
 75)   006D 28 43 29 20 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0071 43 6F 70 79 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0075 72 69 67 68 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0079 74 20 52 2E 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   007D 54 2E 52 75 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0081 73 73 65 6C 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0085 6C 20 31 39 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   0089 38 37       		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 76)   008B 0A 0D 0A 0D 					DEFB	0AH,0DH,0AH,0DH	;
 77)   008F 00          					DEFB    0	;
 78)   0090 F6          		@WARM:			DEFB    0F6H	;
 79)   0091 37          		@CLOOP:			SCF	;
 80)   0092 ED 7B E4 62 					LD      SP,(HIMEM)	;
 81)   0096 CD 12 40    					CALL    PROMPT          ;PROMPT USER	;PROMPT USER
 82)   0099 21 FE 62    					LD      HL,LISTON	;
 83)   009C 7E          					LD      A,(HL)	;
 84)   009D E6 0F       					AND     0FH             ;LISTO	;LISTO
 85)   009F F6 30       					OR      30H             ;OPT 3	;OPT 3
 86)   00A1 77          					LD      (HL),A	;
 87)   00A2 ED 62       					SBC     HL,HL           ;HL <- 0 (V3.0)	;HL <- 0 (V3.0)
 88)   00A4 22 EC 62    					LD      (ERRTRP),HL	;
 89)   00A7 22 F4 62    					LD      (ERRLIN),HL	;
 90)   00AA 2A EA 62    					LD      HL,(AUTONO)	;
 91)   00AD 22 E6 62    					LD      (LINENO),HL	;
 92)   00B0 7C          					LD      A,H	;
 93)   00B1 B5          					OR      L	;
 94)   00B2 28 17       					JR      Z,NOAUTO	;
 95)   00B4 E5          					PUSH    HL	;
 96)   00B5 CD 27 09    					CALL    PBCD            ;AUTO NUMBER	;AUTO NUMBER
 97)   00B8 E1          					POP     HL	;
 98)   00B9 ED 4B FF 62 					LD      BC,(INCREM)	;
 99)   00BD 06 00       					LD      B,0	;
100)   00BF 09          					ADD     HL,BC	;
101)   00C0 DA 08 0B    					JP      C,TOOBIG	;
102)   00C3 22 EA 62    					LD      (AUTONO),HL	;
103)   00C6 3E 20       					LD      A,' '	;
104)   00C8 CD 96 08    					CALL    OUTCHR	;
105)   00CB 21 00 60    		NOAUTO:			LD      HL,ACCS	;
106)   00CE CD 1E 40    					CALL    OSLINE          ;GET CONSOLE INPUT	;GET CONSOLE INPUT
107)   00D1 AF          					XOR     A	;
108)   00D2 32 FB 62    					LD      (COUNT),A	;
109)   00D5 FD 21 00 60 					LD      IY,ACCS	;
110)   00D9 CD E3 0A    					CALL    LINNUM	;
111)   00DC CD 9A 24    					CALL    NXT	;
112)   00DF 7C          					LD      A,H	;
113)   00E0 B5          					OR      L	;
114)   00E1 28 03       					JR      Z,LNZERO        ;FOR AUTO (NON-MAPPED)	;FOR AUTO (NON-MAPPED)
115)   00E3 22 E6 62    					LD      (LINENO),HL	;
116)   00E6 11 00 61    		LNZERO:			LD      DE,BUFFER	;
117)   00E9 0E 01       					LD      C,1             ;LEFT MODE	;LEFT MODE
118)   00EB CD 77 0B    					CALL    LEXAN2          ;LEXICAL ANALYSIS	;LEXICAL ANALYSIS
119)   00EE 12          					LD      (DE),A          ;TERMINATOR	;TERMINATOR
120)   00EF AF          					XOR     A	;
121)   00F0 47          					LD      B,A	;
122)   00F1 4B          					LD      C,E             ;BC=LINE LENGTH	;BC=LINE LENGTH
123)   00F2 13          					INC     DE	;
124)   00F3 12          					LD      (DE),A          ;ZERO NEXT	;ZERO NEXT
125)   00F4 2A E6 62    					LD      HL,(LINENO)	;
126)   00F7 7C          					LD      A,H	;
127)   00F8 B5          					OR      L	;
128)   00F9 FD 21 00 61 					LD      IY,BUFFER       ;FOR XEQ	;FOR XEQ
129)   00FD CA 0A 0D    					JP      Z,XEQ           ;DIRECT MODE	;DIRECT MODE
130)   0100 C5          					PUSH    BC	;
131)   0101 E5          					PUSH    HL	;
132)   0102 CD CA 07    					CALL    SETTOP          ;SET TOP	;SET TOP
133)   0105 E1          					POP     HL	;
134)   0106 CD CD 08    					CALL    FINDL	;
135)   0109 CC 8A 07    					CALL    Z,DEL	;
136)   010C C1          					POP     BC	;
137)   010D 79          					LD      A,C	;
138)   010E B7          					OR      A	;
139)   010F CA 91 00    					JP      Z,CLOOP         ;DELETE LINE ONLY	;DELETE LINE ONLY
140)   0112 C6 04       					ADD     A,4	;
141)   0114 4F          					LD      C,A             ;LENGTH INCLUSIVE	;LENGTH INCLUSIVE
142)   0115 D5          					PUSH    DE              ;LINE NUMBER	;LINE NUMBER
143)   0116 C5          					PUSH    BC              ;SAVE LINE LENGTH	;SAVE LINE LENGTH
144)   0117 EB          					EX      DE,HL	;
145)   0118 2A DE 62    					LD      HL,(TOP)	;
146)   011B E5          					PUSH    HL	;
147)   011C 09          					ADD     HL,BC	;
148)   011D E5          					PUSH    HL	;
149)   011E 24          					INC     H	;
150)   011F AF          					XOR     A	;
151)   0120 ED 72       					SBC     HL,SP	;
152)   0122 E1          					POP     HL	;
153)   0123 D2 FD 06    					JP      NC,ERROR        ;"No room"	;"No room"
154)   0126 22 DE 62    					LD      (TOP),HL	;
155)   0129 E3          					EX      (SP),HL	;
156)   012A E5          					PUSH    HL	;
157)   012B 23          					INC     HL	;
158)   012C B7          					OR      A	;
159)   012D ED 52       					SBC     HL,DE	;
160)   012F 44          					LD      B,H             ;BC=AMOUNT TO MOVE	;BC=AMOUNT TO MOVE
161)   0130 4D          					LD      C,L	;
162)   0131 E1          					POP     HL	;
163)   0132 D1          					POP     DE	;
164)   0133 28 02       					JR      Z,ATEND	;
165)   0135 ED B8       					LDDR                    ;MAKE SPACE	;MAKE SPACE
166)   0137 C1          		ATEND:			POP     BC              ;LINE LENGTH	;LINE LENGTH
167)   0138 D1          					POP     DE              ;LINE NUMBER	;LINE NUMBER
168)   0139 23          					INC     HL	;
169)   013A 71          					LD      (HL),C          ;STORE LENGTH	;STORE LENGTH
170)   013B 23          					INC     HL	;
171)   013C 73          					LD      (HL),E          ;STORE LINE NUMBER	;STORE LINE NUMBER
172)   013D 23          					INC     HL	;
173)   013E 72          					LD      (HL),D	;
174)   013F 23          					INC     HL	;
175)   0140 11 00 61    					LD      DE,BUFFER	;
176)   0143 EB          					EX      DE,HL	;
177)   0144 0D          					DEC     C	;
178)   0145 0D          					DEC     C	;
179)   0146 0D          					DEC     C	;
180)   0147 ED B0       					LDIR                    ;ADD LINE	;ADD LINE
181)   0149 CD BF 07    					CALL    CLEAN	;
182)   014C C3 91 00    					JP      CLOOP		;
189)   014F 80          		KEYWDS:			DEFB    80H	;
190)   0150 41 4E 44    					DEFM    'AND'	;
191)   0153 94          					DEFB    94H	;
192)   0154 41 42 53    					DEFM    'ABS'	;
193)   0157 95          					DEFB    95H	;
194)   0158 41 43 53    					DEFM    'ACS'	;
195)   015B 96          					DEFB    96H	;
196)   015C 41 44 56 41 					DEFM    'ADVAL'	;
196)   0160 4C          					DEFM    'ADVAL'	;
197)   0161 97          					DEFB    97H	;
198)   0162 41 53 43    					DEFM    'ASC'	;
199)   0165 98          					DEFB    98H	;
200)   0166 41 53 4E    					DEFM    'ASN'	;
201)   0169 99          					DEFB    99H	;
202)   016A 41 54 4E    					DEFM    'ATN'	;
203)   016D C6          					DEFB    0C6H	;
204)   016E 41 55 54 4F 					DEFM    'AUTO'	;
205)   0172 9A          					DEFB    9AH	;
206)   0173 42 47 45 54 					DEFM    'BGET'	;
207)   0177 00          					DEFB    0	;
208)   0178 D5          					DEFB    0D5H	;
209)   0179 42 50 55 54 					DEFM    'BPUT'	;
210)   017D 00          					DEFB    0	;
211)   017E FB          					DEFB    0FBH	;
212)   017F 43 4F 4C 4F 					DEFM    'COLOUR'	;
212)   0183 55 52       					DEFM    'COLOUR'	;
213)   0185 FB          					DEFB    0FBH	;
214)   0186 43 4F 4C 4F 					DEFM    'COLOR'	;
214)   018A 52          					DEFM    'COLOR'	;
215)   018B D6          					DEFB    0D6H	;
216)   018C 43 41 4C 4C 					DEFM    'CALL'	;
217)   0190 D7          					DEFB    0D7H	;
218)   0191 43 48 41 49 					DEFM    'CHAIN'	;
218)   0195 4E          					DEFM    'CHAIN'	;
219)   0196 BD          					DEFB    0BDH	;
220)   0197 43 48 52 24 					DEFM    'CHR$'	;
221)   019B D8          					DEFB    0D8H	;
222)   019C 43 4C 45 41 					DEFM    'CLEAR'	;
222)   01A0 52          					DEFM    'CLEAR'	;
223)   01A1 00          					DEFB    0	;
224)   01A2 D9          					DEFB    0D9H	;
225)   01A3 43 4C 4F 53 					DEFM    'CLOSE'	;
225)   01A7 45          					DEFM    'CLOSE'	;
226)   01A8 00          					DEFB    0	;
227)   01A9 DA          					DEFB    0DAH	;
228)   01AA 43 4C 47    					DEFM    'CLG'	;
229)   01AD 00          					DEFB    0	;
230)   01AE DB          					DEFB    0DBH	;
231)   01AF 43 4C 53    					DEFM    'CLS'	;
232)   01B2 00          					DEFB    0	;
233)   01B3 9B          					DEFB    9BH	;
234)   01B4 43 4F 53    					DEFM    'COS'	;
235)   01B7 9C          					DEFB    9CH	;
236)   01B8 43 4F 55 4E 					DEFM    'COUNT'	;
236)   01BC 54          					DEFM    'COUNT'	;
237)   01BD 00          					DEFB    0	;
238)   01BE DC          					DEFB    0DCH	;
239)   01BF 44 41 54 41 					DEFM    'DATA'	;
240)   01C3 9D          					DEFB    9DH	;
241)   01C4 44 45 47    					DEFM    'DEG'	;
242)   01C7 DD          					DEFB    0DDH	;
243)   01C8 44 45 46    					DEFM    'DEF'	;
244)   01CB C7          					DEFB    0C7H	;
245)   01CC 44 45 4C 45 					DEFM    'DELETE'	;
245)   01D0 54 45       					DEFM    'DELETE'	;
246)   01D2 81          					DEFB    81H	;
247)   01D3 44 49 56    					DEFM    'DIV'	;
248)   01D6 DE          					DEFB    0DEH	;
249)   01D7 44 49 4D    					DEFM    'DIM'	;
250)   01DA DF          					DEFB    0DFH	;
251)   01DB 44 52 41 57 					DEFM    'DRAW'	;
252)   01DF E1          					DEFB    0E1H	;
253)   01E0 45 4E 44 50 					DEFM    'ENDPROC'	;
253)   01E4 52 4F 43    					DEFM    'ENDPROC'	;
254)   01E7 00          					DEFB    0	;
255)   01E8 E0          					DEFB    0E0H	;
256)   01E9 45 4E 44    					DEFM    'END'	;
257)   01EC 00          					DEFB    0	;
258)   01ED E2          					DEFB    0E2H	;
259)   01EE 45 4E 56 45 					DEFM    'ENVELOPE'	;
259)   01F2 4C 4F 50 45 					DEFM    'ENVELOPE'	;
260)   01F6 8B          					DEFB    8BH	;
261)   01F7 45 4C 53 45 					DEFM    'ELSE'	;
262)   01FB A0          					DEFB    0A0H	;
263)   01FC 45 56 41 4C 					DEFM    'EVAL'	;
264)   0200 9E          					DEFB    9EH	;
265)   0201 45 52 4C    					DEFM    'ERL'	;
266)   0204 00          					DEFB    0	;
267)   0205 85          					DEFB    85H	;
268)   0206 45 52 52 4F 					DEFM    'ERROR'	;
268)   020A 52          					DEFM    'ERROR'	;
269)   020B C5          					DEFB    0C5H	;
270)   020C 45 4F 46    					DEFM    'EOF'	;
271)   020F 00          					DEFB    0	;
272)   0210 82          					DEFB    82H	;
273)   0211 45 4F 52    					DEFM    'EOR'	;
274)   0214 9F          					DEFB    9FH	;
275)   0215 45 52 52    					DEFM    'ERR'	;
276)   0218 00          					DEFB    0	;
277)   0219 A1          					DEFB    0A1H	;
278)   021A 45 58 50    					DEFM    'EXP'	;
279)   021D A2          					DEFB    0A2H	;
280)   021E 45 58 54    					DEFM    'EXT'	;
281)   0221 00          					DEFB    0	;
282)   0222 E3          					DEFB    0E3H	;
283)   0223 46 4F 52    					DEFM    'FOR'	;
284)   0226 A3          					DEFB    0A3H	;
285)   0227 46 41 4C 53 					DEFM    'FALSE'	;
285)   022B 45          					DEFM    'FALSE'	;
286)   022C 00          					DEFB    0	;
287)   022D A4          					DEFB    0A4H	;
288)   022E 46 4E       					DEFM    'FN'	;
289)   0230 E5          					DEFB    0E5H	;
290)   0231 47 4F 54 4F 					DEFM    'GOTO'	;
291)   0235 BE          					DEFB    0BEH	;
292)   0236 47 45 54 24 					DEFM    'GET$'	;
293)   023A A5          					DEFB    0A5H	;
294)   023B 47 45 54    					DEFM    'GET'	;
295)   023E E4          					DEFB    0E4H	;
296)   023F 47 4F 53 55 					DEFM    'GOSUB'	;
296)   0243 42          					DEFM    'GOSUB'	;
297)   0244 E6          					DEFB    0E6H	;
298)   0245 47 43 4F 4C 					DEFM    'GCOL'	;
299)   0249 93          					DEFB    93H	;
300)   024A 48 49 4D 45 					DEFM    'HIMEM'	;
300)   024E 4D          					DEFM    'HIMEM'	;
301)   024F 00          					DEFB    0	;
302)   0250 E8          					DEFB    0E8H	;
303)   0251 49 4E 50 55 					DEFM    'INPUT'	;
303)   0255 54          					DEFM    'INPUT'	;
304)   0256 E7          					DEFB    0E7H	;
305)   0257 49 46       					DEFM    'IF'	;
306)   0259 BF          					DEFB    0BFH	;
307)   025A 49 4E 4B 45 					DEFM    'INKEY$'	;
307)   025E 59 24       					DEFM    'INKEY$'	;
308)   0260 A6          					DEFB    0A6H	;
309)   0261 49 4E 4B 45 					DEFM    'INKEY'	;
309)   0265 59          					DEFM    'INKEY'	;
310)   0266 A8          					DEFB    0A8H	;
311)   0267 49 4E 54    					DEFM    'INT'	;
312)   026A A7          					DEFB    0A7H	;
313)   026B 49 4E 53 54 					DEFM    'INSTR('	;
313)   026F 52 28       					DEFM    'INSTR('	;
314)   0271 C9          					DEFB    0C9H	;
315)   0272 4C 49 53 54 					DEFM    'LIST'	;
316)   0276 86          					DEFB    86H	;
317)   0277 4C 49 4E 45 					DEFM    'LINE'	;
318)   027B C8          					DEFB    0C8H	;
319)   027C 4C 4F 41 44 					DEFM    'LOAD'	;
320)   0280 92          					DEFB    92H	;
321)   0281 4C 4F 4D 45 					DEFM    'LOMEM'	;
321)   0285 4D          					DEFM    'LOMEM'	;
322)   0286 00          					DEFB    0	;
323)   0287 EA          					DEFB    0EAH	;
324)   0288 4C 4F 43 41 					DEFM    'LOCAL'	;
324)   028C 4C          					DEFM    'LOCAL'	;
325)   028D C0          					DEFB    0C0H	;
326)   028E 4C 45 46 54 					DEFM    'LEFT$('	;
326)   0292 24 28       					DEFM    'LEFT$('	;
327)   0294 A9          					DEFB    0A9H	;
328)   0295 4C 45 4E    					DEFM    'LEN'	;
329)   0298 E9          					DEFB    0E9H	;
330)   0299 4C 45 54    					DEFM    'LET'	;
331)   029C AB          					DEFB    0ABH	;
332)   029D 4C 4F 47    					DEFM    'LOG'	;
333)   02A0 AA          					DEFB    0AAH	;
334)   02A1 4C 4E       					DEFM    'LN'	;
335)   02A3 C1          					DEFB    0C1H	;
336)   02A4 4D 49 44 24 					DEFM    'MID$('	;
336)   02A8 28          					DEFM    'MID$('	;
337)   02A9 EB          					DEFB    0EBH	;
338)   02AA 4D 4F 44 45 					DEFM    'MODE'	;
339)   02AE 83          					DEFB    83H	;
340)   02AF 4D 4F 44    					DEFM    'MOD'	;
341)   02B2 EC          					DEFB    0ECH	;
342)   02B3 4D 4F 56 45 					DEFM    'MOVE'	;
343)   02B7 ED          					DEFB    0EDH	;
344)   02B8 4E 45 58 54 					DEFM    'NEXT'	;
345)   02BC CA          					DEFB    0CAH	;
346)   02BD 4E 45 57    					DEFM    'NEW'	;
347)   02C0 00          					DEFB    0	;
348)   02C1 AC          					DEFB    0ACH	;
349)   02C2 4E 4F 54    					DEFM    'NOT'	;
350)   02C5 CB          					DEFB    0CBH	;
351)   02C6 4F 4C 44    					DEFM    'OLD'	;
352)   02C9 00          					DEFB    0	;
353)   02CA EE          					DEFB    0EEH	;
354)   02CB 4F 4E       					DEFM    'ON'	;
355)   02CD 87          					DEFB    87H	;
356)   02CE 4F 46 46    					DEFM    'OFF'	;
357)   02D1 84          					DEFB    84H	;
358)   02D2 4F 52       					DEFM    'OR'	;
359)   02D4 8E          					DEFB    8EH	;
360)   02D5 4F 50 45 4E 					DEFM    'OPENIN'	;
360)   02D9 49 4E       					DEFM    'OPENIN'	;
361)   02DB AE          					DEFB    0AEH	;
362)   02DC 4F 50 45 4E 					DEFM    'OPENOUT'	;
362)   02E0 4F 55 54    					DEFM    'OPENOUT'	;
363)   02E3 AD          					DEFB    0ADH	;
364)   02E4 4F 50 45 4E 					DEFM    'OPENUP'	;
364)   02E8 55 50       					DEFM    'OPENUP'	;
365)   02EA FF          					DEFB    0FFH	;
366)   02EB 4F 53 43 4C 					DEFM    'OSCLI'	;
366)   02EF 49          					DEFM    'OSCLI'	;
367)   02F0 F1          					DEFB    0F1H	;
368)   02F1 50 52 49 4E 					DEFM    'PRINT'	;
368)   02F5 54          					DEFM    'PRINT'	;
369)   02F6 90          					DEFB    90H	;
370)   02F7 50 41 47 45 					DEFM    'PAGE'	;
371)   02FB 00          					DEFB    0	;
372)   02FC 8F          					DEFB    8FH	;
373)   02FD 50 54 52    					DEFM    'PTR'	;
374)   0300 00          					DEFB    0	;
375)   0301 AF          					DEFB    0AFH	;
376)   0302 50 49       					DEFM    'PI'	;
377)   0304 00          					DEFB    0	;
378)   0305 F0          					DEFB    0F0H	;
379)   0306 50 4C 4F 54 					DEFM    'PLOT'	;
380)   030A B0          					DEFB    0B0H	;
381)   030B 50 4F 49 4E 					DEFM    'POINT('	;
381)   030F 54 28       					DEFM    'POINT('	;
382)   0311 F2          					DEFB    0F2H	;
383)   0312 50 52 4F 43 					DEFM    'PROC'	;
384)   0316 B1          					DEFB    0B1H	;
385)   0317 50 4F 53    					DEFM    'POS'	;
386)   031A 00          					DEFB    0	;
387)   031B CE          					DEFB    0CEH	;
388)   031C 50 55 54    					DEFM    'PUT'	;
389)   031F F8          					DEFB    0F8H	;
390)   0320 52 45 54 55 					DEFM    'RETURN'	;
390)   0324 52 4E       					DEFM    'RETURN'	;
391)   0326 00          					DEFB    0	;
392)   0327 F5          					DEFB    0F5H	;
393)   0328 52 45 50 45 					DEFM    'REPEAT'	;
393)   032C 41 54       					DEFM    'REPEAT'	;
394)   032E F6          					DEFB    0F6H	;
395)   032F 52 45 50 4F 					DEFM    'REPORT'	;
395)   0333 52 54       					DEFM    'REPORT'	;
396)   0335 00          					DEFB    0	;
397)   0336 F3          					DEFB    0F3H	;
398)   0337 52 45 41 44 					DEFM    'READ'	;
399)   033B F4          					DEFB    0F4H	;
400)   033C 52 45 4D    					DEFM    'REM'	;
401)   033F F9          					DEFB    0F9H	;
402)   0340 52 55 4E    					DEFM    'RUN'	;
403)   0343 00          					DEFB    0	;
404)   0344 B2          					DEFB    0B2H	;
405)   0345 52 41 44    					DEFM    'RAD'	;
406)   0348 F7          					DEFB    0F7H	;
407)   0349 52 45 53 54 					DEFM    'RESTORE'	;
407)   034D 4F 52 45    					DEFM    'RESTORE'	;
408)   0350 C2          					DEFB    0C2H	;
409)   0351 52 49 47 48 					DEFM    'RIGHT$('	;
409)   0355 54 24 28    					DEFM    'RIGHT$('	;
410)   0358 B3          					DEFB    0B3H	;
411)   0359 52 4E 44    					DEFM    'RND'	;
412)   035C 00          					DEFB    0	;
413)   035D CC          					DEFB    0CCH	;
414)   035E 52 45 4E 55 					DEFM    'RENUMBER'	;
414)   0362 4D 42 45 52 					DEFM    'RENUMBER'	;
415)   0366 88          					DEFB    88H	;
416)   0367 53 54 45 50 					DEFM    'STEP'	;
417)   036B CD          					DEFB    0CDH	;
418)   036C 53 41 56 45 					DEFM    'SAVE'	;
419)   0370 B4          					DEFB    0B4H	;
420)   0371 53 47 4E    					DEFM    'SGN'	;
421)   0374 B5          					DEFB    0B5H	;
422)   0375 53 49 4E    					DEFM    'SIN'	;
423)   0378 B6          					DEFB    0B6H	;
424)   0379 53 51 52    					DEFM    'SQR'	;
425)   037C 89          					DEFB    89H	;
426)   037D 53 50 43    					DEFM    'SPC'	;
427)   0380 C3          					DEFB    0C3H	;
428)   0381 53 54 52 24 					DEFM    'STR$'	;
429)   0385 C4          					DEFB    0C4H	;
430)   0386 53 54 52 49 					DEFM    'STRING$('	;
430)   038A 4E 47 24 28 					DEFM    'STRING$('	;
431)   038E D4          					DEFB    0D4H	;
432)   038F 53 4F 55 4E 					DEFM    'SOUND'	;
432)   0393 44          					DEFM    'SOUND'	;
433)   0394 FA          					DEFB    0FAH	;
434)   0395 53 54 4F 50 					DEFM    'STOP'	;
435)   0399 00          					DEFB    0	;
436)   039A B7          					DEFB    0B7H	;
437)   039B 54 41 4E    					DEFM    'TAN'	;
438)   039E 8C          					DEFB    8CH	;
439)   039F 54 48 45 4E 					DEFM    'THEN'	;
440)   03A3 B8          					DEFB    0B8H	;
441)   03A4 54 4F       					DEFM    'TO'	;
442)   03A6 8A          					DEFB    8AH	;
443)   03A7 54 41 42 28 					DEFM    'TAB('	;
444)   03AB FC          					DEFB    0FCH	;
445)   03AC 54 52 41 43 					DEFM    'TRACE'	;
445)   03B0 45          					DEFM    'TRACE'	;
446)   03B1 91          					DEFB    91H	;
447)   03B2 54 49 4D 45 					DEFM    'TIME'	;
448)   03B6 00          					DEFB    0	;
449)   03B7 B9          					DEFB    0B9H	;
450)   03B8 54 52 55 45 					DEFM    'TRUE'	;
451)   03BC 00          					DEFB    0	;
452)   03BD FD          					DEFB    0FDH	;
453)   03BE 55 4E 54 49 					DEFM    'UNTIL'	;
453)   03C2 4C          					DEFM    'UNTIL'	;
454)   03C3 BA          					DEFB    0BAH	;
455)   03C4 55 53 52    					DEFM    'USR'	;
456)   03C7 EF          					DEFB    0EFH	;
457)   03C8 56 44 55    					DEFM    'VDU'	;
458)   03CB BB          					DEFB    0BBH	;
459)   03CC 56 41 4C    					DEFM    'VAL'	;
460)   03CF BC          					DEFB    0BCH	;
461)   03D0 56 50 4F 53 					DEFM    'VPOS'	;
462)   03D4 00          					DEFB    0	;
463)   03D5 FE          					DEFB    0FEH	;
464)   03D6 57 49 44 54 					DEFM    'WIDTH'	;
464)   03DA 48          					DEFM    'WIDTH'	;
465)   03DB D3          					DEFB    0D3H	;
466)   03DC 48 49 4D 45 					DEFM    'HIMEM'	;
466)   03E0 4D          					DEFM    'HIMEM'	;
467)   03E1 D2          					DEFB    0D2H	;
468)   03E2 4C 4F 4D 45 					DEFM    'LOMEM'	;
468)   03E6 4D          					DEFM    'LOMEM'	;
469)   03E7 D0          					DEFB    0D0H	;
470)   03E8 50 41 47 45 					DEFM    'PAGE'	;
471)   03EC CF          					DEFB    0CFH	;
472)   03ED 50 54 52    					DEFM    'PTR'	;
473)   03F0 D1          					DEFB    0D1H	;
474)   03F1 54 49 4D 45 					DEFM    'TIME'	;
475)   03F5 01          					DEFB    1	;
476)   03F6 4D 69 73 73 					DEFM    'Missing '	;
476)   03FA 69 6E 67 20 					DEFM    'Missing '	;
477)   03FE 02          					DEFB    2	;
478)   03FF 4E 6F 20 73 					DEFM    'No such '	;
478)   0403 75 63 68 20 					DEFM    'No such '	;
479)   0407 03          					DEFB    3	;
480)   0408 42 61 64 20 					DEFM    'Bad '	;
481)   040C 04          					DEFB    4	;
482)   040D 20 72 61 6E 					DEFM    ' range'	;
482)   0411 67 65       					DEFM    ' range'	;
483)   0413 05          					DEFB    5	;
484)   0414 76 61 72 69 					DEFM    'variable'	;
484)   0418 61 62 6C 65 					DEFM    'variable'	;
485)   041C 06          					DEFB    6	;
486)   041D 4F 75 74 20 					DEFM    'Out of'	;
486)   0421 6F 66       					DEFM    'Out of'	;
487)   0423 07          					DEFB    7	;
488)   0424 4E 6F 20    					DEFM    'No '	;
489)   0427 08          					DEFB    8	;
490)   0428 20 73 70 61 					DEFM    ' space'	;
490)   042C 63 65       					DEFM    ' space'	;
492)   042E FF FF       					DEFW    -1	;
496)   0430 07          		ERRWDS:			DEFB    7	;
497)   0431 72 6F 6F 6D 					DEFM    'room'	;
498)   0435 00          					DEFB    0	;
499)   0436 06          					DEFB    6	;
500)   0437 04          					DEFB    4	;
501)   0438 00          					DEFB    0	;
502)   0439 00 00       					DEFW    0	;
503)   043B 4D 69 73 74 					DEFM    'Mistake'	;
503)   043F 61 6B 65    					DEFM    'Mistake'	;
504)   0442 00          					DEFB    0	;
505)   0443 01          					DEFB    1	;
506)   0444 2C          					DEFM    ','	;
507)   0445 00          					DEFB    0	;
508)   0446 54 79 70 65 					DEFM    'Type mismatch'	;
508)   044A 20 6D 69 73 					DEFM    'Type mismatch'	;
508)   044E 6D 61 74 63 					DEFM    'Type mismatch'	;
508)   0452 68          					DEFM    'Type mismatch'	;
509)   0453 00          					DEFB    0	;
510)   0454 07          					DEFB    7	;
511)   0455 A4          					DEFB    FN	;
512)   0456 00 00       					DEFW    0	;
513)   0458 01          					DEFB    1	;
514)   0459 22          					DEFB    34		;ASCII ""	;ASCII ""
515)   045A 00          					DEFB    0	;
516)   045B 03          					DEFB    3	;
517)   045C DE          					DEFB    DIM	;
518)   045D 00          					DEFB    0	;
519)   045E DE          					DEFB    DIM	;
520)   045F 08          					DEFB    8	;
521)   0460 00          					DEFB    0	;
522)   0461 4E 6F 74 20 					DEFM    'Not '	;
523)   0465 EA          					DEFB    LOCAL	;
524)   0466 00          					DEFB    0	;
525)   0467 07          					DEFB    7	;
526)   0468 F2          					DEFB    PROC	;
527)   0469 00          					DEFB    0	;
528)   046A 41 72 72 61 					DEFM    'Array'	;
528)   046E 79          					DEFM    'Array'	;
529)   046F 00          					DEFB    0	;
530)   0470 53 75 62 73 					DEFM    'Subscript'	;
530)   0474 63 72 69 70 					DEFM    'Subscript'	;
530)   0478 74          					DEFM    'Subscript'	;
531)   0479 00          					DEFB    0	;
532)   047A 53 79 6E 74 					DEFM    'Syntax error'	;
532)   047E 61 78 20 65 					DEFM    'Syntax error'	;
532)   0482 72 72 6F 72 					DEFM    'Syntax error'	;
533)   0486 00          					DEFB    0	;
534)   0487 45 73 63 61 					DEFM    'Escape'	;
534)   048B 70 65       					DEFM    'Escape'	;
535)   048D 00          					DEFB    0	;
536)   048E 44 69 76 69 					DEFM    'Division by zero'	;
536)   0492 73 69 6F 6E 					DEFM    'Division by zero'	;
536)   0496 20 62 79 20 					DEFM    'Division by zero'	;
536)   049A 7A 65 72 6F 					DEFM    'Division by zero'	;
537)   049E 00          					DEFB    0	;
538)   049F 53 74 72 69 					DEFM    'String too long'	;
538)   04A3 6E 67 20 74 					DEFM    'String too long'	;
538)   04A7 6F 6F 20 6C 					DEFM    'String too long'	;
538)   04AB 6F 6E 67    					DEFM    'String too long'	;
539)   04AE 00          					DEFB    0	;
540)   04AF 54 6F 6F 20 					DEFM    'Too big'	;
540)   04B3 62 69 67    					DEFM    'Too big'	;
541)   04B6 00          					DEFB    0	;
542)   04B7 2D 76 65 20 					DEFM    '-ve root'	;
542)   04BB 72 6F 6F 74 					DEFM    '-ve root'	;
543)   04BF 00          					DEFB    0	;
544)   04C0 4C 6F 67    					DEFM    'Log'	;
545)   04C3 04          					DEFB    4	;
546)   04C4 00          					DEFB    0	;
547)   04C5 41 63 63 75 					DEFM    'Accuracy lost'	;
547)   04C9 72 61 63 79 					DEFM    'Accuracy lost'	;
547)   04CD 20 6C 6F 73 					DEFM    'Accuracy lost'	;
547)   04D1 74          					DEFM    'Accuracy lost'	;
548)   04D2 00          					DEFB    0	;
549)   04D3 45 78 70    					DEFM    'Exp'	;
550)   04D6 04          					DEFB    4	;
551)   04D7 00 00       					DEFW    0	;
552)   04D9 02          					DEFB    2	;
553)   04DA 05          					DEFB    5	;
554)   04DB 00          					DEFB    0	;
555)   04DC 01          					DEFB    1	;
556)   04DD 29          					DEFM    ')'	;
557)   04DE 00          					DEFB    0	;
558)   04DF 03          					DEFB    3	;
559)   04E0 48 45 58    					DEFM    'HEX'	;
560)   04E3 00          					DEFB    0	;
561)   04E4 02          					DEFB    2	;
562)   04E5 A4          					DEFB    FN	;
563)   04E6 2F          					DEFM    '/'	;
564)   04E7 F2          					DEFB    PROC	;
565)   04E8 00          					DEFB    0	;
566)   04E9 03          					DEFB    3	;
567)   04EA 63 61 6C 6C 					DEFM    'call'	;
568)   04EE 00          					DEFB    0	;
569)   04EF 41 72 67 75 					DEFM    'Arguments'	;
569)   04F3 6D 65 6E 74 					DEFM    'Arguments'	;
569)   04F7 73          					DEFM    'Arguments'	;
570)   04F8 00          					DEFB    0	;
571)   04F9 07          					DEFB    7	;
572)   04FA E3          					DEFB    FOR	;
573)   04FB 00          					DEFB    0	;
574)   04FC 43 61 6E 27 					DEFM    'Can't match '	;
574)   0500 74 20 6D 61 					DEFM    'Can't match '	;
574)   0504 74 63 68 20 					DEFM    'Can't match '	;
575)   0508 E3          					DEFB    FOR	;
576)   0509 00          					DEFB    0	;
577)   050A E3          					DEFB    FOR	;
578)   050B 20          					DEFM    ' '	;
579)   050C 05          					DEFB    5	;
580)   050D 00 00       					DEFW    0	;
581)   050F 07          					DEFB    7	;
582)   0510 B8          					DEFB    TO	;
583)   0511 00 00       					DEFW    0	;
584)   0513 07          					DEFB    7	;
585)   0514 E4          					DEFB    GOSUB	;
586)   0515 00          					DEFB    0	;
587)   0516 EE          					DEFB    ON	;
588)   0517 20 73 79 6E 					DEFM    ' syntax'	;
588)   051B 74 61 78    					DEFM    ' syntax'	;
589)   051E 00          					DEFB    0	;
590)   051F EE          					DEFB    ON	;
591)   0520 04          					DEFB    4	;
592)   0521 00          					DEFB    0	;
593)   0522 02          					DEFB    2	;
594)   0523 6C 69 6E 65 					DEFM    'line'	;
595)   0527 00          					DEFB    0	;
596)   0528 06          					DEFB    6	;
597)   0529 20          					DEFM    ' '	;
598)   052A DC          					DEFB    DATA	;
599)   052B 00          					DEFB    0	;
600)   052C 07          					DEFB    7	;
601)   052D F5          					DEFB    REPEAT	;
602)   052E 00 00       					DEFW    0	;
603)   0530 01          					DEFB    1	;
604)   0531 23          					DEFM    '#'	;
605)   0532 00          					DEFB    0	;
611)   0533 CD CA 07    		@DELETE:		CALL    SETTOP          ;SET TOP	;SET TOP
612)   0536 CD 30 0B    					CALL    DLPAIR	;
613)   0539 7E          		DELET1:			LD      A,(HL)	;
614)   053A B7          					OR      A	;
615)   053B 28 71       					JR      Z,WARMNC	;
616)   053D 23          					INC     HL	;
617)   053E 5E          					LD      E,(HL)	;
618)   053F 23          					INC     HL	;
619)   0540 56          					LD      D,(HL)	;
620)   0541 7A          					LD      A,D	;
621)   0542 B3          					OR      E	;
622)   0543 28 1A       					JR      Z,CLOOP1        ;LINE NUMBER ZERO	;LINE NUMBER ZERO
623)   0545 2B          					DEC     HL	;
624)   0546 2B          					DEC     HL	;
625)   0547 EB          					EX      DE,HL	;
626)   0548 37          					SCF	;
627)   0549 ED 42       					SBC     HL,BC	;
628)   054B EB          					EX      DE,HL	;
629)   054C 30 60       					JR      NC,WARMNC	;
630)   054E C5          					PUSH    BC	;
631)   054F CD 8A 07    					CALL    DEL	;
632)   0552 C1          					POP     BC	;
633)   0553 18 E4       					JR      DELET1	;
637)   0555 FD 23       		LISTO:			INC     IY              ;SKIP "O"	;SKIP "O"
638)   0557 CD B6 1E    					CALL    EXPRI	;
639)   055A D9          					EXX	;
640)   055B 7D          					LD      A,L	;
641)   055C 32 FE 62    					LD      (LISTON),A	;
642)   055F C3 91 00    		CLOOP1:			JP      CLOOP	;
650)   0562 FE 4F       		@LIST:			CP      'O'	;
651)   0564 28 EF       					JR      Z,LISTO	;
652)   0566 CD 30 0B    					CALL    DLPAIR	;
653)   0569 CD 9A 24    					CALL    NXT	;
654)   056C FE E7       					CP      TIF             ;IF CLAUSE ?	;IF CLAUSE ?
655)   056E 3E 00       					LD      A,0             ;INIT IF-CLAUSE LENGTH	;INIT IF-CLAUSE LENGTH
656)   0570 20 15       					JR      NZ,LISTB	;
657)   0572 FD 23       					INC     IY              ;SKIP IF	;SKIP IF
658)   0574 CD 9A 24    					CALL    NXT             ;SKIP SPACES (IF ANY)	;SKIP SPACES (IF ANY)
659)   0577 EB          					EX      DE,HL	;
660)   0578 FD E5       					PUSH    IY	;
661)   057A E1          					POP     HL              ;HL ADDRESSES IF CLAUSE	;HL ADDRESSES IF CLAUSE
662)   057B 3E 0D       					LD      A,CR	;
663)   057D C5          					PUSH    BC	;
664)   057E 01 00 01    					LD      BC,256	;
665)   0581 ED B1       					CPIR                    ;LOCATE CR	;LOCATE CR
666)   0583 79          					LD      A,C	;
667)   0584 2F          					CPL                     ;A = SUBSTRING LENGTH	;A = SUBSTRING LENGTH
668)   0585 C1          					POP     BC	;
669)   0586 EB          					EX      DE,HL	;
670)   0587 5F          		LISTB:			LD      E,A             ;IF-CLAUSE LENGTH	;IF-CLAUSE LENGTH
671)   0588 78          					LD      A,B	;
672)   0589 B1          					OR      C	;
673)   058A 20 01       					JR      NZ,LISTA	;
674)   058C 0B          					DEC     BC	;
675)   058D D9          		LISTA:			EXX	;
676)   058E DD 21 FE 62 					LD      IX,LISTON	;
677)   0592 01 00 00    					LD      BC,0            ;INDENTATION COUNT	;INDENTATION COUNT
678)   0595 D9          					EXX	;
679)   0596 3E 14       					LD      A,20	;
681)   0598 C5          		LISTC:			PUSH    BC              ;SAVE HIGH LINE NUMBER	;SAVE HIGH LINE NUMBER
682)   0599 D5          					PUSH    DE              ;SAVE IF-CLAUSE LENGTH	;SAVE IF-CLAUSE LENGTH
683)   059A E5          					PUSH    HL              ;SAVE PROGRAM POINTER	;SAVE PROGRAM POINTER
684)   059B 08          					EX      AF,AF'	;
685)   059C 7E          					LD      A,(HL)	;
686)   059D B7          					OR      A	;
687)   059E 28 0E       					JR      Z,WARMNC	;
691)   05A0 7B          					LD      A,E             ;A = IF-CLAUSE LENGTH	;A = IF-CLAUSE LENGTH
692)   05A1 23          					INC     HL	;
693)   05A2 5E          					LD      E,(HL)	;
694)   05A3 23          					INC     HL	;
695)   05A4 56          					LD      D,(HL)          ;DE = LINE NUMBER	;DE = LINE NUMBER
696)   05A5 2B          					DEC     HL	;
697)   05A6 2B          					DEC     HL	;
698)   05A7 D5          					PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
699)   05A8 EB          					EX      DE,HL	;
700)   05A9 37          					SCF	;
701)   05AA ED 42       					SBC     HL,BC	;
702)   05AC EB          					EX      DE,HL	;
703)   05AD D1          					POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
704)   05AE D2 90 00    		WARMNC:			JP      NC,WARM	;
705)   05B1 4E          					LD      C,(HL)          ;C = LINE LENGTH + 4	;C = LINE LENGTH + 4
706)   05B2 47          					LD      B,A             ;B = IF-CLAUSE LENGTH	;B = IF-CLAUSE LENGTH
710)   05B3 7A          					LD      A,D	;
711)   05B4 B3          					OR      E	;
712)   05B5 CA 91 00    					JP      Z,CLOOP	;
716)   05B8 23          					INC     HL	;
717)   05B9 23          					INC     HL	;
718)   05BA 23          					INC     HL              ;HL ADDRESSES LINE TEXT	;HL ADDRESSES LINE TEXT
719)   05BB 0D          					DEC     C	;
720)   05BC 0D          					DEC     C	;
721)   05BD 0D          					DEC     C	;
722)   05BE 0D          					DEC     C               ;C = LINE LENGTH	;C = LINE LENGTH
723)   05BF D5          					PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
724)   05C0 E5          					PUSH    HL              ;SAVE LINE ADDRESS	;SAVE LINE ADDRESS
725)   05C1 AF          					XOR     A               ;A <- 0	;A <- 0
726)   05C2 B8          					CP      B               ;WAS THERE AN IF-CLAUSE	;WAS THERE AN IF-CLAUSE
727)   05C3 FD E5       					PUSH    IY	;
728)   05C5 D1          					POP     DE              ;DE ADDRESSES IF-CLAUSE	;DE ADDRESSES IF-CLAUSE
729)   05C6 C4 55 22    					CALL    NZ,SEARCH       ;SEARCH FOR IF CLAUSE	;SEARCH FOR IF CLAUSE
730)   05C9 E1          					POP     HL              ;RESTORE LINE ADDRESS	;RESTORE LINE ADDRESS
731)   05CA D1          					POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
732)   05CB FD E5       					PUSH    IY	;
733)   05CD CC 06 08    					CALL    Z,LISTIT        ;LIST IF MATCH	;LIST IF MATCH
734)   05D0 FD E1       					POP     IY	;
736)   05D2 08          					EX      AF,AF'	;
737)   05D3 3D          					DEC     A	;
738)   05D4 CD 4B 40    					CALL    LTRAP	;
739)   05D7 E1          					POP     HL              ;RESTORE POINTER	;RESTORE POINTER
740)   05D8 5E          					LD      E,(HL)	;
741)   05D9 16 00       					LD      D,0	;
742)   05DB 19          					ADD     HL,DE           ;ADDRESS NEXT LINE	;ADDRESS NEXT LINE
743)   05DC D1          					POP     DE              ;RESTORE IF-CLAUSE LEN	;RESTORE IF-CLAUSE LEN
744)   05DD C1          					POP     BC              ;RESTORE HI LINE NUMBER	;RESTORE HI LINE NUMBER
745)   05DE 18 B8       					JR      LISTC	;
752)   05E0 CD EE 07    		@RENUM:			CALL    CLEAR           ;USES DYNAMIC AREA	;USES DYNAMIC AREA
753)   05E3 CD 0D 0B    					CALL    PAIR            ;LOAD HL,BC	;LOAD HL,BC
754)   05E6 D9          					EXX	;
755)   05E7 2A DC 62    					LD      HL,(PAGE)	;
756)   05EA ED 5B E0 62 					LD      DE,(LOMEM)	;
757)   05EE 7E          		RENUM1:			LD      A,(HL)          ;BUILD TABLE	;BUILD TABLE
758)   05EF B7          					OR      A	;
759)   05F0 28 30       					JR      Z,RENUM2	;
760)   05F2 23          					INC     HL	;
761)   05F3 4E          					LD      C,(HL)          ;OLD LINE NUMBER	;OLD LINE NUMBER
762)   05F4 23          					INC     HL	;
763)   05F5 46          					LD      B,(HL)	;
764)   05F6 78          					LD      A,B	;
765)   05F7 B1          					OR      C	;
766)   05F8 CA 91 00    					JP      Z,CLOOP         ;LINE NUMBER ZERO	;LINE NUMBER ZERO
767)   05FB EB          					EX      DE,HL	;
768)   05FC 71          					LD      (HL),C	;
769)   05FD 23          					INC     HL	;
770)   05FE 70          					LD      (HL),B	;
771)   05FF 23          					INC     HL	;
772)   0600 D9          					EXX	;
773)   0601 E5          					PUSH    HL	;
774)   0602 09          					ADD     HL,BC           ;ADD INCREMENT	;ADD INCREMENT
775)   0603 DA 08 0B    					JP      C,TOOBIG        ;"Too big"	;"Too big"
776)   0606 D9          					EXX	;
777)   0607 C1          					POP     BC	;
778)   0608 71          					LD      (HL),C	;
779)   0609 23          					INC     HL	;
780)   060A 70          					LD      (HL),B	;
781)   060B 23          					INC     HL	;
782)   060C EB          					EX      DE,HL	;
783)   060D 2B          					DEC     HL	;
784)   060E 2B          					DEC     HL	;
785)   060F AF          					XOR     A	;
786)   0610 47          					LD      B,A	;
787)   0611 4E          					LD      C,(HL)	;
788)   0612 09          					ADD     HL,BC           ;NEXT LINE	;NEXT LINE
789)   0613 EB          					EX      DE,HL	;
790)   0614 E5          					PUSH    HL	;
791)   0615 24          					INC     H	;
792)   0616 ED 72       					SBC     HL,SP	;
793)   0618 E1          					POP     HL	;
794)   0619 EB          					EX      DE,HL	;
795)   061A 38 D2       					JR      C,RENUM1        ;CONTINUE	;CONTINUE
796)   061C CD 12 07    					CALL    EXTERR          ;"RENUMBER space'	;"RENUMBER space'
797)   061F CC          					DEFB    REN	;
798)   0620 08          					DEFB    8	;
799)   0621 00          					DEFB    0	;
801)   0622 EB          		RENUM2:			EX      DE,HL	;
802)   0623 36 FF       					LD      (HL),-1	;
803)   0625 23          					INC     HL	;
804)   0626 36 FF       					LD      (HL),-1	;
805)   0628 ED 5B E0 62 					LD      DE,(LOMEM)	;
806)   062C D9          					EXX	;
807)   062D 2A DC 62    					LD      HL,(PAGE)	;
808)   0630 4E          		RENUM3:			LD      C,(HL)	;
809)   0631 79          					LD      A,C	;
810)   0632 B7          					OR      A	;
811)   0633 CA 90 00    					JP      Z,WARM	;
812)   0636 D9          					EXX	;
813)   0637 EB          					EX      DE,HL	;
814)   0638 23          					INC     HL	;
815)   0639 23          					INC     HL	;
816)   063A 5E          					LD      E,(HL)	;
817)   063B 23          					INC     HL	;
818)   063C 56          					LD      D,(HL)	;
819)   063D 23          					INC     HL	;
820)   063E D5          					PUSH    DE	;
821)   063F EB          					EX      DE,HL	;
822)   0640 22 E6 62    					LD      (LINENO),HL	;
823)   0643 D9          					EXX	;
824)   0644 D1          					POP     DE	;
825)   0645 23          					INC     HL	;
826)   0646 73          					LD      (HL),E          ;NEW LINE NUMBER	;NEW LINE NUMBER
827)   0647 23          					INC     HL	;
828)   0648 72          					LD      (HL),D	;
829)   0649 23          					INC     HL	;
830)   064A 0D          					DEC     C	;
831)   064B 0D          					DEC     C	;
832)   064C 0D          					DEC     C	;
833)   064D 06 00       					LD      B,0	;
834)   064F 3E 8D       		RENUM7:			LD      A,LINO	;
835)   0651 ED B1       					CPIR                    ;SEARCH FOR LINE NUMBER	;SEARCH FOR LINE NUMBER
836)   0653 20 DB       					JR      NZ,RENUM3	;
837)   0655 C5          					PUSH    BC	;
838)   0656 E5          					PUSH    HL	;
839)   0657 E5          					PUSH    HL	;
840)   0658 FD E1       					POP     IY	;
841)   065A D9          					EXX	;
842)   065B CD 48 23    					CALL    DECODE          ;DECODE LINE NUMBER	;DECODE LINE NUMBER
843)   065E D9          					EXX	;
844)   065F 44          					LD      B,H	;
845)   0660 4D          					LD      C,L	;
846)   0661 2A E0 62    					LD      HL,(LOMEM)	;
847)   0664 5E          		RENUM4:			LD      E,(HL)          ;CROSS-REFERENCE TABLE	;CROSS-REFERENCE TABLE
848)   0665 23          					INC     HL	;
849)   0666 56          					LD      D,(HL)	;
850)   0667 23          					INC     HL	;
851)   0668 EB          					EX      DE,HL	;
852)   0669 B7          					OR      A               ;CLEAR CARRY	;CLEAR CARRY
853)   066A ED 42       					SBC     HL,BC	;
854)   066C EB          					EX      DE,HL	;
855)   066D 5E          					LD      E,(HL)          ;NEW NUMBER	;NEW NUMBER
856)   066E 23          					INC     HL	;
857)   066F 56          					LD      D,(HL)	;
858)   0670 23          					INC     HL	;
859)   0671 38 F1       					JR      C,RENUM4	;
860)   0673 EB          					EX      DE,HL	;
861)   0674 28 19       					JR      Z,RENUM5        ;FOUND	;FOUND
862)   0676 CD 4D 0C    					CALL    TELL	;
863)   0679 46 61 69 6C 					DEFM    'Failed at '	;
863)   067D 65 64 20 61 					DEFM    'Failed at '	;
863)   0681 74 20       					DEFM    'Failed at '	;
864)   0683 00          					DEFB    0	;
865)   0684 2A E6 62    					LD      HL,(LINENO)	;
866)   0687 CD 23 09    					CALL    PBCDL	;
867)   068A CD 8F 08    					CALL    CRLF	;
868)   068D 18 06       					JR      RENUM6	;
869)   068F D1          		RENUM5:			POP     DE	;
870)   0690 D5          					PUSH    DE	;
871)   0691 1B          					DEC     DE	;
872)   0692 CD 1B 0C    					CALL    ENCODE          ;RE-WRITE NUMBER	;RE-WRITE NUMBER
873)   0695 E1          		RENUM6:			POP     HL	;
874)   0696 C1          					POP     BC	;
875)   0697 18 B6       					JR      RENUM7	;
882)   0699 CD 0D 0B    		@AUTO:			CALL    PAIR	;
883)   069C 22 EA 62    					LD      (AUTONO),HL	;
884)   069F 79          					LD      A,C	;
885)   06A0 32 FF 62    					LD      (INCREM),A	;
886)   06A3 18 29       					JR      CLOOP0	;
891)   06A5 CD 4D 0C    		BAD:			CALL    TELL            ;"Bad program'	;"Bad program'
892)   06A8 03          					DEFB    3	;
893)   06A9 70 72 6F 67 					DEFM    'program'	;
893)   06AD 72 61 6D    					DEFM    'program'	;
894)   06B0 0D          					DEFB    CR	;
895)   06B1 0A          					DEFB    LF	;
896)   06B2 00          					DEFB    0	;
897)   06B3 CD E6 07    		@NEW:			CALL    NEWIT	;
898)   06B6 18 16       					JR      CLOOP0	;
902)   06B8 2A DC 62    		@OLD:			LD      HL,(PAGE)	;
903)   06BB E5          					PUSH    HL	;
904)   06BC 23          					INC     HL	;
905)   06BD 23          					INC     HL	;
906)   06BE 23          					INC     HL	;
907)   06BF 01 FC 00    					LD      BC,252	;
908)   06C2 3E 0D       					LD      A,CR	;
909)   06C4 ED B1       					CPIR	;
910)   06C6 20 DD       					JR      NZ,BAD	;
911)   06C8 7D          					LD      A,L	;
912)   06C9 E1          					POP     HL	;
913)   06CA 77          					LD      (HL),A	;
914)   06CB CD BF 07    					CALL    CLEAN	;
915)   06CE C3 91 00    		CLOOP0:			JP      CLOOP	;
919)   06D1 CD BF 1E    		@LOAD:			CALL    EXPRS           ;GET FILENAME	;GET FILENAME
920)   06D4 3E 0D       					LD      A,CR	;
921)   06D6 12          					LD      (DE),A	;
922)   06D7 CD A5 07    					CALL    LOAD0	;
923)   06DA CD EE 07    					CALL    CLEAR	;
924)   06DD 18 1B       					JR      WARM0	;
928)   06DF CD CA 07    		@SAVE:			CALL    SETTOP          ;SET TOP	;SET TOP
929)   06E2 CD BF 1E    					CALL    EXPRS           ;FILENAME	;FILENAME
930)   06E5 3E 0D       					LD      A,CR	;
931)   06E7 12          					LD      (DE),A	;
932)   06E8 ED 5B DC 62 					LD      DE,(PAGE)	;
933)   06EC 2A DE 62    					LD      HL,(TOP)	;
934)   06EF B7          					OR      A	;
935)   06F0 ED 52       					SBC     HL,DE	;
936)   06F2 44          					LD      B,H             ;LENGTH OF PROGRAM	;LENGTH OF PROGRAM
937)   06F3 4D          					LD      C,L	;
938)   06F4 21 00 60    					LD      HL,ACCS	;
939)   06F7 CD 36 40    					CALL    OSSAVE	;
940)   06FA C3 90 00    		WARM0:			JP      WARM	;
944)   06FD ED 7B E4 62 		@ERROR:			LD      SP,(HIMEM)	;
945)   0701 21 30 04    					LD      HL,ERRWDS	;
946)   0704 B7          					OR      A	;
947)   0705 28 0A       					JR      Z,ERROR1	;
948)   0707 47          					LD      B,A             ;ERROR NUMBER	;ERROR NUMBER
949)   0708 08          					EX      AF,AF'	;
950)   0709 AF          					XOR     A	;
951)   070A BE          		ERROR0:			CP      (HL)	;
952)   070B 23          					INC     HL	;
953)   070C 20 FC       					JR      NZ,ERROR0	;
954)   070E 10 FA       					DJNZ    ERROR0	;
955)   0710 08          					EX      AF,AF'	;
956)   0711 E5          		ERROR1:			PUSH    HL	;
957)   0712 E1          		@EXTERR:		POP     HL	;
958)   0713 22 EE 62    					LD      (ERRTXT),HL	;
959)   0716 ED 7B E4 62 					LD      SP,(HIMEM)	;
960)   071A 32 FD 62    					LD      (ERR),A	;
961)   071D CD E6 08    					CALL    SETLIN	;
962)   0720 22 F2 62    					LD      (ERL),HL	;
963)   0723 B7          					OR      A	;
964)   0724 28 0B       					JR      Z,ERROR2	;
965)   0726 2A EC 62    					LD      HL,(ERRTRP)	;
966)   0729 7C          					LD      A,H	;
967)   072A B5          					OR      L	;
968)   072B E5          					PUSH    HL	;
969)   072C FD E1       					POP     IY	;
970)   072E C2 0A 0D    					JP      NZ,XEQ          ;ERROR TRAPPED	;ERROR TRAPPED
971)   0731 21 00 00    		ERROR2:			LD      HL,0	;
972)   0734 22 EA 62    					LD      (AUTONO),HL	;
973)   0737 22 E8 62    					LD      (TRACEN),HL     ;CANCEL TRACE	;CANCEL TRACE
974)   073A CD 45 40    					CALL    RESET           ;RESET OPSYS	;RESET OPSYS
975)   073D CD 8F 08    					CALL    CRLF	;
976)   0740 CD 41 0C    					CALL    REPORT          ;MESSAGE	;MESSAGE
977)   0743 CD 10 09    					CALL    SAYLN	;
978)   0746 1E 00       					LD      E,0	;
979)   0748 DC 2D 40    					CALL    C,OSSHUT        ;CLOSE ALL FILES	;CLOSE ALL FILES
980)   074B CD 8F 08    					CALL    CRLF	;
981)   074E C3 91 00    					JP      CLOOP	;
994)   0751 21 4F 01    		LEX:			LD      HL,KEYWDS	;
995)   0754 FD 7E 00    		LEX0:			LD      A,(IY)	;
996)   0757 46          					LD      B,(HL)	;
997)   0758 23          					INC     HL	;
998)   0759 BE          					CP      (HL)	;
999)   075A 28 08       					JR      Z,LEX2	;
1000)   075C D8          					RET     C               ;FAIL EXIT	;FAIL EXIT
1001)   075D 23          		LEX1:			INC     HL	;
1002)   075E CB 7E       					BIT     7,(HL)	;
1003)   0760 28 FB       					JR      Z,LEX1	;
1004)   0762 18 F0       					JR      LEX0	;
1005)   0764 FD E5       		LEX2:			PUSH    IY              ;SAVE POINTER	;SAVE POINTER
1006)   0766 23          		LEX3:			INC     HL	;
1007)   0767 CB 7E       					BIT     7,(HL)	;
1008)   0769 20 1B       					JR      NZ,LEX6         ;FOUND	;FOUND
1009)   076B FD 23       					INC     IY	;
1010)   076D FD 7E 00    					LD      A,(IY)	;
1011)   0770 FE 2E       					CP      '.'	;
1012)   0772 28 12       					JR      Z,LEX6          ;FOUND (ABBREV.)	;FOUND (ABBREV.)
1013)   0774 BE          					CP      (HL)	;
1014)   0775 28 EF       					JR      Z,LEX3	;
1015)   0777 CD 54 0B    					CALL    RANGE1	;
1016)   077A 38 04       					JR      C,LEX5	;
1017)   077C FD E1       		LEX4:			POP     IY              ;RESTORE POINTER	;RESTORE POINTER
1018)   077E 18 DD       					JR      LEX1	;
1019)   0780 7E          		LEX5:			LD      A,(HL)	;
1020)   0781 B7          					OR      A	;
1021)   0782 20 F8       					JR      NZ,LEX4	;
1022)   0784 FD 2B       					DEC     IY	;
1023)   0786 F1          		LEX6:			POP     AF	;
1024)   0787 AF          					XOR     A	;
1025)   0788 78          					LD      A,B	;
1026)   0789 C9          					RET	;
1032)   078A D5          		DEL:			PUSH    DE	;
1033)   078B E5          					PUSH    HL	;
1034)   078C E5          					PUSH    HL	;
1035)   078D 06 00       					LD      B,0	;
1036)   078F 4E          					LD      C,(HL)	;
1037)   0790 09          					ADD     HL,BC	;
1038)   0791 E5          					PUSH    HL	;
1039)   0792 EB          					EX      DE,HL	;
1040)   0793 2A DE 62    					LD      HL,(TOP)	;
1041)   0796 ED 52       					SBC     HL,DE	;
1042)   0798 44          					LD      B,H	;
1043)   0799 4D          					LD      C,L	;
1044)   079A E1          					POP     HL	;
1045)   079B D1          					POP     DE	;
1046)   079C ED B0       					LDIR                    ;DELETE LINE	;DELETE LINE
1047)   079E ED 53 DE 62 					LD      (TOP),DE	;
1048)   07A2 E1          					POP     HL	;
1049)   07A3 D1          					POP     DE	;
1050)   07A4 C9          					RET	;
1060)   07A5 ED 5B DC 62 		@LOAD0: 		LD      DE,(PAGE)	;
1061)   07A9 21 00 FF    					LD      HL,-256	;
1062)   07AC 39          					ADD     HL,SP	;
1063)   07AD ED 52       					SBC     HL,DE           ;FIND AVAILABLE SPACE	;FIND AVAILABLE SPACE
1064)   07AF 44          					LD      B,H	;
1065)   07B0 4D          					LD      C,L	;
1066)   07B1 21 00 60    					LD      HL,ACCS	;
1067)   07B4 CD 39 40    					CALL    OSLOAD          ;LOAD	;LOAD
1068)   07B7 D4 E6 07    					CALL    NC,NEWIT	;
1069)   07BA 3E 00       					LD      A,0	;
1070)   07BC D2 FD 06    					JP      NC,ERROR        ;"No room"	;"No room"
1071)   07BF CD CA 07    		CLEAN:			CALL    SETTOP	;
1072)   07C2 2B          					DEC     HL	;
1073)   07C3 36 FF       					LD      (HL),-1         ;WRITE &FFFF	;WRITE &FFFF
1074)   07C5 2B          					DEC     HL	;
1075)   07C6 36 FF       					LD      (HL),-1	;
1076)   07C8 18 24       					JR      CLEAR	;
1078)   07CA 2A DC 62    		SETTOP:			LD      HL,(PAGE)	;
1079)   07CD 06 00       					LD      B,0	;
1080)   07CF 3E 0D       					LD      A,CR	;
1081)   07D1 4E          		SETOP1:			LD      C,(HL)	;
1082)   07D2 0C          					INC     C	;
1083)   07D3 0D          					DEC     C	;
1084)   07D4 28 09       					JR      Z,SETOP2	;
1085)   07D6 09          					ADD     HL,BC	;
1086)   07D7 2B          					DEC     HL	;
1087)   07D8 BE          					CP      (HL)	;
1088)   07D9 23          					INC     HL	;
1089)   07DA 28 F5       					JR      Z,SETOP1	;
1090)   07DC C3 A5 06    					JP      BAD	;
1091)   07DF 23          		SETOP2:			INC     HL              ;N.B. CALLED FROM NEWIT	;N.B. CALLED FROM NEWIT
1092)   07E0 23          					INC     HL	;
1093)   07E1 23          					INC     HL	;
1094)   07E2 22 DE 62    					LD      (TOP),HL	;
1095)   07E5 C9          					RET	;
1104)   07E6 2A DC 62    		NEWIT:			LD      HL,(PAGE)	;
1105)   07E9 36 00       					LD      (HL),0	;
1106)   07EB CD DF 07    					CALL    SETOP2	;
1107)   07EE E5          		@CLEAR:			PUSH    HL	;
1108)   07EF 2A DE 62    					LD      HL,(TOP)	;
1109)   07F2 22 E0 62    					LD      (LOMEM),HL	;
1110)   07F5 22 E2 62    					LD      (FREE),HL	;
1111)   07F8 21 6C 62    					LD      HL,DYNVAR	;
1112)   07FB C5          					PUSH    BC	;
1113)   07FC 06 70       					LD      B,2*(54+2)	;
1114)   07FE 36 00       		CLEAR1:			LD      (HL),0	;
1115)   0800 23          					INC     HL	;
1116)   0801 10 FB       					DJNZ    CLEAR1	;
1117)   0803 C1          					POP     BC	;
1118)   0804 E1          					POP     HL	;
1119)   0805 C9          					RET	;
1127)   0806 E5          		LISTIT:			PUSH    HL	;
1128)   0807 EB          					EX      DE,HL	;
1129)   0808 C5          					PUSH    BC	;
1130)   0809 CD 27 09    					CALL    PBCD	;
1131)   080C C1          					POP     BC	;
1132)   080D E1          					POP     HL	;
1133)   080E 7E          					LD      A,(HL)	;
1134)   080F FE ED       					CP      NEXT	;
1135)   0811 CC 72 08    					CALL    Z,INDENT	;
1136)   0814 FE FD       					CP      UNTIL	;
1137)   0816 CC 72 08    					CALL    Z,INDENT	;
1138)   0819 D9          					EXX	;
1139)   081A 3E 20       					LD      A,' '	;
1140)   081C DD CB 00 46 					BIT     0,(IX)	;
1141)   0820 C4 96 08    					CALL    NZ,OUTCHR	;
1142)   0823 78          					LD      A,B	;
1143)   0824 87          					ADD     A,A	;
1144)   0825 DD CB 00 4E 					BIT     1,(IX)	;
1145)   0829 C4 4C 17    					CALL    NZ,FILL	;
1146)   082C 79          					LD      A,C	;
1147)   082D 87          					ADD     A,A	;
1148)   082E DD CB 00 56 					BIT     2,(IX)	;
1149)   0832 C4 4C 17    					CALL    NZ,FILL	;
1150)   0835 D9          					EXX	;
1151)   0836 7E          					LD      A,(HL)	;
1152)   0837 FE E3       					CP      FOR	;
1153)   0839 CC 72 08    					CALL    Z,INDENT	;
1154)   083C FE F5       					CP      REPEAT	;
1155)   083E CC 72 08    					CALL    Z,INDENT	;
1156)   0841 1E 00       					LD      E,0	;
1157)   0843 7E          		LIST8:			LD      A,(HL)	;
1158)   0844 23          					INC     HL	;
1159)   0845 FE 0D       					CP      CR	;
1160)   0847 28 46       					JR      Z,CRLF	;
1161)   0849 FE 22       					CP      34		;ASCII ""	;ASCII ""
1162)   084B 20 01       					JR      NZ,LIST7	;
1163)   084D 1C          					INC     E	;
1164)   084E CD 66 08    		LIST7:			CALL    LOUT	;
1165)   0851 18 F0       					JR      LIST8	;
1167)   0853 E5          		PRLINO:			PUSH    HL	;
1168)   0854 FD E1       					POP     IY	;
1169)   0856 C5          					PUSH    BC	;
1170)   0857 CD 48 23    					CALL    DECODE	;
1171)   085A C1          					POP     BC	;
1172)   085B D9          					EXX	;
1173)   085C C5          					PUSH    BC	;
1174)   085D CD 23 09    					CALL    PBCDL	;
1175)   0860 C1          					POP     BC	;
1176)   0861 D9          					EXX	;
1177)   0862 FD E5       					PUSH    IY	;
1178)   0864 E1          					POP     HL	;
1179)   0865 C9          					RET	;
1181)   0866 CB 43       		LOUT:			BIT     0,E	;
1182)   0868 20 2C       					JR      NZ,OUTCHR	;
1183)   086A FE 8D       					CP      LINO	;
1184)   086C 28 E5       					JR      Z,PRLINO	;
1185)   086E CD AF 08    					CALL    OUT	;
1186)   0871 7E          					LD      A,(HL)	;
1187)   0872 D9          		INDENT:			EXX	;
1188)   0873 FE E3       					CP      FOR	;
1189)   0875 28 08       					JR      Z,IND1	;
1190)   0877 FE ED       					CP      NEXT	;
1191)   0879 20 05       					JR      NZ,IND2	;
1192)   087B 05          					DEC     B	;
1193)   087C F2 80 08    					JP      P,IND2	;
1194)   087F 04          		IND1:			INC     B	;
1195)   0880 FE F5       		IND2:			CP      REPEAT	;
1196)   0882 28 08       					JR      Z,IND3	;
1197)   0884 FE FD       					CP      UNTIL	;
1198)   0886 20 05       					JR      NZ,IND4	;
1199)   0888 0D          					DEC     C	;
1200)   0889 F2 8D 08    					JP      P,IND4	;
1201)   088C 0C          		IND3:			INC     C	;
1202)   088D D9          		IND4:			EXX	;
1203)   088E C9          					RET	;
1211)   088F 3E 0D       		@CRLF:			LD      A,CR	;
1212)   0891 CD 96 08    					CALL    OUTCHR	;
1213)   0894 3E 0A       					LD      A,LF	;
1214)   0896 CD 15 40    		@OUTCHR:		CALL    OSWRCH	;
1215)   0899 D6 0D       					SUB     CR	;
1216)   089B 28 05       					JR      Z,CARRET	;
1217)   089D D8          					RET     C               ;NON-PRINTING	;NON-PRINTING
1218)   089E 3A FB 62    					LD      A,(COUNT)	;
1219)   08A1 3C          					INC     A	;
1220)   08A2 32 FB 62    		CARRET:			LD      (COUNT),A	;
1221)   08A5 C8          					RET     Z	;
1222)   08A6 E5          					PUSH    HL	;
1223)   08A7 2A FC 62    					LD      HL,(WIDTH)	;
1224)   08AA BD          					CP      L	;
1225)   08AB E1          					POP     HL	;
1226)   08AC C0          					RET     NZ	;
1227)   08AD 18 E0       					JR      CRLF	;
1234)   08AF FE 8A       		@OUT:			CP      138	;
1235)   08B1 EA 96 08    					JP      PE,OUTCHR	;
1236)   08B4 C5          					PUSH    BC	;
1237)   08B5 E5          					PUSH    HL	;
1238)   08B6 21 4F 01    					LD      HL,KEYWDS	;
1239)   08B9 01 DF 02    					LD      BC,KEYWDL	;
1240)   08BC ED B1       					CPIR	;
1241)   08BE 7E          		TOKEN1:			LD      A,(HL)	;
1242)   08BF 23          					INC     HL	;
1243)   08C0 FE 8A       					CP      138	;
1244)   08C2 F5          					PUSH    AF	;
1245)   08C3 EC 96 08    					CALL    PE,OUTCHR	;
1246)   08C6 F1          					POP     AF	;
1247)   08C7 EA BE 08    					JP      PE,TOKEN1	;
1248)   08CA E1          					POP     HL	;
1249)   08CB C1          					POP     BC	;
1250)   08CC C9          					RET	;
1259)   08CD EB          		@FINDL:			EX      DE,HL	;
1260)   08CE 2A DC 62    					LD      HL,(PAGE)	;
1261)   08D1 AF          					XOR     A               ;A=0	;A=0
1262)   08D2 BE          					CP      (HL)	;
1263)   08D3 3C          					INC     A	;
1264)   08D4 D0          					RET     NC	;
1265)   08D5 AF          					XOR     A               ;CLEAR CARRY	;CLEAR CARRY
1266)   08D6 47          					LD      B,A	;
1267)   08D7 4E          		FINDL1:			LD      C,(HL)	;
1268)   08D8 E5          					PUSH    HL	;
1269)   08D9 23          					INC     HL	;
1270)   08DA 7E          					LD      A,(HL)	;
1271)   08DB 23          					INC     HL	;
1272)   08DC 66          					LD      H,(HL)	;
1273)   08DD 6F          					LD      L,A	;
1274)   08DE ED 52       					SBC     HL,DE	;
1275)   08E0 E1          					POP     HL	;
1276)   08E1 D0          					RET     NC              ;FOUND OR PAST	;FOUND OR PAST
1277)   08E2 09          					ADD     HL,BC	;
1278)   08E3 C3 D7 08    					JP      FINDL1	;
1286)   08E6 06 00       		@SETLIN:		LD      B,0	;
1287)   08E8 ED 5B F4 62 					LD      DE,(ERRLIN)	;
1288)   08EC 2A DC 62    					LD      HL,(PAGE)	;
1289)   08EF B7          					OR      A	;
1290)   08F0 ED 52       					SBC     HL,DE	;
1291)   08F2 19          					ADD     HL,DE	;
1292)   08F3 30 16       					JR      NC,SET3	;
1293)   08F5 4E          		SET1:			LD      C,(HL)	;
1294)   08F6 0C          					INC     C	;
1295)   08F7 0D          					DEC     C	;
1296)   08F8 28 11       					JR      Z,SET3	;
1297)   08FA 09          					ADD     HL,BC	;
1298)   08FB ED 52       					SBC     HL,DE	;
1299)   08FD 19          					ADD     HL,DE	;
1300)   08FE 38 F5       					JR      C,SET1	;
1301)   0900 ED 42       					SBC     HL,BC	;
1302)   0902 23          					INC     HL	;
1303)   0903 5E          					LD      E,(HL)          ;LINE NUMBER	;LINE NUMBER
1304)   0904 23          					INC     HL	;
1305)   0905 56          					LD      D,(HL)	;
1306)   0906 EB          					EX      DE,HL	;
1307)   0907 22 E6 62    		SET2:			LD      (LINENO),HL	;
1308)   090A C9          					RET	;
1309)   090B 21 00 00    		SET3:			LD      HL,0	;
1310)   090E 18 F7       					JR      SET2	;
1317)   0910 2A E6 62    		@SAYLN:			LD      HL,(LINENO)	;
1318)   0913 7C          					LD      A,H	;
1319)   0914 B5          					OR      L	;
1320)   0915 C8          					RET     Z	;
1321)   0916 CD 4D 0C    					CALL    TELL	;
1322)   0919 20 61 74 20 					DEFM    ' at line '	;
1322)   091D 6C 69 6E 65 					DEFM    ' at line '	;
1322)   0921 20          					DEFM    ' at line '	;
1323)   0922 00          					DEFB    0	;
1324)   0923 0E 00       		@PBCDL:			LD      C,0	;
1325)   0925 18 02       					JR      PBCD0	;
1332)   0927 0E 20       		PBCD:			LD      C,' '	;
1333)   0929 06 05       		PBCD0:			LD      B,5	;
1334)   092B 11 10 27    					LD      DE,10000	;
1335)   092E AF          		PBCD1:			XOR     A	;
1336)   092F ED 52       		PBCD2:			SBC     HL,DE	;
1337)   0931 3C          					INC     A	;
1338)   0932 30 FB       					JR      NC,PBCD2	;
1339)   0934 19          					ADD     HL,DE	;
1340)   0935 3D          					DEC     A	;
1341)   0936 28 04       					JR      Z,PBCD3	;
1342)   0938 CB E1       					SET     4,C	;
1343)   093A CB E9       					SET     5,C	;
1344)   093C B1          		PBCD3:			OR      C	;
1345)   093D C4 96 08    					CALL    NZ,OUTCHR	;
1346)   0940 78          					LD      A,B	;
1347)   0941 FE 05       					CP      5	;
1348)   0943 28 06       					JR      Z,PBCD4	;
1349)   0945 29          					ADD     HL,HL	;
1350)   0946 54          					LD      D,H	;
1351)   0947 5D          					LD      E,L	;
1352)   0948 29          					ADD     HL,HL	;
1353)   0949 29          					ADD     HL,HL	;
1354)   094A 19          					ADD     HL,DE	;
1355)   094B 11 E8 03    		PBCD4:			LD      DE,1000	;
1356)   094E 10 DE       					DJNZ    PBCD1	;
1357)   0950 37          					SCF	;
1358)   0951 C9          					RET	;
1365)   0952 CD 9F 0A    		@PUTVAR:		CALL    CREATE	;
1366)   0955 FD 7E 00    					LD      A,(IY)	;
1367)   0958 FE 28       					CP      '('	;
1368)   095A 20 68       					JR      NZ,GETVZ        ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1369)   095C 3E 0E       		ARRAY:			LD      A,14            ;'Array'	;'Array'
1370)   095E C3 FD 06    		ERROR3:			JP      ERROR	;
1383)   0961 FD 7E 00    		@GETVAR:		LD      A,(IY)	;
1384)   0964 FE 24       					CP      '$'	;
1385)   0966 28 62       					JR      Z,GETV4	;
1386)   0968 FE 21       					CP      '!'	;
1387)   096A 28 62       					JR      Z,GETV5	;
1388)   096C FE 3F       					CP      '?'	;
1389)   096E 28 62       					JR      Z,GETV6	;
1390)   0970 CD 17 0A    					CALL    LOCATE	;
1391)   0973 C0          					RET     NZ	;
1392)   0974 FD 7E 00    					LD      A,(IY)	;
1393)   0977 FE 28       					CP      '('             ;ARRAY?	;ARRAY?
1394)   0979 20 41       					JR      NZ,GETVX        ;EXIT	;EXIT
1395)   097B D5          					PUSH    DE              ;SAVE TYPE	;SAVE TYPE
1396)   097C 7E          					LD      A,(HL)          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
1397)   097D B7          					OR      A	;
1398)   097E 28 DC       					JR      Z,ARRAY	;
1399)   0980 23          					INC     HL	;
1400)   0981 11 00 00    					LD      DE,0            ;ACCUMULATOR	;ACCUMULATOR
1401)   0984 F5          					PUSH    AF	;
1402)   0985 FD 23       					INC     IY              ;SKIP (	;SKIP (
1403)   0987 18 04       					JR      GETV3	;
1404)   0989 F5          		GETV2:			PUSH    AF	;
1405)   098A CD 52 24    					CALL    COMMA	;
1406)   098D E5          		GETV3:			PUSH    HL	;
1407)   098E D5          					PUSH    DE	;
1408)   098F CD B6 1E    					CALL    EXPRI           ;SUBSCRIPT	;SUBSCRIPT
1409)   0992 D9          					EXX	;
1410)   0993 D1          					POP     DE	;
1411)   0994 E3          					EX      (SP),HL	;
1412)   0995 4E          					LD      C,(HL)	;
1413)   0996 23          					INC     HL	;
1414)   0997 46          					LD      B,(HL)	;
1415)   0998 23          					INC     HL	;
1416)   0999 E3          					EX      (SP),HL	;
1417)   099A EB          					EX      DE,HL	;
1418)   099B D5          					PUSH    DE	;
1419)   099C CD C5 17    					CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
1420)   099F D1          					POP     DE	;
1421)   09A0 19          					ADD     HL,DE	;
1422)   09A1 EB          					EX      DE,HL	;
1423)   09A2 B7          					OR      A	;
1424)   09A3 ED 42       					SBC     HL,BC	;
1425)   09A5 3E 0F       					LD      A,15	;
1426)   09A7 30 B5       					JR      NC,ERROR3       ;"Subscript"	;"Subscript"
1427)   09A9 E1          					POP     HL	;
1428)   09AA F1          					POP     AF	;
1429)   09AB 3D          					DEC     A               ;DIMENSION COUNTER	;DIMENSION COUNTER
1430)   09AC 20 DB       					JR      NZ,GETV2	;
1431)   09AE CD 5E 24    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
1432)   09B1 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1433)   09B2 E5          					PUSH    HL	;
1434)   09B3 CD B8 17    					CALL    X4OR5           ;DE=DE*n	;DE=DE*n
1435)   09B6 E1          					POP     HL	;
1436)   09B7 19          					ADD     HL,DE	;
1437)   09B8 57          					LD      D,A             ;TYPE	;TYPE
1438)   09B9 FD 7E 00    					LD      A,(IY)	;
1439)   09BC FE 3F       		GETVX:			CP      '?'	;
1440)   09BE 28 1D       					JR      Z,GETV9	;
1441)   09C0 FE 21       					CP      '!'	;
1442)   09C2 28 15       					JR      Z,GETV8	;
1443)   09C4 E5          		GETVZ:			PUSH    HL              ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1444)   09C5 DD E1       					POP     IX	;
1445)   09C7 7A          					LD      A,D	;
1446)   09C8 BF          					CP      A	;
1447)   09C9 C9          					RET	;
1451)   09CA 3E 80       		GETV4:			LD      A,128           ;STATIC STRING	;STATIC STRING
1452)   09CC 18 05       					JR      GETV7	;
1453)   09CE 3E 04       		GETV5:			LD      A,4             ;UNARY 32-BIT INDIRN.	;UNARY 32-BIT INDIRN.
1454)   09D0 18 01       					JR      GETV7	;
1455)   09D2 AF          		GETV6:			XOR     A               ;UNARY 8-BIT INDIRECTION	;UNARY 8-BIT INDIRECTION
1456)   09D3 21 00 00    		GETV7:			LD      HL,0	;
1457)   09D6 F5          					PUSH    AF	;
1458)   09D7 18 15       					JR      GETV0	;
1460)   09D9 06 04       		GETV8:			LD      B,4             ;32-BIT BINARY INDIRN.	;32-BIT BINARY INDIRN.
1461)   09DB 18 02       					JR      GETVA	;
1462)   09DD 06 00       		GETV9:			LD      B,0             ;8-BIT BINARY INDIRN.	;8-BIT BINARY INDIRN.
1463)   09DF E5          		GETVA:			PUSH    HL	;
1464)   09E0 DD E1       					POP     IX	;
1465)   09E2 7A          					LD      A,D             ;TYPE	;TYPE
1466)   09E3 FE 81       					CP      129	;
1467)   09E5 C8          					RET     Z               ;STRING!	;STRING!
1468)   09E6 C5          					PUSH    BC	;
1469)   09E7 CD 6F 1F    					CALL    LOADN           ;LEFT OPERAND	;LEFT OPERAND
1470)   09EA CD 5D 21    					CALL    SFIX	;
1471)   09ED D9          					EXX	;
1472)   09EE E5          		GETV0:			PUSH    HL	;
1473)   09EF FD 23       					INC     IY	;
1474)   09F1 CD CD 1E    					CALL    ITEMI	;
1475)   09F4 D9          					EXX	;
1476)   09F5 D1          					POP     DE	;
1477)   09F6 F1          					POP     AF	;
1478)   09F7 19          					ADD     HL,DE	;
1479)   09F8 E5          					PUSH    HL	;
1480)   09F9 DD E1       					POP     IX	;
1481)   09FB BF          					CP      A	;
1482)   09FC C9          					RET	;
1492)   09FD FD 7E 01    		@GETDEF:		LD      A,(IY+1)	;
1493)   0A00 CD 54 0B    					CALL    RANGE1	;
1494)   0A03 D8          					RET     C	;
1495)   0A04 FD 7E 00    					LD      A,(IY)	;
1496)   0A07 21 D8 62    					LD      HL,FNPTR	;
1497)   0A0A FE A4       					CP      FN	;
1498)   0A0C 28 43       					JR      Z,LOC2	;
1499)   0A0E 21 DA 62    					LD      HL,PROPTR	;
1500)   0A11 FE F2       					CP      PROC	;
1501)   0A13 28 3C       					JR      Z,LOC2	;
1502)   0A15 37          					SCF	;
1503)   0A16 C9          					RET	;
1519)   0A17 D6 40       		LOCATE:			SUB     '@'	;
1520)   0A19 D8          					RET     C	;
1521)   0A1A 26 00       					LD      H,0	;
1522)   0A1C FE 1B       					CP      'Z'-'@'+1	;
1523)   0A1E 30 1D       					JR      NC,LOC0         ;NOT STATIC	;NOT STATIC
1524)   0A20 87          					ADD     A,A	;
1525)   0A21 6F          					LD      L,A	;
1526)   0A22 FD 7E 01    					LD      A,(IY+1)        ;2nd CHARACTER	;2nd CHARACTER
1527)   0A25 FE 25       					CP      '%'	;
1528)   0A27 20 20       					JR      NZ,LOC1         ;NOT STATIC	;NOT STATIC
1529)   0A29 FD 7E 02    					LD      A,(IY+2)	;
1530)   0A2C FE 28       					CP      '('	;
1531)   0A2E 28 19       					JR      Z,LOC1          ;NOT STATIC	;NOT STATIC
1532)   0A30 29          					ADD     HL,HL	;
1533)   0A31 11 00 62    					LD      DE,STAVAR       ;STATIC VARIABLES	;STATIC VARIABLES
1534)   0A34 19          					ADD     HL,DE	;
1535)   0A35 FD 23       					INC     IY	;
1536)   0A37 FD 23       					INC     IY	;
1537)   0A39 16 04       					LD      D,4             ;INTEGER TYPE	;INTEGER TYPE
1538)   0A3B AF          					XOR     A	;
1539)   0A3C C9          					RET	;
1541)   0A3D FE 1F       		LOC0:			CP      '_'-'@'	;
1542)   0A3F D8          					RET     C	;
1543)   0A40 FE 3B       					CP      'z'-'@'+1	;
1544)   0A42 3F          					CCF	;
1545)   0A43 3D          					DEC     A               ;SET NZ	;SET NZ
1546)   0A44 D8          					RET     C	;
1547)   0A45 D6 03       					SUB     3	;
1548)   0A47 87          					ADD     A,A	;
1549)   0A48 6F          					LD      L,A	;
1550)   0A49 11 6C 62    		LOC1:			LD      DE,DYNVAR       ;DYNAMIC VARIABLES	;DYNAMIC VARIABLES
1551)   0A4C 2D          					DEC     L	;
1552)   0A4D 2D          					DEC     L	;
1553)   0A4E 37          					SCF	;
1554)   0A4F F8          					RET     M	;
1555)   0A50 19          					ADD     HL,DE	;
1556)   0A51 5E          		LOC2:			LD      E,(HL)	;
1557)   0A52 23          					INC     HL	;
1558)   0A53 56          					LD      D,(HL)	;
1559)   0A54 7A          					LD      A,D	;
1560)   0A55 B3          					OR      E	;
1561)   0A56 28 45       					JR      Z,LOC6          ;UNDEFINED VARIABLE	;UNDEFINED VARIABLE
1562)   0A58 62          					LD      H,D	;
1563)   0A59 6B          					LD      L,E	;
1564)   0A5A 23          					INC     HL              ;SKIP LINK	;SKIP LINK
1565)   0A5B 23          					INC     HL	;
1566)   0A5C FD E5       					PUSH    IY	;
1567)   0A5E 7E          		LOC3:			LD      A,(HL)          ;COMPARE	;COMPARE
1568)   0A5F 23          					INC     HL	;
1569)   0A60 FD 23       					INC     IY	;
1570)   0A62 FD BE 00    					CP      (IY)	;
1571)   0A65 28 F7       					JR      Z,LOC3	;
1572)   0A67 B7          					OR      A               ;0=TERMINATOR	;0=TERMINATOR
1573)   0A68 28 06       					JR      Z,LOC5          ;FOUND (MAYBE)	;FOUND (MAYBE)
1574)   0A6A FD E1       		LOC4:			POP     IY	;
1575)   0A6C EB          					EX      DE,HL	;
1576)   0A6D C3 51 0A    					JP      LOC2            ;TRY NEXT ENTRY	;TRY NEXT ENTRY
1578)   0A70 FD 2B       		LOC5:			DEC     IY	;
1579)   0A72 FD 7E 00    					LD      A,(IY)	;
1580)   0A75 FE 28       					CP      '('	;
1581)   0A77 28 13       					JR      Z,LOC5A         ;FOUND	;FOUND
1582)   0A79 FD 23       					INC     IY	;
1583)   0A7B CD 48 0B    					CALL    RANGE	;
1584)   0A7E 38 0C       					JR      C,LOC5A         ;FOUND	;FOUND
1585)   0A80 FE 28       					CP      '('	;
1586)   0A82 28 E6       					JR      Z,LOC4          ;KEEP LOOKING	;KEEP LOOKING
1587)   0A84 FD 7E FF    					LD      A,(IY-1)	;
1588)   0A87 CD 54 0B    					CALL    RANGE1	;
1589)   0A8A 30 DE       					JR      NC,LOC4         ;KEEP LOOKING	;KEEP LOOKING
1590)   0A8C D1          		LOC5A:			POP     DE	;
1591)   0A8D FD 7E FF    		TYPE:			LD      A,(IY-1)	;
1592)   0A90 FE 24       					CP      '$'	;
1593)   0A92 16 81       					LD      D,129	;
1594)   0A94 C8          					RET     Z               ;STRING	;STRING
1595)   0A95 FE 25       					CP      '%'	;
1596)   0A97 16 04       					LD      D,4	;
1597)   0A99 C8          					RET     Z               ;INTEGER	;INTEGER
1598)   0A9A 14          					INC     D	;
1599)   0A9B BF          					CP      A	;
1600)   0A9C C9          					RET	;
1602)   0A9D 3C          		LOC6:			INC     A               ;SET NZ	;SET NZ
1603)   0A9E C9          					RET	;
1610)   0A9F AF          		@CREATE:		XOR     A	;
1611)   0AA0 ED 5B E2 62 					LD      DE,(FREE)	;
1612)   0AA4 72          					LD      (HL),D	;
1613)   0AA5 2B          					DEC     HL	;
1614)   0AA6 73          					LD      (HL),E	;
1615)   0AA7 EB          					EX      DE,HL	;
1616)   0AA8 77          					LD      (HL),A	;
1617)   0AA9 23          					INC     HL	;
1618)   0AAA 77          					LD      (HL),A	;
1619)   0AAB 23          					INC     HL	;
1620)   0AAC FD 23       		LOC7:			INC     IY	;
1621)   0AAE CD 48 0B    					CALL    RANGE           ;END OF VARIABLE?	;END OF VARIABLE?
1622)   0AB1 38 14       					JR      C,LOC8	;
1623)   0AB3 77          					LD      (HL),A	;
1624)   0AB4 23          					INC     HL	;
1625)   0AB5 CD 54 0B    					CALL    RANGE1	;
1626)   0AB8 30 F2       					JR      NC,LOC7	;
1627)   0ABA FE 28       					CP      '('	;
1628)   0ABC 28 09       					JR      Z,LOC8	;
1629)   0ABE FD 7E 01    					LD      A,(IY+1)	;
1630)   0AC1 FE 28       					CP      '('	;
1631)   0AC3 28 E7       					JR      Z,LOC7	;
1632)   0AC5 FD 23       					INC     IY	;
1633)   0AC7 36 00       		LOC8:			LD      (HL),0          ;TERMINATOR	;TERMINATOR
1634)   0AC9 23          					INC     HL	;
1635)   0ACA E5          					PUSH    HL	;
1636)   0ACB CD 8D 0A    					CALL    TYPE	;
1637)   0ACE 3E 05       					LD      A,5	;
1638)   0AD0 BA          					CP      D	;
1639)   0AD1 28 01       					JR      Z,LOC9	;
1640)   0AD3 3D          					DEC     A	;
1641)   0AD4 36 00       		LOC9:			LD      (HL),0          ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1642)   0AD6 23          					INC     HL	;
1643)   0AD7 3D          					DEC     A	;
1644)   0AD8 20 FA       					JR      NZ,LOC9	;
1645)   0ADA 22 E2 62    					LD      (FREE),HL	;
1646)   0ADD CD E1 15    					CALL    CHECK	;
1647)   0AE0 E1          					POP     HL	;
1648)   0AE1 AF          					XOR     A	;
1649)   0AE2 C9          					RET	;
1657)   0AE3 CD 9A 24    		LINNUM:			CALL    NXT	;
1658)   0AE6 21 00 00    					LD      HL,0	;
1659)   0AE9 FD 7E 00    		LINNM1:			LD      A,(IY)	;
1660)   0AEC D6 30       					SUB     '0'	;
1661)   0AEE D8          					RET     C	;
1662)   0AEF FE 0A       					CP      10	;
1663)   0AF1 D0          					RET     NC	;
1664)   0AF2 FD 23       					INC     IY	;
1665)   0AF4 54          					LD      D,H	;
1666)   0AF5 5D          					LD      E,L	;
1667)   0AF6 29          					ADD     HL,HL           ;*2	;*2
1668)   0AF7 38 0F       					JR      C,TOOBIG	;
1669)   0AF9 29          					ADD     HL,HL           ;*4	;*4
1670)   0AFA 38 0C       					JR      C,TOOBIG	;
1671)   0AFC 19          					ADD     HL,DE           ;*5	;*5
1672)   0AFD 38 09       					JR      C,TOOBIG	;
1673)   0AFF 29          					ADD     HL,HL           ;*10	;*10
1674)   0B00 38 06       					JR      C,TOOBIG	;
1675)   0B02 5F          					LD      E,A	;
1676)   0B03 16 00       					LD      D,0	;
1677)   0B05 19          					ADD     HL,DE           ;ADD IN DIGIT	;ADD IN DIGIT
1678)   0B06 30 E1       					JR      NC,LINNM1       	;
1679)   0B08 3E 14       		TOOBIG:			LD      A,20	;
1680)   0B0A C3 FD 06    					JP      ERROR           ;"Too big"	;"Too big"
1688)   0B0D CD E3 0A    		PAIR:			CALL    LINNUM          ;FIRST	;FIRST
1689)   0B10 7C          					LD      A,H	;
1690)   0B11 B5          					OR      L	;
1691)   0B12 20 02       					JR      NZ,PAIR1	;
1692)   0B14 2E 0A       					LD      L,10	;
1693)   0B16 CD E4 16    		PAIR1:			CALL    TERM?	;
1694)   0B19 FD 23       					INC     IY	;
1695)   0B1B E5          					PUSH    HL	;
1696)   0B1C 21 0A 00    					LD      HL,10	;
1697)   0B1F C4 E3 0A    					CALL    NZ,LINNUM       ;SECOND	;SECOND
1698)   0B22 E3          					EX      (SP),HL	;
1699)   0B23 C1          					POP     BC	;
1700)   0B24 78          					LD      A,B	;
1701)   0B25 B1          					OR      C	;
1702)   0B26 C0          					RET     NZ	;
1703)   0B27 CD 12 07    					CALL    EXTERR	;
1704)   0B2A 53 69 6C 6C 					DEFM    'Silly'	;
1704)   0B2E 79          					DEFM    'Silly'	;
1705)   0B2F 00          					DEFB    0	;
1713)   0B30 CD E3 0A    		DLPAIR:			CALL    LINNUM	;
1714)   0B33 E5          					PUSH    HL	;
1715)   0B34 CD E4 16    					CALL    TERM?	;
1716)   0B37 28 09       					JR      Z,DLP1	;
1717)   0B39 FE E7       					CP      TIF	;
1718)   0B3B 28 05       					JR      Z,DLP1	;
1719)   0B3D FD 23       					INC     IY	;
1720)   0B3F CD E3 0A    					CALL    LINNUM	;
1721)   0B42 E3          		DLP1:			EX      (SP),HL	;
1722)   0B43 CD CD 08    					CALL    FINDL	;
1723)   0B46 C1          					POP     BC	;
1724)   0B47 C9          					RET	;
1731)   0B48 FD 7E 00    		@RANGE:			LD      A,(IY)	;
1732)   0B4B FE 24       					CP      '$'	;
1733)   0B4D C8          					RET     Z	;
1734)   0B4E FE 25       					CP      '%'	;
1735)   0B50 C8          					RET     Z	;
1736)   0B51 FE 28       					CP      '('	;
1737)   0B53 C8          					RET     Z	;
1738)   0B54 FE 30       		RANGE1:			CP      '0'	;
1739)   0B56 D8          					RET     C	;
1740)   0B57 FE 3A       					CP      '9'+1	;
1741)   0B59 3F          					CCF	;
1742)   0B5A D0          					RET     NC	;
1743)   0B5B FE 40       					CP      '@'             ;V2.4	;V2.4
1744)   0B5D C8          					RET     Z	;
1745)   0B5E FE 41       		RANGE2:			CP      'A'	;
1746)   0B60 D8          					RET     C	;
1747)   0B61 FE 5B       					CP      'Z'+1	;
1748)   0B63 3F          					CCF	;
1749)   0B64 D0          					RET     NC	;
1750)   0B65 FE 5F       					CP      '_'	;
1751)   0B67 D8          					RET     C	;
1752)   0B68 FE 7B       					CP      'z'+1	;
1753)   0B6A 3F          					CCF	;
1754)   0B6B C9          					RET	;
1756)   0B6C AF          		SPACE: 			XOR     A	;
1757)   0B6D CD 12 07    					CALL    EXTERR          ;"LINE space"	;"LINE space"
1758)   0B70 86          					DEFB    LINE	;
1759)   0B71 08          					DEFB    8	;
1760)   0B72 00          					DEFB    0	;
1776)   0B73 12          		LEXAN1:			LD      (DE),A          ;TRANSFER TO BUFFER	;TRANSFER TO BUFFER
1777)   0B74 13          					INC     DE              ;INCREMENT POINTERS	;INCREMENT POINTERS
1778)   0B75 FD 23       					INC     IY	;
1779)   0B77 7B          		@LEXAN2:		LD      A,E             ;MAIN ENTRY	;MAIN ENTRY
1780)   0B78 FE FC       					CP      252             ;TEST LENGTH	;TEST LENGTH
1781)   0B7A 30 F0       					JR      NC,SPACE        ;LINE TOO LONG	;LINE TOO LONG
1782)   0B7C FD 7E 00    					LD      A,(IY)	;
1783)   0B7F FE 0D       					CP      CR	;
1784)   0B81 C8          					RET     Z               ;END OF LINE	;END OF LINE
1785)   0B82 CD 54 0B    					CALL    RANGE1	;
1786)   0B85 30 04       					JR      NC,LEXAN3	;
1787)   0B87 CB A9       					RES     5,C             ;NOT IN VARIABLE	;NOT IN VARIABLE
1788)   0B89 CB 99       					RES     3,C             ;NOT IN HEX	;NOT IN HEX
1789)   0B8B FE 20       		LEXAN3:			CP      ' '	;
1790)   0B8D 28 E4       					JR      Z,LEXAN1        ;PASS SPACES	;PASS SPACES
1791)   0B8F FE 2C       					CP      ','	;
1792)   0B91 28 E0       					JR      Z,LEXAN1        ;PASS COMMAS	;PASS COMMAS
1793)   0B93 FE 47       					CP      'G'	;
1794)   0B95 38 02       					JR      C,LEXAN4	;
1795)   0B97 CB 99       					RES     3,C             ;NOT IN HEX	;NOT IN HEX
1796)   0B99 FE 22       		LEXAN4:			CP      34		;ASCII ""	;ASCII ""
1797)   0B9B 20 05       					JR      NZ,LEXAN5	;
1798)   0B9D CB 11       					RL      C	;
1799)   0B9F 3F          					CCF                     ;TOGGLE C7	;TOGGLE C7
1800)   0BA0 CB 19       					RR      C	;
1801)   0BA2 CB 61       		LEXAN5:			BIT     4,C	;
1802)   0BA4 28 10       					JR      Z,LEXAN6	;
1803)   0BA6 CB A1       					RES     4,C	;
1804)   0BA8 C5          					PUSH    BC	;
1805)   0BA9 D5          					PUSH    DE	;
1806)   0BAA CD E3 0A    					CALL    LINNUM          ;GET LINE NUMBER	;GET LINE NUMBER
1807)   0BAD D1          					POP     DE	;
1808)   0BAE C1          					POP     BC	;
1809)   0BAF 7C          					LD      A,H	;
1810)   0BB0 B5          					OR      L	;
1811)   0BB1 C4 1B 0C    					CALL    NZ,ENCODE       ;ENCODE LINE NUMBER	;ENCODE LINE NUMBER
1812)   0BB4 18 C1       					JR      LEXAN2          ;CONTINUE	;CONTINUE
1814)   0BB6 0D          		LEXAN6:			DEC     C	;
1815)   0BB7 28 09       					JR      Z,LEXAN7        ;C=1 (LEFT)	;C=1 (LEFT)
1816)   0BB9 0C          					INC     C	;
1817)   0BBA 20 B7       					JR      NZ,LEXAN1	;
1818)   0BBC B7          					OR      A	;
1819)   0BBD F4 51 07    					CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1820)   0BC0 18 12       					JR      LEXAN8	;
1822)   0BC2 FE 2A       		LEXAN7:			CP      '*'	;
1823)   0BC4 28 16       					JR      Z,LEXAN9	;
1824)   0BC6 B7          					OR      A	;
1825)   0BC7 F4 51 07    					CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1826)   0BCA FE 8F       					CP      TOKLO	;
1827)   0BCC 38 06       					JR      C,LEXAN8	;
1828)   0BCE FE 94       					CP      TOKHI+1	;
1829)   0BD0 30 02       					JR      NC,LEXAN8	;
1830)   0BD2 C6 40       					ADD     A,OFFSET        ;LEFT VERSION	;LEFT VERSION
1831)   0BD4 FE F4       		LEXAN8:			CP      REM	;
1832)   0BD6 28 04       					JR      Z,LEXAN9	;
1833)   0BD8 FE DC       					CP      DATA	;
1834)   0BDA 20 02       					JR      NZ,LEXANA	;
1835)   0BDC CB F1       		LEXAN9:			SET     6,C             ;QUIT TOKENISING	;QUIT TOKENISING
1836)   0BDE FE A4       		LEXANA:			CP      FN	;
1837)   0BE0 28 09       					JR      Z,LEXANB	;
1838)   0BE2 FE F2       					CP      PROC	;
1839)   0BE4 28 05       					JR      Z,LEXANB	;
1840)   0BE6 CD 5E 0B    					CALL    RANGE2	;
1841)   0BE9 38 02       					JR      C,LEXANC	;
1842)   0BEB CB E9       		LEXANB:			SET     5,C             ;IN VARIABLE/FN/PROC	;IN VARIABLE/FN/PROC
1843)   0BED FE 26       		LEXANC:			CP      '&'	;
1844)   0BEF 20 02       					JR      NZ,LEXAND	;
1845)   0BF1 CB D9       					SET     3,C             ;IN HEX	;IN HEX
1846)   0BF3 21 12 0C    		LEXAND:			LD      HL,LIST1	;
1847)   0BF6 C5          					PUSH    BC	;
1848)   0BF7 01 06 00    					LD      BC,LIST1L	;
1849)   0BFA ED B1       					CPIR	;
1850)   0BFC C1          					POP     BC	;
1851)   0BFD 20 02       					JR      NZ,LEXANE	;
1852)   0BFF CB E1       					SET     4,C             ;ACCEPT LINE NUMBER	;ACCEPT LINE NUMBER
1853)   0C01 21 16 0C    		LEXANE:			LD      HL,LIST2	;
1854)   0C04 C5          					PUSH    BC	;
1855)   0C05 01 05 00    					LD      BC,LIST2L	;
1856)   0C08 ED B1       					CPIR	;
1857)   0C0A C1          					POP     BC	;
1858)   0C0B 20 02       					JR      NZ,LEXANF	;
1859)   0C0D CB C1       					SET     0,C             ;ENTER LEFT MODE	;ENTER LEFT MODE
1860)   0C0F C3 73 0B    		LEXANF:			JP      LEXAN1	;
1862)   0C12 E5          		LIST1:			DEFB    GOTO	;
1863)   0C13 E4          					DEFB    GOSUB	;
1864)   0C14 F7          					DEFB    RESTOR	;
1865)   0C15 FC          					DEFB    TRACE	;
1866)   0C16 8C          		LIST2:			DEFB    THEN	;
1867)   0C17 8B          					DEFB    ELSE	;
1869)   0C18 F5          					DEFB    REPEAT	;
1870)   0C19 85          					DEFB    TERROR	;
1871)   0C1A 3A          					DEFB    ':'	;
1879)   0C1B CB E1       		ENCODE:			SET     4,C	;
1880)   0C1D EB          					EX      DE,HL	;
1881)   0C1E 36 8D       					LD      (HL),LINO	;
1882)   0C20 23          					INC     HL	;
1883)   0C21 7A          					LD      A,D	;
1884)   0C22 E6 C0       					AND     0C0H	;
1885)   0C24 0F          					RRCA	;
1886)   0C25 0F          					RRCA	;
1887)   0C26 47          					LD      B,A	;
1888)   0C27 7B          					LD      A,E	;
1889)   0C28 E6 C0       					AND     0C0H	;
1890)   0C2A B0          					OR      B	;
1891)   0C2B 0F          					RRCA	;
1892)   0C2C 0F          					RRCA	;
1893)   0C2D EE 54       					XOR     01010100B	;
1894)   0C2F 77          					LD      (HL),A	;
1895)   0C30 23          					INC     HL	;
1896)   0C31 7B          					LD      A,E	;
1897)   0C32 E6 3F       					AND     3FH	;
1898)   0C34 F6 40       					OR      '@'	;
1899)   0C36 77          					LD      (HL),A	;
1900)   0C37 23          					INC     HL	;
1901)   0C38 7A          					LD      A,D	;
1902)   0C39 E6 3F       					AND     3FH	;
1903)   0C3B F6 40       					OR      '@'	;
1904)   0C3D 77          					LD      (HL),A	;
1905)   0C3E 23          					INC     HL	;
1906)   0C3F EB          					EX      DE,HL	;
1907)   0C40 C9          					RET	;
1914)   0C41 2A EE 62    		@REPORT:		LD      HL,(ERRTXT)	;
1915)   0C44 7E          		TEXT:			LD      A,(HL)	;
1916)   0C45 23          					INC     HL	;
1917)   0C46 B7          					OR      A	;
1918)   0C47 C8          					RET     Z	;
1919)   0C48 CD AF 08    					CALL    OUT	;
1920)   0C4B 18 F7       					JR      TEXT	;
1926)   0C4D E3          		@TELL:			EX      (SP),HL         ;GET RETURN ADDRESS	;GET RETURN ADDRESS
1927)   0C4E CD 44 0C    					CALL    TEXT	;
1928)   0C51 E3          					EX      (SP),HL	;
1929)   0C52 C9          					RET	;
 33)   0C53 99 06       		CMDTAB:			DEFW    AUTO	;
 34)   0C55 33 05       					DEFW    DELETE	;
 35)   0C57 D1 06       					DEFW    LOAD	;
 36)   0C59 62 05       					DEFW    LIST	;
 37)   0C5B B3 06       					DEFW    NEW	;
 38)   0C5D B8 06       					DEFW    OLD	;
 39)   0C5F E0 05       					DEFW    RENUM	;
 40)   0C61 DF 06       					DEFW    SAVE	;
 41)   0C63 5A 15       					DEFW    PUT	;
 42)   0C65 10 14       					DEFW    PTR	;
 43)   0C67 25 14       					DEFW    PAGEV	;
 44)   0C69 34 14       					DEFW    TIMEV	;
 45)   0C6B 55 14       					DEFW    LOMEMV	;
 46)   0C6D 68 14       					DEFW    HIMEMV	;
 47)   0C6F 66 40       					DEFW    SOUND	;
 48)   0C71 DC 14       					DEFW    BPUT	;
 49)   0C73 EF 14       					DEFW    CALL	;
 50)   0C75 CC 0C       					DEFW    CHAIN	;
 51)   0C77 EA 13       					DEFW    CLR	;
 52)   0C79 D3 14       					DEFW    CLOSE	;
 53)   0C7B 4E 40       					DEFW    CLG	;
 54)   0C7D C7 13       					DEFW    CLS	;
 55)   0C7F 83 0D       					DEFW    REM             ;DATA	;DATA
 56)   0C81 83 0D       					DEFW    REM             ;DEF	;DEF
 57)   0C83 30 0E       					DEFW    DIM	;
 58)   0C85 54 40       					DEFW    DRAW	;
 59)   0C87 32 0D       					DEFW    END	;
 60)   0C89 1F 12       					DEFW    ENDPRO	;
 61)   0C8B 57 40       					DEFW    ENVEL	;
 62)   0C8D 74 10       					DEFW    FOR	;
 63)   0C8F 2F 10       					DEFW    GOSUB	;
 64)   0C91 18 10       					DEFW    GOTO	;
 65)   0C93 5A 40       					DEFW    GCOL	;
 66)   0C95 9A 13       					DEFW    IF	;
 67)   0C97 AA 12       					DEFW    INPUT	;
 68)   0C99 A3 0D       					DEFW    LET	;
 69)   0C9B D1 11       					DEFW    LOCAL	;
 70)   0C9D 5D 40       					DEFW    MODE	;
 71)   0C9F 60 40       					DEFW    MOVE	;
 72)   0CA1 B9 10       					DEFW    NEXT	;
 73)   0CA3 B2 0F       					DEFW    ON	;
 74)   0CA5 B2 14       					DEFW    VDU	;
 75)   0CA7 63 40       					DEFW    PLOT	;
 76)   0CA9 DD 0E       					DEFW    PRINT	;
 77)   0CAB 42 11       					DEFW    PROC	;
 78)   0CAD 49 13       					DEFW    READ	;
 79)   0CAF 83 0D       					DEFW    REM	;
 80)   0CB1 4A 10       					DEFW    REPEAT	;
 81)   0CB3 E4 13       					DEFW    REPOR	;
 82)   0CB5 F2 13       					DEFW    RESTOR	;
 83)   0CB7 3A 10       					DEFW    RETURN	;
 84)   0CB9 C7 0C       					DEFW    RUN	;
 85)   0CBB D1 13       					DEFW    STOP	;
 86)   0CBD 51 40       					DEFW    COLOUR	;
 87)   0CBF 98 14       					DEFW    TRACE	;
 88)   0CC1 52 10       					DEFW    UNTIL	;
 89)   0CC3 8D 14       					DEFW    WIDTHV	;
 90)   0CC5 6F 0D       					DEFW    CLI             ;OSCLI	;OSCLI
 92)   0CC7 CD E4 16    		RUN:			CALL    TERM?	;
 93)   0CCA 28 0D       					JR      Z,RUN0	;
 94)   0CCC CD BF 1E    		CHAIN:			CALL    EXPRS	;
 95)   0CCF 3E 0D       					LD      A,CR	;
 96)   0CD1 12          					LD      (DE),A	;
 97)   0CD2 ED 7B E4 62 		@CHAIN0:		LD      SP,(HIMEM)	;
 98)   0CD6 CD A5 07    					CALL    LOAD0	;
 99)   0CD9 ED 7B E4 62 		@RUN0:			LD      SP,(HIMEM)      ;PREPARE FOR RUN	;PREPARE FOR RUN
100)   0CDD DD 21 F6 62 					LD      IX,RANDOM	;
104)   0CE1 ED 5F       					ld      a, r	;
105)   0CE3 20 1D       					jr      nz, 1F	;
106)   0CE5 3C          					inc     a	;
108)   0CE6 07          		L1:			RLCA	;
109)   0CE7 07          					RLCA	;
110)   0CE8 DD 77 03    					LD      (IX+3),A	;
111)   0CEB 9F          					SBC     A,A	;
112)   0CEC DD 77 04    					LD      (IX+4),A	;
113)   0CEF CD EE 07    					CALL    CLEAR	;
114)   0CF2 21 00 00    					LD      HL,0	;
115)   0CF5 22 EC 62    					LD      (ERRTRP),HL	;
116)   0CF8 2A DC 62    					LD      HL,(PAGE)	;
117)   0CFB 3E DC       					LD      A,DATA	;
118)   0CFD CD A2 17    					CALL    SEARCH          ;LOOK FOR "DATA"	;LOOK FOR "DATA"
119)   0D00 22 F0 62    					LD      (DATPTR),HL     ;SET DATA POINTER	;SET DATA POINTER
120)   0D03 FD 2A DC 62 					LD      IY,(PAGE)	;
121)   0D07 CD 42 0D    		XEQ0:			CALL    NEWLIN	;
122)   0D0A FD 22 F4 62 		@XEQ:			LD      (ERRLIN),IY     ;ERROR POINTER	;ERROR POINTER
123)   0D0E CD 48 40    					CALL    TRAP            ;CHECK KEYBOARD	;CHECK KEYBOARD
124)   0D11 CD 9A 24    		XEQ1:			CALL    NXT	;
125)   0D14 FD 23       					INC     IY	;
126)   0D16 FE 3A       					CP      ':'             ;SEPARATOR	;SEPARATOR
127)   0D18 28 F7       					JR      Z,XEQ1	;
128)   0D1A FE 0D       					CP      CR	;
129)   0D1C 28 E9       					JR      Z,XEQ0          ;NEW PROGRAM LINE	;NEW PROGRAM LINE
130)   0D1E D6 C6       					SUB     TCMD	;
131)   0D20 38 6F       					JR      C,LET0          ;IMPLIED "LET"	;IMPLIED "LET"
132)   0D22 87          					ADD     A,A	;
133)   0D23 4F          					LD      C,A	;
134)   0D24 06 00       					LD      B,0	;
135)   0D26 21 53 0C    					LD      HL,CMDTAB	;
136)   0D29 09          					ADD     HL,BC	;
137)   0D2A 7E          					LD      A,(HL)          ;TABLE ENTRY	;TABLE ENTRY
138)   0D2B 23          					INC     HL	;
139)   0D2C 66          					LD      H,(HL)	;
140)   0D2D 6F          					LD      L,A	;
141)   0D2E CD 9A 24    					CALL    NXT	;
142)   0D31 E9          					JP      (HL)            ;EXECUTE STATEMENT	;EXECUTE STATEMENT
146)   0D32 CD E6 08    		END:			CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
147)   0D35 7C          					LD      A,H	;
148)   0D36 B5          					OR      L               ;DIRECT?	;DIRECT?
149)   0D37 CA 91 00    					JP      Z,CLOOP	;
150)   0D3A 1E 00       					LD      E,0	;
151)   0D3C CD 2D 40    					CALL    OSSHUT          ;CLOSE ALL FILES	;CLOSE ALL FILES
152)   0D3F C3 90 00    					JP      WARM            ;"Ready"	;"Ready"
154)   0D42 FD 7E 00    		NEWLIN:			LD      A,(IY+0)        ;A=LINE LENGTH	;A=LINE LENGTH
155)   0D45 01 03 00    					LD      BC,3	;
156)   0D48 FD 09       					ADD     IY,BC	;
157)   0D4A B7          					OR      A	;
158)   0D4B 28 E5       					JR      Z,END           ;LENGTH=0, EXIT	;LENGTH=0, EXIT
159)   0D4D 2A E8 62    					LD      HL,(TRACEN)	;
160)   0D50 7C          					LD      A,H	;
161)   0D51 B5          					OR      L	;
162)   0D52 C8          					RET     Z	;
163)   0D53 FD 56 FF    					LD      D,(IY-1)        ;DE = LINE NUMBER	;DE = LINE NUMBER
164)   0D56 FD 5E FE    					LD      E,(IY-2)	;
165)   0D59 ED 52       					SBC     HL,DE	;
166)   0D5B D8          					RET     C	;
167)   0D5C EB          					EX      DE,HL	;
168)   0D5D 3E 5B       					LD      A,'['           ;TRACE	;TRACE
169)   0D5F CD 96 08    					CALL    OUTCHR	;
170)   0D62 CD 23 09    					CALL    PBCDL	;
171)   0D65 3E 5D       					LD      A,']'	;
172)   0D67 CD 96 08    					CALL    OUTCHR	;
173)   0D6A 3E 20       					LD      A,' '	;
174)   0D6C C3 96 08    					JP      OUTCHR	;
180)   0D6F CD BF 1E    		CLI:			CALL    EXPRS	;
181)   0D72 3E 0D       					LD      A,CR	;
182)   0D74 12          					LD      (DE),A	;
183)   0D75 21 00 60    					LD      HL,ACCS	;
184)   0D78 CD 21 40    					CALL    OSCLI	;
185)   0D7B 18 8D       					JR      XEQ	;
189)   0D7D FD E5       		EXT:			PUSH    IY	;
190)   0D7F E1          					POP     HL	;
191)   0D80 CD 21 40    					CALL    OSCLI	;
192)   0D83 FD E5       		REM:			PUSH    IY	;
193)   0D85 E1          					POP     HL	;
194)   0D86 3E 0D       					LD      A,CR	;
195)   0D88 47          					LD      B,A	;
196)   0D89 ED B1       					CPIR                    ;FIND LINE END	;FIND LINE END
197)   0D8B E5          					PUSH    HL	;
198)   0D8C FD E1       					POP     IY	;
199)   0D8E C3 07 0D    					JP      XEQ0	;
203)   0D91 FE C5       		LET0:			CP      ELSE-TCMD	;
204)   0D93 28 EE       					JR      Z,REM	;
205)   0D95 FE 64       					CP      ('*'-TCMD) AND 0xFF	;
206)   0D97 28 E4       					JR      Z,EXT	;
207)   0D99 FE 77       					CP      ('='-TCMD) AND 0xFF	;
208)   0D9B 28 4C       					JR      Z,FNEND	;
209)   0D9D FE 95       					CP      ('['-TCMD) AND 0xFF	;
210)   0D9F 28 1E       					JR      Z,ASM	;
211)   0DA1 FD 2B       					DEC     IY	;
212)   0DA3 CD 6C 15    		LET:			CALL    ASSIGN	;
213)   0DA6 CA 0A 0D    					JP      Z,XEQ	;
214)   0DA9 38 36       					JR      C,SYNTAX        ;"Syntax error"	;"Syntax error"
215)   0DAB F5          					PUSH    AF              ;SAVE STRING TYPE	;SAVE STRING TYPE
216)   0DAC CD F8 16    					CALL    EQUALS	;
217)   0DAF E5          					PUSH    HL	;
218)   0DB0 CD BF 1E    					CALL    EXPRS	;
219)   0DB3 DD E1       					POP     IX	;
220)   0DB5 F1          					POP     AF	;
221)   0DB6 CD A9 15    					CALL    STACCS	;
222)   0DB9 C3 0A 0D    		XEQR:			JP      XEQ	;
224)   0DBC CD 42 0D    		ASM0:			CALL    NEWLIN	;
225)   0DBF FD 22 F4 62 		ASM:			LD      (ERRLIN),IY	;
226)   0DC3 CD 48 40    					CALL    TRAP	;
227)   0DC6 CD EB 17    					CALL    ASSEM	;
228)   0DC9 38 16       					JR      C,SYNTAX	;
229)   0DCB FE 0D       					CP      CR	;
230)   0DCD 28 ED       					JR      Z,ASM0	;
231)   0DCF 21 FE 62    					LD      HL,LISTON	;
232)   0DD2 7E          					LD      A,(HL)	;
233)   0DD3 E6 0F       					AND     0FH	;
234)   0DD5 F6 30       					OR      30H	;
235)   0DD7 77          					LD      (HL),A	;
236)   0DD8 18 DF       					JR      XEQR	;
238)   0DDA CD 61 09    		VAR:			CALL    GETVAR	;
239)   0DDD C8          					RET     Z	;
240)   0DDE D2 52 09    					JP      NC,PUTVAR	;
241)   0DE1 3E 10       		@SYNTAX:		LD      A,16            ;"Syntax error"	;"Syntax error"
242)   0DE3 21          					DEFB    21H	;
243)   0DE4 3E 11       		@ESCAPE:		LD      A,17            ;"Escape"	;"Escape"
244)   0DE6 C3 FD 06    		ERROR0:			JP      ERROR	;
248)   0DE9 CD A6 1D    		FNEND:			CALL    EXPR            ;FUNCTION RESULT	;FUNCTION RESULT
249)   0DEC 43          					LD      B,E	;
250)   0DED EB          					EX      DE,HL	;
251)   0DEE D9          					EXX                     ;SAVE RESULT	;SAVE RESULT
252)   0DEF EB          					EX      DE,HL           ; IN DEB'C'D'E'	; IN DEB'C'D'E'
253)   0DF0 C1          		FNEND5:			POP     BC	;
254)   0DF1 21 C4 16    					LD      HL,LOCCHK	;
255)   0DF4 B7          					OR      A	;
256)   0DF5 ED 42       					SBC     HL,BC	;
257)   0DF7 28 19       					JR      Z,FNEND0        ;LOCAL VARIABLE	;LOCAL VARIABLE
258)   0DF9 21 42 11    					LD      HL,FNCHK	;
259)   0DFC B7          					OR      A	;
260)   0DFD ED 42       					SBC     HL,BC	;
261)   0DFF 3E 07       					LD      A,7	;
262)   0E01 20 E3       					JR      NZ,ERROR0       ;"No FN"	;"No FN"
263)   0E03 FD E1       					POP     IY	;
264)   0E05 FD 22 F4 62 					LD      (ERRLIN),IY     ;IN CASE OF ERROR	;IN CASE OF ERROR
265)   0E09 EB          					EX      DE,HL	;
266)   0E0A D9          					EXX	;
267)   0E0B EB          					EX      DE,HL	;
268)   0E0C 11 00 60    					LD      DE,ACCS	;
269)   0E0F 58          					LD      E,B	;
270)   0E10 08          					EX      AF,AF'	;
271)   0E11 C9          					RET	;
273)   0E12 DD E1       		FNEND0:			POP     IX	;
274)   0E14 C1          					POP     BC	;
275)   0E15 78          					LD      A,B	;
276)   0E16 B7          					OR      A	;
277)   0E17 FA 23 0E    					JP      M,FNEND1        ;STRING	;STRING
278)   0E1A E1          					POP     HL	;
279)   0E1B D9          					EXX	;
280)   0E1C E1          					POP     HL	;
281)   0E1D D9          					EXX	;
282)   0E1E CD 80 15    					CALL    STORE	;
283)   0E21 18 CD       					JR      FNEND5	;
284)   0E23 21 00 00    		FNEND1:			LD      HL,0	;
285)   0E26 39          					ADD     HL,SP	;
286)   0E27 D5          					PUSH    DE	;
287)   0E28 59          					LD      E,C	;
288)   0E29 CD AC 15    					CALL    STORES	;
289)   0E2C D1          					POP     DE	;
290)   0E2D F9          					LD      SP,HL	;
291)   0E2E 18 C0       					JR      FNEND5	;
296)   0E30 CD 61 09    		DIM:			CALL    GETVAR          ;VARIABLE	;VARIABLE
297)   0E33 38 7B       					JR      C,BADDIM	;
298)   0E35 CA B8 0E    					JP      Z,DIM4	;
299)   0E38 CD 9F 0A    					CALL    CREATE	;
300)   0E3B E5          					PUSH    HL	;
301)   0E3C DD E1       					POP     IX	;
302)   0E3E FD 7E 00    					LD      A,(IY)	;
303)   0E41 FE 28       					CP      '('	;
304)   0E43 7A          					LD      A,D	;
305)   0E44 20 72       					JR      NZ,DIM4	;
306)   0E46 E5          					PUSH    HL	;
307)   0E47 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
308)   0E48 11 01 00    					LD      DE,1	;
309)   0E4B 42          					LD      B,D             ;DIMENSION COUNTER	;DIMENSION COUNTER
310)   0E4C FD 23       		DIM1:			INC     IY	;
311)   0E4E C5          					PUSH    BC	;
312)   0E4F D5          					PUSH    DE	;
313)   0E50 DD E5       					PUSH    IX	;
314)   0E52 CD B6 1E    					CALL    EXPRI           ;DIMENSION SIZE	;DIMENSION SIZE
315)   0E55 CB 7C       					BIT     7,H	;
316)   0E57 20 57       					JR      NZ,BADDIM	;
317)   0E59 D9          					EXX	;
318)   0E5A 23          					INC     HL	;
319)   0E5B DD E1       					POP     IX	;
320)   0E5D DD 23       					INC     IX	;
321)   0E5F DD 75 00    					LD      (IX),L          ;SAVE SIZE	;SAVE SIZE
322)   0E62 DD 23       					INC     IX	;
323)   0E64 DD 74 00    					LD      (IX),H	;
324)   0E67 C1          					POP     BC	;
325)   0E68 CD C5 17    					CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
326)   0E6B 38 46       					JR      C,NOROOM        ;TOO LARGE	;TOO LARGE
327)   0E6D EB          					EX      DE,HL           ;DE=PRODUCT	;DE=PRODUCT
328)   0E6E C1          					POP     BC	;
329)   0E6F 04          					INC     B               ;DIMENSION COUNTER	;DIMENSION COUNTER
330)   0E70 FD 7E 00    					LD      A,(IY)	;
331)   0E73 FE 2C       					CP      ','             ;ANOTHER	;ANOTHER
332)   0E75 28 D5       					JR      Z,DIM1	;
333)   0E77 CD 5E 24    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
334)   0E7A F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
335)   0E7B DD 23       					INC     IX	;
336)   0E7D DD E3       					EX      (SP),IX	;
337)   0E7F DD 70 00    					LD      (IX),B          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
338)   0E82 CD B8 17    					CALL    X4OR5           ;DE=DE*n	;DE=DE*n
339)   0E85 E1          					POP     HL	;
340)   0E86 38 2B       					JR      C,NOROOM	;
341)   0E88 19          		DIM3:			ADD     HL,DE	;
342)   0E89 38 28       					JR      C,NOROOM	;
343)   0E8B E5          					PUSH    HL	;
344)   0E8C 24          					INC     H	;
345)   0E8D 28 24       					JR      Z,NOROOM	;
346)   0E8F ED 72       					SBC     HL,SP	;
347)   0E91 30 20       					JR      NC,NOROOM       ;OUT OF SPACE	;OUT OF SPACE
348)   0E93 E1          					POP     HL	;
349)   0E94 22 E2 62    					LD      (FREE),HL	;
350)   0E97 7A          		DIM2:			LD      A,D	;
351)   0E98 B3          					OR      E	;
352)   0E99 28 06       					JR      Z,DIM5	;
353)   0E9B 2B          					DEC     HL	;
354)   0E9C 36 00       					LD      (HL),0          ;INITIALISE ARRAY	;INITIALISE ARRAY
355)   0E9E 1B          					DEC     DE	;
356)   0E9F 18 F6       					JR      DIM2	;
357)   0EA1 CD 9A 24    		DIM5:			CALL    NXT	;
358)   0EA4 FE 2C       					CP      ','             ;ANOTHER VARIABLE?	;ANOTHER VARIABLE?
359)   0EA6 C2 0A 0D    					JP      NZ,XEQ	;
360)   0EA9 FD 23       					INC     IY	;
361)   0EAB CD 9A 24    					CALL    NXT	;
362)   0EAE 18 80       					JR      DIM	;
364)   0EB0 3E 0A       		BADDIM:			LD      A,10            ;"Bad DIM"	;"Bad DIM"
365)   0EB2 21          					DEFB    21H	;
366)   0EB3 3E 0B       		NOROOM:			LD      A,11            ;"DIM space"	;"DIM space"
367)   0EB5 C3 FD 06    		ERROR1:			JP      ERROR	;
369)   0EB8 B7          		DIM4:			OR      A	;
370)   0EB9 28 F5       					JR      Z,BADDIM	;
371)   0EBB FA B0 0E    					JP      M,BADDIM        	;
372)   0EBE 47          					LD      B,A	;
373)   0EBF FD 7E FF    					LD      A,(IY-1)	;
374)   0EC2 FE 29       					CP      ')'	;
375)   0EC4 78          					LD      A,B	;
376)   0EC5 28 E9       					JR      Z,BADDIM	;
377)   0EC7 2A E2 62    					LD      HL,(FREE)	;
378)   0ECA D9          					EXX	;
379)   0ECB 21 00 00    					LD      HL,0	;
380)   0ECE 4C          					LD      C,H	;
381)   0ECF CD 80 15    					CALL    STORE           ;RESERVED AREA	;RESERVED AREA
382)   0ED2 CD B6 1E    					CALL    EXPRI	;
383)   0ED5 D9          					EXX	;
384)   0ED6 23          					INC     HL	;
385)   0ED7 EB          					EX      DE,HL	;
386)   0ED8 2A E2 62    					LD      HL,(FREE)	;
387)   0EDB 18 AB       					JR      DIM3	;
392)   0EDD FE 23       		PRINT:			CP      '#'	;
393)   0EDF 20 6B       					JR      NZ,PRINT0	;
394)   0EE1 CD E3 17    					CALL    CHNL            ;CHANNEL NO. = E	;CHANNEL NO. = E
395)   0EE4 CD 9A 24    		PRNTN1:			CALL    NXT	;
396)   0EE7 FE 2C       					CP      ','	;
397)   0EE9 C2 0A 0D    					JP      NZ,XEQ	;
398)   0EEC FD 23       					INC     IY	;
399)   0EEE D5          					PUSH    DE	;
400)   0EEF CD A6 1D    					CALL    EXPR            ;ITEM TO PRINT	;ITEM TO PRINT
401)   0EF2 08          					EX      AF,AF'	;
402)   0EF3 FA 13 0F    					JP      M,PRNTN2        ;STRING	;STRING
403)   0EF6 D1          					POP     DE	;
404)   0EF7 C5          					PUSH    BC	;
405)   0EF8 D9          					EXX	;
406)   0EF9 7D          					LD      A,L	;
407)   0EFA D9          					EXX	;
408)   0EFB CD 24 40    					CALL    OSBPUT	;
409)   0EFE D9          					EXX	;
410)   0EFF 7C          					LD      A,H	;
411)   0F00 D9          					EXX	;
412)   0F01 CD 24 40    					CALL    OSBPUT	;
413)   0F04 7D          					LD      A,L	;
414)   0F05 CD 24 40    					CALL    OSBPUT	;
415)   0F08 7C          					LD      A,H	;
416)   0F09 CD 24 40    					CALL    OSBPUT	;
417)   0F0C C1          					POP     BC	;
418)   0F0D 79          					LD      A,C	;
419)   0F0E CD 24 40    					CALL    OSBPUT	;
420)   0F11 18 D1       					JR      PRNTN1	;
421)   0F13 4B          		PRNTN2:			LD      C,E	;
422)   0F14 D1          					POP     DE	;
423)   0F15 21 00 60    					LD      HL,ACCS	;
424)   0F18 0C          					INC     C	;
425)   0F19 0D          		PRNTN3:			DEC     C	;
426)   0F1A 28 09       					JR      Z,PRNTN4	;
427)   0F1C 7E          					LD      A,(HL)	;
428)   0F1D 23          					INC     HL	;
429)   0F1E C5          					PUSH    BC	;
430)   0F1F CD 24 40    					CALL    OSBPUT	;
431)   0F22 C1          					POP     BC	;
432)   0F23 18 F4       					JR      PRNTN3	;
433)   0F25 3E 0D       		PRNTN4:			LD      A,CR	;
434)   0F27 CD 24 40    					CALL    OSBPUT	;
435)   0F2A 18 B8       					JR      PRNTN1	;
437)   0F2C 06 02       		PRINT6:			LD      B,2	;
438)   0F2E 18 22       					JR      PRINTC	;
439)   0F30 01 00 01    		PRINT8:			LD      BC,100H	;
440)   0F33 18 1D       					JR      PRINTC	;
441)   0F35 21 00 62    		PRINT9:			LD      HL,STAVAR	;
442)   0F38 AF          					XOR     A	;
443)   0F39 BE          					CP      (HL)	;
444)   0F3A 28 10       					JR      Z,PRINT0	;
445)   0F3C 3A FB 62    					LD      A,(COUNT)	;
446)   0F3F B7          					OR      A	;
447)   0F40 28 0A       					JR      Z,PRINT0	;
448)   0F42 96          		PRINTA:			SUB     (HL)	;
449)   0F43 28 07       					JR      Z,PRINT0	;
450)   0F45 30 FB       					JR      NC,PRINTA	;
451)   0F47 ED 44       					NEG	;
452)   0F49 CD 4C 17    					CALL    FILL	;
453)   0F4C 3A 00 62    		PRINT0:			LD      A,(STAVAR)	;
454)   0F4F 4F          					LD      C,A             ;PRINTS	;PRINTS
455)   0F50 06 00       					LD      B,0             ;PRINTF	;PRINTF
456)   0F52 CD E4 16    		PRINTC:			CALL    TERM?	;
457)   0F55 28 38       					JR      Z,PRINT4	;
458)   0F57 CB 80       					RES     0,B	;
459)   0F59 FD 23       					INC     IY	;
460)   0F5B FE 7E       					CP      '~'	;
461)   0F5D 28 CD       					JR      Z,PRINT6	;
462)   0F5F FE 3B       					CP      ';'	;
463)   0F61 28 CD       					JR      Z,PRINT8	;
464)   0F63 FE 2C       					CP      ','	;
465)   0F65 28 CE       					JR      Z,PRINT9	;
466)   0F67 CD 05 17    					CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
467)   0F6A 28 E6       					JR      Z,PRINTC	;
468)   0F6C FD 2B       					DEC     IY	;
469)   0F6E C5          					PUSH    BC	;
470)   0F6F CD A6 1D    					CALL    EXPR            ;VARIABLE TYPE	;VARIABLE TYPE
471)   0F72 08          					EX      AF,AF'	;
472)   0F73 FA 89 0F    					JP      M,PRINT3        ;STRING	;STRING
473)   0F76 D1          					POP     DE	;
474)   0F77 D5          					PUSH    DE	;
475)   0F78 CB 4A       					BIT     1,D	;
476)   0F7A F5          					PUSH    AF	;
477)   0F7B CC B8 23    					CALL    Z,STR           ;DECIMAL	;DECIMAL
478)   0F7E F1          					POP     AF	;
479)   0F7F C4 75 23    					CALL    NZ,HEXSTR       ;HEX	;HEX
480)   0F82 C1          					POP     BC	;
481)   0F83 C5          					PUSH    BC	;
482)   0F84 79          					LD      A,C	;
483)   0F85 93          					SUB     E	;
484)   0F86 D4 4C 17    					CALL    NC,FILL         ;RIGHT JUSTIFY	;RIGHT JUSTIFY
485)   0F89 C1          		PRINT3:			POP     BC	;
486)   0F8A CD 5A 17    					CALL    PTEXT           ;PRINT	;PRINT
487)   0F8D 18 C3       					JR      PRINTC	;
488)   0F8F CB 40       		PRINT4:			BIT     0,B	;
489)   0F91 CC 8F 08    					CALL    Z,CRLF	;
490)   0F94 C3 0A 0D    					JP      XEQ	;
493)   0F97 FD 23       		ONERR:			INC     IY              ;SKIP "ERROR"	;SKIP "ERROR"
494)   0F99 21 00 00    					LD      HL,0	;
495)   0F9C 22 EC 62    					LD      (ERRTRP),HL	;
496)   0F9F CD 9A 24    					CALL    NXT	;
497)   0FA2 FE 87       					CP      OFF	;
498)   0FA4 FD 23       					INC     IY	;
499)   0FA6 CA 0A 0D    					JP      Z,XEQ	;
500)   0FA9 FD 2B       					DEC     IY	;
501)   0FAB FD 22 EC 62 					LD      (ERRTRP),IY	;
502)   0FAF C3 83 0D    					JP      REM	;
512)   0FB2 FE 85       		ON:			CP      TERROR	;
513)   0FB4 28 E1       					JR      Z,ONERR         ;"ON ERROR"	;"ON ERROR"
514)   0FB6 CD B6 1E    					CALL    EXPRI	;
515)   0FB9 FD 7E 00    					LD      A,(IY)	;
516)   0FBC FD 23       					INC     IY	;
517)   0FBE 1E 2C       					LD      E,','           ;SEPARATOR	;SEPARATOR
518)   0FC0 FE E5       					CP      TGOTO	;
519)   0FC2 28 0B       					JR      Z,ON1	;
520)   0FC4 FE E4       					CP      TGOSUB	;
521)   0FC6 28 07       					JR      Z,ON1	;
522)   0FC8 1E F2       					LD      E,TPROC	;
523)   0FCA BB          					CP      E	;
524)   0FCB 3E 27       					LD      A,39	;
525)   0FCD 20 41       					JR      NZ,ERROR2       ;"ON syntax"	;"ON syntax"
526)   0FCF 57          		ON1:			LD      D,A	;
527)   0FD0 D9          					EXX	;
528)   0FD1 E5          					PUSH    HL	;
529)   0FD2 D9          					EXX	;
530)   0FD3 C1          					POP     BC              ;ON INDEX	;ON INDEX
531)   0FD4 78          					LD      A,B	;
532)   0FD5 B4          					OR      H	;
533)   0FD6 B5          					OR      L	;
534)   0FD7 20 27       					JR      NZ,ON4          ;OUT OF RANGE	;OUT OF RANGE
535)   0FD9 B1          					OR      C	;
536)   0FDA 28 24       					JR      Z,ON4	;
537)   0FDC 0D          					DEC     C	;
538)   0FDD 28 0D       					JR      Z,ON3           ;INDEX=1	;INDEX=1
539)   0FDF CD E4 16    		ON2:			CALL    TERM?	;
540)   0FE2 28 1C       					JR      Z,ON4           ;OUT OF RANGE	;OUT OF RANGE
541)   0FE4 FD 23       					INC     IY              ;SKIP DELIMITER	;SKIP DELIMITER
542)   0FE6 BB          					CP      E	;
543)   0FE7 20 F6       					JR      NZ,ON2	;
544)   0FE9 0D          					DEC     C	;
545)   0FEA 20 F3       					JR      NZ,ON2	;
546)   0FEC 7B          		ON3:			LD      A,E	;
547)   0FED FE F2       					CP      TPROC	;
548)   0FEF 28 22       					JR      Z,ONPROC	;
549)   0FF1 D5          					PUSH    DE	;
550)   0FF2 CD CD 1E    					CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
551)   0FF5 D1          					POP     DE	;
552)   0FF6 7A          					LD      A,D	;
553)   0FF7 FE E5       					CP      TGOTO	;
554)   0FF9 28 26       					JR      Z,GOTO2	;
555)   0FFB CD F0 16    					CALL    SPAN            ;SKIP REST OF LIST	;SKIP REST OF LIST
556)   0FFE 18 32       					JR      GOSUB1	;
558)   1000 FD 7E 00    		ON4:			LD      A,(IY)	;
559)   1003 FD 23       					INC     IY	;
560)   1005 FE 8B       					CP      ELSE	;
561)   1007 CA AC 13    					JP      Z,IF1           ;ELSE CLAUSE	;ELSE CLAUSE
562)   100A FE 0D       					CP      CR	;
563)   100C 20 F2       					JR      NZ,ON4	;
564)   100E 3E 28       					LD      A,40	;
565)   1010 C3 FD 06    		ERROR2:			JP      ERROR           ;"ON range"	;"ON range"
567)   1013 3E EE       		ONPROC:			LD      A,TON	;
568)   1015 C3 42 11    					JP      PROC	;
572)   1018 CD CD 1E    		GOTO:			CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
573)   101B CD E4 16    		GOTO1:			CALL    TERM?	;
574)   101E C2 E1 0D    					JP      NZ,SYNTAX	;
575)   1021 D9          		GOTO2:			EXX	;
576)   1022 CD CD 08    					CALL    FINDL	;
577)   1025 E5          					PUSH    HL	;
578)   1026 FD E1       					POP     IY	;
579)   1028 CA 07 0D    					JP      Z,XEQ0	;
580)   102B 3E 29       					LD      A,41	;
581)   102D 18 E1       					JR      ERROR2          ;"No such line"	;"No such line"
585)   102F CD CD 1E    		GOSUB:			CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
586)   1032 FD E5       		GOSUB1:			PUSH    IY              ;TEXT POINTER	;TEXT POINTER
587)   1034 CD E1 15    					CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
588)   1037 CD 1B 10    					CALL    GOTO1           ;SAVE MARKER	;SAVE MARKER
593)   103A D1          		RETURN:			POP     DE              ;MARKER	;MARKER
594)   103B 21 3A 10    					LD      HL,GOSCHK	;
595)   103E B7          					OR      A	;
596)   103F ED 52       					SBC     HL,DE	;
597)   1041 FD E1       					POP     IY	;
598)   1043 CA 0A 0D    					JP      Z,XEQ	;
599)   1046 3E 26       					LD      A,38	;
600)   1048 18 C6       					JR      ERROR2          ;"No GOSUB"	;"No GOSUB"
604)   104A FD E5       		REPEAT:			PUSH    IY	;
605)   104C CD E1 15    					CALL    CHECK	;
606)   104F CD 0A 0D    					CALL    XEQ	;
611)   1052 C1          		UNTIL:			POP     BC	;
612)   1053 C5          					PUSH    BC	;
613)   1054 21 52 10    					LD      HL,REPCHK	;
614)   1057 B7          					OR      A	;
615)   1058 ED 42       					SBC     HL,BC	;
616)   105A 3E 2B       					LD      A,43	;
617)   105C 20 B2       					JR      NZ,ERROR2       ;"No REPEAT"	;"No REPEAT"
618)   105E CD B6 1E    					CALL    EXPRI	;
619)   1061 CD 41 23    					CALL    TEST	;
620)   1064 C1          					POP     BC	;
621)   1065 D1          					POP     DE	;
622)   1066 20 05       					JR      NZ,XEQ2         ;TRUE	;TRUE
623)   1068 D5          					PUSH    DE	;
624)   1069 C5          					PUSH    BC	;
625)   106A D5          					PUSH    DE	;
626)   106B FD E1       					POP     IY	;
627)   106D C3 0A 0D    		XEQ2:			JP      XEQ	;
631)   1070 3E 22       		FORVAR:			LD      A,34	;
632)   1072 18 9C       					JR      ERROR2          ;"FOR variable"	;"FOR variable"
634)   1074 CD 6C 15    		FOR:			CALL    ASSIGN	;
635)   1077 20 F7       					JR      NZ,FORVAR       ;"FOR variable"	;"FOR variable"
636)   1079 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
637)   107A FD 7E 00    					LD      A,(IY)	;
638)   107D FE B8       					CP      TO	;
639)   107F 3E 24       					LD      A,36	;
640)   1081 20 8D       					JR      NZ,ERROR2       ;"No TO"	;"No TO"
641)   1083 FD 23       					INC     IY	;
642)   1085 DD E5       					PUSH    IX	;
643)   1087 CD AF 1E    					CALL    EXPRN           ;LIMIT	;LIMIT
644)   108A DD E1       					POP     IX	;
645)   108C F1          					POP     AF	;
646)   108D 47          					LD      B,A             ;TYPE	;TYPE
647)   108E C5          					PUSH    BC              ;SAVE ON STACK	;SAVE ON STACK
648)   108F E5          					PUSH    HL	;
649)   1090 21 00 00    					LD      HL,0	;
650)   1093 4C          					LD      C,H	;
651)   1094 D9          					EXX	;
652)   1095 E5          					PUSH    HL	;
653)   1096 21 01 00    					LD      HL,1            ;PRESET STEP	;PRESET STEP
654)   1099 D9          					EXX	;
655)   109A FD 7E 00    					LD      A,(IY)	;
656)   109D FE 88       					CP      STEP	;
657)   109F 20 09       					JR      NZ,FOR1	;
658)   10A1 FD 23       					INC     IY	;
659)   10A3 DD E5       					PUSH    IX	;
660)   10A5 CD AF 1E    					CALL    EXPRN           ;STEP	;STEP
661)   10A8 DD E1       					POP     IX	;
662)   10AA C5          		FOR1:			PUSH    BC	;
663)   10AB E5          					PUSH    HL	;
664)   10AC D9          					EXX	;
665)   10AD E5          					PUSH    HL	;
666)   10AE D9          					EXX	;
667)   10AF FD E5       					PUSH    IY              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
668)   10B1 DD E5       					PUSH    IX              ;LOOP VARIABLE	;LOOP VARIABLE
669)   10B3 CD E1 15    					CALL    CHECK	;
670)   10B6 CD 0A 0D    					CALL    XEQ	;
675)   10B9 C1          		NEXT:			POP     BC              ;MARKER	;MARKER
676)   10BA 21 B9 10    					LD      HL,FORCHK	;
677)   10BD B7          					OR      A	;
678)   10BE ED 42       					SBC     HL,BC	;
679)   10C0 3E 20       					LD      A,32	;
680)   10C2 20 77       					JR      NZ,ERROR3       ;"No FOR"	;"No FOR"
681)   10C4 CD E4 16    					CALL    TERM?	;
682)   10C7 E1          					POP     HL	;
683)   10C8 E5          					PUSH    HL	;
684)   10C9 C5          					PUSH    BC	;
685)   10CA E5          					PUSH    HL	;
686)   10CB C4 61 09    					CALL    NZ,GETVAR       ;VARIABLE	;VARIABLE
687)   10CE D1          					POP     DE	;
688)   10CF EB          					EX      DE,HL	;
689)   10D0 B7          					OR      A	;
690)   10D1 ED 52       		NEXT0:			SBC     HL,DE	;
691)   10D3 20 54       					JR      NZ,NEXT1	;
692)   10D5 D5          					PUSH    DE	;
693)   10D6 DD 21 08 00 					LD      IX,6+2	;
694)   10DA DD 39       					ADD     IX,SP	;
695)   10DC CD E7 1F    					CALL    DLOAD5          ;STEP	;STEP
696)   10DF DD 7E 0B    					LD      A,(IX+11)       ;TYPE	;TYPE
697)   10E2 DD E1       					POP     IX	;
698)   10E4 CD 6F 1F    					CALL    LOADN           ;LOOP VARIABLE	;LOOP VARIABLE
699)   10E7 CB 7A       					BIT     7,D             ;SIGN?	;SIGN?
700)   10E9 F5          					PUSH    AF	;
701)   10EA 3E 0B       					LD      A,'+' AND 0FH	;
702)   10EC CD BE 24    					CALL    FPP             ;ADD STEP	;ADD STEP
703)   10EF 38 4A       					JR      C,ERROR3	;
704)   10F1 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
705)   10F2 F5          					PUSH    AF	;
706)   10F3 CD 80 15    					CALL    STORE           ;UPDATE VARIABLE	;UPDATE VARIABLE
707)   10F6 DD 21 0E 00 					LD      IX,12+2	;
708)   10FA DD 39       					ADD     IX,SP	;
709)   10FC CD E7 1F    					CALL    DLOAD5          ;LIMIT	;LIMIT
710)   10FF F1          					POP     AF	;
711)   1100 CC 39 23    					CALL    Z,SWAP	;
712)   1103 3E 08       					LD      A,0+('<'-4) AND 0FH	;
713)   1105 CD BE 24    					CALL    FPP             ;TEST AGAINST LIMIT	;TEST AGAINST LIMIT
714)   1108 38 31       					JR      C,ERROR3	;
715)   110A 24          					INC     H	;
716)   110B 20 11       					JR      NZ,LOOP         ;KEEP LOOPING	;KEEP LOOPING
717)   110D 21 12 00    					LD      HL,18	;
718)   1110 39          					ADD     HL,SP	;
719)   1111 F9          					LD      SP,HL	;
720)   1112 CD 9A 24    					CALL    NXT	;
721)   1115 FE 2C       					CP      ','	;
722)   1117 C2 0A 0D    					JP      NZ,XEQ	;
723)   111A FD 23       					INC     IY	;
724)   111C 18 9B       					JR      NEXT	;
726)   111E C1          		LOOP:			POP     BC	;
727)   111F D1          					POP     DE	;
728)   1120 FD E1       					POP     IY	;
729)   1122 FD E5       					PUSH    IY	;
730)   1124 D5          					PUSH    DE	;
731)   1125 C5          					PUSH    BC	;
732)   1126 C3 0A 0D    					JP      XEQ	;
734)   1129 21 12 00    		NEXT1:			LD      HL,18	;
735)   112C 39          					ADD     HL,SP	;
736)   112D F9          					LD      SP,HL           ;"POP" THE STACK	;"POP" THE STACK
737)   112E C1          					POP     BC	;
738)   112F 21 B9 10    					LD      HL,FORCHK	;
739)   1132 ED 42       					SBC     HL,BC	;
740)   1134 E1          					POP     HL              ;VARIABLE POINTER	;VARIABLE POINTER
741)   1135 E5          					PUSH    HL	;
742)   1136 C5          					PUSH    BC	;
743)   1137 28 98       					JR      Z,NEXT0	;
744)   1139 3E 21       					LD      A,33	;
745)   113B C3 FD 06    		ERROR3:			JP      ERROR           ;"Can't match FOR"	;"Can't match FOR"
750)   113E F5          		@FN:			PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
751)   113F CD 46 11    					CALL    PROC1	;
757)   1142 F5          		PROC:			PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
758)   1143 CD 46 11    					CALL    PROC1	;
760)   1146 CD E1 15    		PROC1::			CALL    CHECK	;
761)   1149 FD 2B       					DEC     IY	;
762)   114B FD E5       					PUSH    IY	;
763)   114D CD FD 09    					CALL    GETDEF	;
764)   1150 C1          					POP     BC	;
765)   1151 28 39       					JR      Z,PROC4	;
766)   1153 3E 1E       					LD      A,30	;
767)   1155 38 E4       					JR      C,ERROR3        ;"Bad call"	;"Bad call"
768)   1157 C5          					PUSH    BC	;
769)   1158 2A DC 62    					LD      HL,(PAGE)	;
770)   115B 3E DD       		PROC2:			LD      A,DEF	;
771)   115D CD A2 17    					CALL    SEARCH          ;LOOK FOR "DEF"	;LOOK FOR "DEF"
772)   1160 38 21       					JR      C,PROC3	;
773)   1162 E5          					PUSH    HL	;
774)   1163 FD E1       					POP     IY	;
775)   1165 FD 23       					INC     IY              ;SKIP DEF	;SKIP DEF
776)   1167 CD 9A 24    					CALL    NXT	;
777)   116A CD FD 09    					CALL    GETDEF	;
778)   116D FD E5       					PUSH    IY	;
779)   116F D1          					POP     DE	;
780)   1170 38 09       					JR      C,PROC6	;
781)   1172 C4 9F 0A    					CALL    NZ,CREATE	;
782)   1175 FD E5       					PUSH    IY	;
783)   1177 D1          					POP     DE	;
784)   1178 73          					LD      (HL),E	;
785)   1179 23          					INC     HL	;
786)   117A 72          					LD      (HL),D          ;SAVE ADDRESS	;SAVE ADDRESS
787)   117B EB          		PROC6:			EX      DE,HL	;
788)   117C 3E 0D       					LD      A,CR	;
789)   117E 47          					LD      B,A	;
790)   117F ED B1       					CPIR                    ;SKIP TO END OF LINE	;SKIP TO END OF LINE
791)   1181 18 D8       					JR      PROC2	;
792)   1183 FD E1       		PROC3:			POP     IY              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
793)   1185 CD FD 09    					CALL    GETDEF	;
794)   1188 3E 1D       					LD      A,29	;
795)   118A 20 AF       					JR      NZ,ERROR3       ;"No such FN/PROC"	;"No such FN/PROC"
796)   118C 5E          		PROC4:			LD      E,(HL)	;
797)   118D 23          					INC     HL	;
798)   118E 56          					LD      D,(HL)          ;GET ADDRESS	;GET ADDRESS
799)   118F 21 02 00    					LD      HL,2	;
800)   1192 39          					ADD     HL,SP	;
801)   1193 CD 9A 24    					CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
802)   1196 D5          					PUSH    DE              ;EXCHANGE DE,IY	;EXCHANGE DE,IY
803)   1197 FD E3       					EX      (SP),IY	;
804)   1199 D1          					POP     DE	;
805)   119A FE 28       					CP      '('             ;ARGUMENTS?	;ARGUMENTS?
806)   119C 20 1B       					JR      NZ,PROC5	;
807)   119E CD 9A 24    					CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
808)   11A1 FE 28       					CP      '('	;
809)   11A3 C2 E1 0D    					JP      NZ,SYNTAX       ;"Syntax error"	;"Syntax error"
810)   11A6 FD E5       					PUSH    IY	;
811)   11A8 C1          					POP     BC              ;SAVE IY IN BC	;SAVE IY IN BC
812)   11A9 D9          					EXX	;
813)   11AA CD 72 16    					CALL    SAVLOC          ;SAVE DUMMY VARIABLES	;SAVE DUMMY VARIABLES
814)   11AD CD 5E 24    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
815)   11B0 D9          					EXX	;
816)   11B1 C5          					PUSH    BC	;
817)   11B2 FD E1       					POP     IY              ;RESTORE IY	;RESTORE IY
818)   11B4 E5          					PUSH    HL	;
819)   11B5 CD FD 15    					CALL    ARGUE           ;TRANSFER ARGUMENTS	;TRANSFER ARGUMENTS
820)   11B8 E1          					POP     HL	;
821)   11B9 73          		PROC5:			LD      (HL),E          ;SAVE "RETURN ADDRESS"	;SAVE "RETURN ADDRESS"
822)   11BA 23          					INC     HL	;
823)   11BB 7E          					LD      A,(HL)	;
824)   11BC 72          					LD      (HL),D	;
825)   11BD FE EE       					CP      TON             ;WAS IT "ON PROC" ?	;WAS IT "ON PROC" ?
826)   11BF C2 0A 0D    					JP      NZ,XEQ	;
827)   11C2 D5          					PUSH    DE	;
828)   11C3 FD E3       					EX      (SP),IY	;
829)   11C5 CD F0 16    					CALL    SPAN            ;SKIP REST OF ON LIST	;SKIP REST OF ON LIST
830)   11C8 FD E3       					EX      (SP),IY	;
831)   11CA D1          					POP     DE	;
832)   11CB 72          					LD      (HL),D	;
833)   11CC 2B          					DEC     HL	;
834)   11CD 73          					LD      (HL),E	;
835)   11CE C3 0A 0D    					JP      XEQ	;
839)   11D1 C1          		LOCAL:			POP     BC	;
840)   11D2 C5          					PUSH    BC	;
841)   11D3 21 42 11    					LD      HL,FNCHK	;
842)   11D6 B7          					OR      A	;
843)   11D7 ED 42       					SBC     HL,BC	;
844)   11D9 28 13       					JR      Z,LOCAL1	;
845)   11DB 21 46 11    					LD      HL,PROCHK	;
846)   11DE B7          					OR      A	;
847)   11DF ED 42       					SBC     HL,BC	;
848)   11E1 28 0B       					JR      Z,LOCAL1	;
849)   11E3 21 C4 16    					LD      HL,LOCCHK	;
850)   11E6 B7          					OR      A	;
851)   11E7 ED 42       					SBC     HL,BC	;
852)   11E9 3E 0C       					LD      A,12	;
853)   11EB C2 FD 06    					JP      NZ,ERROR        ;"Not LOCAL"	;"Not LOCAL"
854)   11EE FD E5       		LOCAL1:			PUSH    IY	;
855)   11F0 C1          					POP     BC	;
856)   11F1 D9          					EXX	;
857)   11F2 FD 2B       					DEC     IY	;
858)   11F4 CD 72 16    					CALL    SAVLOC	;
859)   11F7 D9          					EXX	;
860)   11F8 C5          					PUSH    BC	;
861)   11F9 FD E1       					POP     IY	;
862)   11FB CD 61 09    		LOCAL2:			CALL    GETVAR	;
863)   11FE C2 E1 0D    					JP      NZ,SYNTAX	;
864)   1201 B7          					OR      A               ;TYPE	;TYPE
865)   1202 08          					EX      AF,AF'	;
866)   1203 CD E0 23    					CALL    ZERO	;
867)   1206 08          					EX      AF,AF'	;
868)   1207 F5          					PUSH    AF	;
869)   1208 F4 80 15    					CALL    P,STORE         ;ZERO	;ZERO
870)   120B F1          					POP     AF	;
871)   120C 59          					LD      E,C	;
872)   120D FC AC 15    					CALL    M,STORES	;
873)   1210 CD 9A 24    					CALL    NXT	;
874)   1213 FE 2C       					CP      ','	;
875)   1215 C2 0A 0D    					JP      NZ,XEQ	;
876)   1218 FD 23       					INC     IY	;
877)   121A CD 9A 24    					CALL    NXT	;
878)   121D 18 DC       					JR      LOCAL2	;
882)   121F C1          		ENDPRO:			POP     BC	;
883)   1220 21 C4 16    					LD      HL,LOCCHK	;
884)   1223 B7          					OR      A	;
885)   1224 ED 42       					SBC     HL,BC	;
886)   1226 28 10       					JR      Z,UNSTK         ;LOCAL VARIABLE	;LOCAL VARIABLE
887)   1228 21 46 11    					LD      HL,PROCHK       ;PROC MARKER	;PROC MARKER
888)   122B B7          					OR      A	;
889)   122C ED 42       					SBC     HL,BC	;
890)   122E FD E1       					POP     IY	;
891)   1230 CA 0A 0D    					JP      Z,XEQ	;
892)   1233 3E 0D       					LD      A,13	;
893)   1235 C3 FD 06    					JP      ERROR           ;"No PROC"	;"No PROC"
895)   1238 DD E1       		UNSTK:			POP     IX	;
896)   123A C1          					POP     BC	;
897)   123B 78          					LD      A,B	;
898)   123C B7          					OR      A	;
899)   123D FA 49 12    					JP      M,UNSTK1        ;STRING	;STRING
900)   1240 E1          					POP     HL	;
901)   1241 D9          					EXX	;
902)   1242 E1          					POP     HL	;
903)   1243 D9          					EXX	;
904)   1244 CD 80 15    					CALL    STORE	;
905)   1247 18 D6       					JR      ENDPRO	;
906)   1249 21 00 00    		UNSTK1:			LD      HL,0	;
907)   124C 39          					ADD     HL,SP	;
908)   124D 59          					LD      E,C	;
909)   124E CD AC 15    					CALL    STORES	;
910)   1251 F9          					LD      SP,HL	;
911)   1252 18 CB       					JR      ENDPRO	;
915)   1254 CD E3 17    		INPUTN:			CALL    CHNL            ;E = CHANNEL NUMBER	;E = CHANNEL NUMBER
916)   1257 CD 9A 24    		INPN1:			CALL    NXT	;
917)   125A FE 2C       					CP      ','	;
918)   125C C2 0A 0D    					JP      NZ,XEQ	;
919)   125F FD 23       					INC     IY	;
920)   1261 CD 9A 24    					CALL    NXT	;
921)   1264 D5          					PUSH    DE	;
922)   1265 CD DA 0D    					CALL    VAR	;
923)   1268 D1          					POP     DE	;
924)   1269 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
925)   126A E5          					PUSH    HL              ;VARPTR	;VARPTR
926)   126B B7          					OR      A	;
927)   126C FA 91 12    					JP      M,INPN2         ;STRING	;STRING
928)   126F CD 27 40    					CALL    OSBGET	;
929)   1272 D9          					EXX	;
930)   1273 6F          					LD      L,A	;
931)   1274 D9          					EXX	;
932)   1275 CD 27 40    					CALL    OSBGET	;
933)   1278 D9          					EXX	;
934)   1279 67          					LD      H,A	;
935)   127A D9          					EXX	;
936)   127B CD 27 40    					CALL    OSBGET	;
937)   127E 6F          					LD      L,A	;
938)   127F CD 27 40    					CALL    OSBGET	;
939)   1282 67          					LD      H,A	;
940)   1283 CD 27 40    					CALL    OSBGET	;
941)   1286 4F          					LD      C,A	;
942)   1287 DD E1       					POP     IX	;
943)   1289 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
944)   128A D5          					PUSH    DE              ;SAVE CHANNEL	;SAVE CHANNEL
945)   128B CD 80 15    					CALL    STORE	;
946)   128E D1          					POP     DE	;
947)   128F 18 C6       					JR      INPN1	;
948)   1291 21 00 60    		INPN2:			LD      HL,ACCS	;
949)   1294 CD 27 40    		INPN3:			CALL    OSBGET	;
950)   1297 FE 0D       					CP      CR	;
951)   1299 28 04       					JR      Z,INPN4	;
952)   129B 77          					LD      (HL),A	;
953)   129C 2C          					INC     L	;
954)   129D 20 F5       					JR      NZ,INPN3	;
955)   129F DD E1       		INPN4:			POP     IX	;
956)   12A1 F1          					POP     AF	;
957)   12A2 D5          					PUSH    DE	;
958)   12A3 EB          					EX      DE,HL	;
959)   12A4 CD A9 15    					CALL    STACCS	;
960)   12A7 D1          					POP     DE	;
961)   12A8 18 AD       					JR      INPN1	;
966)   12AA FE 23       		INPUT:			CP      '#'	;
967)   12AC 28 A6       					JR      Z,INPUTN	;
968)   12AE 0E 00       					LD      C,0             ;FLAG PROMPT	;FLAG PROMPT
969)   12B0 FE 86       					CP      LINE	;
970)   12B2 20 04       					JR      NZ,INPUT0	;
971)   12B4 FD 23       					INC     IY              ;SKIP "LINE"	;SKIP "LINE"
972)   12B6 0E 80       					LD      C,80H	;
973)   12B8 21 00 61    		INPUT0:			LD      HL,BUFFER	;
974)   12BB 36 0D       					LD      (HL),CR         ;INITIALISE EMPTY	;INITIALISE EMPTY
975)   12BD CD E4 16    		INPUT1:			CALL    TERM?	;
976)   12C0 CA 0A 0D    					JP      Z,XEQ           ;DONE	;DONE
977)   12C3 FD 23       					INC     IY	;
978)   12C5 FE 2C       					CP      ','	;
979)   12C7 28 51       					JR      Z,INPUT3        ;SKIP COMMA	;SKIP COMMA
980)   12C9 FE 3B       					CP      ';'	;
981)   12CB 28 4D       					JR      Z,INPUT3	;
982)   12CD E5          					PUSH    HL              ;SAVE BUFFER POINTER	;SAVE BUFFER POINTER
983)   12CE FE 22       					CP      34		;ASCII ""	;ASCII ""
984)   12D0 20 0A       					JR      NZ,INPUT6	;
985)   12D2 C5          					PUSH    BC	;
986)   12D3 CD B1 1F    					CALL    CONS	;
987)   12D6 C1          					POP     BC	;
988)   12D7 CD 5A 17    					CALL    PTEXT           ;PRINT PROMPT	;PRINT PROMPT
989)   12DA 18 05       					JR      INPUT9	;
990)   12DC CD 05 17    		INPUT6:			CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
991)   12DF 20 05       					JR      NZ,INPUT2	;
992)   12E1 E1          		INPUT9:			POP     HL	;
993)   12E2 CB C1       					SET     0,C             ;FLAG NO PROMPT	;FLAG NO PROMPT
994)   12E4 18 D2       					JR      INPUT0	;
995)   12E6 FD 2B       		INPUT2:			DEC     IY	;
996)   12E8 C5          					PUSH    BC	;
997)   12E9 CD DA 0D    					CALL    VAR	;
998)   12EC C1          					POP     BC	;
999)   12ED E1          					POP     HL	;
1000)   12EE F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1001)   12EF 7E          					LD      A,(HL)	;
1002)   12F0 23          					INC     HL	;
1003)   12F1 FE 0D       					CP      CR              ;BUFFER EMPTY?	;BUFFER EMPTY?
1004)   12F3 CC 1E 13    					CALL    Z,REFILL	;
1005)   12F6 CB 79       					BIT     7,C	;
1006)   12F8 F5          					PUSH    AF	;
1007)   12F9 C4 78 17    					CALL    NZ,LINES	;
1008)   12FC F1          					POP     AF	;
1009)   12FD CC 67 17    					CALL    Z,FETCHS	;
1010)   1300 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1011)   1301 C5          					PUSH    BC	;
1012)   1302 E5          					PUSH    HL	;
1013)   1303 B7          					OR      A	;
1014)   1304 FA 15 13    					JP      M,INPUT4        ;STRING	;STRING
1015)   1307 F5          					PUSH    AF	;
1016)   1308 DD E5       					PUSH    IX	;
1017)   130A CD 68 21    					CALL    VAL0	;
1018)   130D DD E1       					POP     IX	;
1019)   130F F1          					POP     AF	;
1020)   1310 CD 80 15    					CALL    STORE	;
1021)   1313 18 03       					JR      INPUT5	;
1022)   1315 CD A9 15    		INPUT4:			CALL    STACCS	;
1023)   1318 E1          		INPUT5:			POP     HL	;
1024)   1319 C1          					POP     BC	;
1025)   131A CB 81       		INPUT3:			RES     0,C	;
1026)   131C 18 9F       					JR      INPUT1	;
1028)   131E CB 41       		REFILL:			BIT     0,C	;
1029)   1320 20 0A       					JR      NZ,REFIL0       ;NO PROMPT	;NO PROMPT
1030)   1322 3E 3F       					LD      A,'?'	;
1031)   1324 CD 96 08    					CALL    OUTCHR          ;PROMPT	;PROMPT
1032)   1327 3E 20       					LD      A,' '	;
1033)   1329 CD 96 08    					CALL    OUTCHR	;
1034)   132C 21 00 61    		REFIL0:			LD      HL,BUFFER	;
1035)   132F C5          					PUSH    BC	;
1036)   1330 E5          					PUSH    HL	;
1037)   1331 DD E5       					PUSH    IX	;
1038)   1333 CD 1E 40    					CALL    OSLINE	;
1039)   1336 DD E1       					POP     IX	;
1040)   1338 E1          					POP     HL	;
1041)   1339 C1          					POP     BC	;
1042)   133A 47          					LD      B,A             ;POS AT ENTRY	;POS AT ENTRY
1043)   133B AF          					XOR     A	;
1044)   133C 32 FB 62    					LD      (COUNT),A	;
1045)   133F B8          					CP      B	;
1046)   1340 C8          					RET     Z	;
1047)   1341 7E          		REFIL1:			LD      A,(HL)	;
1048)   1342 FE 0D       					CP      CR	;
1049)   1344 C8          					RET     Z	;
1050)   1345 23          					INC     HL	;
1051)   1346 10 F9       					DJNZ    REFIL1	;
1052)   1348 C9          					RET	;
1056)   1349 FE 23       		READ:			CP      '#'	;
1057)   134B CA 54 12    					JP      Z,INPUTN	;
1058)   134E 2A F0 62    					LD      HL,(DATPTR)	;
1059)   1351 7E          		READ0:			LD      A,(HL)	;
1060)   1352 23          					INC     HL              ;SKIP COMMA OR "DATA"	;SKIP COMMA OR "DATA"
1061)   1353 FE 0D       					CP      CR              ;END OF DATA STMT?	;END OF DATA STMT?
1062)   1355 CC 8E 13    					CALL    Z,GETDAT	;
1063)   1358 E5          					PUSH    HL	;
1064)   1359 CD DA 0D    					CALL    VAR	;
1065)   135C E1          					POP     HL	;
1066)   135D B7          					OR      A	;
1067)   135E FA 74 13    					JP      M,READ1         ;STRING	;STRING
1068)   1361 E5          					PUSH    HL	;
1069)   1362 FD E3       					EX      (SP),IY	;
1070)   1364 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1071)   1365 DD E5       					PUSH    IX	;
1072)   1367 CD AF 1E    					CALL    EXPRN	;
1073)   136A DD E1       					POP     IX	;
1074)   136C F1          					POP     AF	;
1075)   136D CD 80 15    					CALL    STORE	;
1076)   1370 FD E3       					EX      (SP),IY	;
1077)   1372 18 07       					JR      READ2	;
1078)   1374 CD 67 17    		READ1:			CALL    FETCHS	;
1079)   1377 E5          					PUSH    HL	;
1080)   1378 CD A9 15    					CALL    STACCS	;
1081)   137B E1          		READ2:			POP     HL	;
1082)   137C 22 F0 62    					LD      (DATPTR),HL	;
1083)   137F CD 9A 24    					CALL    NXT	;
1084)   1382 FE 2C       					CP      ','	;
1085)   1384 C2 0A 0D    					JP      NZ,XEQ	;
1086)   1387 FD 23       					INC     IY	;
1087)   1389 CD 9A 24    					CALL    NXT	;
1088)   138C 18 C3       					JR      READ0	;
1090)   138E 3E DC       		GETDAT:			LD      A,DATA	;
1091)   1390 CD A2 17    					CALL    SEARCH	;
1092)   1393 23          					INC     HL	;
1093)   1394 D0          					RET     NC	;
1094)   1395 3E 2A       					LD      A,42	;
1095)   1397 C3 FD 06    		ERROR4:			JP      ERROR           ;"Out of DATA"	;"Out of DATA"
1101)   139A CD B6 1E    		IF:			CALL    EXPRI	;
1102)   139D CD 41 23    					CALL    TEST	;
1103)   13A0 28 15       					JR      Z,IFNOT         ;FALSE	;FALSE
1104)   13A2 FD 7E 00    					LD      A,(IY)	;
1105)   13A5 FE 8C       					CP      THEN	;
1106)   13A7 C2 0A 0D    					JP      NZ,XEQ	;
1107)   13AA FD 23       					INC     IY              ;SKIP "THEN"	;SKIP "THEN"
1108)   13AC CD 9A 24    		IF1:			CALL    NXT	;
1109)   13AF FE 8D       					CP      LINO	;
1110)   13B1 C2 0A 0D    					JP      NZ,XEQ          ;STATEMENT FOLLOWS	;STATEMENT FOLLOWS
1111)   13B4 C3 18 10    					JP      GOTO            ;LINE NO. FOLLOWS	;LINE NO. FOLLOWS
1112)   13B7 FD 7E 00    		IFNOT:			LD      A,(IY)	;
1113)   13BA FE 0D       					CP      CR	;
1114)   13BC FD 23       					INC     IY	;
1115)   13BE CA 07 0D    					JP      Z,XEQ0          ;END OF LINE	;END OF LINE
1116)   13C1 FE 8B       					CP      ELSE	;
1117)   13C3 20 F2       					JR      NZ,IFNOT	;
1118)   13C5 18 E5       					JR      IF1	;
1122)   13C7 CD 00 40    		CLS:			CALL    CLRSCN	;
1123)   13CA AF          					XOR     A	;
1124)   13CB 32 FB 62    					LD      (COUNT),A	;
1125)   13CE C3 0A 0D    					JP      XEQ	;
1129)   13D1 CD 4D 0C    		STOP:			CALL    TELL	;
1130)   13D4 0D          					DEFB    CR	;
1131)   13D5 0A          					DEFB    LF	;
1132)   13D6 FA          					DEFB    TSTOP	;
1133)   13D7 00          					DEFB    0	;
1134)   13D8 CD E6 08    					CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
1135)   13DB CD 10 09    					CALL    SAYLN	;
1136)   13DE CD 8F 08    					CALL    CRLF	;
1137)   13E1 C3 91 00    					JP      CLOOP	;
1141)   13E4 CD 41 0C    		REPOR:			CALL    REPORT	;
1142)   13E7 C3 0A 0D    					JP      XEQ	;
1146)   13EA CD EE 07    		CLR:			CALL    CLEAR	;
1147)   13ED 2A DC 62    					LD      HL,(PAGE)	;
1148)   13F0 18 13       					JR      RESTR1	;
1152)   13F2 2A DC 62    		RESTOR:			LD      HL,(PAGE)	;
1153)   13F5 CD E4 16    					CALL    TERM?	;
1154)   13F8 28 0B       					JR      Z,RESTR1	;
1155)   13FA CD CD 1E    					CALL    ITEMI	;
1156)   13FD D9          					EXX	;
1157)   13FE CD CD 08    					CALL    FINDL           ;SEARCH FOR LINE	;SEARCH FOR LINE
1158)   1401 3E 29       					LD      A,41	;
1159)   1403 20 92       					JR      NZ,ERROR4       ;"No such line"	;"No such line"
1160)   1405 3E DC       		RESTR1:			LD      A,DATA	;
1161)   1407 CD A2 17    					CALL    SEARCH	;
1162)   140A 22 F0 62    					LD      (DATPTR),HL	;
1163)   140D C3 0A 0D    					JP      XEQ	;
1171)   1410 CD D9 17    		PTR:			CALL    CHANEL	;
1172)   1413 CD F8 16    					CALL    EQUALS	;
1173)   1416 7B          					LD      A,E	;
1174)   1417 F5          					PUSH    AF	;
1175)   1418 CD B6 1E    					CALL    EXPRI	;
1176)   141B E5          					PUSH    HL	;
1177)   141C D9          					EXX	;
1178)   141D D1          					POP     DE	;
1179)   141E F1          					POP     AF	;
1180)   141F CD 3F 40    					CALL    PUTPTR	;
1181)   1422 C3 0A 0D    					JP      XEQ	;
1183)   1425 CD F8 16    		PAGEV:			CALL    EQUALS	;
1184)   1428 CD B6 1E    					CALL    EXPRI	;
1185)   142B D9          					EXX	;
1186)   142C 2E 00       					LD      L,0	;
1187)   142E 22 DC 62    					LD      (PAGE),HL	;
1188)   1431 C3 0A 0D    					JP      XEQ	;
1190)   1434 FE 24       		TIMEV:			CP      '$'	;
1191)   1436 28 0F       					JR      Z,TIMEVS	;
1192)   1438 CD F8 16    					CALL    EQUALS	;
1193)   143B CD B6 1E    					CALL    EXPRI	;
1194)   143E E5          					PUSH    HL	;
1195)   143F D9          					EXX	;
1196)   1440 D1          					POP     DE	;
1197)   1441 CD 03 40    					CALL    PUTIME	;
1198)   1444 C3 0A 0D    					JP      XEQ	;
1200)   1447 FD 23       		TIMEVS:			INC     IY              ;SKIP '$'	;SKIP '$'
1201)   1449 CD F8 16    					CALL    EQUALS	;
1202)   144C CD BF 1E    					CALL    EXPRS	;
1203)   144F CD 72 40    					CALL    PUTIMS	;
1204)   1452 C3 0A 0D    					JP      XEQ	;
1206)   1455 CD F8 16    		LOMEMV:			CALL    EQUALS	;
1207)   1458 CD B6 1E    					CALL    EXPRI	;
1208)   145B CD EE 07    					CALL    CLEAR	;
1209)   145E D9          					EXX	;
1210)   145F 22 E0 62    					LD      (LOMEM),HL	;
1211)   1462 22 E2 62    					LD      (FREE),HL	;
1212)   1465 C3 0A 0D    					JP      XEQ	;
1214)   1468 CD F8 16    		HIMEMV:			CALL    EQUALS	;
1215)   146B CD B6 1E    					CALL    EXPRI	;
1216)   146E D9          					EXX	;
1217)   146F ED 5B E2 62 					LD      DE,(FREE)	;
1218)   1473 14          					INC     D	;
1219)   1474 AF          					XOR     A	;
1220)   1475 ED 52       					SBC     HL,DE	;
1221)   1477 19          					ADD     HL,DE	;
1222)   1478 DA FD 06    					JP      C,ERROR         ;"No room"	;"No room"
1223)   147B ED 5B E4 62 					LD      DE,(HIMEM)	;
1224)   147F 22 E4 62    					LD      (HIMEM),HL	;
1225)   1482 EB          					EX      DE,HL	;
1226)   1483 ED 72       					SBC     HL,SP	;
1227)   1485 C2 0A 0D    					JP      NZ,XEQ	;
1228)   1488 EB          					EX      DE,HL	;
1229)   1489 F9          					LD      SP,HL           ;LOAD STACK POINTER	;LOAD STACK POINTER
1230)   148A C3 0A 0D    					JP      XEQ	;
1234)   148D CD B6 1E    		WIDTHV:			CALL    EXPRI	;
1235)   1490 D9          					EXX	;
1236)   1491 7D          					LD      A,L	;
1237)   1492 32 FC 62    					LD      (WIDTH),A	;
1238)   1495 C3 0A 0D    					JP      XEQ	;
1244)   1498 FD 23       		TRACE:			INC     IY	;
1245)   149A 21 00 00    					LD      HL,0	;
1246)   149D FE EE       					CP      TON	;
1247)   149F 28 0A       					JR      Z,TRACE0	;
1248)   14A1 FE 87       					CP      OFF	;
1249)   14A3 28 07       					JR      Z,TRACE1	;
1250)   14A5 FD 2B       					DEC     IY	;
1251)   14A7 CD B6 1E    					CALL    EXPRI	;
1252)   14AA D9          					EXX	;
1253)   14AB 2B          		TRACE0:			DEC     HL	;
1254)   14AC 22 E8 62    		TRACE1:			LD      (TRACEN),HL	;
1255)   14AF C3 0A 0D    					JP      XEQ	;
1259)   14B2 CD B6 1E    		VDU:			CALL    EXPRI	;
1260)   14B5 D9          					EXX	;
1261)   14B6 7D          					LD      A,L	;
1262)   14B7 CD 15 40    					CALL    OSWRCH	;
1263)   14BA FD 7E 00    					LD      A,(IY)	;
1264)   14BD FE 2C       					CP      ','	;
1265)   14BF 28 08       					JR      Z,VDU2	;
1266)   14C1 FE 3B       					CP      ';'	;
1267)   14C3 20 06       					JR      NZ,VDU3	;
1268)   14C5 7C          					LD      A,H	;
1269)   14C6 CD 15 40    					CALL    OSWRCH	;
1270)   14C9 FD 23       		VDU2:			INC     IY	;
1271)   14CB CD E4 16    		VDU3:			CALL    TERM?	;
1272)   14CE 20 E2       					JR      NZ,VDU	;
1273)   14D0 C3 0A 0D    					JP      XEQ	;
1277)   14D3 CD D9 17    		CLOSE:			CALL    CHANEL	;
1278)   14D6 CD 2D 40    					CALL    OSSHUT	;
1279)   14D9 C3 0A 0D    					JP      XEQ	;
1283)   14DC CD D9 17    		BPUT:			CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
1284)   14DF D5          					PUSH    DE	;
1285)   14E0 CD 52 24    					CALL    COMMA	;
1286)   14E3 CD B6 1E    					CALL    EXPRI           ;BYTE	;BYTE
1287)   14E6 D9          					EXX	;
1288)   14E7 7D          					LD      A,L	;
1289)   14E8 D1          					POP     DE	;
1290)   14E9 CD 24 40    					CALL    OSBPUT	;
1291)   14EC C3 0A 0D    					JP      XEQ	;
1295)   14EF CD B6 1E    		CALL:			CALL    EXPRI           ;ADDRESS	;ADDRESS
1296)   14F2 D9          					EXX	;
1297)   14F3 E5          					PUSH    HL              ;SAVE IT	;SAVE IT
1298)   14F4 06 00       					LD      B,0             ;PARAMETER COUNTER	;PARAMETER COUNTER
1299)   14F6 11 00 61    					LD      DE,BUFFER       ;VECTOR	;VECTOR
1300)   14F9 CD 9A 24    		CALL1:			CALL    NXT	;
1301)   14FC FE 2C       					CP      ','	;
1302)   14FE 20 17       					JR      NZ,CALL2	;
1303)   1500 FD 23       					INC     IY	;
1304)   1502 04          					INC     B	;
1305)   1503 CD 9A 24    					CALL    NXT	;
1306)   1506 C5          					PUSH    BC	;
1307)   1507 D5          					PUSH    DE	;
1308)   1508 CD DA 0D    					CALL    VAR	;
1309)   150B D1          					POP     DE	;
1310)   150C C1          					POP     BC	;
1311)   150D 13          					INC     DE	;
1312)   150E 12          					LD      (DE),A          ;PARAMETER TYPE	;PARAMETER TYPE
1313)   150F 13          					INC     DE	;
1314)   1510 EB          					EX      DE,HL	;
1315)   1511 73          					LD      (HL),E          ;PARAMETER ADDRESS	;PARAMETER ADDRESS
1316)   1512 23          					INC     HL	;
1317)   1513 72          					LD      (HL),D	;
1318)   1514 EB          					EX      DE,HL	;
1319)   1515 18 E2       					JR      CALL1	;
1320)   1517 78          		CALL2:			LD      A,B	;
1321)   1518 32 00 61    					LD      (BUFFER),A      ;PARAMETER COUNT	;PARAMETER COUNT
1322)   151B E1          					POP     HL              ;RESTORE ADDRESS	;RESTORE ADDRESS
1323)   151C CD 26 15    					CALL    USR1	;
1324)   151F C3 0A 0D    					JP      XEQ	;
1328)   1522 CD CD 1E    		@USR:			CALL    ITEMI	;
1329)   1525 D9          					EXX	;
1330)   1526 E5          		USR1:			PUSH    HL              ;ADDRESS ON STACK	;ADDRESS ON STACK
1331)   1527 FD E3       					EX      (SP),IY	;
1332)   1529 24          					INC     H               ;PAGE &FF?	;PAGE &FF?
1333)   152A 21 55 15    					LD      HL,USR2         ;RETURN ADDRESS	;RETURN ADDRESS
1334)   152D E5          					PUSH    HL	;
1335)   152E DD 21 00 62 					LD      IX,STAVAR	;
1336)   1532 CC 33 40    					CALL    Z,OSCALL        ;INTERCEPT PAGE &FF	;INTERCEPT PAGE &FF
1337)   1535 DD 4E 18    					LD      C,(IX+24)	;
1338)   1538 C5          					PUSH    BC	;
1339)   1539 F1          					POP     AF              ;LOAD FLAGS	;LOAD FLAGS
1340)   153A DD 7E 04    					LD      A,(IX+4)        ;LOAD Z80 REGISTERS	;LOAD Z80 REGISTERS
1341)   153D DD 46 08    					LD      B,(IX+8)	;
1342)   1540 DD 4E 0C    					LD      C,(IX+12)	;
1343)   1543 DD 56 10    					LD      D,(IX+16)	;
1344)   1546 DD 5E 14    					LD      E,(IX+20)	;
1345)   1549 DD 66 20    					LD      H,(IX+32)	;
1346)   154C DD 6E 30    					LD      L,(IX+48)	;
1347)   154F DD 21 00 61 					LD      IX,BUFFER	;
1348)   1553 FD E9       					JP      (IY)            ;OFF TO USER ROUTINE	;OFF TO USER ROUTINE
1349)   1555 FD E1       		USR2:			POP     IY	;
1350)   1557 AF          					XOR     A	;
1351)   1558 4F          					LD      C,A	;
1352)   1559 C9          					RET	;
1356)   155A CD B6 1E    		PUT:			CALL    EXPRI           ;PORT ADDRESS	;PORT ADDRESS
1357)   155D D9          					EXX	;
1358)   155E E5          					PUSH    HL	;
1359)   155F CD 52 24    					CALL    COMMA	;
1360)   1562 CD B6 1E    					CALL    EXPRI           ;DATA	;DATA
1361)   1565 D9          					EXX	;
1362)   1566 C1          					POP     BC	;
1363)   1567 ED 69       					OUT     (C),L           ;OUTPUT TO PORT BC	;OUTPUT TO PORT BC
1364)   1569 C3 0A 0D    					JP      XEQ	;
1373)   156C CD 61 09    		ASSIGN:			CALL    GETVAR          ;VARIABLE	;VARIABLE
1374)   156F D8          					RET     C               ;ILLEGAL VARIABLE	;ILLEGAL VARIABLE
1375)   1570 C4 52 09    					CALL    NZ,PUTVAR	;
1376)   1573 B7          					OR      A	;
1377)   1574 F8          					RET     M               ;STRING VARIABLE	;STRING VARIABLE
1378)   1575 F5          					PUSH    AF              ;NUMERIC TYPE	;NUMERIC TYPE
1379)   1576 CD F8 16    					CALL    EQUALS	;
1380)   1579 E5          					PUSH    HL	;
1381)   157A CD AF 1E    					CALL    EXPRN	;
1382)   157D DD E1       					POP     IX	;
1383)   157F F1          					POP     AF	;
1384)   1580 CB 47       		STORE:			BIT     0,A	;
1385)   1582 28 13       					JR      Z,STOREI	;
1386)   1584 BF          					CP      A               ;SET ZERO	;SET ZERO
1387)   1585 DD 71 04    		@STORE5:		LD      (IX+4),C	;
1388)   1588 D9          		@STORE4:		EXX	;
1389)   1589 DD 75 00    					LD      (IX+0),L	;
1390)   158C DD 74 01    					LD      (IX+1),H	;
1391)   158F D9          					EXX	;
1392)   1590 DD 75 02    					LD      (IX+2),L	;
1393)   1593 DD 74 03    					LD      (IX+3),H	;
1394)   1596 C9          					RET	;
1395)   1597 F5          		STOREI:			PUSH    AF	;
1396)   1598 0C          					INC     C               ;SPEED - & PRESERVE F'	;SPEED - & PRESERVE F'
1397)   1599 0D          					DEC     C               ; WHEN CALLED BY FNEND0	; WHEN CALLED BY FNEND0
1398)   159A C4 5D 21    					CALL    NZ,SFIX         ;CONVERT TO INTEGER	;CONVERT TO INTEGER
1399)   159D F1          					POP     AF	;
1400)   159E FE 04       					CP      4	;
1401)   15A0 28 E6       					JR      Z,STORE4	;
1402)   15A2 BF          					CP      A               ;SET ZERO	;SET ZERO
1403)   15A3 D9          		STORE1:			EXX	;
1404)   15A4 DD 75 00    					LD      (IX+0),L	;
1405)   15A7 D9          					EXX	;
1406)   15A8 C9          					RET	;
1408)   15A9 21 00 60    		STACCS:			LD      HL,ACCS	;
1409)   15AC 1F          		STORES:			RRA	;
1410)   15AD 30 3F       					JR      NC,STORS3       ;FIXED STRING	;FIXED STRING
1411)   15AF E5          					PUSH    HL	;
1412)   15B0 CD 7B 1F    					CALL    LOAD4	;
1413)   15B3 7B          					LD      A,E             ;LENGTH OF STRING	;LENGTH OF STRING
1414)   15B4 D9          					EXX	;
1415)   15B5 6F          					LD      L,A	;
1416)   15B6 7C          					LD      A,H             ;LENGTH ALLOCATED	;LENGTH ALLOCATED
1417)   15B7 D9          					EXX	;
1418)   15B8 BB          					CP      E	;
1419)   15B9 30 14       					JR      NC,STORS1       ;ENOUGH ROOM	;ENOUGH ROOM
1420)   15BB D9          					EXX	;
1421)   15BC 65          					LD      H,L	;
1422)   15BD D9          					EXX	;
1423)   15BE E5          					PUSH    HL	;
1424)   15BF 06 00       					LD      B,0	;
1425)   15C1 4F          					LD      C,A	;
1426)   15C2 09          					ADD     HL,BC	;
1427)   15C3 ED 4B E2 62 					LD      BC,(FREE)	;
1428)   15C7 ED 42       					SBC     HL,BC           ;IS STRING LAST?	;IS STRING LAST?
1429)   15C9 E1          					POP     HL	;
1430)   15CA 37          					SCF	;
1431)   15CB 28 02       					JR      Z,STORS1	;
1432)   15CD 60          					LD      H,B	;
1433)   15CE 69          					LD      L,C	;
1434)   15CF CD 88 15    		STORS1:			CALL    STORE4          ;PRESERVES CARRY!	;PRESERVES CARRY!
1435)   15D2 06 00       					LD      B,0	;
1436)   15D4 4B          					LD      C,E	;
1437)   15D5 EB          					EX      DE,HL	;
1438)   15D6 E1          					POP     HL	;
1439)   15D7 0D          					DEC     C	;
1440)   15D8 0C          					INC     C	;
1441)   15D9 C8          					RET     Z               ;NULL STRING	;NULL STRING
1442)   15DA ED B0       					LDIR	;
1443)   15DC D0          					RET     NC              ;STRING REPLACED	;STRING REPLACED
1444)   15DD ED 53 E2 62 					LD      (FREE),DE	;
1445)   15E1 E5          		@CHECK:			PUSH    HL	;
1446)   15E2 2A E2 62    					LD      HL,(FREE)	;
1447)   15E5 24          					INC     H	;
1448)   15E6 ED 72       					SBC     HL,SP	;
1449)   15E8 E1          					POP     HL	;
1450)   15E9 D8          					RET     C	;
1451)   15EA AF          					XOR     A	;
1452)   15EB C3 FD 06    					JP      ERROR           ;"No room"	;"No room"
1454)   15EE 4B          		STORS3:			LD      C,E	;
1455)   15EF DD E5       					PUSH    IX	;
1456)   15F1 D1          					POP     DE	;
1457)   15F2 AF          					XOR     A	;
1458)   15F3 47          					LD      B,A	;
1459)   15F4 B9          					CP      C	;
1460)   15F5 28 02       					JR      Z,STORS5	;
1461)   15F7 ED B0       					LDIR	;
1462)   15F9 3E 0D       		STORS5:			LD      A,CR	;
1463)   15FB 12          					LD      (DE),A	;
1464)   15FC C9          					RET	;
1475)   15FD 3E FF       		ARGUE:			LD      A,-1	;
1476)   15FF F5          					PUSH    AF              ;PUT MARKER ON STACK	;PUT MARKER ON STACK
1477)   1600 FD 23       		ARGUE1:			INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1478)   1602 13          					INC     DE	;
1479)   1603 D5          					PUSH    DE	;
1480)   1604 CD 9A 24    					CALL    NXT	;
1481)   1607 CD 61 09    					CALL    GETVAR	;
1482)   160A 38 38       					JR      C,ARGERR	;
1483)   160C C4 52 09    					CALL    NZ,PUTVAR	;
1484)   160F D1          					POP     DE	;
1485)   1610 E5          					PUSH    HL              ;VARPTR	;VARPTR
1486)   1611 B7          					OR      A               ;TYPE	;TYPE
1487)   1612 F5          					PUSH    AF	;
1488)   1613 D5          					PUSH    DE	;
1489)   1614 FD E3       					EX      (SP),IY	;
1490)   1616 FA 2B 16    					JP      M,ARGUE2        ;STRING	;STRING
1491)   1619 CD AF 1E    					CALL    EXPRN           ;PARAMETER VALUE	;PARAMETER VALUE
1492)   161C FD E3       					EX      (SP),IY	;
1493)   161E D1          					POP     DE	;
1494)   161F F1          					POP     AF	;
1495)   1620 D9          					EXX	;
1496)   1621 E5          					PUSH    HL	;
1497)   1622 D9          					EXX	;
1498)   1623 E5          					PUSH    HL	;
1499)   1624 47          					LD      B,A	;
1500)   1625 C5          					PUSH    BC	;
1501)   1626 CD E1 15    					CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
1502)   1629 18 0D       					JR      ARGUE4	;
1503)   162B CD BF 1E    		ARGUE2:			CALL    EXPRS	;
1504)   162E FD E3       					EX      (SP),IY	;
1505)   1630 D9          					EXX	;
1506)   1631 D1          					POP     DE	;
1507)   1632 D9          					EXX	;
1508)   1633 F1          					POP     AF	;
1509)   1634 CD 01 24    					CALL    PUSHS	;
1510)   1637 D9          					EXX	;
1511)   1638 CD 9A 24    		ARGUE4:			CALL    NXT	;
1512)   163B FE 2C       					CP      ','	;
1513)   163D 20 0A       					JR      NZ,ARGUE5	;
1514)   163F 1A          					LD      A,(DE)	;
1515)   1640 FE 2C       					CP      ','	;
1516)   1642 28 BC       					JR      Z,ARGUE1        ;ANOTHER	;ANOTHER
1517)   1644 3E 1F       		ARGERR:			LD      A,31	;
1518)   1646 C3 FD 06    					JP      ERROR           ;"Arguments"	;"Arguments"
1519)   1649 CD 5E 24    		ARGUE5:			CALL    BRAKET	;
1520)   164C 1A          					LD      A,(DE)	;
1521)   164D FE 29       					CP      ')'	;
1522)   164F 20 F3       					JR      NZ,ARGERR	;
1523)   1651 13          					INC     DE	;
1524)   1652 D9          					EXX	;
1525)   1653 C1          		ARGUE6:			POP     BC	;
1526)   1654 78          					LD      A,B	;
1527)   1655 3C          					INC     A	;
1528)   1656 D9          					EXX	;
1529)   1657 C8          					RET     Z               ;MARKER POPPED	;MARKER POPPED
1530)   1658 D9          					EXX	;
1531)   1659 3D          					DEC     A	;
1532)   165A FA 68 16    					JP      M,ARGUE7        ;STRING	;STRING
1533)   165D E1          					POP     HL	;
1534)   165E D9          					EXX	;
1535)   165F E1          					POP     HL	;
1536)   1660 D9          					EXX	;
1537)   1661 DD E1       					POP     IX	;
1538)   1663 CD 80 15    					CALL    STORE           ;WRITE TO DUMMY	;WRITE TO DUMMY
1539)   1666 18 EB       					JR      ARGUE6	;
1540)   1668 CD 20 24    		ARGUE7:			CALL    POPS	;
1541)   166B DD E1       					POP     IX	;
1542)   166D CD A9 15    					CALL    STACCS	;
1543)   1670 18 E1       					JR      ARGUE6	;
1552)   1672 D1          		SAVLOC:			POP     DE              ;RETURN ADDRESS	;RETURN ADDRESS
1553)   1673 FD 23       		SAVLO1:			INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1554)   1675 CD 9A 24    					CALL    NXT	;
1555)   1678 D5          					PUSH    DE	;
1556)   1679 D9          					EXX	;
1557)   167A C5          					PUSH    BC	;
1558)   167B D5          					PUSH    DE	;
1559)   167C E5          					PUSH    HL	;
1560)   167D D9          					EXX	;
1561)   167E CD DA 0D    					CALL    VAR             ;DUMMY VARIABLE	;DUMMY VARIABLE
1562)   1681 D9          					EXX	;
1563)   1682 E1          					POP     HL	;
1564)   1683 D1          					POP     DE	;
1565)   1684 C1          					POP     BC	;
1566)   1685 D9          					EXX	;
1567)   1686 D1          					POP     DE	;
1568)   1687 B7          					OR      A               ;TYPE	;TYPE
1569)   1688 FA 99 16    					JP      M,SAVLO2        ;STRING	;STRING
1570)   168B D9          					EXX	;
1571)   168C E5          					PUSH    HL              ;SAVE H'L'	;SAVE H'L'
1572)   168D D9          					EXX	;
1573)   168E 47          					LD      B,A             ;TYPE	;TYPE
1574)   168F CD 6F 1F    					CALL    LOADN	;
1575)   1692 D9          					EXX	;
1576)   1693 E3          					EX      (SP),HL	;
1577)   1694 D9          					EXX	;
1578)   1695 E5          					PUSH    HL	;
1579)   1696 C5          					PUSH    BC	;
1580)   1697 18 26       					JR      SAVLO4	;
1581)   1699 F5          		SAVLO2:			PUSH    AF              ;STRING TYPE	;STRING TYPE
1582)   169A D5          					PUSH    DE	;
1583)   169B D9          					EXX	;
1584)   169C E5          					PUSH    HL	;
1585)   169D D9          					EXX	;
1586)   169E CD F9 1F    					CALL    LOADS	;
1587)   16A1 D9          					EXX	;
1588)   16A2 E1          					POP     HL	;
1589)   16A3 D9          					EXX	;
1590)   16A4 4B          					LD      C,E	;
1591)   16A5 D1          					POP     DE	;
1592)   16A6 CD E1 15    					CALL    CHECK	;
1593)   16A9 F1          					POP     AF              ;LEVEL STACK	;LEVEL STACK
1594)   16AA 21 00 00    					LD      HL,0	;
1595)   16AD 45          					LD      B,L	;
1596)   16AE ED 42       					SBC     HL,BC	;
1597)   16B0 39          					ADD     HL,SP	;
1598)   16B1 F9          					LD      SP,HL	;
1599)   16B2 47          					LD      B,A             ;TYPE	;TYPE
1600)   16B3 C5          					PUSH    BC	;
1601)   16B4 28 09       					JR      Z,SAVLO4	;
1602)   16B6 D5          					PUSH    DE	;
1603)   16B7 11 00 60    					LD      DE,ACCS	;
1604)   16BA EB          					EX      DE,HL	;
1605)   16BB 45          					LD      B,L	;
1606)   16BC ED B0       					LDIR                    ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1607)   16BE D1          					POP     DE	;
1608)   16BF DD E5       		SAVLO4:			PUSH    IX              ;VARPTR	;VARPTR
1609)   16C1 CD C4 16    					CALL    SAVLO5	;
1611)   16C4 CD E1 15    		SAVLO5:			CALL    CHECK	;
1612)   16C7 CD 9A 24    					CALL    NXT	;
1613)   16CA FE 2C       					CP      ','             ;MORE?	;MORE?
1614)   16CC 28 A5       					JR      Z,SAVLO1	;
1615)   16CE EB          					EX      DE,HL	;
1616)   16CF E9          					JP      (HL)            ;"RETURN"	;"RETURN"
1618)   16D0 FD 7E 00    		DELIM:			LD      A,(IY)          ;ASSEMBLER DELIMITER	;ASSEMBLER DELIMITER
1619)   16D3 FE 20       					CP      ' '	;
1620)   16D5 C8          					RET     Z	;
1621)   16D6 FE 2C       					CP      ','	;
1622)   16D8 C8          					RET     Z	;
1623)   16D9 FE 29       					CP      ')'	;
1624)   16DB C8          					RET     Z	;
1625)   16DC FE 3B       		TERM:			CP      ';'             ;ASSEMBLER TERMINATOR	;ASSEMBLER TERMINATOR
1626)   16DE C8          					RET     Z	;
1627)   16DF FE 5C       					CP      '\'	;
1628)   16E1 C8          					RET     Z	;
1629)   16E2 18 06       					JR      TERM0	;
1631)   16E4 CD 9A 24    		@TERM?:			CALL    NXT	;
1632)   16E7 FE 8B       					CP      ELSE	;
1633)   16E9 D0          					RET     NC	;
1634)   16EA FE 3A       		TERM0:			CP      ':'             ;ASSEMBLER SEPARATOR	;ASSEMBLER SEPARATOR
1635)   16EC D0          					RET     NC	;
1636)   16ED FE 0D       					CP      CR	;
1637)   16EF C9          					RET	;
1639)   16F0 CD E4 16    		SPAN:			CALL    TERM?	;
1640)   16F3 C8          					RET     Z	;
1641)   16F4 FD 23       					INC     IY	;
1642)   16F6 18 F8       					JR      SPAN	;
1644)   16F8 CD 9A 24    		EQUALS:			CALL    NXT	;
1645)   16FB FD 23       					INC     IY	;
1646)   16FD FE 3D       					CP      '='	;
1647)   16FF C8          					RET     Z	;
1648)   1700 3E 04       					LD      A,4	;
1649)   1702 C3 FD 06    					JP      ERROR           ;"Mistake"	;"Mistake"
1651)   1705 FE 8A       		FORMAT:			CP      TAB	;
1652)   1707 28 0C       					JR      Z,DOTAB	;
1653)   1709 FE 89       					CP      SPC	;
1654)   170B 28 38       					JR      Z,DOSPC	;
1655)   170D FE 27       					CP      ''''	;
1656)   170F C0          					RET     NZ	;
1657)   1710 CD 8F 08    					CALL    CRLF	;
1658)   1713 AF          					XOR     A	;
1659)   1714 C9          					RET	;
1661)   1715 C5          		DOTAB:			PUSH    BC	;
1662)   1716 CD B6 1E    					CALL    EXPRI	;
1663)   1719 D9          					EXX	;
1664)   171A C1          					POP     BC	;
1665)   171B FD 7E 00    					LD      A,(IY)	;
1666)   171E FE 2C       					CP      ','	;
1667)   1720 28 11       					JR      Z,DOTAB1	;
1668)   1722 CD 5E 24    					CALL    BRAKET	;
1669)   1725 7D          					LD      A,L	;
1670)   1726 21 FB 62    		TABIT:			LD      HL,COUNT	;
1671)   1729 BE          					CP      (HL)	;
1672)   172A C8          					RET     Z	;
1673)   172B F5          					PUSH    AF	;
1674)   172C DC 8F 08    					CALL    C,CRLF	;
1675)   172F F1          					POP     AF	;
1676)   1730 96          					SUB     (HL)	;
1677)   1731 18 19       					JR      FILL	;
1678)   1733 FD 23       		DOTAB1:			INC     IY	;
1679)   1735 C5          					PUSH    BC	;
1680)   1736 E5          					PUSH    HL	;
1681)   1737 CD B6 1E    					CALL    EXPRI	;
1682)   173A D9          					EXX	;
1683)   173B D1          					POP     DE	;
1684)   173C C1          					POP     BC	;
1685)   173D CD 5E 24    					CALL    BRAKET	;
1686)   1740 CD 09 40    					CALL    PUTCSR	;
1687)   1743 AF          					XOR     A	;
1688)   1744 C9          					RET	;
1690)   1745 C5          		DOSPC:			PUSH    BC	;
1691)   1746 CD CD 1E    					CALL    ITEMI	;
1692)   1749 D9          					EXX	;
1693)   174A 7D          					LD      A,L	;
1694)   174B C1          					POP     BC	;
1695)   174C B7          		@FILL:			OR      A	;
1696)   174D C8          					RET     Z	;
1697)   174E C5          					PUSH    BC	;
1698)   174F 47          					LD      B,A	;
1699)   1750 3E 20       		FILL1:			LD      A,' '	;
1700)   1752 CD 96 08    					CALL    OUTCHR	;
1701)   1755 10 F9       					DJNZ    FILL1	;
1702)   1757 C1          					POP     BC	;
1703)   1758 AF          					XOR     A	;
1704)   1759 C9          					RET	;
1706)   175A 21 00 60    		PTEXT:			LD      HL,ACCS	;
1707)   175D 1C          					INC     E	;
1708)   175E 1D          		PTEXT1:			DEC     E	;
1709)   175F C8          					RET     Z	;
1710)   1760 7E          					LD      A,(HL)	;
1711)   1761 23          					INC     HL	;
1712)   1762 CD 96 08    					CALL    OUTCHR	;
1713)   1765 18 F7       					JR      PTEXT1	;
1715)   1767 F5          		FETCHS:			PUSH    AF	;
1716)   1768 C5          					PUSH    BC	;
1717)   1769 E5          					PUSH    HL	;
1718)   176A FD E3       					EX      (SP),IY	;
1719)   176C CD 84 17    					CALL    XTRACT	;
1720)   176F CD 9A 24    					CALL    NXT	;
1721)   1772 FD E3       					EX      (SP),IY	;
1722)   1774 E1          					POP     HL	;
1723)   1775 C1          					POP     BC	;
1724)   1776 F1          					POP     AF	;
1725)   1777 C9          					RET	;
1727)   1778 11 00 60    		LINES:			LD      DE,ACCS	;
1728)   177B 7E          		LINE1S:			LD      A,(HL)	;
1729)   177C 12          					LD      (DE),A	;
1730)   177D FE 0D       					CP      CR	;
1731)   177F C8          					RET     Z	;
1732)   1780 23          					INC     HL	;
1733)   1781 1C          					INC     E	;
1734)   1782 18 F7       					JR      LINE1S	;
1736)   1784 CD 9A 24    		XTRACT:			CALL    NXT	;
1737)   1787 FE 22       					CP      34		;ASCII ""	;ASCII ""
1738)   1789 FD 23       					INC     IY	;
1739)   178B CA B1 1F    					JP      Z,CONS	;
1740)   178E FD 2B       					DEC     IY	;
1741)   1790 11 00 60    					LD      DE,ACCS	;
1742)   1793 FD 7E 00    		XTRAC1:			LD      A,(IY)	;
1743)   1796 12          					LD      (DE),A	;
1744)   1797 FE 2C       					CP      ','	;
1745)   1799 C8          					RET     Z	;
1746)   179A FE 0D       					CP      CR	;
1747)   179C C8          					RET     Z	;
1748)   179D FD 23       					INC     IY	;
1749)   179F 1C          					INC     E	;
1750)   17A0 18 F1       					JR      XTRAC1	;
1752)   17A2 06 00       		SEARCH:			LD      B,0	;
1753)   17A4 4E          		SRCH1:			LD      C,(HL)	;
1754)   17A5 0C          					INC     C	;
1755)   17A6 0D          					DEC     C	;
1756)   17A7 28 0C       					JR      Z,SRCH2         ;FAIL	;FAIL
1757)   17A9 23          					INC     HL	;
1758)   17AA 23          					INC     HL	;
1759)   17AB 23          					INC     HL	;
1760)   17AC BE          					CP      (HL)	;
1761)   17AD C8          					RET     Z	;
1762)   17AE 0D          					DEC     C	;
1763)   17AF 0D          					DEC     C	;
1764)   17B0 0D          					DEC     C	;
1765)   17B1 09          					ADD     HL,BC	;
1766)   17B2 C3 A4 17    					JP      SRCH1	;
1767)   17B5 2B          		SRCH2:			DEC     HL              ;POINT TO CR	;POINT TO CR
1768)   17B6 37          					SCF	;
1769)   17B7 C9          					RET	;
1771)   17B8 FE 05       		@X4OR5:			CP      5	;
1772)   17BA 62          					LD      H,D	;
1773)   17BB 6B          					LD      L,E	;
1774)   17BC 29          					ADD     HL,HL	;
1775)   17BD D8          					RET     C	;
1776)   17BE 29          					ADD     HL,HL	;
1777)   17BF D8          					RET     C	;
1778)   17C0 EB          					EX      DE,HL	;
1779)   17C1 C0          					RET     NZ	;
1780)   17C2 19          					ADD     HL,DE	;
1781)   17C3 EB          					EX      DE,HL	;
1782)   17C4 C9          					RET	;
1784)   17C5 EB          		@MUL16:			EX      DE,HL	;
1785)   17C6 21 00 00    					LD      HL,0	;
1786)   17C9 3E 10       					LD      A,16	;
1787)   17CB 29          		MUL161:			ADD     HL,HL	;
1788)   17CC D8          					RET     C               ;OVERFLOW	;OVERFLOW
1789)   17CD CB 23       					SLA     E	;
1790)   17CF CB 12       					RL      D	;
1791)   17D1 30 02       					JR      NC,MUL162	;
1792)   17D3 09          					ADD     HL,BC	;
1793)   17D4 D8          					RET     C	;
1794)   17D5 3D          		MUL162:			DEC     A	;
1795)   17D6 20 F3       					JR      NZ,MUL161	;
1796)   17D8 C9          					RET	;
1798)   17D9 CD 9A 24    		@CHANEL:		CALL    NXT	;
1799)   17DC FE 23       					CP      '#'	;
1800)   17DE 3E 2D       					LD      A,45	;
1801)   17E0 C2 FD 06    					JP      NZ,ERROR        ;"Missing #"	;"Missing #"
1802)   17E3 FD 23       		CHNL:			INC     IY              ;SKIP '#'	;SKIP '#'
1803)   17E5 CD CD 1E    					CALL    ITEMI	;
1804)   17E8 D9          					EXX	;
1805)   17E9 EB          					EX      DE,HL	;
1806)   17EA C9          					RET	;
1812)   17EB CD 61 1B    		ASSEM:			CALL    SKIP	;
1813)   17EE FD 23       					INC     IY	;
1814)   17F0 FE 3A       					CP      ':'	;
1815)   17F2 28 F7       					JR      Z,ASSEM	;
1816)   17F4 FE 5D       					CP      ']'	;
1817)   17F6 C8          					RET     Z	;
1818)   17F7 FE 0D       					CP      CR	;
1819)   17F9 C8          					RET     Z	;
1820)   17FA FD 2B       					DEC     IY	;
1821)   17FC DD 2A 40 62 					LD      IX,(PC)         ;PROGRAM COUNTER	;PROGRAM COUNTER
1822)   1800 21 FE 62    					LD      HL,LISTON	;
1823)   1803 CB 76       					BIT     6,(HL)	;
1824)   1805 28 04       					JR      Z,ASSEM0	;
1825)   1807 DD 2A 3C 62 					LD      IX,(OC)         ;ORIGIN of CODE	;ORIGIN of CODE
1826)   180B DD E5       		ASSEM0:			PUSH    IX	;
1827)   180D FD E5       					PUSH    IY	;
1828)   180F CD 9F 18    					CALL    ASMB	;
1829)   1812 C1          					POP     BC	;
1830)   1813 D1          					POP     DE	;
1831)   1814 D8          					RET     C	;
1832)   1815 CD 61 1B    					CALL    SKIP	;
1833)   1818 37          					SCF	;
1834)   1819 C0          					RET     NZ	;
1835)   181A FD 2B       					DEC     IY	;
1836)   181C FD 23       		ASSEM3:			INC     IY	;
1837)   181E FD 7E 00    					LD      A,(IY)	;
1838)   1821 CD EA 16    					CALL    TERM0	;
1839)   1824 20 F6       					JR      NZ,ASSEM3	;
1840)   1826 3A FE 62    					LD      A,(LISTON)	;
1841)   1829 DD E5       					PUSH    IX	;
1842)   182B E1          					POP     HL	;
1843)   182C B7          					OR      A	;
1844)   182D ED 52       					SBC     HL,DE	;
1845)   182F EB          					EX      DE,HL           ;DE= NO. OF BYTES	;DE= NO. OF BYTES
1846)   1830 E5          					PUSH    HL	;
1847)   1831 2A 40 62    					LD      HL,(PC)	;
1848)   1834 E5          					PUSH    HL	;
1849)   1835 19          					ADD     HL,DE	;
1850)   1836 22 40 62    					LD      (PC),HL         ;UPDATE PC	;UPDATE PC
1851)   1839 CB 77       					BIT     6,A	;
1852)   183B 28 07       					JR      Z,ASSEM5	;
1853)   183D 2A 3C 62    					LD      HL,(OC)	;
1854)   1840 19          					ADD     HL,DE	;
1855)   1841 22 3C 62    					LD      (OC),HL         ;UPDATE OC	;UPDATE OC
1856)   1844 E1          		ASSEM5:			POP     HL              ;OLD PC	;OLD PC
1857)   1845 DD E1       					POP     IX              ;CODE HERE	;CODE HERE
1858)   1847 CB 67       					BIT     4,A	;
1859)   1849 28 A0       					JR      Z,ASSEM	;
1860)   184B 7C          					LD      A,H	;
1861)   184C CD 8B 18    					CALL    HEX	;
1862)   184F 7D          					LD      A,L	;
1863)   1850 CD 84 18    					CALL    HEXSP	;
1864)   1853 AF          					XOR     A	;
1865)   1854 BB          					CP      E	;
1866)   1855 28 15       					JR      Z,ASSEM2	;
1867)   1857 3A FB 62    		ASSEM1:			LD      A,(COUNT)	;
1868)   185A FE 11       					CP      17	;
1869)   185C 3E 05       					LD      A,5	;
1870)   185E D4 26 17    					CALL    NC,TABIT        ;NEXT LINE	;NEXT LINE
1871)   1861 DD 7E 00    					LD      A,(IX)	;
1872)   1864 CD 84 18    					CALL    HEXSP	;
1873)   1867 DD 23       					INC     IX	;
1874)   1869 1D          					DEC     E	;
1875)   186A 20 EB       					JR      NZ,ASSEM1	;
1876)   186C 3E 12       		ASSEM2:			LD      A,18	;
1877)   186E CD 26 17    					CALL    TABIT	;
1878)   1871 FD E5       					PUSH    IY	;
1879)   1873 E1          					POP     HL	;
1880)   1874 ED 42       					SBC     HL,BC	;
1881)   1876 0A          		ASSEM4:			LD      A,(BC)	;
1882)   1877 CD AF 08    					CALL    OUT	;
1883)   187A 03          					INC     BC	;
1884)   187B 2D          					DEC     L	;
1885)   187C 20 F8       					JR      NZ,ASSEM4	;
1886)   187E CD 8F 08    					CALL    CRLF	;
1887)   1881 C3 EB 17    					JP      ASSEM	;
1889)   1884 CD 8B 18    		HEXSP:			CALL    HEX	;
1890)   1887 3E 20       					LD      A,' '	;
1891)   1889 18 11       					JR      OUTCH1	;
1892)   188B F5          		HEX:			PUSH    AF	;
1893)   188C 0F          					RRCA	;
1894)   188D 0F          					RRCA	;
1895)   188E 0F          					RRCA	;
1896)   188F 0F          					RRCA	;
1897)   1890 CD 94 18    					CALL    HEXOUT	;
1898)   1893 F1          					POP     AF	;
1899)   1894 E6 0F       		HEXOUT:			AND     0FH	;
1900)   1896 C6 90       					ADD     A,90H	;
1901)   1898 27          					DAA	;
1902)   1899 CE 40       					ADC     A,40H	;
1903)   189B 27          					DAA	;
1904)   189C C3 AF 08    		OUTCH1:			JP      OUT	;
1918)   189F FE 2E       		ASMB:			CP      '.'	;
1919)   18A1 20 16       					JR      NZ,ASMB1	;
1920)   18A3 FD 23       					INC     IY	;
1921)   18A5 DD E5       					PUSH    IX	;
1922)   18A7 CD DA 0D    					CALL    VAR	;
1923)   18AA F5          					PUSH    AF	;
1924)   18AB CD E0 23    					CALL    ZERO	;
1925)   18AE D9          					EXX	;
1926)   18AF 2A 40 62    					LD      HL,(PC)	;
1927)   18B2 D9          					EXX	;
1928)   18B3 F1          					POP     AF	;
1929)   18B4 CD 80 15    					CALL    STORE	;
1930)   18B7 DD E1       					POP     IX	;
1931)   18B9 CD 61 1B    		ASMB1:			CALL    SKIP	;
1932)   18BC C8          					RET     Z	;
1933)   18BD FE D6       					CP      TCALL	;
1934)   18BF 0E C4       					LD      C,0C4H	;
1935)   18C1 FD 23       					INC     IY	;
1936)   18C3 CA B0 19    					JP      Z,GRPC	;
1937)   18C6 FD 2B       					DEC     IY	;
1938)   18C8 21 73 1B    					LD      HL,OPCODS	;
1939)   18CB CD 18 1B    					CALL    FIND	;
1940)   18CE D8          					RET     C	;
1941)   18CF 48          					LD      C,B     ;ROOT OPCODE	;ROOT OPCODE
1942)   18D0 16 00       					LD      D,0     ;CLEAR IX/IY FLAG	;CLEAR IX/IY FLAG
1947)   18D2 D6 27       					SUB     39	;
1948)   18D4 30 07       					JR      NC,GROUP2	;
1949)   18D6 FE E8       					CP      15-39	;
1950)   18D8 D4 7E 1A    					CALL    NC,ED	;
1951)   18DB 18 68       					JR      BYTE0	;
1956)   18DD D6 0A       		GROUP2:			SUB     10	;
1957)   18DF 30 0F       					JR      NC,GROUP4	;
1958)   18E1 FE F9       					CP      3-10	;
1959)   18E3 DC 08 1B    					CALL    C,BIT	;
1960)   18E6 D8          					RET     C	;
1961)   18E7 CD DD 1A    					CALL    REGLO	;
1962)   18EA D8          					RET     C	;
1963)   18EB CD 82 1A    					CALL    CB	;
1964)   18EE 18 55       					JR      BYTE0	;
1968)   18F0 D6 03       		GROUP4:			SUB     3	;
1969)   18F2 30 06       					JR      NC,GROUP5	;
1970)   18F4 CD FC 1A    		G4:			CALL    PAIR	;
1971)   18F7 D8          					RET     C	;
1972)   18F8 18 4B       					JR      BYTE0	;
1977)   18FA D6 0A       		GROUP5:			SUB     8+2	;
1978)   18FC 30 32       					JR      NC,GROUP7	;
1979)   18FE FE FD       					CP      5-8	;
1980)   1900 06 07       					LD      B,7	;
1981)   1902 D4 90 1A    					CALL    NC,OPND	;
1982)   1905 78          					LD      A,B	;
1983)   1906 FE 07       					CP      7	;
1984)   1908 20 10       					JR      NZ,G6HL	;
1985)   190A CD DD 1A    		G6:			CALL    REGLO	;
1986)   190D 79          					LD      A,C	;
1987)   190E 30 28       					JR      NC,BIND1	;
1988)   1910 EE 46       					XOR     46H	;
1989)   1912 CD 84 1A    					CALL    BIND	;
1990)   1915 CD C0 1A    		DB:			CALL    NUMBER	;
1991)   1918 18 78       					JR      VAL8	;
1993)   191A E6 3F       		G6HL:			AND     3FH	;
1994)   191C FE 0C       					CP      12	;
1995)   191E 37          					SCF	;
1996)   191F C0          					RET     NZ	;
1997)   1920 79          					LD      A,C	;
1998)   1921 FE 80       					CP      80H	;
1999)   1923 0E 09       					LD      C,9	;
2000)   1925 28 CD       					JR      Z,G4	;
2001)   1927 EE 1C       					XOR     1CH	;
2002)   1929 0F          					RRCA	;
2003)   192A 4F          					LD      C,A	;
2004)   192B CD 7E 1A    					CALL    ED	;
2005)   192E 18 C4       					JR      G4	;
2009)   1930 D6 02       		GROUP7:			SUB     2	;
2010)   1932 30 14       					JR      NC,GROUP8	;
2011)   1934 CD E3 1A    					CALL    REGHI	;
2012)   1937 79          					LD      A,C	;
2013)   1938 D2 84 1A    		BIND1:			JP      NC,BIND	;
2014)   193B EE 64       					XOR     64H	;
2015)   193D 07          					RLCA	;
2016)   193E 07          					RLCA	;
2017)   193F 07          					RLCA	;
2018)   1940 4F          					LD      C,A	;
2019)   1941 CD 00 1B    					CALL    PAIR1	;
2020)   1944 D8          					RET     C	;
2021)   1945 79          		BYTE0:			LD      A,C	;
2022)   1946 18 7F       					JR      BYTE2	;
2027)   1948 D6 02       		GROUP8:			SUB     2	;
2028)   194A 30 21       					JR      NC,GROUPA	;
2029)   194C FE FF       					CP      1-2	;
2030)   194E CC 73 1A    					CALL    Z,CORN	;
2031)   1951 08          					EX      AF,AF'	;
2032)   1952 CD E3 1A    					CALL    REGHI	;
2033)   1955 D8          					RET     C	;
2034)   1956 08          					EX      AF,AF'	;
2035)   1957 DC 73 1A    					CALL    C,CORN	;
2036)   195A 24          					INC     H	;
2037)   195B 28 E8       					JR      Z,BYTE0	;
2038)   195D 78          					LD      A,B	;
2039)   195E FE 07       					CP      7	;
2040)   1960 37          					SCF	;
2041)   1961 C0          					RET     NZ	;
2042)   1962 79          					LD      A,C	;
2043)   1963 EE 03       					XOR     3	;
2044)   1965 07          					RLCA	;
2045)   1966 07          					RLCA	;
2046)   1967 07          					RLCA	;
2047)   1968 CD B0 1A    					CALL    BYTE	;
2048)   196B 18 25       					JR      VAL8	;
2052)   196D D6 02       		GROUPA:			SUB     2	;
2053)   196F 30 24       					JR      NC,GROUPB	;
2054)   1971 FE FF       					CP      1-2	;
2055)   1973 C4 E9 1A    					CALL    NZ,COND	;
2056)   1976 79          					LD      A,C	;
2057)   1977 30 02       					JR      NC,GRPA	;
2058)   1979 3E 18       					LD      A,18H	;
2059)   197B CD B0 1A    		GRPA:			CALL    BYTE	;
2060)   197E CD C0 1A    					CALL    NUMBER	;
2061)   1981 ED 5B 40 62 					LD      DE,(PC)	;
2062)   1985 13          					INC     DE	;
2063)   1986 37          					SCF	;
2064)   1987 ED 52       					SBC     HL,DE	;
2065)   1989 7D          					LD      A,L	;
2066)   198A 17          					RLA	;
2067)   198B 9F          					SBC     A,A	;
2068)   198C BC          					CP      H	;
2069)   198D 3E 01       		TOOFAR:			LD      A,1	;
2070)   198F C2 FD 06    					JP      NZ,ERROR        ;"Out of range"	;"Out of range"
2071)   1992 7D          		VAL8:			LD      A,L	;
2072)   1993 18 32       					JR      BYTE2	;
2076)   1995 47          		GROUPB:			LD      B,A	;
2077)   1996 20 16       					JR      NZ,GROUPC	;
2078)   1998 CD E9 1A    					CALL    COND	;
2079)   199B 79          					LD      A,C	;
2080)   199C 30 0B       					JR      NC,GRPB	;
2081)   199E 78          					LD      A,B	;
2082)   199F E6 3F       					AND     3FH	;
2083)   19A1 FE 06       					CP      6	;
2084)   19A3 3E E9       					LD      A,0E9H	;
2085)   19A5 28 20       					JR      Z,BYTE2	;
2086)   19A7 3E C3       					LD      A,0C3H	;
2087)   19A9 CD B0 1A    		GRPB:			CALL    BYTE	;
2088)   19AC 18 05       					JR      ADDR	;
2092)   19AE 10 0C       		GROUPC:			DJNZ    GROUPD	;
2093)   19B0 CD CB 19    		GRPC:			CALL    GRPE	;
2094)   19B3 CD C0 1A    		ADDR:			CALL    NUMBER	;
2095)   19B6 CD 92 19    		VAL16:			CALL    VAL8	;
2096)   19B9 7C          					LD      A,H	;
2097)   19BA 18 0B       					JR      BYTE2	;
2101)   19BC 10 0B       		GROUPD:			DJNZ    GROUPE	;
2102)   19BE CD C0 1A    					CALL    NUMBER	;
2103)   19C1 A1          					AND     C	;
2104)   19C2 B4          					OR      H	;
2105)   19C3 20 C8       					JR      NZ,TOOFAR	;
2106)   19C5 7D          					LD      A,L	;
2107)   19C6 B1          					OR      C	;
2108)   19C7 18 78       		BYTE2:  		JR      BYTE1	;
2112)   19C9 10 0A       		GROUPE:			DJNZ    GROUPF	;
2113)   19CB CD E9 1A    		GRPE:			CALL    COND	;
2114)   19CE 79          					LD      A,C	;
2115)   19CF 30 70       					JR      NC,BYTE1	;
2116)   19D1 F6 09       					OR      9	;
2117)   19D3 18 6C       					JR      BYTE1	;
2121)   19D5 10 6C       		GROUPF:			DJNZ    MISC	;
2122)   19D7 CD 15 1B    					CALL    LDOP	;
2123)   19DA 30 5F       					JR      NC,LDA	;
2124)   19DC CD E3 1A    					CALL    REGHI	;
2125)   19DF 08          					EX      AF,AF'	;
2126)   19E0 CD 61 1B    					CALL    SKIP	;
2127)   19E3 FE 28       					CP      '('	;
2128)   19E5 28 1D       					JR      Z,LDIN	;
2129)   19E7 08          					EX      AF,AF'	;
2130)   19E8 D2 0A 19    					JP      NC,G6	;
2131)   19EB 0E 01       					LD      C,1	;
2132)   19ED CD 00 1B    					CALL    PAIR1	;
2133)   19F0 D8          					RET     C	;
2134)   19F1 3E 0E       					LD      A,14	;
2135)   19F3 B8          					CP      B	;
2136)   19F4 47          					LD      B,A	;
2137)   19F5 CC FC 1A    					CALL    Z,PAIR	;
2138)   19F8 78          					LD      A,B	;
2139)   19F9 E6 3F       					AND     3FH	;
2140)   19FB FE 0C       					CP      12	;
2141)   19FD 79          					LD      A,C	;
2142)   19FE 20 A9       					JR      NZ,GRPB	;
2143)   1A00 3E F9       					LD      A,0F9H	;
2144)   1A02 18 3D       					JR      BYTE1	;
2146)   1A04 08          		LDIN:			EX      AF,AF'	;
2147)   1A05 C5          					PUSH    BC	;
2148)   1A06 D4 DD 1A    					CALL    NC,REGLO	;
2149)   1A09 79          					LD      A,C	;
2150)   1A0A C1          					POP     BC	;
2151)   1A0B 30 77       					JR      NC,BIND	;
2152)   1A0D 0E 0A       					LD      C,0AH	;
2153)   1A0F CD 00 1B    					CALL    PAIR1	;
2154)   1A12 CD 5A 1A    					CALL    LD16	;
2155)   1A15 30 92       					JR      NC,GRPB	;
2156)   1A17 CD C0 1A    					CALL    NUMBER	;
2157)   1A1A 0E 02       					LD      C,2	;
2158)   1A1C CD FC 1A    					CALL    PAIR	;
2159)   1A1F CD 5A 1A    					CALL    LD16	;
2160)   1A22 D8          					RET     C	;
2161)   1A23 CD B0 1A    					CALL    BYTE	;
2162)   1A26 18 8E       					JR      VAL16	;
2166)   1A28 05          		OPT:			DEC     B	;
2167)   1A29 CA 15 19    					JP      Z,DB	;
2168)   1A2C 10 85       					DJNZ    ADDR	;
2169)   1A2E CD C0 1A    					CALL    NUMBER	;
2170)   1A31 21 FE 62    					LD      HL,LISTON	;
2171)   1A34 4F          					LD      C,A	;
2172)   1A35 ED 6F       					RLD	;
2173)   1A37 79          					LD      A,C	;
2174)   1A38 ED 67       					RRD	;
2175)   1A3A C9          					RET	;
2177)   1A3B FE 04       		LDA:			CP      4	;
2178)   1A3D DC 7E 1A    					CALL    C,ED	;
2179)   1A40 78          					LD      A,B	;
2180)   1A41 18 6D       		BYTE1:			JR      BYTE	;
2184)   1A43 10 E3       		MISC:			DJNZ    OPT	;
2185)   1A45 DD E5       					PUSH    IX	;
2186)   1A47 CD BF 1E    					CALL    EXPRS	;
2187)   1A4A DD E1       					POP     IX	;
2188)   1A4C 21 00 60    					LD      HL,ACCS	;
2189)   1A4F AF          		DEFM1:			XOR     A	;
2190)   1A50 BB          					CP      E	;
2191)   1A51 C8          					RET     Z	;
2192)   1A52 7E          					LD      A,(HL)	;
2193)   1A53 23          					INC     HL	;
2194)   1A54 CD B0 1A    					CALL    BYTE	;
2195)   1A57 1D          					DEC     E	;
2196)   1A58 18 F5       					JR      DEFM1	;
2200)   1A5A 78          		LD16:			LD      A,B	;
2201)   1A5B 38 0E       					JR      C,LD8	;
2202)   1A5D 78          					LD      A,B	;
2203)   1A5E E6 3F       					AND     3FH	;
2204)   1A60 FE 0C       					CP      12	;
2205)   1A62 79          					LD      A,C	;
2206)   1A63 C8          					RET     Z	;
2207)   1A64 CD 7E 1A    					CALL    ED	;
2208)   1A67 79          					LD      A,C	;
2209)   1A68 F6 43       					OR      43H	;
2210)   1A6A C9          					RET	;
2212)   1A6B FE 07       		LD8:			CP      7	;
2213)   1A6D 37          					SCF	;
2214)   1A6E C0          					RET     NZ	;
2215)   1A6F 79          					LD      A,C	;
2216)   1A70 F6 30       					OR      30H	;
2217)   1A72 C9          					RET	;
2219)   1A73 C5          		CORN:			PUSH    BC	;
2220)   1A74 CD 90 1A    					CALL    OPND	;
2221)   1A77 CB 68       					BIT     5,B	;
2222)   1A79 C1          					POP     BC	;
2223)   1A7A 28 44       					JR      Z,NUMBER	;
2224)   1A7C 26 FF       					LD      H,-1	;
2225)   1A7E 3E ED       		ED:			LD      A,0EDH	;
2226)   1A80 18 2E       					JR      BYTE	;
2228)   1A82 3E CB       		CB:			LD      A,0CBH	;
2229)   1A84 FE 76       		BIND:			CP      76H	;
2230)   1A86 37          					SCF	;
2231)   1A87 C8          					RET     Z               ;REJECT LD (HL),(HL)	;REJECT LD (HL),(HL)
2232)   1A88 CD B0 1A    					CALL    BYTE	;
2233)   1A8B 14          					INC     D	;
2234)   1A8C F0          					RET     P	;
2235)   1A8D 7B          					LD      A,E	;
2236)   1A8E 18 20       					JR      BYTE	;
2238)   1A90 E5          		OPND:			PUSH    HL	;
2239)   1A91 21 BA 1C    					LD      HL,OPRNDS	;
2240)   1A94 CD 18 1B    					CALL    FIND	;
2241)   1A97 E1          					POP     HL	;
2242)   1A98 D8          					RET     C	;
2243)   1A99 CB 78       					BIT     7,B	;
2244)   1A9B C8          					RET     Z	;
2245)   1A9C CB 58       					BIT     3,B	;
2246)   1A9E E5          					PUSH    HL	;
2247)   1A9F CC B7 1A    					CALL    Z,OFFSET	;
2248)   1AA2 5D          					LD      E,L	;
2249)   1AA3 E1          					POP     HL	;
2250)   1AA4 3E DD       					LD      A,0DDH	;
2251)   1AA6 CB 70       					BIT     6,B	;
2252)   1AA8 28 02       					JR      Z,OP1	;
2253)   1AAA 3E FD       					LD      A,0FDH	;
2254)   1AAC B7          		OP1:			OR      A	;
2255)   1AAD 14          					INC     D	;
2256)   1AAE 57          					LD      D,A	;
2257)   1AAF F8          					RET     M	;
2258)   1AB0 DD 77 00    		BYTE:			LD      (IX),A	;
2259)   1AB3 DD 23       					INC     IX	;
2260)   1AB5 B7          					OR      A	;
2261)   1AB6 C9          					RET	;
2263)   1AB7 FD 7E 00    		OFFSET:			LD      A,(IY)	;
2264)   1ABA FE 29       					CP      ')'	;
2265)   1ABC 21 00 00    					LD      HL,0	;
2266)   1ABF C8          					RET     Z	;
2267)   1AC0 CD 61 1B    		NUMBER:			CALL    SKIP	;
2268)   1AC3 C5          					PUSH    BC	;
2269)   1AC4 D5          					PUSH    DE	;
2270)   1AC5 DD E5       					PUSH    IX	;
2271)   1AC7 CD B6 1E    					CALL    EXPRI	;
2272)   1ACA DD E1       					POP     IX	;
2273)   1ACC D9          					EXX	;
2274)   1ACD D1          					POP     DE	;
2275)   1ACE C1          					POP     BC	;
2276)   1ACF 7D          					LD      A,L	;
2277)   1AD0 B7          					OR      A	;
2278)   1AD1 C9          					RET	;
2280)   1AD2 CD 90 1A    		REG:			CALL    OPND	;
2281)   1AD5 D8          					RET     C	;
2282)   1AD6 78          					LD      A,B	;
2283)   1AD7 E6 3F       					AND     3FH	;
2284)   1AD9 FE 08       					CP      8	;
2285)   1ADB 3F          					CCF	;
2286)   1ADC C9          					RET	;
2288)   1ADD CD D2 1A    		REGLO:			CALL    REG	;
2289)   1AE0 D8          					RET     C	;
2290)   1AE1 18 2F       					JR      ORC	;
2292)   1AE3 CD D2 1A    		REGHI:			CALL    REG	;
2293)   1AE6 D8          					RET     C	;
2294)   1AE7 18 26       					JR      SHL3	;
2296)   1AE9 CD 90 1A    		COND:			CALL    OPND	;
2297)   1AEC D8          					RET     C	;
2298)   1AED 78          					LD      A,B	;
2299)   1AEE E6 1F       					AND     1FH	;
2300)   1AF0 D6 10       					SUB     16	;
2301)   1AF2 30 1B       					JR      NC,SHL3	;
2302)   1AF4 FE F1       					CP      -15	;
2303)   1AF6 37          					SCF	;
2304)   1AF7 C0          					RET     NZ	;
2305)   1AF8 3E 03       					LD      A,3	;
2306)   1AFA 18 13       					JR      SHL3	;
2308)   1AFC CD 90 1A    		PAIR:			CALL    OPND	;
2309)   1AFF D8          					RET     C	;
2310)   1B00 78          		PAIR1:			LD      A,B	;
2311)   1B01 E6 0F       					AND     0FH	;
2312)   1B03 D6 08       					SUB     8	;
2313)   1B05 D8          					RET     C	;
2314)   1B06 18 07       					JR      SHL3	;
2316)   1B08 CD C0 1A    		BIT:			CALL    NUMBER	;
2317)   1B0B FE 08       					CP      8	;
2318)   1B0D 3F          					CCF	;
2319)   1B0E D8          					RET     C	;
2320)   1B0F 07          		SHL3:			RLCA	;
2321)   1B10 07          					RLCA	;
2322)   1B11 07          					RLCA	;
2323)   1B12 B1          		ORC:			OR      C	;
2324)   1B13 4F          					LD      C,A	;
2325)   1B14 C9          					RET	;
2327)   1B15 21 FF 1C    		LDOP:			LD      HL,LDOPS	;
2328)   1B18 CD 61 1B    		FIND:			CALL    SKIP	;
2329)   1B1B 06 00       		EXIT:			LD      B,0	;
2330)   1B1D 37          					SCF	;
2331)   1B1E C8          					RET     Z	;
2332)   1B1F FE DD       					CP      DEF	;
2333)   1B21 28 04       					JR      Z,FIND0	;
2334)   1B23 FE 85       					CP      TOR+1	;
2335)   1B25 3F          					CCF	;
2336)   1B26 D8          					RET     C	;
2337)   1B27 7E          		FIND0:			LD      A,(HL)	;
2338)   1B28 B7          					OR      A	;
2339)   1B29 28 F0       					JR      Z,EXIT	;
2340)   1B2B FD AE 00    					XOR     (IY)	;
2341)   1B2E E6 5F       					AND     01011111B	;
2342)   1B30 28 09       					JR      Z,FIND2	;
2343)   1B32 CB 7E       		FIND1:			BIT     7,(HL)	;
2344)   1B34 23          					INC     HL	;
2345)   1B35 28 FB       					JR      Z,FIND1	;
2346)   1B37 23          					INC     HL	;
2347)   1B38 04          					INC     B	;
2348)   1B39 18 EC       					JR      FIND0	;
2350)   1B3B FD E5       		FIND2:			PUSH    IY	;
2351)   1B3D CB 7E       		FIND3:			BIT     7,(HL)	;
2352)   1B3F FD 23       					INC     IY	;
2353)   1B41 23          					INC     HL	;
2354)   1B42 20 10       					JR      NZ,FIND5	;
2355)   1B44 BE          					CP      (HL)	;
2356)   1B45 CC 60 1B    					CALL    Z,SKIP0	;
2357)   1B48 7E          					LD      A,(HL)	;
2358)   1B49 FD AE 00    					XOR     (IY)	;
2359)   1B4C E6 5F       					AND     01011111B	;
2360)   1B4E 28 ED       					JR      Z,FIND3	;
2361)   1B50 FD E1       		FIND4:			POP     IY	;
2362)   1B52 18 DE       					JR      FIND1	;
2364)   1B54 CD D0 16    		FIND5:			CALL    DELIM	;
2365)   1B57 C4 6D 1B    					CALL    NZ,SIGN	;
2366)   1B5A 20 F4       					JR      NZ,FIND4	;
2367)   1B5C 78          		FIND6:			LD      A,B	;
2368)   1B5D 46          					LD      B,(HL)	;
2369)   1B5E E1          					POP     HL	;
2370)   1B5F C9          					RET	;
2372)   1B60 23          		SKIP0:			INC     HL	;
2373)   1B61 CD D0 16    		SKIP:			CALL    DELIM	;
2374)   1B64 C0          					RET     NZ	;
2375)   1B65 CD DC 16    					CALL    TERM	;
2376)   1B68 C8          					RET     Z	;
2377)   1B69 FD 23       					INC     IY	;
2378)   1B6B 18 F4       					JR      SKIP	;
2380)   1B6D FE 2B       		SIGN:			CP      '+'	;
2381)   1B6F C8          					RET     Z	;
2382)   1B70 FE 2D       					CP      '-'	;
2383)   1B72 C9          					RET	;
2386)   1B73 4E 4F       		OPCODS:			DEFM    'NO'	;
2387)   1B75 D0          					DEFB    'P'+80H	;
2388)   1B76 00          					DEFB    0	;
2389)   1B77 52 4C 43    					DEFM    'RLC'	;
2390)   1B7A C1          					DEFB    'A'+80H	;
2391)   1B7B 07          					DEFB    7	;
2392)   1B7C 45 58       					DEFM    'EX'	;
2393)   1B7E 00          					DEFB    0	;
2394)   1B7F 41 46       					DEFM    'AF'	;
2395)   1B81 00          					DEFB    0	;
2396)   1B82 41 46       					DEFM    'AF'	;
2397)   1B84 A7          					DEFB    ''''+80H	;
2398)   1B85 08          					DEFB    8	;
2399)   1B86 52 52 43    					DEFM    'RRC'	;
2400)   1B89 C1          					DEFB    'A'+80H	;
2401)   1B8A 0F          					DEFB    0FH	;
2402)   1B8B 52 4C       					DEFM    'RL'	;
2403)   1B8D C1          					DEFB    'A'+80H	;
2404)   1B8E 17          					DEFB    17H	;
2405)   1B8F 52 52       					DEFM    'RR'	;
2406)   1B91 C1          					DEFB    'A'+80H	;
2407)   1B92 1F          					DEFB    1FH	;
2408)   1B93 44 41       					DEFM    'DA'	;
2409)   1B95 C1          					DEFB    'A'+80H	;
2410)   1B96 27          					DEFB    27H	;
2411)   1B97 43 50       					DEFM    'CP'	;
2412)   1B99 CC          					DEFB    'L'+80H	;
2413)   1B9A 2F          					DEFB    2FH	;
2414)   1B9B 53 43       					DEFM    'SC'	;
2415)   1B9D C6          					DEFB    'F'+80H	;
2416)   1B9E 37          					DEFB    37H	;
2417)   1B9F 43 43       					DEFM    'CC'	;
2418)   1BA1 C6          					DEFB    'F'+80H	;
2419)   1BA2 3F          					DEFB    3FH	;
2420)   1BA3 48 41 4C    					DEFM    'HAL'	;
2421)   1BA6 D4          					DEFB    'T'+80H	;
2422)   1BA7 76          					DEFB    76H	;
2423)   1BA8 45 58       					DEFM    'EX'	;
2424)   1BAA D8          					DEFB    'X'+80H	;
2425)   1BAB D9          					DEFB    0D9H	;
2426)   1BAC 45 58       					DEFM    'EX'	;
2427)   1BAE 00          					DEFB    0	;
2428)   1BAF 44 45       					DEFM    'DE'	;
2429)   1BB1 00          					DEFB    0	;
2430)   1BB2 48          					DEFM    'H'	;
2431)   1BB3 CC          					DEFB    'L'+80H	;
2432)   1BB4 EB          					DEFB    0EBH	;
2433)   1BB5 44          					DEFM    'D'	;
2434)   1BB6 C9          					DEFB    'I'+80H	;
2435)   1BB7 F3          					DEFB    0F3H	;
2436)   1BB8 45          					DEFM    'E'	;
2437)   1BB9 C9          					DEFB    'I'+80H	;
2438)   1BBA FB          					DEFB    0FBH	;
2440)   1BBB 4E 45       					DEFM    'NE'	;
2441)   1BBD C7          					DEFB    'G'+80H	;
2442)   1BBE 44          					DEFB    44H	;
2443)   1BBF 49 4D       					DEFM    'IM'	;
2444)   1BC1 00          					DEFB    0	;
2445)   1BC2 B0          					DEFB    '0'+80H	;
2446)   1BC3 46          					DEFB    46H	;
2447)   1BC4 52 45 54    					DEFM    'RET'	;
2448)   1BC7 CE          					DEFB    'N'+80H	;
2449)   1BC8 45          					DEFB    45H	;
2450)   1BC9 52 45 54    					DEFM    'RET'	;
2451)   1BCC C9          					DEFB    'I'+80H	;
2452)   1BCD 4D          					DEFB    4DH	;
2453)   1BCE 49 4D       					DEFM    'IM'	;
2454)   1BD0 00          					DEFB    0	;
2455)   1BD1 B1          					DEFB    '1'+80H	;
2456)   1BD2 56          					DEFB    56H	;
2457)   1BD3 49 4D       					DEFM    'IM'	;
2458)   1BD5 00          					DEFB    0	;
2459)   1BD6 B2          					DEFB    '2'+80H	;
2460)   1BD7 5E          					DEFB    5EH	;
2461)   1BD8 52 52       					DEFM    'RR'	;
2462)   1BDA C4          					DEFB    'D'+80H	;
2463)   1BDB 67          					DEFB    67H	;
2464)   1BDC 52 4C       					DEFM    'RL'	;
2465)   1BDE C4          					DEFB    'D'+80H	;
2466)   1BDF 6F          					DEFB    6FH	;
2467)   1BE0 4C 44       					DEFM    'LD'	;
2468)   1BE2 C9          					DEFB    'I'+80H	;
2469)   1BE3 A0          					DEFB    0A0H	;
2470)   1BE4 43 50       					DEFM    'CP'	;
2471)   1BE6 C9          					DEFB    'I'+80H	;
2472)   1BE7 A1          					DEFB    0A1H	;
2473)   1BE8 49 4E       					DEFM    'IN'	;
2474)   1BEA C9          					DEFB    'I'+80H	;
2475)   1BEB A2          					DEFB    0A2H	;
2476)   1BEC 4F 55 54    					DEFM    'OUT'	;
2477)   1BEF C9          					DEFB    'I'+80H	;
2478)   1BF0 A3          					DEFB    0A3H	;
2479)   1BF1 4C 44       					DEFM    'LD'	;
2480)   1BF3 C4          					DEFB    'D'+80H	;
2481)   1BF4 A8          					DEFB    0A8H	;
2482)   1BF5 43 50       					DEFM    'CP'	;
2483)   1BF7 C4          					DEFB    'D'+80H	;
2484)   1BF8 A9          					DEFB    0A9H	;
2485)   1BF9 49 4E       					DEFM    'IN'	;
2486)   1BFB C4          					DEFB    'D'+80H	;
2487)   1BFC AA          					DEFB    0AAH	;
2488)   1BFD 4F 55 54    					DEFM    'OUT'	;
2489)   1C00 C4          					DEFB    'D'+80H	;
2490)   1C01 AB          					DEFB    0ABH	;
2491)   1C02 4C 44 49    					DEFM    'LDI'	;
2492)   1C05 D2          					DEFB    'R'+80H	;
2493)   1C06 B0          					DEFB    0B0H	;
2494)   1C07 43 50 49    					DEFM    'CPI'	;
2495)   1C0A D2          					DEFB    'R'+80H	;
2496)   1C0B B1          					DEFB    0B1H	;
2497)   1C0C 49 4E 49    					DEFM    'INI'	;
2498)   1C0F D2          					DEFB    'R'+80H	;
2499)   1C10 B2          					DEFB    0B2H	;
2500)   1C11 4F 54 49    					DEFM    'OTI'	;
2501)   1C14 D2          					DEFB    'R'+80H	;
2502)   1C15 B3          					DEFB    0B3H	;
2503)   1C16 4C 44 44    					DEFM    'LDD'	;
2504)   1C19 D2          					DEFB    'R'+80H	;
2505)   1C1A B8          					DEFB    0B8H	;
2506)   1C1B 43 50 44    					DEFM    'CPD'	;
2507)   1C1E D2          					DEFB    'R'+80H	;
2508)   1C1F B9          					DEFB    0B9H	;
2509)   1C20 49 4E 44    					DEFM    'IND'	;
2510)   1C23 D2          					DEFB    'R'+80H	;
2511)   1C24 BA          					DEFB    0BAH	;
2512)   1C25 4F 54 44    					DEFM    'OTD'	;
2513)   1C28 D2          					DEFB    'R'+80H	;
2514)   1C29 BB          					DEFB    0BBH	;
2516)   1C2A 42 49       					DEFM    'BI'	;
2517)   1C2C D4          					DEFB    'T'+80H	;
2518)   1C2D 40          					DEFB    40H	;
2519)   1C2E 52 45       					DEFM    'RE'	;
2520)   1C30 D3          					DEFB    'S'+80H	;
2521)   1C31 80          					DEFB    80H	;
2522)   1C32 53 45       					DEFM    'SE'	;
2523)   1C34 D4          					DEFB    'T'+80H	;
2524)   1C35 C0          					DEFB    0C0H	;
2526)   1C36 52 4C       					DEFM    'RL'	;
2527)   1C38 C3          					DEFB    'C'+80H	;
2528)   1C39 00          					DEFB    0	;
2529)   1C3A 52 52       					DEFM    'RR'	;
2530)   1C3C C3          					DEFB    'C'+80H	;
2531)   1C3D 08          					DEFB    8	;
2532)   1C3E 52          					DEFM    'R'	;
2533)   1C3F CC          					DEFB    'L'+80H	;
2534)   1C40 10          					DEFB    10H	;
2535)   1C41 52          					DEFM    'R'	;
2536)   1C42 D2          					DEFB    'R'+80H	;
2537)   1C43 18          					DEFB    18H	;
2538)   1C44 53 4C       					DEFM    'SL'	;
2539)   1C46 C1          					DEFB    'A'+80H	;
2540)   1C47 20          					DEFB    20H	;
2541)   1C48 53 52       					DEFM    'SR'	;
2542)   1C4A C1          					DEFB    'A'+80H	;
2543)   1C4B 28          					DEFB    28H	;
2544)   1C4C 53 52       					DEFM    'SR'	;
2545)   1C4E CC          					DEFB    'L'+80H	;
2546)   1C4F 38          					DEFB    38H	;
2548)   1C50 50 4F       					DEFM    'PO'	;
2549)   1C52 D0          					DEFB    'P'+80H	;
2550)   1C53 C1          					DEFB    0C1H	;
2551)   1C54 50 55 53    					DEFM    'PUS'	;
2552)   1C57 C8          					DEFB    'H'+80H	;
2553)   1C58 C5          					DEFB    0C5H	;
2554)   1C59 45 58       					DEFM    'EX'	;
2555)   1C5B 00          					DEFB    0	;
2556)   1C5C 28 53       					DEFM    '(S'	;
2557)   1C5E D0          					DEFB    'P'+80H	;
2558)   1C5F E3          					DEFB    0E3H	;
2560)   1C60 53 55       					DEFM    'SU'	;
2561)   1C62 C2          					DEFB    'B'+80H	;
2562)   1C63 90          					DEFB    90H	;
2563)   1C64 41 4E       					DEFM    'AN'	;
2564)   1C66 C4          					DEFB    'D'+80H	;
2565)   1C67 A0          					DEFB    0A0H	;
2566)   1C68 58 4F       					DEFM    'XO'	;
2567)   1C6A D2          					DEFB    'R'+80H	;
2568)   1C6B A8          					DEFB    0A8H	;
2569)   1C6C 4F          					DEFM    'O'	;
2570)   1C6D D2          					DEFB    'R'+80H	;
2571)   1C6E B0          					DEFB    0B0H	;
2572)   1C6F 43          					DEFM    'C'	;
2573)   1C70 D0          					DEFB    'P'+80H	;
2574)   1C71 B8          					DEFB    0B8H	;
2575)   1C72 80          					DEFB    TAND	;
2576)   1C73 A0          					DEFB    0A0H	;
2577)   1C74 84          					DEFB    TOR	;
2578)   1C75 B0          					DEFB    0B0H	;
2580)   1C76 41 44       					DEFM    'AD'	;
2581)   1C78 C4          					DEFB    'D'+80H	;
2582)   1C79 80          					DEFB    80H	;
2583)   1C7A 41 44       					DEFM    'AD'	;
2584)   1C7C C3          					DEFB    'C'+80H	;
2585)   1C7D 88          					DEFB    88H	;
2586)   1C7E 53 42       					DEFM    'SB'	;
2587)   1C80 C3          					DEFB    'C'+80H	;
2588)   1C81 98          					DEFB    98H	;
2590)   1C82 49 4E       					DEFM    'IN'	;
2591)   1C84 C3          					DEFB    'C'+80H	;
2592)   1C85 04          					DEFB    4	;
2593)   1C86 44 45       					DEFM    'DE'	;
2594)   1C88 C3          					DEFB    'C'+80H	;
2595)   1C89 05          					DEFB    5	;
2597)   1C8A 49          					DEFM    'I'	;
2598)   1C8B CE          					DEFB    'N'+80H	;
2599)   1C8C 40          					DEFB    40H	;
2600)   1C8D 4F 55       					DEFM    'OU'	;
2601)   1C8F D4          					DEFB    'T'+80H	;
2602)   1C90 41          					DEFB    41H	;
2604)   1C91 4A          					DEFM    'J'	;
2605)   1C92 D2          					DEFB    'R'+80H	;
2606)   1C93 20          					DEFB    20H	;
2607)   1C94 44 4A 4E    					DEFM    'DJN'	;
2608)   1C97 DA          					DEFB    'Z'+80H	;
2609)   1C98 10          					DEFB    10H	;
2611)   1C99 4A          					DEFM    'J'	;
2612)   1C9A D0          					DEFB    'P'+80H	;
2613)   1C9B C2          					DEFB    0C2H	;
2615)   1C9C 43 41 4C    					DEFM    'CAL'	;
2616)   1C9F CC          					DEFB    'L'+80H	;
2617)   1CA0 C4          					DEFB    0C4H	;
2619)   1CA1 52 53       					DEFM    'RS'	;
2620)   1CA3 D4          					DEFB    'T'+80H	;
2621)   1CA4 C7          					DEFB    0C7H	;
2623)   1CA5 52 45       					DEFM    'RE'	;
2624)   1CA7 D4          					DEFB    'T'+80H	;
2625)   1CA8 C0          					DEFB    0C0H	;
2627)   1CA9 4C          					DEFM    'L'	;
2628)   1CAA C4          					DEFB    'D'+80H	;
2629)   1CAB 40          					DEFB    40H	;
2631)   1CAC 5D          					DEFB    DEF AND 7FH	;
2632)   1CAD CD          					DEFB    'M'+80H	;
2633)   1CAE 00          					DEFB    0	;
2635)   1CAF 5D          					DEFB    DEF AND 7FH	;
2636)   1CB0 C2          					DEFB    'B'+80H	;
2637)   1CB1 00          					DEFB    0	;
2639)   1CB2 4F 50       					DEFM    'OP'	;
2640)   1CB4 D4          					DEFB    'T'+80H	;
2641)   1CB5 00          					DEFB    0	;
2643)   1CB6 5D          					DEFB    DEF AND 7FH	;
2644)   1CB7 D7          					DEFB    'W'+80H	;
2645)   1CB8 00          					DEFB    0	;
2647)   1CB9 00          					DEFB    0	;
2649)   1CBA C2          		OPRNDS:			DEFB    'B'+80H	;
2650)   1CBB 00          					DEFB    0	;
2651)   1CBC C3          					DEFB    'C'+80H	;
2652)   1CBD 01          					DEFB    1	;
2653)   1CBE C4          					DEFB    'D'+80H	;
2654)   1CBF 02          					DEFB    2	;
2655)   1CC0 C5          					DEFB    'E'+80H	;
2656)   1CC1 03          					DEFB    3	;
2657)   1CC2 C8          					DEFB    'H'+80H	;
2658)   1CC3 04          					DEFB    4	;
2659)   1CC4 CC          					DEFB    'L'+80H	;
2660)   1CC5 05          					DEFB    5	;
2661)   1CC6 28 48       					DEFM    '(H'	;
2662)   1CC8 CC          					DEFB    'L'+80H	;
2663)   1CC9 06          					DEFB    6	;
2664)   1CCA C1          					DEFB    'A'+80H	;
2665)   1CCB 07          					DEFB    7	;
2666)   1CCC 28 49       					DEFM    '(I'	;
2667)   1CCE D8          					DEFB    'X'+80H	;
2668)   1CCF 86          					DEFB    86H	;
2669)   1CD0 28 49       					DEFM    '(I'	;
2670)   1CD2 D9          					DEFB    'Y'+80H	;
2671)   1CD3 C6          					DEFB    0C6H	;
2673)   1CD4 42          					DEFM    'B'	;
2674)   1CD5 C3          					DEFB    'C'+80H	;
2675)   1CD6 08          					DEFB    8	;
2676)   1CD7 44          					DEFM    'D'	;
2677)   1CD8 C5          					DEFB    'E'+80H	;
2678)   1CD9 0A          					DEFB    10	;
2679)   1CDA 48          					DEFM    'H'	;
2680)   1CDB CC          					DEFB    'L'+80H	;
2681)   1CDC 0C          					DEFB    12	;
2682)   1CDD 49          					DEFM    'I'	;
2683)   1CDE D8          					DEFB    'X'+80H	;
2684)   1CDF 8C          					DEFB    8CH	;
2685)   1CE0 49          					DEFM    'I'	;
2686)   1CE1 D9          					DEFB    'Y'+80H	;
2687)   1CE2 CC          					DEFB    0CCH	;
2688)   1CE3 41          					DEFM    'A'	;
2689)   1CE4 C6          					DEFB    'F'+80H	;
2690)   1CE5 0E          					DEFB    14	;
2691)   1CE6 53          					DEFM    'S'	;
2692)   1CE7 D0          					DEFB    'P'+80H	;
2693)   1CE8 0E          					DEFB    14	;
2695)   1CE9 4E          					DEFM    'N'	;
2696)   1CEA DA          					DEFB    'Z'+80H	;
2697)   1CEB 10          					DEFB    16	;
2698)   1CEC DA          					DEFB    'Z'+80H	;
2699)   1CED 11          					DEFB    17	;
2700)   1CEE 4E          					DEFM    'N'	;
2701)   1CEF C3          					DEFB    'C'+80H	;
2702)   1CF0 12          					DEFB    18	;
2703)   1CF1 50          					DEFM    'P'	;
2704)   1CF2 CF          					DEFB    'O'+80H	;
2705)   1CF3 14          					DEFB    20	;
2706)   1CF4 50          					DEFM    'P'	;
2707)   1CF5 C5          					DEFB    'E'+80H	;
2708)   1CF6 15          					DEFB    21	;
2709)   1CF7 D0          					DEFB    'P'+80H	;
2710)   1CF8 16          					DEFB    22	;
2711)   1CF9 CD          					DEFB    'M'+80H	;
2712)   1CFA 17          					DEFB    23	;
2714)   1CFB 28          					DEFM    '('	;
2715)   1CFC C3          					DEFB    'C'+80H	;
2716)   1CFD 20          					DEFB    20H	;
2718)   1CFE 00          					DEFB    0	;
2720)   1CFF 49          		LDOPS:			DEFM    'I'	;
2721)   1D00 00          					DEFB    0	;
2722)   1D01 C1          					DEFB    'A'+80H	;
2723)   1D02 47          					DEFB    47H	;
2724)   1D03 52          					DEFM    'R'	;
2725)   1D04 00          					DEFB    0	;
2726)   1D05 C1          					DEFB    'A'+80H	;
2727)   1D06 4F          					DEFB    4FH	;
2728)   1D07 41          					DEFM    'A'	;
2729)   1D08 00          					DEFB    0	;
2730)   1D09 C9          					DEFB    'I'+80H	;
2731)   1D0A 57          					DEFB    57H	;
2732)   1D0B 41          					DEFM    'A'	;
2733)   1D0C 00          					DEFB    0	;
2734)   1D0D D2          					DEFB    'R'+80H	;
2735)   1D0E 5F          					DEFB    5FH	;
2736)   1D0F 28 42 43    					DEFM    '(BC'	;
2737)   1D12 00          					DEFB    0	;
2738)   1D13 C1          					DEFB    'A'+80H	;
2739)   1D14 02          					DEFB    2	;
2740)   1D15 28 44 45    					DEFM    '(DE'	;
2741)   1D18 00          					DEFB    0	;
2742)   1D19 C1          					DEFB    'A'+80H	;
2743)   1D1A 12          					DEFB    12H	;
2744)   1D1B 41          					DEFM    'A'	;
2745)   1D1C 00          					DEFB    0	;
2746)   1D1D 28 42       					DEFM    '(B'	;
2747)   1D1F C3          					DEFB    'C'+80H	;
2748)   1D20 0A          					DEFB    0AH	;
2749)   1D21 41          					DEFM    'A'	;
2750)   1D22 00          					DEFB    0	;
2751)   1D23 28 44       					DEFM    '(D'	;
2752)   1D25 C5          					DEFB    'E'+80H	;
2753)   1D26 1A          					DEFB    1AH	;
2755)   1D27 00          					DEFB    0	;
 29)   1D28 48 23       		FUNTBL:			DEFW    DECODE          ;Line number	;Line number
 30)   1D2A A1 20       					DEFW    OPENIN          ;OPENIN	;OPENIN
 31)   1D2C BE 20       					DEFW    PTR             ;PTR	;PTR
 32)   1D2E 73 20       					DEFW    PAGEV           ;PAGE	;PAGE
 33)   1D30 C6 20       					DEFW    TIMEV           ;TIME	;TIME
 34)   1D32 69 20       					DEFW    LOMEMV          ;LOMEM	;LOMEM
 35)   1D34 6E 20       					DEFW    HIMEMV          ;HIMEM	;HIMEM
 36)   1D36 12 21       					DEFW    ABS             ;ABS	;ABS
 37)   1D38 4E 21       					DEFW    ACS             ;ACS	;ACS
 38)   1D3A 69 40       					DEFW    ADVAL           ;ADVAL	;ADVAL
 39)   1D3C 56 20       					DEFW    ASC             ;ASC	;ASC
 40)   1D3E 46 21       					DEFW    ASN             ;ASN	;ASN
 41)   1D40 4A 21       					DEFW    ATN             ;ATN	;ATN
 42)   1D42 32 20       					DEFW    BGET            ;BGET	;BGET
 43)   1D44 32 21       					DEFW    COS             ;COS	;COS
 44)   1D46 91 20       					DEFW    COUNTV          ;COUNT	;COUNT
 45)   1D48 1A 21       					DEFW    DEG             ;DEG	;DEG
 46)   1D4A 87 20       					DEFW    ERLV            ;ERL	;ERL
 47)   1D4C 8C 20       					DEFW    ERRV            ;ERR	;ERR
 48)   1D4E 72 21       					DEFW    EVAL            ;EVAL	;EVAL
 49)   1D50 3A 21       					DEFW    EXP             ;EXP	;EXP
 50)   1D52 B6 20       					DEFW    EXT             ;EXT	;EXT
 51)   1D54 E0 23       					DEFW    ZERO            ;FALSE	;FALSE
 52)   1D56 3E 11       					DEFW    FN              ;FN	;FN
 53)   1D58 40 20       					DEFW    GET             ;GET	;GET
 54)   1D5A 3B 20       					DEFW    INKEY           ;INKEY	;INKEY
 55)   1D5C 0B 22       					DEFW    INSTR           ;INSTR(	;INSTR(
 56)   1D5E 26 21       					DEFW    INT             ;INT	;INT
 57)   1D60 63 20       					DEFW    LEN             ;LEN	;LEN
 58)   1D62 3E 21       					DEFW    LN              ;LN	;LN
 59)   1D64 42 21       					DEFW    LOG             ;LOG	;LOG
 60)   1D66 16 21       					DEFW    NOTK            ;NOT	;NOT
 61)   1D68 9E 20       					DEFW    OPENUP          ;OPENUP	;OPENUP
 62)   1D6A 9C 20       					DEFW    OPENOT          ;OPENOUT	;OPENOUT
 63)   1D6C 0E 21       					DEFW    PI              ;PI	;PI
 64)   1D6E 6C 40       					DEFW    POINT           ;POINT(	;POINT(
 65)   1D70 1B 20       					DEFW    POS             ;POS	;POS
 66)   1D72 1E 21       					DEFW    RAD             ;RAD	;RAD
 67)   1D74 9F 21       					DEFW    RND             ;RND	;RND
 68)   1D76 22 21       					DEFW    SGN             ;SGN	;SGN
 69)   1D78 36 21       					DEFW    SIN             ;SIN	;SIN
 70)   1D7A 2A 21       					DEFW    SQR             ;SQR	;SQR
 71)   1D7C 2E 21       					DEFW    TAN             ;TAN	;TAN
 72)   1D7E 78 20       					DEFW    TOPV            ;TO(P)	;TO(P)
 73)   1D80 03 21       					DEFW    TRUE            ;TRUE	;TRUE
 74)   1D82 22 15       					DEFW    USR             ;USR	;USR
 75)   1D84 65 21       					DEFW    VAL             ;VAL	;VAL
 76)   1D86 21 20       					DEFW    VPOS            ;VPOS	;VPOS
 77)   1D88 89 22       					DEFW    CHRS            ;CHRS	;CHRS
 78)   1D8A 90 22       					DEFW    GETS            ;GETS	;GETS
 79)   1D8C 96 22       					DEFW    INKEYS          ;INKEYS	;INKEYS
 80)   1D8E D7 22       					DEFW    LEFTS           ;LEFTS(	;LEFTS(
 81)   1D90 A6 22       					DEFW    MIDS            ;MIDS(	;MIDS(
 82)   1D92 F2 22       					DEFW    RIGHTS          ;RIGHTS(	;RIGHTS(
 83)   1D94 A0 23       					DEFW    STRS            ;STR$	;STR$
 84)   1D96 06 23       					DEFW    STRING          ;STRINGS(	;STRINGS(
 85)   1D98 26 20       					DEFW    EOF             ;EOF	;EOF
 95)   1D9A F1 20       		SOPTBL:			DEFW    SLE             ;<= (STRING)	;<= (STRING)
 96)   1D9C F9 20       					DEFW    SNE             ;<>	;<>
 97)   1D9E EB 20       					DEFW    SGE             ;>=	;>=
 98)   1DA0 DE 20       					DEFW    SLT             ;<	;<
 99)   1DA2 FF 20       					DEFW    SEQ             ;=	;=
100)   1DA4 E4 20       					DEFW    SGT             ;>	;>
119)   1DA6 CD BB 1D    		@EXPR:			CALL    EXPR1           ;GET FIRST OPERAND	;GET FIRST OPERAND
120)   1DA9 FE 82       		EXPR0A:			CP      EORK            ;CHECK OPERATOR	;CHECK OPERATOR
121)   1DAB 28 03       					JR      Z,EXPR0B	;
122)   1DAD FE 84       					CP      ORK	;
123)   1DAF C0          					RET     NZ	;
124)   1DB0 CD 6B 24    		EXPR0B:			CALL    SAVE            ;SAVE FIRST OPERAND	;SAVE FIRST OPERAND
125)   1DB3 CD BB 1D    					CALL    EXPR1           ;GET SECOND OPERAND	;GET SECOND OPERAND
126)   1DB6 CD 79 24    					CALL    DOIT            ;DO OPERATION	;DO OPERATION
127)   1DB9 18 EE       					JR      EXPR0A          ;CONTINUE	;CONTINUE
129)   1DBB CD CC 1D    		EXPR1:			CALL    EXPR2	;
130)   1DBE FE 80       		EXPR1A:			CP      ANDK	;
131)   1DC0 C0          					RET     NZ	;
132)   1DC1 CD 6B 24    					CALL    SAVE	;
133)   1DC4 CD CC 1D    					CALL    EXPR2	;
134)   1DC7 CD 79 24    					CALL    DOIT	;
135)   1DCA 18 F2       					JR      EXPR1A	;
137)   1DCC CD 2B 1E    		EXPR2:			CALL    EXPR3	;
138)   1DCF CD 46 24    					CALL    RELOP?	;
139)   1DD2 C0          					RET     NZ	;
140)   1DD3 47          					LD      B,A	;
141)   1DD4 FD 23       					INC     IY              ;BUMP OVER OPERATOR	;BUMP OVER OPERATOR
142)   1DD6 CD 9A 24    					CALL    NXT	;
143)   1DD9 CD 46 24    					CALL    RELOP?          ;COMPOUND OPERATOR?	;COMPOUND OPERATOR?
144)   1DDC 20 08       					JR      NZ,EXPR2B	;
145)   1DDE FD 23       					INC     IY	;
146)   1DE0 B8          					CP      B	;
147)   1DE1 CA E1 0D    					JP      Z,SYNTAX        ;ILLEGAL COMBINATION	;ILLEGAL COMBINATION
148)   1DE4 80          					ADD     A,B	;
149)   1DE5 47          					LD      B,A	;
150)   1DE6 78          		EXPR2B:			LD      A,B	;
151)   1DE7 08          					EX      AF,AF'	;
152)   1DE8 FA FE 1D    					JP      M,EXPR2S	;
153)   1DEB 08          					EX      AF,AF'	;
154)   1DEC D6 04       					SUB     4	;
155)   1DEE FE 3A       					CP      '>'-4	;
156)   1DF0 20 02       					JR      NZ,EXPR2C	;
157)   1DF2 C6 02       					ADD     A,2	;
158)   1DF4 CD 6D 24    		EXPR2C:			CALL    SAVE1	;
159)   1DF7 CD 2B 1E    					CALL    EXPR3	;
160)   1DFA CD 79 24    					CALL    DOIT            ;Must NOT be "JP DOIT"	;Must NOT be "JP DOIT"
161)   1DFD C9          					RET	;
163)   1DFE 08          		EXPR2S:			EX      AF,AF'	;
164)   1DFF 3D          					DEC     A	;
165)   1E00 E6 07       					AND     7	;
166)   1E02 CD 01 24    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
167)   1E05 F5          					PUSH    AF              ;SAVE OPERATOR	;SAVE OPERATOR
168)   1E06 CD 2B 1E    					CALL    EXPR3           ;SECOND STRING	;SECOND STRING
169)   1E09 08          					EX      AF,AF'	;
170)   1E0A F2 DB 1E    					JP      P,TYPE	;
171)   1E0D F1          					POP     AF	;
172)   1E0E 4B          					LD      C,E             ;LENGTH OF STRING #2	;LENGTH OF STRING #2
173)   1E0F D1          					POP     DE	;
174)   1E10 21 00 00    					LD      HL,0	;
175)   1E13 39          					ADD     HL,SP	;
176)   1E14 43          					LD      B,E             ;LENGTH OF STRING #1	;LENGTH OF STRING #1
177)   1E15 D5          					PUSH    DE	;
178)   1E16 11 00 60    					LD      DE,ACCS	;
179)   1E19 EB          					EX      DE,HL	;
180)   1E1A CD A5 24    					CALL    DISPT2	;
181)   1E1D D1          					POP     DE	;
182)   1E1E EB          					EX      DE,HL	;
183)   1E1F 26 00       					LD      H,0	;
184)   1E21 39          					ADD     HL,SP	;
185)   1E22 F9          					LD      SP,HL	;
186)   1E23 EB          					EX      DE,HL	;
187)   1E24 AF          					XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
188)   1E25 4F          					LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
189)   1E26 08          					EX      AF,AF'	;
190)   1E27 FD 7E 00    					LD      A,(IY)	;
191)   1E2A C9          					RET	;
193)   1E2B CD 7A 1E    		EXPR3:			CALL    EXPR4	;
194)   1E2E FE 2D       		EXPR3A:			CP      '-'	;
195)   1E30 28 08       					JR      Z,EXPR3B	;
196)   1E32 FE 2B       					CP      '+'	;
197)   1E34 C0          					RET     NZ	;
198)   1E35 08          					EX      AF,AF'	;
199)   1E36 FA 45 1E    					JP      M,EXPR3S	;
200)   1E39 08          					EX      AF,AF'	;
201)   1E3A CD 6B 24    		EXPR3B:			CALL    SAVE	;
202)   1E3D CD 7A 1E    					CALL    EXPR4	;
203)   1E40 CD 79 24    					CALL    DOIT	;
204)   1E43 18 E9       					JR      EXPR3A	;
206)   1E45 08          		EXPR3S:			EX      AF,AF'	;
207)   1E46 FD 23       					INC     IY              ;BUMP PAST '+'	;BUMP PAST '+'
208)   1E48 CD 01 24    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
209)   1E4B CD 7A 1E    					CALL    EXPR4           ;SECOND STRING	;SECOND STRING
210)   1E4E 08          					EX      AF,AF'	;
211)   1E4F F2 DB 1E    					JP      P,TYPE	;
212)   1E52 4B          					LD      C,E             ;C=LENGTH	;C=LENGTH
213)   1E53 D1          					POP     DE	;
214)   1E54 D5          					PUSH    DE	;
215)   1E55 21 00 60    					LD      HL,ACCS	;
216)   1E58 54          					LD      D,H	;
217)   1E59 79          					LD      A,C	;
218)   1E5A B7          					OR      A	;
219)   1E5B 28 0F       					JR      Z,EXP3S3	;
220)   1E5D 45          					LD      B,L	;
221)   1E5E 6F          					LD      L,A             ;SOURCE	;SOURCE
222)   1E5F 83          					ADD     A,E	;
223)   1E60 5F          					LD      E,A             ;DESTINATION	;DESTINATION
224)   1E61 3E 13       					LD      A,19	;
225)   1E63 DA FD 06    					JP      C,ERROR         ;"String too long"	;"String too long"
226)   1E66 D5          					PUSH    DE	;
227)   1E67 1D          					DEC     E	;
228)   1E68 2D          					DEC     L	;
229)   1E69 ED B8       					LDDR                    ;COPY	;COPY
230)   1E6B D1          					POP     DE	;
231)   1E6C D9          		EXP3S3:			EXX	;
232)   1E6D C1          					POP     BC	;
233)   1E6E CD 20 24    					CALL    POPS            ;RESTORE FROM STACK	;RESTORE FROM STACK
234)   1E71 D9          					EXX	;
235)   1E72 F6 80       					OR      80H             ;FLAG STRING	;FLAG STRING
236)   1E74 08          					EX      AF,AF'	;
237)   1E75 FD 7E 00    					LD      A,(IY)	;
238)   1E78 18 B4       					JR      EXPR3A	;
240)   1E7A CD 97 1E    		EXPR4:			CALL    EXPR5	;
241)   1E7D FE 2A       		EXPR4A:			CP      '*'	;
242)   1E7F 28 0B       					JR      Z,EXPR4B	;
243)   1E81 FE 2F       					CP      '/'	;
244)   1E83 28 07       					JR      Z,EXPR4B	;
245)   1E85 FE 83       					CP      MODK	;
246)   1E87 28 03       					JR      Z,EXPR4B	;
247)   1E89 FE 81       					CP      DIVK	;
248)   1E8B C0          					RET     NZ	;
249)   1E8C CD 6B 24    		EXPR4B:			CALL    SAVE	;
250)   1E8F CD 97 1E    					CALL    EXPR5	;
251)   1E92 CD 79 24    					CALL    DOIT	;
252)   1E95 18 E6       					JR      EXPR4A	;
254)   1E97 CD 32 1F    		EXPR5:			CALL    ITEM	;
255)   1E9A B7          					OR      A               ;TEST TYPE	;TEST TYPE
256)   1E9B 08          					EX      AF,AF'          ;SAVE TYPE	;SAVE TYPE
257)   1E9C CD 9A 24    		EXPR5A:			CALL    NXT	;
258)   1E9F FE 5E       					CP      '^'	;
259)   1EA1 C0          					RET     NZ	;
260)   1EA2 CD 6B 24    					CALL    SAVE	;
261)   1EA5 CD 32 1F    					CALL    ITEM	;
262)   1EA8 B7          					OR      A	;
263)   1EA9 08          					EX      AF,AF'	;
264)   1EAA CD 79 24    					CALL    DOIT	;
265)   1EAD 18 ED       					JR      EXPR5A	;
267)   1EAF CD A6 1D    		@EXPRN:			CALL    EXPR	;
268)   1EB2 08          					EX      AF,AF'	;
269)   1EB3 F0          					RET     P	;
270)   1EB4 18 25       					JR      TYPE	;
272)   1EB6 CD A6 1D    		@EXPRI:			CALL    EXPR	;
273)   1EB9 08          					EX      AF,AF'	;
274)   1EBA F2 5D 21    					JP      P,SFIX	;
275)   1EBD 18 1C       					JR      TYPE	;
277)   1EBF CD A6 1D    		@EXPRS:			CALL    EXPR	;
278)   1EC2 08          					EX      AF,AF'	;
279)   1EC3 F8          					RET     M	;
280)   1EC4 18 15       					JR      TYPE	;
283)   1EC6 CD 32 1F    		ITEMN:			CALL    ITEM	;
284)   1EC9 B7          					OR      A	;
285)   1ECA F0          					RET     P	;
286)   1ECB 18 0E       					JR      TYPE	;
288)   1ECD CD 32 1F    		@ITEMI:			CALL    ITEM	;
289)   1ED0 B7          					OR      A	;
290)   1ED1 F2 5D 21    					JP      P,SFIX	;
291)   1ED4 18 05       					JR      TYPE	;
293)   1ED6 CD 32 1F    		ITEMS:			CALL    ITEM	;
294)   1ED9 B7          					OR      A	;
295)   1EDA F8          					RET     M	;
296)   1EDB 3E 06       		TYPE:			LD      A,6	;
297)   1EDD C3 FD 06    					JP      ERROR           ;"Type mismatch"	;"Type mismatch"
299)   1EE0 CD A6 1D    		ITEM1:			CALL    EXPR            ;BRACKETED EXPR	;BRACKETED EXPR
300)   1EE3 CD 5E 24    					CALL    BRAKET	;
301)   1EE6 08          					EX      AF,AF'	;
302)   1EE7 C9          					RET	;
309)   1EE8 CD E0 23    		HEX:			CALL    ZERO	;
310)   1EEB CD 33 24    					CALL    HEXDIG	;
311)   1EEE 38 18       					JR      C,BADHEX	;
312)   1EF0 FD 23       		HEX1:			INC     IY	;
313)   1EF2 E6 0F       					AND     0FH	;
314)   1EF4 06 04       					LD      B,4	;
315)   1EF6 D9          		HEX2:			EXX	;
316)   1EF7 29          					ADD     HL,HL	;
317)   1EF8 D9          					EXX	;
318)   1EF9 ED 6A       					ADC     HL,HL	;
319)   1EFB 10 F9       					DJNZ    HEX2	;
320)   1EFD D9          					EXX	;
321)   1EFE B5          					OR      L	;
322)   1EFF 6F          					LD      L,A	;
323)   1F00 D9          					EXX	;
324)   1F01 CD 33 24    					CALL    HEXDIG	;
325)   1F04 30 EA       					JR      NC,HEX1	;
326)   1F06 AF          					XOR     A	;
327)   1F07 C9          					RET	;
329)   1F08 3E 1C       		BADHEX:			LD      A,28	;
330)   1F0A C3 FD 06    					JP      ERROR           ;"Bad HEX"	;"Bad HEX"
337)   1F0D CD C6 1E    		MINUS:			CALL    ITEMN	;
338)   1F10 0D          		MINUS0:			DEC     C	;
339)   1F11 0C          					INC     C	;
340)   1F12 28 06       					JR      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
341)   1F14 7C          					LD      A,H	;
342)   1F15 EE 80       					XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
343)   1F17 67          					LD      H,A	;
344)   1F18 AF          					XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
345)   1F19 C9          					RET	;
347)   1F1A D9          		NEGATE:			EXX	;
348)   1F1B 7C          					LD      A,H	;
349)   1F1C 2F          					CPL	;
350)   1F1D 67          					LD      H,A	;
351)   1F1E 7D          					LD      A,L	;
352)   1F1F 2F          					CPL	;
353)   1F20 6F          					LD      L,A	;
354)   1F21 D9          					EXX	;
355)   1F22 7C          					LD      A,H	;
356)   1F23 2F          					CPL	;
357)   1F24 67          					LD      H,A	;
358)   1F25 7D          					LD      A,L	;
359)   1F26 2F          					CPL	;
360)   1F27 6F          					LD      L,A	;
361)   1F28 D9          		ADD1:			EXX	;
362)   1F29 23          					INC     HL	;
363)   1F2A 7C          					LD      A,H	;
364)   1F2B B5          					OR      L	;
365)   1F2C D9          					EXX	;
366)   1F2D 3E 00       					LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
367)   1F2F C0          					RET     NZ	;
368)   1F30 23          					INC     HL	;
369)   1F31 C9          					RET	;
378)   1F32 CD E1 15    		ITEM:			CALL    CHECK	;
379)   1F35 CD 9A 24    					CALL    NXT	;
380)   1F38 FD 23       					INC     IY	;
381)   1F3A FE 26       					CP      '&'	;
382)   1F3C 28 AA       					JR      Z,HEX           ;HEX CONSTANT	;HEX CONSTANT
383)   1F3E FE 2D       					CP      '-'	;
384)   1F40 28 CB       					JR      Z,MINUS         ;UNARY MINUS	;UNARY MINUS
385)   1F42 FE 2B       					CP      '+'	;
386)   1F44 28 80       					JR      Z,ITEMN         ;UNARY PLUS	;UNARY PLUS
387)   1F46 FE 28       					CP      '('	;
388)   1F48 28 96       					JR      Z,ITEM1         ;EXPRESSION	;EXPRESSION
389)   1F4A FE 22       					CP      34		;ASCII ""	;ASCII ""
390)   1F4C 28 63       					JR      Z,CONS          ;STRING CONSTANT	;STRING CONSTANT
391)   1F4E FE C6       					CP      TCMD	;
392)   1F50 D2 E1 0D    					JP      NC,SYNTAX       ;SYNTAX ERROR	;SYNTAX ERROR
393)   1F53 FE 8D       					CP      FUNTOK	;
394)   1F55 D2 AB 24    					JP      NC,DISPAT       ;FUNCTION	;FUNCTION
395)   1F58 FD 2B       					DEC     IY	;
396)   1F5A FE 3A       					CP      ':'	;
397)   1F5C 30 08       					JR      NC,ITEM2        ;VARIABLE?	;VARIABLE?
398)   1F5E FE 30       					CP      '0'	;
399)   1F60 30 74       					JR      NC,CON          ;NUMERIC CONSTANT	;NUMERIC CONSTANT
400)   1F62 FE 2E       					CP      '.'	;
401)   1F64 28 70       					JR      Z,CON           ;NUMERIC CONSTANT	;NUMERIC CONSTANT
402)   1F66 CD 61 09    		ITEM2:			CALL    GETVAR          ;VARIABLE	;VARIABLE
403)   1F69 20 2B       					JR      NZ,NOSUCH	;
404)   1F6B B7          					OR      A	;
405)   1F6C FA F9 1F    					JP      M,LOADS         ;STRING VARIABLE	;STRING VARIABLE
406)   1F6F B7          		@LOADN:			OR      A	;
407)   1F70 28 18       					JR      Z,LOAD1         ;BYTE VARIABLE	;BYTE VARIABLE
408)   1F72 0E 00       					LD      C,0	;
409)   1F74 CB 47       					BIT     0,A	;
410)   1F76 28 03       					JR      Z,LOAD4         ;INTEGER VARIABLE	;INTEGER VARIABLE
411)   1F78 DD 4E 04    		LOAD5:			LD      C,(IX+4)	;
412)   1F7B D9          		@LOAD4:			EXX	;
413)   1F7C DD 6E 00    					LD      L,(IX+0)	;
414)   1F7F DD 66 01    					LD      H,(IX+1)	;
415)   1F82 D9          					EXX	;
416)   1F83 DD 6E 02    					LD      L,(IX+2)	;
417)   1F86 DD 66 03    					LD      H,(IX+3)	;
418)   1F89 C9          					RET	;
420)   1F8A 21 00 00    		LOAD1:			LD      HL,0	;
421)   1F8D D9          					EXX	;
422)   1F8E 26 00       					LD      H,0	;
423)   1F90 DD 6E 00    					LD      L,(IX+0)	;
424)   1F93 D9          					EXX	;
425)   1F94 4C          					LD      C,H	;
426)   1F95 C9          					RET	;
428)   1F96 DA E1 0D    		NOSUCH:			JP      C,SYNTAX	;
429)   1F99 3A FE 62    					LD      A,(LISTON)	;
430)   1F9C CB 6F       					BIT     5,A	;
431)   1F9E 3E 1A       					LD      A,26	;
432)   1FA0 20 23       					JR      NZ,ERROR0       ;"No such variable"	;"No such variable"
433)   1FA2 FD 23       		NOS1:			INC     IY	;
434)   1FA4 CD 48 0B    					CALL    RANGE	;
435)   1FA7 30 F9       					JR      NC,NOS1	;
436)   1FA9 DD 21 40 62 					LD      IX,PC	;
437)   1FAD AF          					XOR     A	;
438)   1FAE 4F          					LD      C,A	;
439)   1FAF 18 CA       					JR      LOAD4	;
448)   1FB1 11 00 60    		@CONS:			LD      DE,ACCS	;
449)   1FB4 FD 7E 00    		CONS3:			LD      A,(IY)	;
450)   1FB7 FD 23       					INC     IY	;
451)   1FB9 FE 22       					CP      34		;ASCII ""	;ASCII ""
452)   1FBB 28 0B       					JR      Z,CONS2	;
453)   1FBD 12          		CONS1:			LD      (DE),A	;
454)   1FBE 1C          					INC     E	;
455)   1FBF FE 0D       					CP      CR	;
456)   1FC1 20 F1       					JR      NZ,CONS3	;
457)   1FC3 3E 09       					LD      A,9	;
458)   1FC5 C3 FD 06    		ERROR0:			JP      ERROR           ;"Missing """	;"Missing """
460)   1FC8 FD 7E 00    		CONS2:			LD      A,(IY)	;
461)   1FCB FE 34       					CP      0x34		;ASCII "	;ASCII "
462)   1FCD FD 23       					INC     IY	;
463)   1FCF 28 EC       					JR      Z,CONS1	;
464)   1FD1 FD 2B       					DEC     IY	;
465)   1FD3 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
466)   1FD5 C9          					RET	;
474)   1FD6 FD E5       		CON:			PUSH    IY	;
475)   1FD8 DD E1       					POP     IX	;
476)   1FDA 3E 24       					LD      A,36	;
477)   1FDC CD BE 24    					CALL    FPP	;
478)   1FDF 38 E4       					JR      C,ERROR0	;
479)   1FE1 DD E5       					PUSH    IX	;
480)   1FE3 FD E1       					POP     IY	;
481)   1FE5 AF          					XOR     A	;
482)   1FE6 C9          					RET	;
484)   1FE7 DD 46 04    		@DLOAD5:		LD      B,(IX+4)	;
485)   1FEA D9          					EXX	;
486)   1FEB DD 5E 00    					LD      E,(IX+0)	;
487)   1FEE DD 56 01    					LD      D,(IX+1)	;
488)   1FF1 D9          					EXX	;
489)   1FF2 DD 5E 02    					LD      E,(IX+2)	;
490)   1FF5 DD 56 03    					LD      D,(IX+3)	;
491)   1FF8 C9          					RET	;
493)   1FF9 11 00 60    		@LOADS:			LD      DE,ACCS	;
494)   1FFC 1F          					RRA	;
495)   1FFD 30 10       					JR      NC,LOADS2       ;FIXED STRING	;FIXED STRING
496)   1FFF CD 7B 1F    					CALL    LOAD4	;
497)   2002 D9          					EXX	;
498)   2003 7D          					LD      A,L	;
499)   2004 D9          					EXX	;
500)   2005 B7          					OR      A	;
501)   2006 4F          					LD      C,A	;
502)   2007 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
503)   2009 C8          					RET     Z	;
504)   200A 06 00       					LD      B,0	;
505)   200C ED B0       					LDIR	;
506)   200E C9          					RET	;
507)   200F 7E          		LOADS2:			LD      A,(HL)	;
508)   2010 12          					LD      (DE),A	;
509)   2011 23          					INC     HL	;
510)   2012 FE 0D       					CP      CR	;
511)   2014 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
512)   2016 C8          					RET     Z	;
513)   2017 1C          					INC     E	;
514)   2018 20 F5       					JR      NZ,LOADS2	;
515)   201A C9          					RET                     ;RETURN NULL STRING	;RETURN NULL STRING
545)   201B CD 0C 40    		POS:			CALL    GETCSR	;
546)   201E EB          					EX      DE,HL	;
547)   201F 18 75       					JR      COUNT1	;
548)   2021 CD 0C 40    		VPOS:			CALL    GETCSR	;
549)   2024 18 70       					JR      COUNT1	;
550)   2026 CD D9 17    		EOF:			CALL    CHANEL	;
551)   2029 CD 2A 40    					CALL    OSSTAT	;
552)   202C CA 03 21    					JP      Z,TRUE	;
553)   202F C3 E0 23    					JP      ZERO	;
554)   2032 CD D9 17    		BGET:			CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
555)   2035 CD 27 40    					CALL    OSBGET	;
556)   2038 6F          					LD      L,A	;
557)   2039 18 59       					JR      COUNT0	;
558)   203B CD 96 22    		INKEY:			CALL    INKEYS	;
559)   203E 18 19       					JR      ASC0	;
560)   2040 CD 9A 24    		GET:			CALL    NXT	;
561)   2043 FE 28       					CP      '('	;
562)   2045 20 0A       					JR      NZ,GET0	;
563)   2047 CD CD 1E    					CALL    ITEMI           ;PORT ADDRESS	;PORT ADDRESS
564)   204A D9          					EXX	;
565)   204B 44          					LD      B,H	;
566)   204C 4D          					LD      C,L	;
567)   204D ED 68       					IN      L,(C)           ;INPUT FROM PORT BC	;INPUT FROM PORT BC
568)   204F 18 43       					JR      COUNT0	;
569)   2051 CD 90 22    		GET0:			CALL    GETS	;
570)   2054 18 08       					JR      ASC1	;
571)   2056 CD D6 1E    		ASC:			CALL    ITEMS	;
572)   2059 AF          		ASC0:			XOR     A	;
573)   205A BB          					CP      E	;
574)   205B CA 03 21    					JP      Z,TRUE          ;NULL STRING	;NULL STRING
575)   205E 2A 00 60    		ASC1:			LD      HL,(ACCS)	;
576)   2061 18 31       					JR      COUNT0	;
577)   2063 CD D6 1E    		LEN:			CALL    ITEMS	;
578)   2066 EB          					EX      DE,HL	;
579)   2067 18 2B       					JR      COUNT0	;
580)   2069 2A E0 62    		LOMEMV:			LD      HL,(LOMEM)	;
581)   206C 18 28       					JR      COUNT1	;
582)   206E 2A E4 62    		HIMEMV:			LD      HL,(HIMEM)	;
583)   2071 18 23       					JR      COUNT1	;
584)   2073 2A DC 62    		PAGEV:			LD      HL,(PAGE)	;
585)   2076 18 1E       					JR      COUNT1	;
586)   2078 FD 7E 00    		TOPV:			LD      A,(IY)	;
587)   207B FD 23       					INC     IY              ;SKIP "P"	;SKIP "P"
588)   207D FE 50       					CP      'P'	;
589)   207F C2 E1 0D    					JP      NZ,SYNTAX       ;"Syntax Error"	;"Syntax Error"
590)   2082 2A DE 62    					LD      HL,(TOP)	;
591)   2085 18 0F       					JR      COUNT1	;
592)   2087 2A F2 62    		ERLV:			LD      HL,(ERL)	;
593)   208A 18 0A       					JR      COUNT1	;
594)   208C 2A FD 62    		ERRV:			LD      HL,(ERR)	;
595)   208F 18 03       					JR      COUNT0	;
596)   2091 2A FB 62    		COUNTV:			LD      HL,(COUNT)	;
597)   2094 26 00       		COUNT0:			LD      H,0	;
598)   2096 D9          		COUNT1:			EXX	;
599)   2097 AF          					XOR     A	;
600)   2098 4F          					LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
601)   2099 67          					LD      H,A	;
602)   209A 6F          					LD      L,A	;
603)   209B C9          					RET	;
610)   209C AF          		OPENOT:			XOR     A	;
611)   209D 21          					DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
612)   209E 3E 02       		OPENUP:			LD      A,2	;
613)   20A0 21          					DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
614)   20A1 3E 01       		OPENIN:			LD      A,1	;
615)   20A3 F5          					PUSH    AF              ;SAVE OPEN TYPE	;SAVE OPEN TYPE
616)   20A4 CD D6 1E    					CALL    ITEMS           ;FILENAME	;FILENAME
617)   20A7 3E 0D       					LD      A,CR	;
618)   20A9 12          					LD      (DE),A	;
619)   20AA F1          					POP     AF              ;RESTORE OPEN TYPE	;RESTORE OPEN TYPE
620)   20AB C6 FF       					ADD     A,-1            ;AFFECT FLAGS	;AFFECT FLAGS
621)   20AD 21 00 60    					LD      HL,ACCS	;
622)   20B0 CD 30 40    					CALL    OSOPEN	;
623)   20B3 6F          					LD      L,A	;
624)   20B4 18 DE       					JR      COUNT0	;
630)   20B6 CD D9 17    		EXT:			CALL    CHANEL	;
631)   20B9 CD 42 40    					CALL    GETEXT	;
632)   20BC 18 12       					JR      TIME0	;
634)   20BE CD D9 17    		PTR:			CALL    CHANEL	;
635)   20C1 CD 3C 40    					CALL    GETPTR	;
636)   20C4 18 0A       					JR      TIME0	;
641)   20C6 FD 7E 00    		TIMEV:			LD      A,(IY)	;
642)   20C9 FE 24       					CP      '$'	;
643)   20CB 28 09       					JR      Z,TIMEVS	;
644)   20CD CD 06 40    					CALL    GETIME	;
645)   20D0 D5          		TIME0:			PUSH    DE	;
646)   20D1 D9          					EXX	;
647)   20D2 E1          					POP     HL	;
648)   20D3 AF          					XOR     A	;
649)   20D4 4F          					LD      C,A	;
650)   20D5 C9          					RET	;
655)   20D6 FD 23       		TIMEVS:			INC     IY              ;SKIP $	;SKIP $
656)   20D8 CD 6F 40    					CALL    GETIMS	;
657)   20DB 3E 80       					LD      A,80H           ;MARK STRING	;MARK STRING
658)   20DD C9          					RET	;
662)   20DE CD DD 23    		SLT:			CALL    SCP	;
663)   20E1 D0          					RET     NC	;
664)   20E2 18 1F       					JR      TRUE	;
666)   20E4 CD DD 23    		SGT:			CALL    SCP	;
667)   20E7 C8          					RET     Z	;
668)   20E8 D8          					RET     C	;
669)   20E9 18 18       					JR      TRUE	;
671)   20EB CD DD 23    		SGE:			CALL    SCP	;
672)   20EE D8          					RET     C	;
673)   20EF 18 12       					JR      TRUE	;
675)   20F1 CD DD 23    		SLE:			CALL    SCP	;
676)   20F4 28 0D       					JR      Z,TRUE	;
677)   20F6 D0          					RET     NC	;
678)   20F7 18 0A       					JR      TRUE	;
680)   20F9 CD DD 23    		SNE:			CALL    SCP	;
681)   20FC C8          					RET     Z	;
682)   20FD 18 04       					JR      TRUE	;
684)   20FF CD DD 23    		SEQ:			CALL    SCP	;
685)   2102 C0          					RET     NZ	;
686)   2103 3E FF       		TRUE:			LD      A,-1	;
687)   2105 D9          					EXX	;
688)   2106 67          					LD      H,A	;
689)   2107 6F          					LD      L,A	;
690)   2108 D9          					EXX	;
691)   2109 67          					LD      H,A	;
692)   210A 6F          					LD      L,A	;
693)   210B 3C          					INC     A	;
694)   210C 4F          					LD      C,A	;
695)   210D C9          					RET	;
700)   210E 3E 23       		PI:			LD      A,35	;
701)   2110 18 43       					JR      FPP1	;
706)   2112 3E 10       		ABS:			LD      A,16	;
707)   2114 18 3A       					JR      FPPN	;
712)   2116 3E 1A       		NOTK:			LD      A,26	;
713)   2118 18 36       					JR      FPPN	;
718)   211A 3E 15       		DEG:			LD      A,21	;
719)   211C 18 32       					JR      FPPN	;
724)   211E 3E 1B       		RAD:			LD      A,27	;
725)   2120 18 2E       					JR      FPPN	;
730)   2122 3E 1C       		SGN:			LD      A,28	;
731)   2124 18 2A       					JR      FPPN	;
736)   2126 3E 17       		INT:			LD      A,23	;
737)   2128 18 26       					JR      FPPN	;
742)   212A 3E 1E       		SQR:			LD      A,30	;
743)   212C 18 22       					JR      FPPN	;
748)   212E 3E 1F       		TAN:			LD      A,31	;
749)   2130 18 1E       					JR      FPPN	;
754)   2132 3E 14       		COS:			LD      A,20	;
755)   2134 18 1A       					JR      FPPN	;
760)   2136 3E 1D       		SIN:			LD      A,29	;
761)   2138 18 16       					JR      FPPN	;
766)   213A 3E 16       		EXP:			LD      A,22	;
767)   213C 18 12       					JR      FPPN	;
772)   213E 3E 18       		LN:			LD      A,24	;
773)   2140 18 0E       					JR      FPPN	;
778)   2142 3E 19       		LOG:			LD      A,25	;
779)   2144 18 0A       					JR      FPPN	;
784)   2146 3E 12       		ASN:			LD      A,18	;
785)   2148 18 06       					JR      FPPN	;
790)   214A 3E 13       		ATN:			LD      A,19	;
791)   214C 18 02       					JR      FPPN	;
796)   214E 3E 11       		ACS:			LD      A,17	;
797)   2150 F5          		FPPN:			PUSH    AF	;
798)   2151 CD C6 1E    					CALL    ITEMN	;
799)   2154 F1          					POP     AF	;
800)   2155 CD BE 24    		FPP1:			CALL    FPP	;
801)   2158 DA FD 06    					JP      C,ERROR	;
802)   215B AF          					XOR     A	;
803)   215C C9          					RET	;
807)   215D 3E 26       		@SFIX:			LD      A,38	;
808)   215F 18 F4       					JR      FPP1	;
812)   2161 3E 27       		SFLOAT:			LD      A,39	;
813)   2163 18 F0       					JR      FPP1	;
818)   2165 CD D6 1E    		VAL:			CALL    ITEMS	;
819)   2168 AF          		@VAL0:			XOR     A	;
820)   2169 12          					LD      (DE),A	;
821)   216A DD 21 00 60 					LD      IX,ACCS	;
822)   216E 3E 24       					LD      A,36	;
823)   2170 18 E3       					JR      FPP1	;
828)   2172 CD D6 1E    		EVAL:			CALL    ITEMS	;
829)   2175 3E 0D       					LD      A,CR	;
830)   2177 12          					LD      (DE),A	;
831)   2178 FD E5       					PUSH    IY	;
832)   217A 11 00 60    					LD      DE,ACCS	;
833)   217D FD 21 00 60 					LD      IY,ACCS	;
834)   2181 0E 00       					LD      C,0	;
835)   2183 CD 77 0B    					CALL    LEXAN2          ;TOKENISE	;TOKENISE
836)   2186 12          					LD      (DE),A	;
837)   2187 13          					INC     DE	;
838)   2188 AF          					XOR     A	;
839)   2189 CD 01 24    					CALL    PUSHS           ;PUT ON STACK	;PUT ON STACK
840)   218C FD 21 02 00 					LD      IY,2	;
841)   2190 FD 39       					ADD     IY,SP	;
842)   2192 CD A6 1D    					CALL    EXPR	;
843)   2195 FD E1       					POP     IY	;
844)   2197 FD 39       					ADD     IY,SP	;
845)   2199 FD F9       					LD      SP,IY           ;ADJUST STACK POINTER	;ADJUST STACK POINTER
846)   219B FD E1       					POP     IY	;
847)   219D 08          					EX      AF,AF'	;
848)   219E C9          					RET	;
857)   219F DD 21 F6 62 		RND:			LD      IX,RANDOM	;
858)   21A3 CD 9A 24    					CALL    NXT	;
859)   21A6 FE 28       					CP      '('	;
860)   21A8 28 1C       					JR      Z,RND5          ;ARGUMENT FOLLOWS	;ARGUMENT FOLLOWS
861)   21AA CD 78 1F    					CALL    LOAD5	;
862)   21AD CB 19       		RND1:			RR      C	;
863)   21AF 06 20       					LD      B,32	;
864)   21B1 D9          		RND2:			EXX                     ;CALCULATE NEXT	;CALCULATE NEXT
865)   21B2 ED 6A       					ADC     HL,HL	;
866)   21B4 D9          					EXX	;
867)   21B5 ED 6A       					ADC     HL,HL	;
868)   21B7 CB 5D       					BIT     3,L	;
869)   21B9 28 01       					JR      Z,RND3	;
870)   21BB 3F          					CCF	;
871)   21BC 10 F3       		RND3:			DJNZ    RND2	;
872)   21BE CB 11       		RND4:			RL      C               ;SAVE CARRY	;SAVE CARRY
873)   21C0 CD 85 15    					CALL    STORE5          ;STORE NEW NUMBER	;STORE NEW NUMBER
874)   21C3 AF          					XOR     A	;
875)   21C4 4F          					LD      C,A	;
876)   21C5 C9          					RET	;
877)   21C6 CD CD 1E    		RND5:			CALL    ITEMI	;
878)   21C9 DD 21 F6 62 					LD      IX,RANDOM	;
879)   21CD CB 7C       					BIT     7,H             ;NEGATIVE?	;NEGATIVE?
880)   21CF 37          					SCF	;
881)   21D0 20 EC       					JR      NZ,RND4         ;SEED	;SEED
882)   21D2 CD 41 23    					CALL    TEST	;
883)   21D5 F5          					PUSH    AF	;
884)   21D6 CD 39 23    					CALL    SWAP	;
885)   21D9 D9          					EXX	;
886)   21DA CD 78 1F    					CALL    LOAD5	;
887)   21DD C4 AD 21    					CALL    NZ,RND1         ;NEXT IF NON-ZERO	;NEXT IF NON-ZERO
888)   21E0 D9          					EXX                     ;SCRAMBLE (CARE!)	;SCRAMBLE (CARE!)
889)   21E1 0E 7F       					LD      C,7FH	;
890)   21E3 CB 7C       		RND6:			BIT     7,H             ;FLOAT	;FLOAT
891)   21E5 20 08       					JR      NZ,RND7	;
892)   21E7 D9          					EXX	;
893)   21E8 29          					ADD     HL,HL	;
894)   21E9 D9          					EXX	;
895)   21EA ED 6A       					ADC     HL,HL	;
896)   21EC 0D          					DEC     C	;
897)   21ED 20 F4       					JR      NZ,RND6	;
898)   21EF CB BC       		RND7:			RES     7,H             ;POSITIVE 0-0.999999	;POSITIVE 0-0.999999
899)   21F1 F1          					POP     AF	;
900)   21F2 C8          					RET     Z               ;ZERO ARGUMENT	;ZERO ARGUMENT
901)   21F3 D9          					EXX	;
902)   21F4 7B          					LD      A,E	;
903)   21F5 3D          					DEC     A	;
904)   21F6 B2          					OR      D	;
905)   21F7 D9          					EXX	;
906)   21F8 B3          					OR      E	;
907)   21F9 B2          					OR      D	;
908)   21FA C8          					RET     Z               ;ARGUMENT=1	;ARGUMENT=1
909)   21FB 06 00       					LD      B,0             ;INTEGER MARKER	;INTEGER MARKER
910)   21FD 3E 0A       					LD      A,10	;
911)   21FF CD BE 24    					CALL    FPP             ;MULTIPLY	;MULTIPLY
912)   2202 DA FD 06    					JP      C,ERROR	;
913)   2205 CD 5D 21    					CALL    SFIX	;
914)   2208 C3 28 1F    					JP      ADD1	;
919)   220B CD 4F 24    		INSTR:			CALL    EXPRSC          ;STRING TO SEARCH	;STRING TO SEARCH
920)   220E CD 01 24    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
921)   2211 CD BF 1E    					CALL    EXPRS           ;SUB-STRING	;SUB-STRING
922)   2214 C1          					POP     BC	;
923)   2215 21 00 00    					LD      HL,0	;
924)   2218 39          					ADD     HL,SP           ;HL ADDRESSES MAIN	;HL ADDRESSES MAIN
925)   2219 C5          					PUSH    BC              ;C = MAIN STRING LENGTH	;C = MAIN STRING LENGTH
926)   221A 43          					LD      B,E             ;B = SUB-STRING LENGTH	;B = SUB-STRING LENGTH
927)   221B CD 9A 24    					CALL    NXT	;
928)   221E FE 2C       					CP      ','	;
929)   2220 3E 00       					LD      A,0	;
930)   2222 20 17       					JR      NZ,INSTR1	;
931)   2224 FD 23       					INC     IY              ;SKIP COMMA	;SKIP COMMA
932)   2226 C5          					PUSH    BC              ;SAVE LENGTHS	;SAVE LENGTHS
933)   2227 E5          					PUSH    HL              ;SAVE MAIN ADDRESS	;SAVE MAIN ADDRESS
934)   2228 CD 01 24    					CALL    PUSHS	;
935)   222B CD B6 1E    					CALL    EXPRI	;
936)   222E C1          					POP     BC	;
937)   222F CD 20 24    					CALL    POPS	;
938)   2232 E1          					POP     HL              ;RESTORE MAIN ADDRESS	;RESTORE MAIN ADDRESS
939)   2233 C1          					POP     BC              ;RESTORE LENGTHS	;RESTORE LENGTHS
940)   2234 D9          					EXX	;
941)   2235 7D          					LD      A,L	;
942)   2236 D9          					EXX	;
943)   2237 B7          					OR      A	;
944)   2238 28 01       					JR      Z,INSTR1	;
945)   223A 3D          					DEC     A	;
946)   223B 11 00 60    		INSTR1:			LD      DE,ACCS         ;DE ADDRESSES SUB	;DE ADDRESSES SUB
947)   223E CD 55 22    					CALL    SEARCH	;
948)   2241 D1          					POP     DE	;
949)   2242 28 03       					JR      Z,INSTR2        ;N.B. CARRY CLEARED	;N.B. CARRY CLEARED
950)   2244 ED 62       					SBC     HL,HL	;
951)   2246 39          					ADD     HL,SP	;
952)   2247 ED 72       		INSTR2:			SBC     HL,SP	;
953)   2249 EB          					EX      DE,HL	;
954)   224A 26 00       					LD      H,0	;
955)   224C 39          					ADD     HL,SP	;
956)   224D F9          					LD      SP,HL	;
957)   224E EB          					EX      DE,HL	;
958)   224F CD 5E 24    					CALL    BRAKET	;
959)   2252 C3 96 20    					JP      COUNT1	;
969)   2255 C5          		@SEARCH:		PUSH    BC	;
970)   2256 06 00       					LD      B,0	;
971)   2258 4F          					LD      C,A	;
972)   2259 09          					ADD     HL,BC           ;NEW START ADDRESS	;NEW START ADDRESS
973)   225A C1          					POP     BC	;
974)   225B 91          					SUB     C	;
975)   225C 30 28       					JR      NC,SRCH4	;
976)   225E ED 44       					NEG	;
977)   2260 4F          					LD      C,A             ;REMAINING LENGTH	;REMAINING LENGTH
978)   2261 1A          		SRCH1:			LD      A,(DE)	;
979)   2262 C5          					PUSH    BC	;
980)   2263 06 00       					LD      B,0	;
981)   2265 ED B1       					CPIR                    ;FIND FIRST CHARACTER	;FIND FIRST CHARACTER
982)   2267 79          					LD      A,C	;
983)   2268 C1          					POP     BC	;
984)   2269 20 1B       					JR      NZ,SRCH4	;
985)   226B 4F          					LD      C,A	;
986)   226C 05          					DEC     B               ;Bug fix	;Bug fix
987)   226D B8          					CP      B               ;Bug fix	;Bug fix
988)   226E 04          					INC     B               ;Bug fix	;Bug fix
989)   226F 38 15       					JR      C,SRCH4         ;Bug fix	;Bug fix
990)   2271 C5          					PUSH    BC	;
991)   2272 D5          					PUSH    DE	;
992)   2273 E5          					PUSH    HL	;
993)   2274 05          					DEC     B	;
994)   2275 28 08       					JR      Z,SRCH3         ;FOUND !	;FOUND !
995)   2277 13          		SRCH2:			INC     DE	;
996)   2278 1A          					LD      A,(DE)	;
997)   2279 BE          					CP      (HL)	;
998)   227A 20 03       					JR      NZ,SRCH3	;
999)   227C 23          					INC     HL	;
1000)   227D 10 F8       					DJNZ    SRCH2	;
1001)   227F E1          		SRCH3:			POP     HL	;
1002)   2280 D1          					POP     DE	;
1003)   2281 C1          					POP     BC	;
1004)   2282 20 DD       					JR      NZ,SRCH1	;
1005)   2284 AF          					XOR     A               ;Z, NC	;Z, NC
1006)   2285 C9          					RET                     ;FOUND	;FOUND
1008)   2286 F6 FF       		SRCH4:			OR      0FFH            ;NZ, NC	;NZ, NC
1009)   2288 C9          					RET                     ;NOT FOUND	;NOT FOUND
1014)   2289 CD CD 1E    		CHRS:			CALL    ITEMI	;
1015)   228C D9          					EXX	;
1016)   228D 7D          					LD      A,L	;
1017)   228E 18 03       					JR      GET1	;
1022)   2290 CD 0F 40    		GETS:			CALL    OSRDCH	;
1023)   2293 37          		GET1:			SCF	;
1024)   2294 18 07       					JR      INKEY1	;
1031)   2296 CD CD 1E    		INKEYS:			CALL    ITEMI	;
1032)   2299 D9          					EXX	;
1033)   229A CD 18 40    					CALL    OSKEY	;
1034)   229D 11 00 60    		INKEY1:			LD      DE,ACCS	;
1035)   22A0 12          					LD      (DE),A	;
1036)   22A1 3E 80       					LD      A,80H	;
1037)   22A3 D0          					RET     NC	;
1038)   22A4 1C          					INC     E	;
1039)   22A5 C9          					RET	;
1044)   22A6 CD 4F 24    		MIDS:			CALL    EXPRSC	;
1045)   22A9 CD 01 24    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1046)   22AC CD B6 1E    					CALL    EXPRI	;
1047)   22AF C1          					POP     BC	;
1048)   22B0 CD 20 24    					CALL    POPS	;
1049)   22B3 D9          					EXX	;
1050)   22B4 7D          					LD      A,L	;
1051)   22B5 D9          					EXX	;
1052)   22B6 B7          					OR      A	;
1053)   22B7 28 0D       					JR      Z,MIDS1	;
1054)   22B9 3D          					DEC     A	;
1055)   22BA 6F          					LD      L,A	;
1056)   22BB 93          					SUB     E	;
1057)   22BC 1E 00       					LD      E,0	;
1058)   22BE 30 06       					JR      NC,MIDS1	;
1059)   22C0 ED 44       					NEG	;
1060)   22C2 4F          					LD      C,A	;
1061)   22C3 CD FD 22    					CALL    RIGHT1	;
1062)   22C6 CD 9A 24    		MIDS1:			CALL    NXT	;
1063)   22C9 FE 2C       					CP      ','	;
1064)   22CB FD 23       					INC     IY	;
1065)   22CD 28 0B       					JR      Z,LEFT1	;
1066)   22CF FD 2B       					DEC     IY	;
1067)   22D1 CD 5E 24    					CALL    BRAKET	;
1068)   22D4 3E 80       					LD      A,80H	;
1069)   22D6 C9          					RET	;
1075)   22D7 CD 4F 24    		LEFTS:			CALL    EXPRSC	;
1076)   22DA CD 01 24    		LEFT1:			CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1077)   22DD CD B6 1E    					CALL    EXPRI	;
1078)   22E0 C1          					POP     BC	;
1079)   22E1 CD 20 24    					CALL    POPS	;
1080)   22E4 CD 5E 24    					CALL    BRAKET	;
1081)   22E7 D9          					EXX	;
1082)   22E8 7D          					LD      A,L	;
1083)   22E9 D9          					EXX	;
1084)   22EA BB          					CP      E	;
1085)   22EB 30 02       					JR      NC,LEFT3	;
1086)   22ED 6B          					LD      L,E             ;FOR RIGHTS	;FOR RIGHTS
1087)   22EE 5F          		LEFT2:			LD      E,A	;
1088)   22EF 3E 80       		LEFT3:			LD      A,80H           ;STRING MARKER	;STRING MARKER
1089)   22F1 C9          					RET	;
1094)   22F2 CD D7 22    		RIGHTS:			CALL    LEFTS	;
1095)   22F5 D0          					RET     NC	;
1096)   22F6 1C          					INC     E	;
1097)   22F7 1D          					DEC     E	;
1098)   22F8 C8          					RET     Z	;
1099)   22F9 4B          					LD      C,E	;
1100)   22FA 7D          					LD      A,L	;
1101)   22FB 93          					SUB     E	;
1102)   22FC 6F          					LD      L,A	;
1103)   22FD 06 00       		RIGHT1:			LD      B,0	;
1104)   22FF 62          					LD      H,D	;
1105)   2300 58          					LD      E,B	;
1106)   2301 ED B0       					LDIR                    ;MOVE	;MOVE
1107)   2303 3E 80       					LD      A,80H	;
1108)   2305 C9          					RET	;
1113)   2306 CD B6 1E    		STRING:			CALL    EXPRI	;
1114)   2309 CD 52 24    					CALL    COMMA	;
1115)   230C D9          					EXX	;
1116)   230D 7D          					LD      A,L	;
1117)   230E D9          					EXX	;
1118)   230F F5          					PUSH    AF	;
1119)   2310 CD BF 1E    					CALL    EXPRS	;
1120)   2313 CD 5E 24    					CALL    BRAKET	;
1121)   2316 F1          					POP     AF	;
1122)   2317 B7          					OR      A	;
1123)   2318 28 D4       					JR      Z,LEFT2         ;N=0	;N=0
1124)   231A 3D          					DEC     A	;
1125)   231B 4F          					LD      C,A	;
1126)   231C 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
1127)   231E C8          					RET     Z	;
1128)   231F 1C          					INC     E	;
1129)   2320 1D          					DEC     E	;
1130)   2321 C8          					RET     Z               ;NULL STRING	;NULL STRING
1131)   2322 43          					LD      B,E	;
1132)   2323 62          					LD      H,D	;
1133)   2324 2E 00       					LD      L,0	;
1134)   2326 C5          		STRIN1:			PUSH    BC	;
1135)   2327 7E          		STRIN2:			LD      A,(HL)	;
1136)   2328 23          					INC     HL	;
1137)   2329 12          					LD      (DE),A	;
1138)   232A 1C          					INC     E	;
1139)   232B 3E 13       					LD      A,19	;
1140)   232D CA FD 06    					JP      Z,ERROR         ;"String too long"	;"String too long"
1141)   2330 10 F5       					DJNZ    STRIN2	;
1142)   2332 C1          					POP     BC	;
1143)   2333 0D          					DEC     C	;
1144)   2334 20 F0       					JR      NZ,STRIN1	;
1145)   2336 3E 80       					LD      A,80H	;
1146)   2338 C9          					RET	;
1154)   2339 79          		@SWAP:			LD      A,C	;
1155)   233A 48          					LD      C,B	;
1156)   233B 47          					LD      B,A	;
1157)   233C EB          					EX      DE,HL	;
1158)   233D D9          					EXX	;
1159)   233E EB          					EX      DE,HL	;
1160)   233F D9          					EXX	;
1161)   2340 C9          					RET	;
1167)   2341 7C          		@TEST:			LD      A,H	;
1168)   2342 B5          					OR      L	;
1169)   2343 D9          					EXX	;
1170)   2344 B4          					OR      H	;
1171)   2345 B5          					OR      L	;
1172)   2346 D9          					EXX	;
1173)   2347 C9          					RET	;
1180)   2348 D9          		@DECODE:		EXX	;
1181)   2349 FD 7E 00    					LD      A,(IY)	;
1182)   234C FD 23       					INC     IY	;
1183)   234E 17          					RLA	;
1184)   234F 17          					RLA	;
1185)   2350 67          					LD      H,A	;
1186)   2351 E6 C0       					AND     0C0H	;
1187)   2353 FD AE 00    					XOR     (IY)	;
1188)   2356 FD 23       					INC     IY	;
1189)   2358 6F          					LD      L,A	;
1190)   2359 7C          					LD      A,H	;
1191)   235A 17          					RLA	;
1192)   235B 17          					RLA	;
1193)   235C E6 C0       					AND     0C0H	;
1194)   235E FD AE 00    					XOR     (IY)	;
1195)   2361 FD 23       					INC     IY	;
1196)   2363 67          					LD      H,A	;
1197)   2364 D9          					EXX	;
1198)   2365 AF          					XOR     A	;
1199)   2366 4F          					LD      C,A	;
1200)   2367 67          					LD      H,A	;
1201)   2368 6F          					LD      L,A	;
1202)   2369 C9          					RET	;
1209)   236A FD 23       		HEXSTS:			INC     IY              ;SKIP TILDE	;SKIP TILDE
1210)   236C CD C6 1E    					CALL    ITEMN	;
1211)   236F CD 75 23    					CALL    HEXSTR	;
1212)   2372 3E 80       					LD      A,80H	;
1213)   2374 C9          					RET	;
1215)   2375 CD 5D 21    		@HEXSTR:		CALL    SFIX	;
1216)   2378 01 08 00    					LD      BC,8	;
1217)   237B 11 00 60    					LD      DE,ACCS	;
1218)   237E C5          		HEXST1:			PUSH    BC	;
1219)   237F 06 04       					LD      B,4	;
1220)   2381 AF          					XOR     A	;
1221)   2382 D9          		HEXST2:			EXX	;
1222)   2383 29          					ADD     HL,HL	;
1223)   2384 D9          					EXX	;
1224)   2385 ED 6A       					ADC     HL,HL	;
1225)   2387 17          					RLA	;
1226)   2388 10 F8       					DJNZ    HEXST2	;
1227)   238A C1          					POP     BC	;
1228)   238B 0D          					DEC     C	;
1229)   238C F8          					RET     M	;
1230)   238D 28 06       					JR      Z,HEXST3	;
1231)   238F B7          					OR      A	;
1232)   2390 20 03       					JR      NZ,HEXST3	;
1233)   2392 B8          					CP      B	;
1234)   2393 28 E9       					JR      Z,HEXST1	;
1235)   2395 C6 90       		HEXST3:			ADD     A,90H	;
1236)   2397 27          					DAA	;
1237)   2398 CE 40       					ADC     A,40H	;
1238)   239A 27          					DAA	;
1239)   239B 12          					LD      (DE),A	;
1240)   239C 13          					INC     DE	;
1241)   239D 47          					LD      B,A	;
1242)   239E 18 DE       					JR      HEXST1	;
1252)   23A0 CD 9A 24    		STRS:			CALL    NXT	;
1253)   23A3 FE 7E       					CP      '~'	;
1254)   23A5 28 C3       					JR      Z,HEXSTS	;
1255)   23A7 CD C6 1E    					CALL    ITEMN	;
1256)   23AA DD 21 00 62 					LD      IX,STAVAR	;
1257)   23AE DD 7E 03    					LD      A,(IX+3)	;
1258)   23B1 B7          					OR      A	;
1259)   23B2 DD 21 DA 23 					LD      IX,G9-1         ;G9 FORMAT	;G9 FORMAT
1260)   23B6 28 04       					JR      Z,STR0	;
1261)   23B8 DD 21 00 62 		@STR:			LD      IX,STAVAR	;
1262)   23BC 11 00 60    		STR0:			LD      DE,ACCS	;
1263)   23BF 3E 25       					LD      A,37	;
1264)   23C1 CD BE 24    					CALL    FPP	;
1265)   23C4 DA FD 06    					JP      C,ERROR	;
1266)   23C7 DD CB 02 46 					BIT     0,(IX+2)	;
1267)   23CB 3E 80       		STR1:			LD      A,80H           ;STRING MARKER	;STRING MARKER
1268)   23CD C8          					RET     Z	;
1269)   23CE 79          					LD      A,C	;
1270)   23CF C6 04       					ADD     A,4	;
1271)   23D1 BB          		STR2:			CP      E	;
1272)   23D2 28 F7       					JR      Z,STR1	;
1273)   23D4 EB          					EX      DE,HL		;
1274)   23D5 36 20       					LD      (HL),' '        ;TRAILING SPACE	;TRAILING SPACE
1275)   23D7 23          					INC     HL	;
1276)   23D8 EB          					EX      DE,HL	;
1277)   23D9 18 F6       					JR      STR2	;
1279)   23DB 09 00       		G9:			DEFW    9	;
1285)   23DD CD EA 23    		SCP:			CALL    SCP0	;
1286)   23E0 3E 00       		@ZERO:			LD      A,0	;
1287)   23E2 D9          					EXX	;
1288)   23E3 67          					LD      H,A	;
1289)   23E4 6F          					LD      L,A	;
1290)   23E5 D9          					EXX	;
1291)   23E6 67          					LD      H,A	;
1292)   23E7 6F          					LD      L,A	;
1293)   23E8 4F          					LD      C,A	;
1294)   23E9 C9          					RET	;
1296)   23EA 04          		SCP0:			INC     B	;
1297)   23EB 0C          					INC     C	;
1298)   23EC 05          		SCP1:			DEC     B	;
1299)   23ED 28 0A       					JR      Z,SCP2	;
1300)   23EF 0D          					DEC     C	;
1301)   23F0 28 0C       					JR      Z,SCP3	;
1302)   23F2 1A          					LD      A,(DE)	;
1303)   23F3 BE          					CP      (HL)	;
1304)   23F4 C0          					RET     NZ	;
1305)   23F5 13          					INC     DE	;
1306)   23F6 23          					INC     HL	;
1307)   23F7 18 F3       					JR      SCP1	;
1308)   23F9 B7          		SCP2:			OR      A	;
1309)   23FA 0D          						DEC     C	;
1310)   23FB C8          					RET     Z	;
1311)   23FC 37          					SCF	;
1312)   23FD C9          					RET	;
1313)   23FE B7          		SCP3:			OR      A	;
1314)   23FF 0C          					INC     C	;
1315)   2400 C9          					RET	;
1323)   2401 CD E1 15    		@PUSHS:			CALL    CHECK	;
1324)   2404 DD E1       					POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1325)   2406 B7          					OR      A               ;CLEAR CARRY	;CLEAR CARRY
1326)   2407 21 00 60    					LD      HL,ACCS	;
1327)   240A 54          					LD      D,H	;
1328)   240B 45          					LD      B,L             ;B=0	;B=0
1329)   240C ED 52       					SBC     HL,DE	;
1330)   240E 39          					ADD     HL,SP	;
1331)   240F F9          					LD      SP,HL	;
1332)   2410 57          					LD      D,A	;
1333)   2411 D5          					PUSH    DE	;
1334)   2412 28 0A       					JR      Z,PUSHS1        ;ZERO LENGTH	;ZERO LENGTH
1335)   2414 4B          					LD      C,E	;
1336)   2415 11 00 60    					LD      DE,ACCS	;
1337)   2418 EB          					EX      DE,HL	;
1338)   2419 ED B0       					LDIR                    ;COPY TO STACK	;COPY TO STACK
1339)   241B CD E1 15    					CALL    CHECK	;
1340)   241E DD E9       		PUSHS1:			JP      (IX)            ;"RETURN"	;"RETURN"
1348)   2420 DD E1       		@POPS:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1349)   2422 21 00 00    					LD      HL,0	;
1350)   2425 44          					LD      B,H             ;B=0	;B=0
1351)   2426 39          					ADD     HL,SP	;
1352)   2427 11 00 60    					LD      DE,ACCS	;
1353)   242A 0C          					INC     C	;
1354)   242B 0D          					DEC     C	;
1355)   242C 28 02       					JR      Z,POPS1         ;ZERO LENGTH	;ZERO LENGTH
1356)   242E ED B0       					LDIR                    ;COPY FROM STACK	;COPY FROM STACK
1357)   2430 F9          		POPS1:			LD      SP,HL	;
1358)   2431 DD E9       					JP      (IX)            ;"RETURN"	;"RETURN"
1360)   2433 FD 7E 00    		HEXDIG:			LD      A,(IY)	;
1361)   2436 FE 30       					CP      '0'	;
1362)   2438 D8          					RET     C	;
1363)   2439 FE 3A       					CP      '9'+1	;
1364)   243B 3F          					CCF	;
1365)   243C D0          					RET     NC	;
1366)   243D FE 41       					CP      'A'	;
1367)   243F D8          					RET     C	;
1368)   2440 D6 37       					SUB     'A'-10	;
1369)   2442 FE 10       					CP      16	;
1370)   2444 3F          					CCF	;
1371)   2445 C9          					RET	;
1373)   2446 FE 3E       		RELOP?:			CP      '>'	;
1374)   2448 D0          					RET     NC	;
1375)   2449 FE 3D       					CP      '='	;
1376)   244B D0          					RET     NC	;
1377)   244C FE 3C       					CP      '<'	;
1378)   244E C9          					RET	;
1380)   244F CD BF 1E    		EXPRSC:			CALL    EXPRS	;
1381)   2452 CD 9A 24    		@COMMA:			CALL    NXT	;
1382)   2455 FD 23       					INC     IY	;
1383)   2457 FE 2C       					CP      ','	;
1384)   2459 C8          					RET     Z	;
1385)   245A 3E 05       					LD      A,5	;
1386)   245C 18 0A       					JR      ERROR1          ;"Missing ,"	;"Missing ,"
1388)   245E CD 9A 24    		@BRAKET:		CALL    NXT	;
1389)   2461 FD 23       					INC     IY	;
1390)   2463 FE 29       					CP      ')'	;
1391)   2465 C8          					RET     Z	;
1392)   2466 3E 1B       					LD      A,27	;
1393)   2468 C3 FD 06    		ERROR1:			JP      ERROR           ;"Missing )"	;"Missing )"
1395)   246B FD 23       		SAVE:			INC     IY	;
1396)   246D 08          		SAVE1:			EX      AF,AF'	;
1397)   246E FA DB 1E    					JP      M,TYPE	;
1398)   2471 08          					EX      AF,AF'	;
1399)   2472 E3          					EX      (SP),HL	;
1400)   2473 D9          					EXX	;
1401)   2474 E5          					PUSH    HL	;
1402)   2475 D9          					EXX	;
1403)   2476 F5          					PUSH    AF	;
1404)   2477 C5          					PUSH    BC	;
1405)   2478 E9          					JP      (HL)	;
1407)   2479 08          		DOIT:			EX      AF,AF'	;
1408)   247A FA DB 1E    					JP      M,TYPE	;
1409)   247D D9          					EXX	;
1410)   247E C1          					POP     BC              ;RETURN ADDRESS	;RETURN ADDRESS
1411)   247F D9          					EXX	;
1412)   2480 79          					LD      A,C	;
1413)   2481 C1          					POP     BC	;
1414)   2482 47          					LD      B,A	;
1415)   2483 F1          					POP     AF              ;OPERATOR	;OPERATOR
1416)   2484 D9          					EXX	;
1417)   2485 EB          					EX      DE,HL	;
1418)   2486 E1          					POP     HL	;
1419)   2487 D9          					EXX	;
1420)   2488 EB          					EX      DE,HL	;
1421)   2489 E1          					POP     HL	;
1422)   248A D9          					EXX	;
1423)   248B C5          					PUSH    BC	;
1424)   248C D9          					EXX	;
1425)   248D E6 0F       					AND     0FH	;
1426)   248F CD BE 24    					CALL    FPP	;
1427)   2492 38 D4       					JR      C,ERROR1	;
1428)   2494 AF          					XOR     A	;
1429)   2495 08          					EX      AF,AF'          ;TYPE	;TYPE
1430)   2496 FD 7E 00    					LD      A,(IY)	;
1431)   2499 C9          					RET	;
1433)   249A FD 7E 00    		@NXT:			LD      A,(IY)	;
1434)   249D FE 20       					CP      ' '	;
1435)   249F C0          					RET     NZ	;
1436)   24A0 FD 23       					INC     IY	;
1437)   24A2 C3 9A 24    					JP      NXT	;
1439)   24A5 E5          		DISPT2:			PUSH    HL	;
1440)   24A6 21 9A 1D    					LD      HL,SOPTBL	;
1441)   24A9 18 06       					JR      DISPT0	;
1443)   24AB E5          		DISPAT:			PUSH    HL	;
1444)   24AC D6 8D       					SUB     FUNTOK	;
1445)   24AE 21 28 1D    					LD      HL,FUNTBL	;
1446)   24B1 C5          		DISPT0:			PUSH    BC	;
1447)   24B2 87          					ADD     A,A	;
1448)   24B3 4F          					LD      C,A	;
1449)   24B4 06 00       					LD      B,0	;
1450)   24B6 09          					ADD     HL,BC	;
1451)   24B7 7E          					LD      A,(HL)	;
1452)   24B8 23          					INC     HL	;
1453)   24B9 66          					LD      H,(HL)	;
1454)   24BA 6F          					LD      L,A	;
1455)   24BB C1          					POP     BC	;
1456)   24BC E3          					EX      (SP),HL	;
1457)   24BD C9          					RET                     ;OFF TO ROUTINE	;OFF TO ROUTINE
 36)   24BE FD E5       		@FPP:			PUSH    IY              ;Save IY	;Save IY
 37)   24C0 FD 21 00 00 		        		LD      IY,0	;
 38)   24C4 FD 39       		        		ADD     IY,SP           ;Save SP in IY	;Save SP in IY
 39)   24C6 CD D5 24    		        		CALL    OP              ;Perform operation	;Perform operation
 40)   24C9 BF          		        		CP      A               ;Good return (Z, NC)	;Good return (Z, NC)
 41)   24CA FD E1       		EXIT:			POP     IY              ;Restore IY	;Restore IY
 42)   24CC C9          		        		RET                     ;Return to caller	;Return to caller
 46)   24CD 3E 01       		BAD:			LD      A,BADOP         ;"Bad operation code"	;"Bad operation code"
 47)   24CF FD F9       		ERROR:			LD      SP,IY           ;Restore SP from IY	;Restore SP from IY
 48)   24D1 B7          		        		OR      A               ;Set NZ	;Set NZ
 49)   24D2 37          		        		SCF                     ;Set C	;Set C
 50)   24D3 18 F5       		        		JR      EXIT	;
 54)   24D5 FE 2A       		OP:			CP      (RTABLE-DTABLE)/2	;
 55)   24D7 30 F4       		        		JR      NC,BAD	;
 56)   24D9 FE 10       		        		CP      (FTABLE-DTABLE)/2	;
 57)   24DB 30 07       		        		JR      NC,DISPAT	;
 58)   24DD 08          		        		EX      AF,AF'	;
 59)   24DE 78          		        		LD      A,B	;
 60)   24DF B1          		        		OR      C               ;Both integer?	;Both integer?
 61)   24E0 C4 5F 2E    		        		CALL    NZ,FLOATA       ;No, so float both	;No, so float both
 62)   24E3 08          		        		EX      AF,AF'	;
 63)   24E4 E5          		DISPAT:			PUSH    HL	;
 64)   24E5 21 F5 24    		        		LD      HL,DTABLE	;
 65)   24E8 C5          		        		PUSH    BC	;
 66)   24E9 87          		        		ADD     A,A             ;A = op-code * 2	;A = op-code * 2
 67)   24EA 4F          		        		LD      C,A	;
 68)   24EB 06 00       		        		LD      B,0             ;BC = op-code * 2	;BC = op-code * 2
 69)   24ED 09          		        		ADD     HL,BC	;
 70)   24EE 7E          		        		LD      A,(HL)          ;Get low byte	;Get low byte
 71)   24EF 23          		        		INC     HL	;
 72)   24F0 66          		        		LD      H,(HL)          ;Get high byte	;Get high byte
 73)   24F1 6F          		        		LD      L,A	;
 74)   24F2 C1          		        		POP     BC	;
 75)   24F3 E3          		        		EX      (SP),HL	;
 76)   24F4 C9          		        		RET                     ;Off to routine	;Off to routine
 80)   24F5 6C 25       		DTABLE:			DEFW    IAND            ;AND (INTEGER)	;AND (INTEGER)
 81)   24F7 CF 25       		        		DEFW    IBDIV           ;DIV	;DIV
 82)   24F9 7E 25       		        		DEFW    IEOR            ;EOR	;EOR
 83)   24FB A2 25       		        		DEFW    IMOD            ;MOD	;MOD
 84)   24FD 90 25       		        		DEFW    IOR             ;OR	;OR
 85)   24FF FE 27       		        		DEFW    ILE             ;<=	;<=
 86)   2501 0B 28       		        		DEFW    INE             ;<>	;<>
 87)   2503 F3 27       		        		DEFW    IGE             ;>=	;>=
 88)   2505 DC 27       		        		DEFW    ILT             ;<	;<
 89)   2507 16 28       		        		DEFW    IEQ             ;=	;=
 90)   2509 99 26       		        		DEFW    IMUL            ;*	;*
 91)   250B F2 25       		        		DEFW    IADD            ;+	;+
 92)   250D E7 27       		        		DEFW    IGT             ;>	;>
 93)   250F DC 25       		        		DEFW    ISUB            ;-	;-
 94)   2511 37 27       		        		DEFW    IPOW            ;^	;^
 95)   2513 51 26       		        		DEFW    IDIV            ;/	;/
 97)   2515 25 28       		FTABLE:			DEFW    ABS             ;ABS	;ABS
 98)   2517 81 2B       		        		DEFW    ACS             ;ACS	;ACS
 99)   2519 DD 2A       		        		DEFW    ASN             ;ASN	;ASN
100)   251B 02 2B       		        		DEFW    ATN             ;ATN	;ATN
101)   251D 1B 29       		        		DEFW    COS             ;COS	;COS
102)   251F 4F 28       		        		DEFW    DEG             ;DEG	;DEG
103)   2521 C0 29       		        		DEFW    EXP             ;EXP	;EXP
104)   2523 95 28       		        		DEFW    INT             ;INT	;INT
105)   2525 4B 2A       		        		DEFW    LN              ;LN	;LN
106)   2527 CB 2A       		        		DEFW    LOG             ;LOG	;LOG
107)   2529 30 28       		        		DEFW    NOTK            ;NOT	;NOT
108)   252B 57 28       		        		DEFW    RAD             ;RAD	;RAD
109)   252D 6D 28       		        		DEFW    SGN             ;SGN	;SGN
110)   252F 26 29       		        		DEFW    SIN             ;SIN	;SIN
111)   2531 AB 28       		        		DEFW    SQR             ;SQR	;SQR
112)   2533 FE 28       		        		DEFW    TAN             ;TAN	;TAN
114)   2535 DB 2E       				        DEFW    ZERO            ;ZERO	;ZERO
115)   2537 9F 29       		        		DEFW    FONE            ;FONE	;FONE
116)   2539 1A 28       		        		DEFW    TRUE            ;TRUE	;TRUE
117)   253B 43 28       		        		DEFW    PI              ;PI	;PI
119)   253D 7D 28       				        DEFW    VAL             ;VAL	;VAL
120)   253F 89 2B       		        		DEFW    STR             ;STR$	;STR$
122)   2541 B0 2D       		        		DEFW    SFIX            ;FIX	;FIX
123)   2543 6C 2E       		        		DEFW    SFLOAT          ;FLOAT	;FLOAT
125)   2545 B1 2E       				        DEFW    FTEST           ;TEST	;TEST
126)   2547 C2 2E       		        		DEFW    FCOMP           ;COMPARE	;COMPARE
128)   2549 69 25       		RTABLE:			DEFW    FAND            ;AND (FLOATING-POINT)	;AND (FLOATING-POINT)
129)   254B CC 25       		        		DEFW    FBDIV           ;DIV	;DIV
130)   254D 7B 25       		        		DEFW    FEOR            ;EOR	;EOR
131)   254F 9F 25       		        		DEFW    FMOD            ;MOD	;MOD
132)   2551 8D 25       		        		DEFW    FOR             ;OR	;OR
133)   2553 F9 27       		        		DEFW    FLE             ;<= 	;<=
134)   2555 06 28       		        		DEFW    FNE             ;<>	;<>
135)   2557 EE 27       		        		DEFW    FGE             ;>=	;>=
136)   2559 D7 27       		        		DEFW    FLT             ;<	;<
137)   255B 11 28       		        		DEFW    FEQ             ;=	;=
138)   255D E7 26       		        		DEFW    FMUL            ;*	;*
139)   255F FC 25       		        		DEFW    FADD            ;+	;+
140)   2561 E2 27       		        		DEFW    FGT             ;>	;>
141)   2563 E6 25       		        		DEFW    FSUB            ;-	;-
142)   2565 AD 27       		        		DEFW    FPOW            ;^	;^
143)   2567 54 26       		        		DEFW    FDIV            ;/	;/
156)   2569 CD A7 2D    		FAND:			CALL    FIX2	;
157)   256C 7C          		IAND:			LD      A,H	;
158)   256D A2          		        		AND     D	;
159)   256E 67          		        		LD      H,A	;
160)   256F 7D          		        		LD      A,L	;
161)   2570 A3          		        		AND     E	;
162)   2571 6F          		        		LD      L,A	;
163)   2572 D9          		        		EXX	;
164)   2573 7C          		        		LD      A,H	;
165)   2574 A2          		        		AND     D	;
166)   2575 67          		        		LD      H,A	;
167)   2576 7D          		        		LD      A,L	;
168)   2577 A3          		        		AND     E	;
169)   2578 6F          		        		LD      L,A	;
170)   2579 D9          		        		EXX	;
171)   257A C9          		        		RET	;
176)   257B CD A7 2D    		FEOR:			CALL    FIX2	;
177)   257E 7C          		IEOR:			LD      A,H	;
178)   257F AA          		        		XOR     D	;
179)   2580 67          		        		LD      H,A	;
180)   2581 7D          		        		LD      A,L	;
181)   2582 AB          		        		XOR     E	;
182)   2583 6F          		        		LD      L,A	;
183)   2584 D9          		        		EXX	;
184)   2585 7C          		        		LD      A,H	;
185)   2586 AA          		        		XOR     D	;
186)   2587 67          		        		LD      H,A	;
187)   2588 7D          		        		LD      A,L	;
188)   2589 AB          		        		XOR     E	;
189)   258A 6F          		        		LD      L,A	;
190)   258B D9          		        		EXX	;
191)   258C C9          		        		RET	;
196)   258D CD A7 2D    		FOR:			CALL    FIX2	;
197)   2590 7C          		IOR:			LD      A,H	;
198)   2591 B2          		        		OR      D	;
199)   2592 67          		        		LD      H,A	;
200)   2593 7D          		        		LD      A,L	;
201)   2594 B3          		        		OR      E	;
202)   2595 6F          		        		LD      L,A	;
203)   2596 D9          		        		EXX	;
204)   2597 7C          		        		LD      A,H	;
205)   2598 B2          		        		OR      D	;
206)   2599 67          		        		LD      H,A	;
207)   259A 7D          		        		LD      A,L	;
208)   259B B3          		        		OR      E	;
209)   259C 6F          		        		LD      L,A	;
210)   259D D9          		        		EXX	;
211)   259E C9          		        		RET	;
216)   259F CD A7 2D    		FMOD:			CALL    FIX2	;
217)   25A2 7C          		IMOD:			LD      A,H	;
218)   25A3 AA          		        		XOR     D               ;DIV RESULT SIGN	;DIV RESULT SIGN
219)   25A4 CB 7C       		        		BIT     7,H	;
220)   25A6 08          		        		EX      AF,AF'	;
221)   25A7 CB 7C       		        		BIT     7,H	;
222)   25A9 C4 BF 2D    		        		CALL    NZ,NEGATE       ;MAKE ARGUMENTS +VE	;MAKE ARGUMENTS +VE
223)   25AC CD 96 2E    		        		CALL    SWAP	;
224)   25AF CB 7C       		        		BIT     7,H	;
225)   25B1 C4 BF 2D    		        		CALL    NZ,NEGATE	;
226)   25B4 44          		        		LD      B,H	;
227)   25B5 4D          		        		LD      C,L	;
228)   25B6 21 00 00    		        		LD      HL,0	;
229)   25B9 D9          		        		EXX	;
230)   25BA 44          		        		LD      B,H	;
231)   25BB 4D          		        		LD      C,L	;
232)   25BC 21 00 00    		        		LD      HL,0	;
233)   25BF 3E DF       		        		LD      A,-33	;
234)   25C1 CD EB 2F    		        		CALL    DIVA            ;DIVIDE	;DIVIDE
235)   25C4 D9          		        		EXX	;
236)   25C5 0E 00       		        		LD      C,0             ;INTEGER MARKER	;INTEGER MARKER
237)   25C7 08          		        		EX      AF,AF'	;
238)   25C8 C8          		        		RET     Z	;
239)   25C9 C3 BF 2D    		        		JP      NEGATE	;
243)   25CC CD A7 2D    		FBDIV:			CALL    FIX2	;
244)   25CF CD A2 25    		IBDIV:			CALL    IMOD	;
245)   25D2 B7          		        		OR      A	;
246)   25D3 CD 96 2E    		        		CALL    SWAP	;
247)   25D6 0E 00       		        		LD      C,0	;
248)   25D8 F0          		        		RET     P	;
249)   25D9 C3 BF 2D    		        		JP      NEGATE	;
254)   25DC CD 1E 2F    		ISUB:			CALL    SUB	;
255)   25DF E0          		        		RET     PO	;
256)   25E0 CD 18 2F    		        		CALL    ADD	;
257)   25E3 CD 63 2E    		        		CALL    FLOAT2	;
258)   25E6 7A          		FSUB:			LD      A,D	;
259)   25E7 EE 80       		        		XOR     80H             ;CHANGE SIGN THEN ADD	;CHANGE SIGN THEN ADD
260)   25E9 57          		        		LD      D,A	;
261)   25EA 18 10       		        		JR      FADD	;
265)   25EC 7C          		RSUB:			LD      A,H	;
266)   25ED EE 80       		        		XOR     80H	;
267)   25EF 67          		        		LD      H,A	;
268)   25F0 18 0A       		        		JR      FADD	;
273)   25F2 CD 18 2F    		IADD:			CALL    ADD	;
274)   25F5 E0          		        		RET     PO	;
275)   25F6 CD 1E 2F    		        		CALL    SUB	;
276)   25F9 CD 63 2E    		        		CALL    FLOAT2	;
277)   25FC 05          		FADD:			DEC     B	;
278)   25FD 04          		        		INC     B	;
279)   25FE C8          		        		RET     Z               ;ARG 2 ZERO	;ARG 2 ZERO
280)   25FF 0D          		        		DEC     C	;
281)   2600 0C          		        		INC     C	;
282)   2601 CA 96 2E    		        		JP      Z,SWAP          ;ARG 1 ZERO	;ARG 1 ZERO
283)   2604 D9          		        		EXX	;
284)   2605 01 00 00    		        		LD      BC,0            ;INITIALISE	;INITIALISE
285)   2608 D9          		        		EXX	;
286)   2609 7C          		        		LD      A,H	;
287)   260A AA          		        		XOR     D               ;XOR SIGNS	;XOR SIGNS
288)   260B F5          		        		PUSH    AF	;
289)   260C 78          		        		LD      A,B	;
290)   260D B9          		        		CP      C               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
291)   260E DC 96 2E    		        		CALL    C,SWAP          ;MAKE DED'E'B LARGEST	;MAKE DED'E'B LARGEST
292)   2611 78          		        		LD      A,B	;
293)   2612 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
294)   2614 C4 97 2D    		        		CALL    NZ,FIX          ;ALIGN	;ALIGN
295)   2617 F1          		        		POP     AF	;
296)   2618 7A          		        		LD      A,D             ;SIGN OF LARGER	;SIGN OF LARGER
297)   2619 CB FA       		        		SET     7,D             ;IMPLIED 1	;IMPLIED 1
298)   261B FA 28 26    		        		JP      M,FADD3         ;SIGNS DIFFERENT	;SIGNS DIFFERENT
299)   261E CD 18 2F    		        		CALL    ADD             ;HLH'L'=HLH'L'+DED'E'	;HLH'L'=HLH'L'+DED'E'
300)   2621 DC 9E 2E    		        		CALL    C,DIV2          ;NORMALISE	;NORMALISE
301)   2624 CB FC       		        		SET     7,H	;
302)   2626 18 0A       		        		JR      FADD4	;
304)   2628 CD 1E 2F    		FADD3:			CALL    SUB             ;HLH'L'=HLH'L'-DED'E'	;HLH'L'=HLH'L'-DED'E'
305)   262B DC D3 2D    		        		CALL    C,NEG           ;NEGATE HLH'L'B'C'	;NEGATE HLH'L'B'C'
306)   262E CD 40 2E    		        		CALL    FLO48	;
307)   2631 2F          		        		CPL                     ;CHANGE RESULT SIGN	;CHANGE RESULT SIGN
308)   2632 D9          		FADD4:			EXX	;
309)   2633 EB          		        		EX      DE,HL	;
310)   2634 21 00 80    		        		LD      HL,8000H	;
311)   2637 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
312)   2638 ED 42       		        		SBC     HL,BC	;
313)   263A EB          		        		EX      DE,HL	;
314)   263B D9          		        		EXX	;
315)   263C CC 90 2E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
316)   263F DC 82 2E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
317)   2642 DC AA 2E    		        		CALL    C,INCC	;
318)   2645 CB BC       		        		RES     7,H	;
319)   2647 0D          		        		DEC     C	;
320)   2648 0C          		        		INC     C	;
321)   2649 CA DB 2E    		        		JP      Z,ZERO	;
322)   264C B7          		        		OR      A               ;RESULT SIGNQ	;RESULT SIGNQ
323)   264D F0          		        		RET     P               ;POSITIVE	;POSITIVE
324)   264E CB FC       		        		SET     7,H             ;NEGATIVE	;NEGATIVE
325)   2650 C9          		        		RET	;
330)   2651 CD 63 2E    		IDIV:			CALL    FLOAT2	;
331)   2654 05          		FDIV:			DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
332)   2655 04          		        		INC     B	;
333)   2656 3E 12       		        		LD      A,DIVBY0	;
334)   2658 CA CF 24    		        		JP      Z,ERROR         ;"Division by zero"	;"Division by zero"
335)   265B 0D          		        		DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
336)   265C 0C          		        		INC     C	;
337)   265D C8          		        		RET     Z	;
338)   265E 7C          		        		LD      A,H	;
339)   265F AA          		        		XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
340)   2660 08          		        		EX      AF,AF'          ;SAVE SIGN	;SAVE SIGN
341)   2661 CB FA       		        		SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
342)   2663 CB FC       		        		SET     7,H	;
343)   2665 C5          		        		PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
344)   2666 42          		        		LD      B,D             ;LOAD REGISTERS	;LOAD REGISTERS
345)   2667 4B          		        		LD      C,E	;
346)   2668 11 00 00    		        		LD      DE,0	;
347)   266B D9          		        		EXX	;
348)   266C 42          		        		LD      B,D	;
349)   266D 4B          		        		LD      C,E	;
350)   266E 11 00 00    		        		LD      DE,0	;
351)   2671 3E E0       		        		LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
352)   2673 CD EB 2F    		        		CALL    DIVA            ;DIVIDE	;DIVIDE
353)   2676 D9          		        		EXX	;
354)   2677 CB 7A       		        		BIT     7,D	;
355)   2679 D9          		        		EXX	;
356)   267A CC 06 30    		        		CALL    Z,DIVB          ;NORMALISE & INC A	;NORMALISE & INC A
357)   267D EB          		        		EX      DE,HL	;
358)   267E D9          		        		EXX	;
359)   267F CB 38       		        		SRL     B               ;DIVISOR/2	;DIVISOR/2
360)   2681 CB 19       		        		RR      C	;
361)   2683 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
362)   2684 ED 42       		        		SBC     HL,BC           ;REMAINDER-DIVISOR/2	;REMAINDER-DIVISOR/2
363)   2686 3F          		        		CCF	;
364)   2687 EB          		        		EX      DE,HL           ;RESULT IN HLH'L'	;RESULT IN HLH'L'
365)   2688 CC 90 2E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
366)   268B DC 82 2E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
367)   268E C1          		        		POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
368)   268F DC AA 2E    		        		CALL    C,INCC	;
369)   2692 1F          		        		RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
370)   2693 79          		        		LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
371)   2694 98          		        		SBC     A,B	;
372)   2695 3F          		        		CCF	;
373)   2696 C3 20 27    		        		JP      CHKOVF	;
377)   2699 7C          		IMUL:			LD      A,H	;
378)   269A AA          		        		XOR     D	;
379)   269B 08          		        		EX      AF,AF'          ;SAVE RESULT SIGN	;SAVE RESULT SIGN
380)   269C CB 7C       		        		BIT     7,H	;
381)   269E C4 BF 2D    		        		CALL    NZ,NEGATE	;
382)   26A1 CD 96 2E    		        		CALL    SWAP	;
383)   26A4 CB 7C       		        		BIT     7,H	;
384)   26A6 C4 BF 2D    		        		CALL    NZ,NEGATE	;
385)   26A9 44          		        		LD      B,H	;
386)   26AA 4D          		        		LD      C,L	;
387)   26AB 21 00 00    		        		LD      HL,0	;
388)   26AE D9          		        		EXX	;
389)   26AF 44          		        		LD      B,H	;
390)   26B0 4D          		        		LD      C,L	;
391)   26B1 21 00 00    		        		LD      HL,0	;
392)   26B4 3E DF       		        		LD      A,-33	;
393)   26B6 CD 19 30    		        		CALL    MULA            ;MULTIPLY	;MULTIPLY
394)   26B9 D9          		        		EXX	;
395)   26BA 0E BF       		        		LD      C,191           ;PRESET EXPONENT	;PRESET EXPONENT
396)   26BC CD BB 2E    		        		CALL    TEST            ;TEST RANGE	;TEST RANGE
397)   26BF 20 0D       		        		JR      NZ,IMUL1        ;TOO BIG	;TOO BIG
398)   26C1 CB 7A       		        		BIT     7,D	;
399)   26C3 20 09       		        		JR      NZ,IMUL1	;
400)   26C5 CD 96 2E    		        		CALL    SWAP	;
401)   26C8 4A          		        		LD      C,D             ;INTEGER MARKER	;INTEGER MARKER
402)   26C9 08          		        		EX      AF,AF'	;
403)   26CA F0          		        		RET     P	;
404)   26CB C3 BF 2D    		        		JP      NEGATE	;
406)   26CE 0D          		IMUL1:			DEC     C	;
407)   26CF D9          		        		EXX	;
408)   26D0 CB 23       		        		SLA     E	;
409)   26D2 CB 12       		        		RL      D	;
410)   26D4 D9          		        		EXX	;
411)   26D5 CB 13       		        		RL      E	;
412)   26D7 CB 12       		        		RL      D	;
413)   26D9 D9          		        		EXX	;
414)   26DA ED 6A       		        		ADC     HL,HL	;
415)   26DC D9          		        		EXX	;
416)   26DD ED 6A       		        		ADC     HL,HL	;
417)   26DF F2 CE 26    		        		JP      P,IMUL1         ;NORMALISE	;NORMALISE
418)   26E2 08          		        		EX      AF,AF'	;
419)   26E3 F8          		        		RET     M	;
420)   26E4 CB BC       		        		RES     7,H             ;POSITIVE	;POSITIVE
421)   26E6 C9          		        		RET	;
425)   26E7 05          		FMUL:			DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
426)   26E8 04          		        		INC     B	;
427)   26E9 CA DB 2E    		        		JP      Z,ZERO	;
428)   26EC 0D          		        		DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
429)   26ED 0C          		        		INC     C	;
430)   26EE C8          		        		RET     Z	;
431)   26EF 7C          		        		LD      A,H	;
432)   26F0 AA          		        		XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
433)   26F1 08          		        		EX      AF,AF'	;
434)   26F2 CB FA       		        		SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
435)   26F4 CB FC       		        		SET     7,H	;
436)   26F6 C5          		        		PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
437)   26F7 44          		        		LD      B,H             ;LOAD REGISTERS	;LOAD REGISTERS
438)   26F8 4D          		        		LD      C,L	;
439)   26F9 21 00 00    		        		LD      HL,0	;
440)   26FC D9          		        		EXX	;
441)   26FD 44          		        		LD      B,H	;
442)   26FE 4D          		        		LD      C,L	;
443)   26FF 21 00 00    		        		LD      HL,0	;
444)   2702 3E E0       		        		LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
445)   2704 CD 19 30    		        		CALL    MULA            ;MULTIPLY	;MULTIPLY
446)   2707 DC 2D 30    		        		CALL    C,MULB          ;NORMALISE & INC A	;NORMALISE & INC A
447)   270A D9          		        		EXX	;
448)   270B E5          		        		PUSH    HL	;
449)   270C 21 00 80    		        		LD      HL,8000H	;
450)   270F B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
451)   2710 ED 52       		        		SBC     HL,DE	;
452)   2712 E1          		        		POP     HL	;
453)   2713 CC 90 2E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
454)   2716 DC 82 2E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
455)   2719 C1          		        		POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
456)   271A DC AA 2E    		        		CALL    C,INCC	;
457)   271D 1F          		        		RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
458)   271E 79          		        		LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
459)   271F 88          		        		ADC     A,B	;
460)   2720 38 05       		CHKOVF:			JR      C,CHKO1	;
461)   2722 F2 DB 2E    		        		JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
462)   2725 18 03       		        		JR      CHKO2	;
463)   2727 FA AC 2E    		CHKO1:			JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
464)   272A C6 80       		CHKO2:			ADD     A,80H	;
465)   272C 4F          		        		LD      C,A	;
466)   272D CA DB 2E    		        		JP      Z,ZERO	;
467)   2730 08          		        		EX      AF,AF'          ;RESTORE SIGN BIT	;RESTORE SIGN BIT
468)   2731 CB BC       		        		RES     7,H	;
469)   2733 F0          		        		RET     P	;
470)   2734 CB FC       		        		SET     7,H	;
471)   2736 C9          		        		RET	;
475)   2737 CD 96 2E    		IPOW:			CALL    SWAP	;
476)   273A CB 7C       		        		BIT     7,H	;
477)   273C F5          		        		PUSH    AF              ;SAVE SIGN	;SAVE SIGN
478)   273D C4 BF 2D    		        		CALL    NZ,NEGATE	;
479)   2740 48          		IPOW0:			LD      C,B	;
480)   2741 06 20       		        		LD      B,32            ;LOOP COUNTER	;LOOP COUNTER
481)   2743 CD 35 2F    		IPOW1:			CALL    X2	;
482)   2746 38 08       		        		JR      C,IPOW2	;
483)   2748 10 F9       		        		DJNZ    IPOW1	;
484)   274A F1          		        		POP     AF	;
485)   274B D9          		        		EXX	;
486)   274C 2C          		        		INC     L               ;RESULT=1	;RESULT=1
487)   274D D9          		        		EXX	;
488)   274E 4C          		        		LD      C,H	;
489)   274F C9          		        		RET	;
491)   2750 F1          		IPOW2:			POP     AF	;
492)   2751 C5          		        		PUSH    BC	;
493)   2752 EB          		        		EX      DE,HL	;
494)   2753 E5          		        		PUSH    HL	;
495)   2754 D9          		        		EXX	;
496)   2755 EB          		        		EX      DE,HL	;
497)   2756 E5          		        		PUSH    HL	;
498)   2757 D9          		        		EXX	;
499)   2758 DD 21 00 00 		        		LD      IX,0	;
500)   275C DD 39       		        		ADD     IX,SP	;
501)   275E 28 42       		        		JR      Z,IPOW4	;
502)   2760 C5          		        		PUSH    BC	;
503)   2761 D9          		        		EXX	;
504)   2762 D5          		        		PUSH    DE	;
505)   2763 D9          		        		EXX	;
506)   2764 D5          		        		PUSH    DE	;
507)   2765 CD 6C 2E    		        		CALL    SFLOAT	;
508)   2768 CD 37 2A    		        		CALL    RECIP	;
509)   276B DD 71 04    		        		LD      (IX+4),C	;
510)   276E D9          		        		EXX	;
511)   276F DD 75 00    		        		LD      (IX+0),L	;
512)   2772 DD 74 01    		        		LD      (IX+1),H	;
513)   2775 D9          		        		EXX	;
514)   2776 DD 75 02    		        		LD      (IX+2),L	;
515)   2779 DD 74 03    		        		LD      (IX+3),H	;
516)   277C 18 1D       		        		JR      IPOW5	;
518)   277E C5          		IPOW3:			PUSH    BC	;
519)   277F D9          		        		EXX	;
520)   2780 CB 23       		        		SLA     E	;
521)   2782 CB 12       		        		RL      D	;
522)   2784 D5          		        		PUSH    DE	;
523)   2785 D9          		        		EXX	;
524)   2786 CB 13       		        		RL      E	;
525)   2788 CB 12       		        		RL      D	;
526)   278A D5          		        		PUSH    DE	;
527)   278B 3E 0A       		        		LD      A,'*' AND 0FH	;
528)   278D F5          		        		PUSH    AF	;
529)   278E CD 47 2F    		        		CALL    COPY	;
530)   2791 CD D5 24    		        		CALL    OP              ;SQUARE	;SQUARE
531)   2794 F1          		        		POP     AF	;
532)   2795 CD DB 2C    		        		CALL    DLOAD5	;
533)   2798 DC D5 24    		        		CALL    C,OP            ;MULTIPLY BY X	;MULTIPLY BY X
534)   279B D1          		IPOW5:			POP     DE	;
535)   279C D9          		        		EXX	;
536)   279D D1          		        		POP     DE	;
537)   279E D9          		        		EXX	;
538)   279F 79          		        		LD      A,C	;
539)   27A0 C1          		        		POP     BC	;
540)   27A1 4F          		        		LD      C,A	;
541)   27A2 10 DA       		IPOW4:			DJNZ    IPOW3	;
542)   27A4 F1          		        		POP     AF	;
543)   27A5 F1          		        		POP     AF	;
544)   27A6 F1          		        		POP     AF	;
545)   27A7 C9          		        		RET	;
547)   27A8 F1          		FPOW0:			POP     AF	;
548)   27A9 F1          		        		POP     AF	;
549)   27AA F1          		        		POP     AF	;
550)   27AB 18 93       		        		JR      IPOW0	;
554)   27AD CB 7A       		FPOW:			BIT     7,D	;
555)   27AF F5          		        		PUSH    AF	;
556)   27B0 CD 96 2E    		        		CALL    SWAP	;
557)   27B3 CD 55 2F    		        		CALL    PUSH5	;
558)   27B6 0D          		        		DEC     C	;
559)   27B7 0C          		        		INC     C	;
560)   27B8 28 EE       		        		JR      Z,FPOW0	;
561)   27BA 3E 9E       		        		LD      A,158	;
562)   27BC B9          		        		CP      C	;
563)   27BD 38 08       		        		JR      C,FPOW1	;
564)   27BF 3C          		        		INC     A	;
565)   27C0 CD 97 2D    		        		CALL    FIX	;
566)   27C3 08          		        		EX      AF,AF'	;
567)   27C4 F2 A8 27    		        		JP      P,FPOW0	;
568)   27C7 CD 96 2E    		FPOW1:			CALL    SWAP	;
569)   27CA CD 4E 2A    		        		CALL    LN0	;
570)   27CD CD 5E 2F    		        		CALL    POP5	;
571)   27D0 F1          		        		POP     AF	;
572)   27D1 CD E7 26    		        		CALL    FMUL	;
573)   27D4 C3 C3 29    		        		JP      EXP0	;
578)   27D7 CD E5 2E    		FLT:			CALL    FCP	;
579)   27DA 18 03       		        		JR      ILT1	;
580)   27DC CD D8 2E    		ILT:			CALL    ICP	;
581)   27DF D0          		ILT1:			RET     NC	;
582)   27E0 18 38       		        		JR      TRUE	;
584)   27E2 CD E5 2E    		FGT:			CALL    FCP	;
585)   27E5 18 03       		        		JR      IGT1	;
586)   27E7 CD D8 2E    		IGT:			CALL    ICP	;
587)   27EA C8          		IGT1:			RET     Z	;
588)   27EB D8          		        		RET     C	;
589)   27EC 18 2C       		        		JR      TRUE	;
591)   27EE CD E5 2E    		FGE:			CALL    FCP	;
592)   27F1 18 03       		        		JR      IGE1	;
593)   27F3 CD D8 2E    		IGE:			CALL    ICP	;
594)   27F6 D8          		IGE1:			RET     C	;
595)   27F7 18 21       		        		JR      TRUE	;
597)   27F9 CD E5 2E    		FLE:			CALL    FCP	;
598)   27FC 18 03       		        		JR      ILE1	;
599)   27FE CD D8 2E    		ILE:			CALL    ICP	;
600)   2801 28 17       		ILE1:			JR      Z,TRUE	;
601)   2803 D0          		        		RET     NC	;
602)   2804 18 14       		        		JR      TRUE	;
604)   2806 CD E5 2E    		FNE:			CALL    FCP	;
605)   2809 18 03       		        		JR      INE1	;
606)   280B CD D8 2E    		INE:			CALL    ICP	;
607)   280E C8          		INE1:			RET     Z	;
608)   280F 18 09       		        		JR      TRUE	;
610)   2811 CD E5 2E    		FEQ:			CALL    FCP	;
611)   2814 18 03       		        		JR      IEQ1	;
612)   2816 CD D8 2E    		IEQ:			CALL    ICP	;
613)   2819 C0          		IEQ1:			RET     NZ	;
614)   281A 21 FF FF    		TRUE:			LD      HL,-1	;
615)   281D D9          		        		EXX	;
616)   281E 21 FF FF    		        		LD      HL,-1	;
617)   2821 D9          		        		EXX	;
618)   2822 AF          		        		XOR     A	;
619)   2823 4F          		        		LD      C,A	;
620)   2824 C9          		        		RET	;
631)   2825 CB 7C       		ABS:			BIT     7,H	;
632)   2827 C8          		        		RET     Z               ;POSITIVE/ZERO	;POSITIVE/ZERO
633)   2828 0D          		        		DEC     C	;
634)   2829 0C          		        		INC     C	;
635)   282A CA BF 2D    		        		JP      Z,NEGATE        ;INTEGER	;INTEGER
636)   282D CB BC       		        		RES     7,H	;
637)   282F C9          		        		RET	;
642)   2830 CD B0 2D    		NOTK:			CALL    SFIX	;
643)   2833 7C          		        		LD      A,H	;
644)   2834 2F          		        		CPL	;
645)   2835 67          		        		LD      H,A	;
646)   2836 7D          		        		LD      A,L	;
647)   2837 2F          		        		CPL	;
648)   2838 6F          		        		LD      L,A	;
649)   2839 D9          		        		EXX	;
650)   283A 7C          		        		LD      A,H	;
651)   283B 2F          		        		CPL	;
652)   283C 67          		        		LD      H,A	;
653)   283D 7D          		        		LD      A,L	;
654)   283E 2F          		        		CPL	;
655)   283F 6F          		        		LD      L,A	;
656)   2840 D9          		        		EXX	;
657)   2841 AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
658)   2842 C9          		        		RET	;
663)   2843 21 0F 49    		PI:			LD      HL,490FH	;
664)   2846 D9          		        		EXX	;
665)   2847 21 A2 DA    		        		LD      HL,0DAA2H	;
666)   284A D9          		        		EXX	;
667)   284B 0E 81       		        		LD      C,81H	;
668)   284D AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
669)   284E C9          		        		RET	;
674)   284F CD 5F 28    		DEG:			CALL    FPI180	;
675)   2852 CD E7 26    		        		CALL    FMUL	;
676)   2855 AF          		        		XOR     A	;
677)   2856 C9          		        		RET	;
682)   2857 CD 5F 28    		RAD:			CALL    FPI180	;
683)   285A CD 54 26    		        		CALL    FDIV	;
684)   285D AF          		        		XOR     A	;
685)   285E C9          		        		RET	;
689)   285F CD 6C 2E    		FPI180:			CALL    SFLOAT	;
690)   2862 11 2E 65    		        		LD      DE,652EH	;
691)   2865 D9          		        		EXX	;
692)   2866 11 D3 E0    		        		LD      DE,0E0D3H	;
693)   2869 D9          		        		EXX	;
694)   286A 06 85       		        		LD      B,85H	;
695)   286C C9          		        		RET	;
700)   286D CD BB 2E    		SGN:			CALL    TEST	;
701)   2870 B1          		        		OR      C	;
702)   2871 C8          		        		RET     Z               ;ZERO	;ZERO
703)   2872 CB 7C       		        		BIT     7,H	;
704)   2874 C2 1A 28    		        		JP      NZ,TRUE         ;-1	;-1
705)   2877 CD DB 2E    		        		CALL    ZERO	;
706)   287A C3 82 2E    		        		JP      ADD1            ;1	;1
712)   287D CD A6 30    		VAL:			CALL    SIGNQ	;
713)   2880 F5          		        		PUSH    AF	;
714)   2881 CD ED 2C    		        		CALL    CON	;
715)   2884 F1          		        		POP     AF	;
716)   2885 FE 2D       		        		CP      '-'	;
717)   2887 3E 00       		        		LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
718)   2889 C0          		        		RET     NZ	;
719)   288A 0D          		        		DEC     C	;
720)   288B 0C          		        		INC     C	;
721)   288C CA BF 2D    		        		JP      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
722)   288F 7C          		        		LD      A,H	;
723)   2890 EE 80       		        		XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
724)   2892 67          		        		LD      H,A	;
725)   2893 AF          		        		XOR     A	;
726)   2894 C9          		        		RET	;
731)   2895 0D          		INT:			DEC     C	;
732)   2896 0C          		        		INC     C	;
733)   2897 C8          		        		RET     Z               ;ZERO/INTEGER	;ZERO/INTEGER
734)   2898 3E 9F       		        		LD      A,159	;
735)   289A 44          		        		LD      B,H             ;B7=SIGN BIT	;B7=SIGN BIT
736)   289B CD 97 2D    		        		CALL    FIX	;
737)   289E 08          		        		EX      AF,AF'	;
738)   289F A0          		        		AND     B	;
739)   28A0 FC 82 2E    		        		CALL    M,ADD1          ;NEGATIVE NON-INTEGER	;NEGATIVE NON-INTEGER
740)   28A3 78          		        		LD      A,B	;
741)   28A4 B7          		        		OR      A	;
742)   28A5 FC BF 2D    		        		CALL    M,NEGATE	;
743)   28A8 AF          		        		XOR     A	;
744)   28A9 4F          		        		LD      C,A	;
745)   28AA C9          		        		RET	;
750)   28AB CD 6C 2E    		SQR:			CALL    SFLOAT	;
751)   28AE CB 7C       		SQR0:			BIT     7,H	;
752)   28B0 3E 15       		        		LD      A,NGROOT	;
753)   28B2 C2 CF 24    		        		JP      NZ,ERROR        ;"-ve root"	;"-ve root"
754)   28B5 0D          		        		DEC     C	;
755)   28B6 0C          		        		INC     C	;
756)   28B7 C8          		        		RET     Z               ;ZERO	;ZERO
757)   28B8 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
758)   28BA CB 41       		        		BIT     0,C	;
759)   28BC CC 9E 2E    		        		CALL    Z,DIV2          ;MAKE EXPONENT ODD	;MAKE EXPONENT ODD
760)   28BF 79          		        		LD      A,C	;
761)   28C0 D6 80       		        		SUB     80H	;
762)   28C2 CB 2F       		        		SRA     A               ;HALVE EXPONENT	;HALVE EXPONENT
763)   28C4 C6 80       		        		ADD     A,80H	;
764)   28C6 4F          		        		LD      C,A	;
765)   28C7 C5          		        		PUSH    BC              ;SAVE EXPONENT	;SAVE EXPONENT
766)   28C8 EB          		        		EX      DE,HL	;
767)   28C9 21 00 00    		        		LD      HL,0	;
768)   28CC 44          		        		LD      B,H	;
769)   28CD 4D          		        		LD      C,L	;
770)   28CE D9          		        		EXX	;
771)   28CF EB          		        		EX      DE,HL	;
772)   28D0 21 00 00    		        		LD      HL,0	;
773)   28D3 44          		        		LD      B,H	;
774)   28D4 4D          		        		LD      C,L	;
775)   28D5 3E E1       		        		LD      A,-31	;
776)   28D7 CD 4C 30    		        		CALL    SQRA            ;ROOT	;ROOT
777)   28DA D9          		        		EXX	;
778)   28DB CB 78       		        		BIT     7,B	;
779)   28DD D9          		        		EXX	;
780)   28DE CC 4C 30    		        		CALL    Z,SQRA          ;NORMALISE & INC A	;NORMALISE & INC A
781)   28E1 CD 85 30    		        		CALL    SQRB	;
782)   28E4 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
783)   28E5 CD 06 30    		        		CALL    DIVB	;
784)   28E8 CB 1B       		        		RR      E               ;LSB TO CARRY	;LSB TO CARRY
785)   28EA 60          		        		LD      H,B	;
786)   28EB 69          		        		LD      L,C	;
787)   28EC D9          		        		EXX	;
788)   28ED 60          		        		LD      H,B	;
789)   28EE 69          		        		LD      L,C	;
790)   28EF DC 82 2E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
791)   28F2 C1          		        		POP     BC              ;RESTORE EXPONENT	;RESTORE EXPONENT
792)   28F3 DC AA 2E    		        		CALL    C,INCC	;
793)   28F6 1F          		        		RRA	;
794)   28F7 9F          		        		SBC     A,A	;
795)   28F8 81          		        		ADD     A,C	;
796)   28F9 4F          		        		LD      C,A	;
797)   28FA CB BC       		        		RES     7,H             ;POSITIVE	;POSITIVE
798)   28FC AF          		        		XOR     A	;
799)   28FD C9          		        		RET	;
804)   28FE CD 6C 2E    		TAN:			CALL    SFLOAT	;
805)   2901 CD 55 2F    		        		CALL    PUSH5	;
806)   2904 CD 1E 29    		        		CALL    COS0	;
807)   2907 CD 5E 2F    		        		CALL    POP5	;
808)   290A CD 55 2F    		        		CALL    PUSH5	;
809)   290D CD 96 2E    		        		CALL    SWAP	;
810)   2910 CD 29 29    		        		CALL    SIN0	;
811)   2913 CD 5E 2F    		        		CALL    POP5	;
812)   2916 CD 54 26    		        		CALL    FDIV	;
813)   2919 AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
814)   291A C9          		        		RET	;
819)   291B CD 6C 2E    		COS:			CALL    SFLOAT	;
820)   291E CD E1 2D    		COS0:			CALL    SCALE	;
821)   2921 1C          		        		INC     E	;
822)   2922 1C          		        		INC     E	;
823)   2923 7B          		        		LD      A,E	;
824)   2924 18 0E       		        		JR      SIN1	;
829)   2926 CD 6C 2E    		SIN:			CALL    SFLOAT	;
830)   2929 E5          		SIN0:			PUSH    HL              ;H7=SIGN	;H7=SIGN
831)   292A CD E1 2D    		        		CALL    SCALE	;
832)   292D F1          		        		POP     AF	;
833)   292E 07          		        		RLCA	;
834)   292F 07          		        		RLCA	;
835)   2930 07          		        		RLCA	;
836)   2931 E6 04       		        		AND     4	;
837)   2933 AB          		        		XOR     E	;
838)   2934 F5          		SIN1:			PUSH    AF              ;OCTANT	;OCTANT
839)   2935 CB BC       		        		RES     7,H	;
840)   2937 1F          		        		RRA	;
841)   2938 CD B5 29    		        		CALL    PIBY4	;
842)   293B DC EC 25    		        		CALL    C,RSUB          ;X=(PI/4)-X	;X=(PI/4)-X
843)   293E F1          		        		POP     AF	;
844)   293F F5          		        		PUSH    AF	;
845)   2940 E6 03       		        		AND     3	;
846)   2942 E2 73 29    		        		JP      PO,SIN2         ;USE COSINE APPROX.	;USE COSINE APPROX.
847)   2945 CD 55 2F    		        		CALL    PUSH5           ;SAVE X	;SAVE X
848)   2948 CD 4F 2F    		        		CALL    SQUARE          ;PUSH X*X	;PUSH X*X
849)   294B CD 88 2F    		        		CALL    POLY	;
850)   294E B7 A8       		        		DEFW    0A8B7H          ;a(8)	;a(8)
851)   2950 11 36       		        		DEFW    3611H	;
852)   2952 6D          		        		DEFB    6DH	;
853)   2953 26 DE       		        		DEFW    0DE26H          ;a(6)	;a(6)
854)   2955 05 D0       		        		DEFW    0D005H	;
855)   2957 73          		        		DEFB    73H	;
856)   2958 C0 80       		        		DEFW    80C0H           ;a(4)	;a(4)
857)   295A 88 08       		        		DEFW    888H	;
858)   295C 79          		        		DEFB    79H	;
859)   295D 9D AA       		        		DEFW    0AA9DH          ;a(2)	;a(2)
860)   295F AA AA       		        		DEFW    0AAAAH	;
861)   2961 7D          		        		DEFB    7DH	;
862)   2962 00 00       		        		DEFW    0               ;a(0)	;a(0)
863)   2964 00 00       		        		DEFW    0	;
864)   2966 80          		        		DEFB    80H	;
865)   2967 CD 5E 2F    		        		CALL    POP5	;
866)   296A CD 5E 2F    		        		CALL    POP5	;
867)   296D CD E7 26    		        		CALL    FMUL	;
868)   2970 C3 95 29    		        		JP      SIN3	;
870)   2973 CD 4F 2F    		SIN2:			CALL    SQUARE          ;PUSH X*X	;PUSH X*X
871)   2976 CD 88 2F    		        		CALL    POLY	;
872)   2979 71 D5       		        		DEFW    0D571H          ;b(8)	;b(8)
873)   297B 78 4C       		        		DEFW    4C78H	;
874)   297D 70          		        		DEFB    70H	;
875)   297E AF 94       		        		DEFW    94AFH           ;b(6)	;b(6)
876)   2980 03 B6       		        		DEFW    0B603H	;
877)   2982 76          		        		DEFB    76H	;
878)   2983 C8 9C       		        		DEFW    9CC8H           ;b(4)	;b(4)
879)   2985 AA 2A       		        		DEFW    2AAAH	;
880)   2987 7B          		        		DEFB    7BH	;
881)   2988 DD FF       		        		DEFW    0FFDDH          ;b(2)	;b(2)
882)   298A FF FF       		        		DEFW    0FFFFH	;
883)   298C 7E          		        		DEFB    7EH	;
884)   298D 00 00       		        		DEFW    0               ;b(0)	;b(0)
885)   298F 00 00       		        		DEFW    0	;
886)   2991 80          		        		DEFB    80H	;
887)   2992 CD 5E 2F    		        		CALL    POP5	;
888)   2995 F1          		SIN3:			POP     AF	;
889)   2996 E6 04       		        		AND     4	;
890)   2998 C8          		        		RET     Z	;
891)   2999 0D          		        		DEC     C	;
892)   299A 0C          		        		INC     C	;
893)   299B C8          		        		RET     Z               ;ZERO	;ZERO
894)   299C CB FC       		        		SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
895)   299E C9          		        		RET	;
899)   299F 21 00 00    		FONE:			LD      HL,0	;
900)   29A2 D9          		        		EXX	;
901)   29A3 21 00 00    		        		LD      HL,0	;
902)   29A6 D9          		        		EXX	;
903)   29A7 0E 80       		        		LD      C,80H	;
904)   29A9 C9          		        		RET	;
906)   29AA 11 00 00    		DONE:			LD      DE,0	;
907)   29AD D9          		        		EXX	;
908)   29AE 11 00 00    		        		LD      DE,0	;
909)   29B1 D9          		        		EXX	;
910)   29B2 06 80       		        		LD      B,80H	;
911)   29B4 C9          		        		RET	;
913)   29B5 11 0F 49    		PIBY4:			LD      DE,490FH	;
914)   29B8 D9          		        		EXX	;
915)   29B9 11 A2 DA    		        		LD      DE,0DAA2H	;
916)   29BC D9          		        		EXX	;
917)   29BD 06 7F       		        		LD      B,7FH	;
918)   29BF C9          		        		RET	;
923)   29C0 CD 6C 2E    		EXP:			CALL    SFLOAT	;
924)   29C3 CD 40 2A    		EXP0:			CALL    LN2             ;LN(2)	;LN(2)
925)   29C6 D9          		        		EXX	;
926)   29C7 1D          			        	DEC     E	;
927)   29C8 01 CF D1    				        LD      BC,0D1CFH       ;0.6931471805599453	;0.6931471805599453
928)   29CB D9          		        		EXX	;
929)   29CC E5          		        		PUSH    HL              ;H7=SIGN	;H7=SIGN
930)   29CD CD F1 2D    		        		CALL    MOD48           ;"MODULUS"	;"MODULUS"
931)   29D0 F1          		        		POP     AF	;
932)   29D1 CB 7B       		        		BIT     7,E	;
933)   29D3 28 09       		        		JR      Z,EXP1	;
934)   29D5 17          		        		RLA	;
935)   29D6 DA DB 2E    		        		JP      C,ZERO	;
936)   29D9 3E 18       		        		LD      A,EXPRNG	;
937)   29DB C3 CF 24    		        		JP      ERROR           ;"Exp range"	;"Exp range"
939)   29DE E6 80       		EXP1:			AND     80H	;
940)   29E0 B3          		        		OR      E	;
941)   29E1 F5          		        		PUSH    AF              ;INTEGER PART	;INTEGER PART
942)   29E2 CB BC       		        		RES     7,H	;
943)   29E4 CD 55 2F    		        		CALL    PUSH5           ;PUSH X*LN(2)	;PUSH X*LN(2)
944)   29E7 CD 88 2F    		        		CALL    POLY	;
945)   29EA 72 40       		        		DEFW    4072H           ;a(7)	;a(7)
946)   29EC 2E 94       		        		DEFW    942EH	;
947)   29EE 73          		        		DEFB    73H	;
948)   29EF 65 6F       		        		DEFW    6F65H           ;a(6)	;a(6)
949)   29F1 4F 2E       		        		DEFW    2E4FH	;
950)   29F3 76          		        		DEFB    76H	;
951)   29F4 37 6D       		        		DEFW    6D37H           ;a(5)	;a(5)
952)   29F6 02 88       		        		DEFW    8802H	;
953)   29F8 79          		        		DEFB    79H	;
954)   29F9 12 E5       		        		DEFW    0E512H          ;a(4)	;a(4)
955)   29FB A0 2A       		        		DEFW    2AA0H	;
956)   29FD 7B          		        		DEFB    7BH	;
957)   29FE 14 4F       		        		DEFW    4F14H           ;a(3)	;a(3)
958)   2A00 AA AA       		        		DEFW    0AAAAH	;
959)   2A02 7D          		        		DEFB    7DH	;
960)   2A03 56 FD       		        		DEFW    0FD56H          ;a(2)	;a(2)
961)   2A05 FF 7F       		        		DEFW    7FFFH	;
962)   2A07 7E          		        		DEFB    7EH	;
963)   2A08 FE FF       		        		DEFW    0FFFEH          ;a(1)	;a(1)
964)   2A0A FF FF       		        		DEFW    0FFFFH	;
965)   2A0C 7F          		        		DEFB    7FH	;
966)   2A0D 00 00       		        		DEFW    0               ;a(0)	;a(0)
967)   2A0F 00 00       		        		DEFW    0	;
968)   2A11 80          		        		DEFB    80H	;
969)   2A12 CD 5E 2F    		        		CALL    POP5	;
970)   2A15 F1          		        		POP     AF	;
971)   2A16 F5          		        		PUSH    AF	;
972)   2A17 F4 37 2A    		        		CALL    P,RECIP         ;X=1/X	;X=1/X
973)   2A1A F1          		        		POP     AF	;
974)   2A1B F2 22 2A    		        		JP      P,EXP4	;
975)   2A1E E6 7F       		        		AND     7FH	;
976)   2A20 ED 44       		        		NEG	;
977)   2A22 C6 80       		EXP4:			ADD     A,80H	;
978)   2A24 81          		        		ADD     A,C	;
979)   2A25 38 05       		        		JR      C,EXP2	;
980)   2A27 F2 DB 2E    		        		JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
981)   2A2A 18 03       		        		JR      EXP3	;
982)   2A2C FA AC 2E    		EXP2:			JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
983)   2A2F C6 80       		EXP3:			ADD     A,80H	;
984)   2A31 CA DB 2E    		        		JP      Z,ZERO	;
985)   2A34 4F          		        		LD      C,A	;
986)   2A35 AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
987)   2A36 C9          		        		RET	;
989)   2A37 CD AA 29    		RECIP:			CALL    DONE	;
990)   2A3A CD 96 2E    		RDIV:			CALL    SWAP	;
991)   2A3D C3 54 26    		        		JP      FDIV            ;RECIPROCAL	;RECIPROCAL
993)   2A40 11 72 31    		LN2:			LD      DE,3172H        ;LN(2)	;LN(2)
994)   2A43 D9          		        		EXX	;
995)   2A44 11 F8 17    		        		LD      DE,17F8H	;
996)   2A47 D9          		        		EXX	;
997)   2A48 06 7F       		        		LD      B,7FH	;
998)   2A4A C9          		        		RET	;
1003)   2A4B CD 6C 2E    		LN:			CALL    SFLOAT	;
1004)   2A4E 3E 16       		LN0:			LD      A,LOGRNG	;
1005)   2A50 CB 7C       		        		BIT     7,H	;
1006)   2A52 C2 CF 24    		        		JP      NZ,ERROR        ;"Log range"	;"Log range"
1007)   2A55 0C          		        		INC     C	;
1008)   2A56 0D          		        		DEC     C	;
1009)   2A57 CA CF 24    		        		JP      Z,ERROR	;
1010)   2A5A 11 04 35    		        		LD      DE,3504H        ;SQR(2)	;SQR(2)
1011)   2A5D D9          		        		EXX	;
1012)   2A5E 11 33 F3    		        		LD      DE,0F333H       ;1.41421356237	;1.41421356237
1013)   2A61 D9          		        		EXX	;
1014)   2A62 CD ED 2E    		        		CALL    ICP0            ;MANTISSA>SQR(2)?	;MANTISSA>SQR(2)?
1015)   2A65 79          		        		LD      A,C             ;EXPONENT	;EXPONENT
1016)   2A66 0E 80       		        		LD      C,80H           ;1 <= X < 2	;1 <= X < 2
1017)   2A68 38 02       		        		JR      C,LN4	;
1018)   2A6A 0D          		        		DEC     C	;
1019)   2A6B 3C          		        		INC     A	;
1020)   2A6C F5          		LN4:			PUSH    AF              ;SAVE EXPONENT	;SAVE EXPONENT
1021)   2A6D CD 6A 2F    		        		CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1022)   2A70 CD 55 2F    		        		CALL    PUSH5	;
1023)   2A73 CD 4F 2F    				        CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1024)   2A76 CD 88 2F    		        		CALL    POLY	;
1025)   2A79 48 CC       		        		DEFW    0CC48H          ;a(9)	;a(9)
1026)   2A7B FB 74       		        		DEFW    74FBH	;
1027)   2A7D 7D          		        		DEFB    7DH	;
1028)   2A7E AF AE       		        		DEFW    0AEAFH          ;a(7)	;a(7)
1029)   2A80 FF 11       		        		DEFW    11FFH	;
1030)   2A82 7E          		        		DEFB    7EH	;
1031)   2A83 8C D9       		        		DEFW    0D98CH          ;a(5)	;a(5)
1032)   2A85 CD 4C       		        		DEFW    4CCDH	;
1033)   2A87 7E          		        		DEFB    7EH	;
1034)   2A88 E3 A9       		        		DEFW    0A9E3H          ;a(3)	;a(3)
1035)   2A8A AA 2A       		        		DEFW    2AAAH	;
1036)   2A8C 7F          		        		DEFB    7FH	;
1037)   2A8D 00 00       		        		DEFW    0               ;a(1)	;a(1)
1038)   2A8F 00 00       		        		DEFW    0	;
1039)   2A91 81          		        		DEFB    81H	;
1040)   2A92 CD 5E 2F    		        		CALL    POP5	;
1041)   2A95 CD 5E 2F    		        		CALL    POP5	;
1042)   2A98 CD E7 26    		        		CALL    FMUL	;
1043)   2A9B F1          		        		POP     AF              ;EXPONENT	;EXPONENT
1044)   2A9C CD 55 2F    		        		CALL    PUSH5	;
1045)   2A9F 08          		        		EX      AF,AF'	;
1046)   2AA0 CD DB 2E    		        		CALL    ZERO	;
1047)   2AA3 08          		        		EX      AF,AF'	;
1048)   2AA4 D6 80       		        		SUB     80H	;
1049)   2AA6 28 1B       		        		JR      Z,LN3	;
1050)   2AA8 30 02       		        		JR      NC,LN1	;
1051)   2AAA 2F          		        		CPL	;
1052)   2AAB 3C          		        		INC     A	;
1053)   2AAC 67          		LN1:			LD      H,A	;
1054)   2AAD 0E 87       		        		LD      C,87H	;
1055)   2AAF F5          		        		PUSH    AF	;
1056)   2AB0 CD 52 2E    		        		CALL    FLOAT	;
1057)   2AB3 CB BC       		        		RES     7,H	;
1058)   2AB5 CD 40 2A    		        		CALL    LN2	;
1059)   2AB8 CD E7 26    		        		CALL    FMUL	;
1060)   2ABB F1          		        		POP     AF	;
1061)   2ABC 30 05       		        		JR      NC,LN3	;
1062)   2ABE FA C3 2A    		        		JP      M,LN3	;
1063)   2AC1 CB FC       		        		SET     7,H	;
1064)   2AC3 CD 5E 2F    		LN3:			CALL    POP5	;
1065)   2AC6 CD FC 25    		        		CALL    FADD	;
1066)   2AC9 AF          		        		XOR     A	;
1067)   2ACA C9          		        		RET	;
1072)   2ACB CD 4B 2A    		LOG:			CALL    LN	;
1073)   2ACE 11 5B 5E    		        		LD      DE,5E5BH        ;LOG(e)	;LOG(e)
1074)   2AD1 D9          		        		EXX	;
1075)   2AD2 11 A9 D8    		        		LD      DE,0D8A9H	;
1076)   2AD5 D9          		        		EXX	;
1077)   2AD6 06 7E       		        		LD      B,7EH	;
1078)   2AD8 CD E7 26    		        		CALL    FMUL	;
1079)   2ADB AF          		        		XOR     A	;
1080)   2ADC C9          		        		RET	;
1085)   2ADD CD 6C 2E    		ASN:			CALL    SFLOAT	;
1086)   2AE0 CD 55 2F    		        		CALL    PUSH5	;
1087)   2AE3 CD 47 2F    		        		CALL    COPY	;
1088)   2AE6 CD E7 26    		        		CALL    FMUL	;
1089)   2AE9 CD AA 29    		        		CALL    DONE	;
1090)   2AEC CD EC 25    		        		CALL    RSUB	;
1091)   2AEF CD AE 28    		        		CALL    SQR0	;
1092)   2AF2 CD 5E 2F    		        		CALL    POP5	;
1093)   2AF5 0C          		        		INC     C	;
1094)   2AF6 0D          		        		DEC     C	;
1095)   2AF7 3E 02       		        		LD      A,2	;
1096)   2AF9 D5          		        		PUSH    DE	;
1097)   2AFA 28 70       		        		JR      Z,ACS1	;
1098)   2AFC D1          		        		POP     DE	;
1099)   2AFD CD 3A 2A    		        		CALL    RDIV	;
1100)   2B00 18 03       		        		JR      ATN0	;
1105)   2B02 CD 6C 2E    		ATN:			CALL    SFLOAT	;
1106)   2B05 E5          		ATN0:			PUSH    HL              ;SAVE SIGN	;SAVE SIGN
1107)   2B06 CB BC       		        		RES     7,H	;
1108)   2B08 11 13 54    		        		LD      DE,5413H        ;TAN(PI/8)=SQR(2)-1	;TAN(PI/8)=SQR(2)-1
1109)   2B0B D9          		        		EXX	;
1110)   2B0C 11 D0 CC    		        		LD      DE,0CCD0H	;
1111)   2B0F D9          		        		EXX	;
1112)   2B10 06 7E       		        		LD      B,7EH	;
1113)   2B12 CD EA 2E    		        		CALL    FCP0            ;COMPARE	;COMPARE
1114)   2B15 06 00       		        		LD      B,0	;
1115)   2B17 38 1C       		        		JR      C,ATN2	;
1116)   2B19 11 82 1A    		        		LD      DE,1A82H        ;TAN(3*PI/8)=SQR(2)+1	;TAN(3*PI/8)=SQR(2)+1
1117)   2B1C D9          		        		EXX	;
1118)   2B1D 11 9A 79    		        		LD      DE,799AH	;
1119)   2B20 D9          		        		EXX	;
1120)   2B21 06 81       		        		LD      B,81H	;
1121)   2B23 CD EA 2E    		        		CALL    FCP0            ;COMPARE	;COMPARE
1122)   2B26 38 08       		        		JR      C,ATN1	;
1123)   2B28 CD 37 2A    		        		CALL    RECIP           ;X=1/X	;X=1/X
1124)   2B2B 06 02       		        		LD      B,2	;
1125)   2B2D C3 35 2B    		        		JP      ATN2	;
1126)   2B30 CD 6A 2F    		ATN1:			CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1127)   2B33 06 01       		        		LD      B,1	;
1128)   2B35 C5          		ATN2:			PUSH    BC              ;SAVE FLAG	;SAVE FLAG
1129)   2B36 CD 55 2F    		        		CALL    PUSH5	;
1130)   2B39 CD 4F 2F    		        		CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1131)   2B3C CD 88 2F    		        		CALL    POLY	;
1132)   2B3F 35 F3       		        		DEFW    0F335H          ;a(13)	;a(13)
1133)   2B41 D8 37       		        		DEFW    37D8H	;
1134)   2B43 7B          		        		DEFB    7BH	;
1135)   2B44 91 6B       		        		DEFW    6B91H           ;a(11)	;a(11)
1136)   2B46 B9 AA       		        		DEFW    0AAB9H	;
1137)   2B48 7C          		        		DEFB    7CH	;
1138)   2B49 DE 41       		        		DEFW    41DEH           ;a(9)	;a(9)
1139)   2B4B 97 61       		        		DEFW    6197H	;
1140)   2B4D 7C          		        		DEFB    7CH	;
1141)   2B4E 7B 9D       		        		DEFW    9D7BH           ;a(7)	;a(7)
1142)   2B50 37 92       		        		DEFW    9237H	;
1143)   2B52 7D          		        		DEFB    7DH	;
1144)   2B53 5A 2A       		        		DEFW    2A5AH           ;a(5)	;a(5)
1145)   2B55 CC 4C       		        		DEFW    4CCCH	;
1146)   2B57 7D          		        		DEFB    7DH	;
1147)   2B58 5C A9       		        		DEFW    0A95CH          ;a(3)	;a(3)
1148)   2B5A AA AA       		        		DEFW    0AAAAH	;
1149)   2B5C 7E          		        		DEFB    7EH	;
1150)   2B5D 00 00       		        		DEFW    0               ;a(1)	;a(1)
1151)   2B5F 00 00       		        		DEFW    0	;
1152)   2B61 80          		        		DEFB    80H	;
1153)   2B62 CD 5E 2F    		        		CALL    POP5	;
1154)   2B65 CD 5E 2F    		        		CALL    POP5	;
1155)   2B68 CD E7 26    		        		CALL    FMUL	;
1156)   2B6B F1          		        		POP     AF	;
1157)   2B6C CD B5 29    		ACS1:			CALL    PIBY4           ;PI/4	;PI/4
1158)   2B6F 1F          		        		RRA	;
1159)   2B70 F5          		        		PUSH    AF	;
1160)   2B71 DC FC 25    		        		CALL    C,FADD	;
1161)   2B74 F1          		        		POP     AF	;
1162)   2B75 04          		        		INC     B	;
1163)   2B76 1F          		        		RRA	;
1164)   2B77 DC EC 25    		        		CALL    C,RSUB	;
1165)   2B7A F1          		        		POP     AF	;
1166)   2B7B B7          		        		OR      A	;
1167)   2B7C F0          		        		RET     P	;
1168)   2B7D CB FC       		        		SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
1169)   2B7F AF          		        		XOR     A	;
1170)   2B80 C9          		        		RET	;
1175)   2B81 CD DD 2A    		ACS:			CALL    ASN	;
1176)   2B84 3E 02       		        		LD      A,2	;
1177)   2B86 F5          		        		PUSH    AF	;
1178)   2B87 18 E3       		        		JR      ACS1	;
1188)   2B89 CD 6C 2E    		STR:			CALL    SFLOAT	;
1189)   2B8C 06 00       		        		LD      B,0             ;DEFAULT PT. POSITION	;DEFAULT PT. POSITION
1190)   2B8E CB 7C       		        		BIT     7,H             ;NEGATIVE?	;NEGATIVE?
1191)   2B90 28 06       		        		JR      Z,STR10	;
1192)   2B92 CB BC       		        		RES     7,H	;
1193)   2B94 3E 2D       		        		LD      A,'-'	;
1194)   2B96 12          		        		LD      (DE),A          ;STORE SIGN	;STORE SIGN
1195)   2B97 13          		        		INC     DE	;
1196)   2B98 AF          		STR10:			XOR     A               ;CLEAR A	;CLEAR A
1197)   2B99 B9          		        		CP      C	;
1198)   2B9A 28 47       		        		JR      Z,STR2          ;ZERO	;ZERO
1199)   2B9C D5          		        		PUSH    DE              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
1200)   2B9D 78          		        		LD      A,B	;
1201)   2B9E F5          		STR11:			PUSH    AF              ;SAVE DECIMAL COUNTER	;SAVE DECIMAL COUNTER
1202)   2B9F 79          		        		LD      A,C             ;BINARY EXPONENT	;BINARY EXPONENT
1203)   2BA0 FE A1       		        		CP      161	;
1204)   2BA2 30 1A       		        		JR      NC,STR14	;
1205)   2BA4 FE 9B       		        		CP      155	;
1206)   2BA6 30 25       		        		JR      NC,STR15	;
1207)   2BA8 2F          		        		CPL	;
1208)   2BA9 FE E1       		        		CP      225	;
1209)   2BAB 38 02       		        		JR      C,STR13	;
1210)   2BAD 3E F8       		        		LD      A,-8	;
1211)   2BAF C6 1C       		STR13:			ADD     A,28	;
1212)   2BB1 CD AF 2F    		        		CALL    POWR10	;
1213)   2BB4 F5          		        		PUSH    AF	;
1214)   2BB5 CD E7 26    		        		CALL    FMUL	;
1215)   2BB8 F1          		        		POP     AF	;
1216)   2BB9 47          		        		LD      B,A	;
1217)   2BBA F1          		        		POP     AF	;
1218)   2BBB 90          		        		SUB     B	;
1219)   2BBC 18 E0       		        		JR      STR11	;
1220)   2BBE D6 20       		STR14:			SUB     32	;
1221)   2BC0 CD AF 2F    		        		CALL    POWR10	;
1222)   2BC3 F5          		        		PUSH    AF	;
1223)   2BC4 CD 54 26    		        		CALL    FDIV	;
1224)   2BC7 F1          		        		POP     AF	;
1225)   2BC8 47          		        		LD      B,A	;
1226)   2BC9 F1          		        		POP     AF	;
1227)   2BCA 80          		        		ADD     A,B	;
1228)   2BCB 18 D1       		        		JR      STR11	;
1229)   2BCD 3E 09       		STR15:			LD      A,9	;
1230)   2BCF CD AF 2F    		        		CALL    POWR10          ;10^9	;10^9
1231)   2BD2 CD EA 2E    		        		CALL    FCP0	;
1232)   2BD5 79          		        		LD      A,C	;
1233)   2BD6 C1          		        		POP     BC	;
1234)   2BD7 4F          		        		LD      C,A	;
1235)   2BD8 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
1236)   2BDA DC 0C 2F    		        		CALL    C,X10B          ;X10, DEC B	;X10, DEC B
1237)   2BDD D1          		        		POP     DE              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
1238)   2BDE CB B9       		        		RES     7,C	;
1239)   2BE0 3E 00       		        		LD      A,0	;
1240)   2BE2 17          		        		RLA                     ;PUT CARRY IN LSB	;PUT CARRY IN LSB
1248)   2BE3 0C          		STR2:			INC     C	;
1249)   2BE4 08          		        		EX      AF,AF'          ;SAVE A	;SAVE A
1250)   2BE5 78          		        		LD      A,B	;
1251)   2BE6 DD CB 02 4E 		        		BIT     1,(IX+2)	;
1252)   2BEA 20 08       		        		JR      NZ,STR20	;
1253)   2BEC AF          		        		XOR     A	;
1254)   2BED DD BE 01    		        		CP      (IX+1)	;
1255)   2BF0 28 0A       		        		JR      Z,STR21	;
1256)   2BF2 3E F6       		        		LD      A,-10	;
1257)   2BF4 DD 86 01    		STR20:			ADD     A,(IX+1)        ;SIG. FIG. COUNT	;SIG. FIG. COUNT
1258)   2BF7 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
1259)   2BF8 FA FC 2B    		        		JP      M,STR21	;
1260)   2BFB AF          		        		XOR     A	;
1261)   2BFC F5          		STR21:			PUSH    AF	;
1262)   2BFD 08          		        		EX      AF,AF'          ;RESTORE A	;RESTORE A
1263)   2BFE CD 35 2F    		STR22:			CALL    X2              ;RL AHLH'L'	;RL AHLH'L'
1264)   2C01 8F          		        		ADC     A,A	;
1265)   2C02 FE 0A       		        		CP      10	;
1266)   2C04 38 05       		        		JR      C,STR23	;
1267)   2C06 D6 0A       		        		SUB     10	;
1268)   2C08 D9          		        		EXX	;
1269)   2C09 2C          		        		INC     L               ;SET RESULT BIT	;SET RESULT BIT
1270)   2C0A D9          		        		EXX	;
1271)   2C0B 0D          		STR23:			DEC     C	;
1272)   2C0C 20 F0       		        		JR      NZ,STR22        ;32 TIMES	;32 TIMES
1273)   2C0E 4F          		        		LD      C,A             ;REMAINDER	;REMAINDER
1274)   2C0F 7C          		        		LD      A,H	;
1275)   2C10 E6 3F       		        		AND     3FH             ;CLEAR OUT JUNK	;CLEAR OUT JUNK
1276)   2C12 67          		        		LD      H,A	;
1277)   2C13 F1          		        		POP     AF	;
1278)   2C14 F2 21 2C    		        		JP      P,STR24	;
1279)   2C17 3C          		        		INC     A	;
1280)   2C18 20 1C       		        		JR      NZ,STR26	;
1281)   2C1A 3E 04       		        		LD      A,4	;
1282)   2C1C B9          		        		CP      C               ;ROUND UP?	;ROUND UP?
1283)   2C1D 3E 00       		        		LD      A,0	;
1284)   2C1F 18 15       		        		JR      STR26	;
1285)   2C21 F5          		STR24:			PUSH    AF	;
1286)   2C22 79          		        		LD      A,C	;
1287)   2C23 CE 30       		        		ADC     A,'0'           ;ADD CARRY	;ADD CARRY
1288)   2C25 FE 30       		        		CP      '0'	;
1289)   2C27 28 05       		        		JR      Z,STR25         ;SUPPRESS ZERO	;SUPPRESS ZERO
1290)   2C29 FE 3A       		        		CP      '9'+1	;
1291)   2C2B 3F          		        		CCF	;
1292)   2C2C 30 08       		        		JR      NC,STR26	;
1293)   2C2E E3          		STR25:			EX      (SP),HL	;
1294)   2C2F CB 75       		        		BIT     6,L             ;ZERO FLAG	;ZERO FLAG
1295)   2C31 E3          				        EX      (SP),HL	;
1296)   2C32 20 05       		        		JR      NZ,STR27	;
1297)   2C34 3E 30       		        		LD      A,'0'	;
1298)   2C36 3C          		STR26:			INC     A               ;SET +VE	;SET +VE
1299)   2C37 3D          		        		DEC     A	;
1300)   2C38 F5          		        		PUSH    AF              ;PUT ON STACK + CARRY	;PUT ON STACK + CARRY
1301)   2C39 04          		STR27:			INC     B	;
1302)   2C3A CD BB 2E    		        		CALL    TEST            ;IS HLH'L' ZERO?	;IS HLH'L' ZERO?
1303)   2C3D 0E 20       		        		LD      C,32	;
1304)   2C3F 3E 00       		        		LD      A,0	;
1305)   2C41 20 BB       		        		JR      NZ,STR22	;
1306)   2C43 F1          		        		POP     AF	;
1307)   2C44 F5          		        		PUSH    AF	;
1308)   2C45 3E 00       		        		LD      A,0	;
1309)   2C47 38 B5       		        		JR      C,STR22	;
1317)   2C49 EB          		STR3:			EX      DE,HL           ;STRING POINTER	;STRING POINTER
1318)   2C4A 0E FF       		        		LD      C,-1            ;FLAG "E"	;FLAG "E"
1319)   2C4C 16 01       		        		LD      D,1	;
1320)   2C4E DD 5E 01    		        		LD      E,(IX+1)        ;f2	;f2
1321)   2C51 DD CB 02 46 		        		BIT     0,(IX+2)	;
1322)   2C55 20 32       		        		JR      NZ,STR34        ;E MODE	;E MODE
1323)   2C57 DD CB 02 4E 		        		BIT     1,(IX+2)	;
1324)   2C5B 28 11       		        		JR      Z,STR31	;
1325)   2C5D 78          		        		LD      A,B             ;F MODE	;F MODE
1326)   2C5E B7          		        		OR      A	;
1327)   2C5F 28 04       		        		JR      Z,STR30	;
1328)   2C61 FA 65 2C    		        		JP      M,STR30	;
1329)   2C64 50          		        		LD      D,B	;
1330)   2C65 7A          		STR30:			LD      A,D	;
1331)   2C66 DD 86 01    		        		ADD     A,(IX+1)	;
1332)   2C69 5F          		        		LD      E,A	;
1333)   2C6A FE 0B       		        		CP      11	;
1334)   2C6C 38 17       		        		JR      C,STR32	;
1335)   2C6E 78          		STR31:			LD      A,B             ;G MODE	;G MODE
1336)   2C6F 11 01 01    		        		LD      DE,101H	;
1337)   2C72 B7          		        		OR      A	;
1338)   2C73 FA 89 2C    		        		JP      M,STR34	;
1339)   2C76 28 0D       		        		JR      Z,STR32	;
1340)   2C78 DD 7E 01    		        		LD      A,(IX+1)	;
1341)   2C7B B7          		        		OR      A	;
1342)   2C7C 20 02       		        		JR      NZ,STR3A	;
1343)   2C7E 3E 0A       		        		LD      A,10	;
1344)   2C80 B8          		STR3A:			CP      B	;
1345)   2C81 38 06       		        		JR      C,STR34	;
1346)   2C83 50          		        		LD      D,B	;
1347)   2C84 58          		        		LD      E,B	;
1348)   2C85 78          		STR32:			LD      A,B	;
1349)   2C86 C6 81       		        		ADD     A,129	;
1350)   2C88 4F          		        		LD      C,A	;
1351)   2C89 CB FA       		STR34:			SET     7,D	;
1352)   2C8B 1D          		        		DEC     E	;
1353)   2C8C 7A          		STR35:			LD      A,D	;
1354)   2C8D B9          		        		CP      C	;
1355)   2C8E 30 0C       		        		JR      NC,STR33	;
1356)   2C90 F1          		STR36:			POP     AF	;
1357)   2C91 28 03       		        		JR      Z,STR37	;
1358)   2C93 F2 9E 2C    		        		JP      P,STR38	;
1359)   2C96 F5          		STR37:			PUSH    AF	;
1360)   2C97 1C          		        		INC     E	;
1361)   2C98 1D          		        		DEC     E	;
1362)   2C99 FA AD 2C    		        		JP      M,STR4	;
1363)   2C9C 3E 30       		STR33:			LD      A,'0'	;
1364)   2C9E 15          		STR38:			DEC     D	;
1365)   2C9F E2 A5 2C    		        		JP      PO,STR39	;
1366)   2CA2 36 2E       		        		LD      (HL),'.'	;
1367)   2CA4 23          		        		INC     HL	;
1368)   2CA5 77          		STR39:			LD      (HL),A	;
1369)   2CA6 23          		        		INC     HL	;
1370)   2CA7 1D          		        		DEC     E	;
1371)   2CA8 F2 8C 2C    		        		JP      P,STR35	;
1372)   2CAB 18 E3       		        		JR      STR36	;
1374)   2CAD F1          		STR4:			POP     AF	;
1375)   2CAE 0C          		STR40:			INC     C	;
1376)   2CAF 4D          		        		LD      C,L	;
1377)   2CB0 20 27       		        		JR      NZ,STR44	;
1378)   2CB2 36 45       		        		LD      (HL),'E'        ;EXPONENT	;EXPONENT
1379)   2CB4 23          		        		INC     HL	;
1380)   2CB5 78          		        		LD      A,B	;
1381)   2CB6 3D          		        		DEC     A	;
1382)   2CB7 F2 BF 2C    		        		JP      P,STR41	;
1383)   2CBA 36 2D       		        		LD      (HL),'-'	;
1384)   2CBC 23          		        		INC     HL	;
1385)   2CBD ED 44       		        		NEG	;
1386)   2CBF 36 30       		STR41:			LD      (HL),'0'	;
1387)   2CC1 28 15       		        		JR      Z,STR47	;
1388)   2CC3 FE 0A       		        		CP      10	;
1389)   2CC5 47          		        		LD      B,A	;
1390)   2CC6 3E 3A       		        		LD      A,':'	;
1391)   2CC8 38 03       		        		JR      C,STR42	;
1392)   2CCA 23          		        		INC     HL	;
1393)   2CCB 36 30       		        		LD      (HL),'0'	;
1394)   2CCD 34          		STR42:			INC     (HL)	;
1395)   2CCE BE          		        		CP      (HL)	;
1396)   2CCF 20 05       		        		JR      NZ,STR43	;
1397)   2CD1 36 30       		        		LD      (HL),'0'	;
1398)   2CD3 2B          		        		DEC     HL	;
1399)   2CD4 34          		        		INC     (HL)	;
1400)   2CD5 23          		        		INC     HL	;
1401)   2CD6 10 F5       		STR43:			DJNZ    STR42	;
1402)   2CD8 23          		STR47:			INC     HL	;
1403)   2CD9 EB          		STR44:			EX      DE,HL	;
1404)   2CDA C9          		      			RET	;
1408)   2CDB DD 46 04    		DLOAD5:			LD      B,(IX+4)	;
1409)   2CDE D9          		        		EXX	;
1410)   2CDF DD 5E 00    		        		LD      E,(IX+0)	;
1411)   2CE2 DD 56 01    		        		LD      D,(IX+1)	;
1412)   2CE5 D9          		        		EXX	;
1413)   2CE6 DD 5E 02    		        		LD      E,(IX+2)	;
1414)   2CE9 DD 56 03    		        		LD      D,(IX+3)	;
1415)   2CEC C9          		        		RET	;
1423)   2CED CD DB 2E    		CON:			CALL    ZERO            ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1424)   2CF0 0E 00       		        		LD      C,0             ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1425)   2CF2 CD 72 2D    		        		CALL    NUMBER          ;GET INTEGER PART	;GET INTEGER PART
1426)   2CF5 FE 2E       		        		CP      '.'	;
1427)   2CF7 06 00       		        		LD      B,0             ;DECL. PLACE COUNTER	;DECL. PLACE COUNTER
1428)   2CF9 CC 70 2D    		        		CALL    Z,NUMBIX        ;GET FRACTION PART	;GET FRACTION PART
1429)   2CFC FE 45       		        		CP      'E'	;
1430)   2CFE 3E 00       		        		LD      A,0             ;INITIALISE EXPONENT	;INITIALISE EXPONENT
1431)   2D00 CC 41 2D    		        		CALL    Z,GETEXP        ;GET EXPONENT	;GET EXPONENT
1432)   2D03 CB 7C       		        		BIT     7,H	;
1433)   2D05 20 08       		        		JR      NZ,CON0         ;INTEGER OVERFLOW	;INTEGER OVERFLOW
1434)   2D07 B7          		        		OR      A	;
1435)   2D08 20 05       		        		JR      NZ,CON0         ;EXPONENT NON-ZERO	;EXPONENT NON-ZERO
1436)   2D0A B8          		        		CP      B	;
1437)   2D0B 20 02       		        		JR      NZ,CON0         ;DECIMAL POINT	;DECIMAL POINT
1438)   2D0D B9          		        		CP      C	;
1439)   2D0E C8          		        		RET     Z               ;INTEGER	;INTEGER
1440)   2D0F 90          		CON0:			SUB     B	;
1441)   2D10 81          		        		ADD     A,C	;
1442)   2D11 0E 9F       		        		LD      C,159	;
1443)   2D13 CD 52 2E    		        		CALL    FLOAT	;
1444)   2D16 CB BC       		        		RES     7,H             ;DITCH IMPLIED 1	;DITCH IMPLIED 1
1445)   2D18 B7          		        		OR      A	;
1446)   2D19 C8          		        		RET     Z               ;DONE	;DONE
1447)   2D1A FA 25 2D    		        		JP      M,CON2          ;NEGATIVE EXPONENT	;NEGATIVE EXPONENT
1448)   2D1D CD AF 2F    		        		CALL    POWR10	;
1449)   2D20 CD E7 26    		        		CALL    FMUL            ;SCALE	;SCALE
1450)   2D23 AF          		        		XOR     A	;
1451)   2D24 C9          		        		RET	;
1452)   2D25 FE DA       		CON2:			CP      -38	;
1453)   2D27 38 0A       		        		JR      C,CON3          ;CAN'T SCALE IN ONE GO	;CAN'T SCALE IN ONE GO
1454)   2D29 ED 44       		        		NEG	;
1455)   2D2B CD AF 2F    		        		CALL    POWR10	;
1456)   2D2E CD 54 26    		        		CALL    FDIV            ;SCALE	;SCALE
1457)   2D31 AF          		        		XOR     A	;
1458)   2D32 C9          		        		RET	;
1459)   2D33 F5          		CON3:			PUSH    AF	;
1460)   2D34 3E 26       		        		LD      A,38	;
1461)   2D36 CD AF 2F    		        		CALL    POWR10	;
1462)   2D39 CD 54 26    		        		CALL    FDIV	;
1463)   2D3C F1          		        		POP     AF	;
1464)   2D3D C6 26       		        		ADD     A,38	;
1465)   2D3F 18 E4       		        		JR      CON2	;
1475)   2D41 C5          		GETEXP:			PUSH    BC              ;SAVE REGISTERS	;SAVE REGISTERS
1476)   2D42 47          		        		LD      B,A             ;INITIAL VALUE	;INITIAL VALUE
1477)   2D43 0E 02       		        		LD      C,2             ;2 DIGITS MAX	;2 DIGITS MAX
1478)   2D45 DD 23       		        		INC     IX              ;BUMP PAST 'E'	;BUMP PAST 'E'
1479)   2D47 CD A6 30    		        		CALL    SIGNQ	;
1480)   2D4A 08          		        		EX      AF,AF'          ;SAVE EXPONENT SIGN	;SAVE EXPONENT SIGN
1481)   2D4B CD 9C 30    		GETEX1:			CALL    DIGITQ	;
1482)   2D4E 38 17       		        		JR      C,GETEX2	;
1483)   2D50 78          		        		LD      A,B             ;B=B*10	;B=B*10
1484)   2D51 87          		        		ADD     A,A	;
1485)   2D52 87          		        		ADD     A,A	;
1486)   2D53 80          		        		ADD     A,B	;
1487)   2D54 87          		        		ADD     A,A	;
1488)   2D55 47          		        		LD      B,A	;
1489)   2D56 DD 7E 00    		        		LD      A,(IX)          ;GET BACK DIGIT	;GET BACK DIGIT
1490)   2D59 DD 23       		        		INC     IX	;
1491)   2D5B E6 0F       		        		AND     0FH             ;MASK UNWANTED BITS	;MASK UNWANTED BITS
1492)   2D5D 80          		        		ADD     A,B             ;ADD IN DIGIT	;ADD IN DIGIT
1493)   2D5E 47          		        		LD      B,A	;
1494)   2D5F 0D          		        		DEC     C	;
1495)   2D60 F2 4B 2D    		        		JP      P,GETEX1	;
1496)   2D63 06 64       		        		LD      B,100           ;FORCE OVERFLOW	;FORCE OVERFLOW
1497)   2D65 18 E4       		        		JR      GETEX1	;
1498)   2D67 08          		GETEX2:			EX      AF,AF'          ;RESTORE SIGN	;RESTORE SIGN
1499)   2D68 FE 2D       		        		CP      '-'	;
1500)   2D6A 78          		        		LD      A,B	;
1501)   2D6B C1          		        		POP     BC              ;RESTORE	;RESTORE
1502)   2D6C C0          		        		RET     NZ	;
1503)   2D6D ED 44       		        		NEG                     ;NEGATE EXPONENT	;NEGATE EXPONENT
1504)   2D6F C9          		        		RET	;
1517)   2D70 DD 23       		NUMBIX:			INC     IX	;
1518)   2D72 CD 9C 30    		NUMBER:			CALL    DIGITQ	;
1519)   2D75 D8          		        		RET     C	;
1520)   2D76 04          		        		INC     B               ;INCREMENT DIGIT COUNT	;INCREMENT DIGIT COUNT
1521)   2D77 DD 23       		        		INC     IX	;
1522)   2D79 CD 26 2F    		        		CALL    X10             ;*10 & COPY OLD VALUE	;*10 & COPY OLD VALUE
1523)   2D7C 38 13       		        		JR      C,NUMB1         ;OVERFLOW	;OVERFLOW
1524)   2D7E 0D          		        		DEC     C               ;SEE IF TRUNCATED	;SEE IF TRUNCATED
1525)   2D7F 0C          		        		INC     C	;
1526)   2D80 20 0F       		        		JR      NZ,NUMB1        ;IMPORTANT!	;IMPORTANT!
1527)   2D82 E6 0F       		        		AND     0FH	;
1528)   2D84 D9          		        		EXX	;
1529)   2D85 06 00       		        		LD      B,0	;
1530)   2D87 4F          		        		LD      C,A	;
1531)   2D88 09          		        		ADD     HL,BC           ;ADD IN DIGIT	;ADD IN DIGIT
1532)   2D89 D9          		        		EXX	;
1533)   2D8A 30 E6       		        		JR      NC,NUMBER	;
1534)   2D8C 23          		        		INC     HL              ;CARRY	;CARRY
1535)   2D8D 7C          		        		LD      A,H	;
1536)   2D8E B5          		        		OR      L	;
1537)   2D8F 20 E1       		        		JR      NZ,NUMBER	;
1538)   2D91 0C          		NUMB1:			INC     C               ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1539)   2D92 CD 99 2E    		        		CALL    SWAP1           ;RESTORE PREVIOUS VALUE	;RESTORE PREVIOUS VALUE
1540)   2D95 18 DB       		        		JR      NUMBER	;
1550)   2D97 08          		FIX:			EX      AF,AF'	;
1551)   2D98 AF          		        		XOR     A	;
1552)   2D99 08          		        		EX      AF,AF'	;
1553)   2D9A CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
1554)   2D9C CD 9E 2E    		FIX1:			CALL    DIV2	;
1555)   2D9F B9          		        		CP      C	;
1556)   2DA0 C8          		        		RET     Z	;
1557)   2DA1 D2 9C 2D    		        		JP      NC,FIX1	;
1558)   2DA4 C3 AC 2E    		        		JP      OFLOW	;
1568)   2DA7 CD 96 2E    		FIX2:			CALL    SWAP	;
1569)   2DAA CD B0 2D    		        		CALL    SFIX	;
1570)   2DAD CD 96 2E    		        		CALL    SWAP	;
1571)   2DB0 0D          		SFIX:			DEC     C	;
1572)   2DB1 0C          		        		INC     C	;
1573)   2DB2 C8          		        		RET     Z               ;INTEGER/ZERO	;INTEGER/ZERO
1574)   2DB3 CB 7C       		        		BIT     7,H             ;SIGN	;SIGN
1575)   2DB5 F5          		        		PUSH    AF	;
1576)   2DB6 3E 9F       		        		LD      A,159	;
1577)   2DB8 CD 97 2D    		        		CALL    FIX	;
1578)   2DBB F1          		        		POP     AF	;
1579)   2DBC 0E 00       		        		LD      C,0	;
1580)   2DBE C8          		        		RET     Z	;
1581)   2DBF B7          		NEGATE:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
1582)   2DC0 D9          		        		EXX	;
1583)   2DC1 D5          		NEG0:			PUSH    DE	;
1584)   2DC2 EB          		        		EX      DE,HL	;
1585)   2DC3 21 00 00    		        		LD      HL,0	;
1586)   2DC6 ED 52       		        		SBC     HL,DE	;
1587)   2DC8 D1          		        		POP     DE	;
1588)   2DC9 D9          		        		EXX	;
1589)   2DCA D5          		        		PUSH    DE	;
1590)   2DCB EB          		        		EX      DE,HL	;
1591)   2DCC 21 00 00    		        		LD      HL,0	;
1592)   2DCF ED 52       		        		SBC     HL,DE	;
1593)   2DD1 D1          		        		POP     DE	;
1594)   2DD2 C9          		        		RET	;
1600)   2DD3 D9          		NEG:			EXX	;
1601)   2DD4 2F          		        		CPL	;
1602)   2DD5 E5          		        		PUSH    HL	;
1603)   2DD6 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
1604)   2DD7 21 00 00    		        		LD      HL,0	;
1605)   2DDA ED 42       		        		SBC     HL,BC	;
1606)   2DDC 44          		        		LD      B,H	;
1607)   2DDD 4D          		        		LD      C,L	;
1608)   2DDE E1          		        		POP     HL	;
1609)   2DDF 18 E0       		        		JR      NEG0	;
1622)   2DE1 3E 96       		SCALE:			LD      A,150	;
1623)   2DE3 B9          		        		CP      C	;
1624)   2DE4 3E 17       		        		LD      A,ACLOST	;
1625)   2DE6 DA CF 24    		        		JP      C,ERROR         ;"Accuracy lost"	;"Accuracy lost"
1626)   2DE9 CD B5 29    		        		CALL    PIBY4	;
1627)   2DEC D9          		        		EXX	;
1628)   2DED 01 69 21    		        		LD      BC,2169H        ;3.141592653589793238	;3.141592653589793238
1629)   2DF0 D9          		        		EXX	;
1630)   2DF1 CB FA       		MOD48:			SET     7,D             ;IMPLIED 1	;IMPLIED 1
1631)   2DF3 CB FC       		        		SET     7,H	;
1632)   2DF5 79          		        		LD      A,C	;
1633)   2DF6 0E 00       		        		LD      C,0             ;INIT QUOTIENT	;INIT QUOTIENT
1634)   2DF8 DD 21 00 00 		        		LD      IX,0	;
1635)   2DFC DD E5       		        		PUSH    IX              ;PUT ZERO ON STACK	;PUT ZERO ON STACK
1636)   2DFE B8          		        		CP      B	;
1637)   2DFF 38 3A       		        		JR      C,MOD485        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1638)   2E01 D9          		MOD481:			EXX                     ;CARRY=0 HERE	;CARRY=0 HERE
1639)   2E02 E3          		        		EX      (SP),HL	;
1640)   2E03 ED 42       		        		SBC     HL,BC	;
1641)   2E05 E3          		        		EX      (SP),HL	;
1642)   2E06 ED 52       		        		SBC     HL,DE	;
1643)   2E08 D9          		        		EXX	;
1644)   2E09 ED 52       		        		SBC     HL,DE	;
1645)   2E0B 30 09       		        		JR      NC,MOD482       ;DIVIDEND>=DIVISOR	;DIVIDEND>=DIVISOR
1646)   2E0D D9          		        		EXX	;
1647)   2E0E E3          		        		EX      (SP),HL	;
1648)   2E0F 09          		        		ADD     HL,BC	;
1649)   2E10 E3          		        		EX      (SP),HL	;
1650)   2E11 ED 5A       		        		ADC     HL,DE	;
1651)   2E13 D9          		        		EXX	;
1652)   2E14 ED 5A       		        		ADC     HL,DE	;
1653)   2E16 3F          		MOD482:			CCF	;
1654)   2E17 CB 11       		        		RL      C               ;QUOTIENT	;QUOTIENT
1655)   2E19 30 02       		        		JR      NC,MOD483	;
1656)   2E1B CB F9       		        		SET     7,C             ;STICKY BIT	;STICKY BIT
1657)   2E1D 3D          		MOD483:			DEC     A	;
1658)   2E1E B8          		        		CP      B	;
1659)   2E1F 38 19       		        		JR      C,MOD484        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1660)   2E21 E3          		        		EX      (SP),HL	;
1661)   2E22 29          		        		ADD     HL,HL           ;DIVIDEND * 2	;DIVIDEND * 2
1662)   2E23 E3          		        		EX      (SP),HL	;
1663)   2E24 D9          		        		EXX	;
1664)   2E25 ED 6A       		        		ADC     HL,HL	;
1665)   2E27 D9          		        		EXX	;
1666)   2E28 ED 6A       		        		ADC     HL,HL	;
1667)   2E2A 30 D5       		        		JR      NC,MOD481       ;AGAIN	;AGAIN
1668)   2E2C B7          		        		OR      A	;
1669)   2E2D D9          		        		EXX	;
1670)   2E2E E3          		        		EX      (SP),HL	;
1671)   2E2F ED 42       		        		SBC     HL,BC           ;OVERFLOW, SO SUBTRACT	;OVERFLOW, SO SUBTRACT
1672)   2E31 E3          		        		EX      (SP),HL	;
1673)   2E32 ED 52       		        		SBC     HL,DE	;
1674)   2E34 D9          		        		EXX	;
1675)   2E35 ED 52       		        		SBC     HL,DE	;
1676)   2E37 B7          		        		OR      A	;
1677)   2E38 18 DC       		        		JR      MOD482	;
1679)   2E3A 3C          		MOD484:			INC     A	;
1680)   2E3B 59          		MOD485:			LD      E,C             ;QUOTIENT	;QUOTIENT
1681)   2E3C 4F          		        		LD      C,A             ;REMAINDER EXPONENT	;REMAINDER EXPONENT
1682)   2E3D D9          		        		EXX	;
1683)   2E3E C1          		        		POP     BC	;
1684)   2E3F D9          		        		EXX	;
1685)   2E40 CB 7C       		FLO48:			BIT     7,H	;
1686)   2E42 C0          		        		RET     NZ	;
1687)   2E43 D9          		        		EXX	;
1688)   2E44 CB 21       		        		SLA     C	;
1689)   2E46 CB 10       		        		RL      B	;
1690)   2E48 ED 6A       		        		ADC     HL,HL	;
1691)   2E4A D9          		        		EXX	;
1692)   2E4B ED 6A       		        		ADC     HL,HL	;
1693)   2E4D 0D          		        		DEC     C	;
1694)   2E4E C2 40 2E    		        		JP      NZ,FLO48	;
1695)   2E51 C9          		        		RET	;
1701)   2E52 CB 7C       		FLOAT:			BIT     7,H	;
1702)   2E54 C0          		        		RET     NZ	;
1703)   2E55 D9          		        		EXX                     ;SAME AS "X2"	;SAME AS "X2"
1704)   2E56 29          		        		ADD     HL,HL           ;TIME-CRITICAL	;TIME-CRITICAL
1705)   2E57 D9          		        		EXX                     ;REGION	;REGION
1706)   2E58 ED 6A       		        		ADC     HL,HL           ;(BENCHMARKS)	;(BENCHMARKS)
1707)   2E5A 0D          		        		DEC     C	;
1708)   2E5B C2 52 2E    		        		JP      NZ,FLOAT	;
1709)   2E5E C9          		        		RET	;
1716)   2E5F 08          		FLOATA:			EX      AF,AF'	;
1717)   2E60 C6 2A       		        		ADD     A,(RTABLE-DTABLE)/2	;
1718)   2E62 08          		        		EX      AF,AF'	;
1719)   2E63 CD 96 2E    		FLOAT2:			CALL    SWAP	;
1720)   2E66 CD 6C 2E    		        		CALL    SFLOAT	;
1721)   2E69 CD 96 2E    		        		CALL    SWAP	;
1722)   2E6C 0D          		SFLOAT:			DEC     C	;
1723)   2E6D 0C          		        		INC     C	;
1724)   2E6E C0          		        		RET     NZ              ;ALREADY FLOATING-POINT	;ALREADY FLOATING-POINT
1725)   2E6F CD BB 2E    		        		CALL    TEST	;
1726)   2E72 C8          		        		RET     Z               ;ZERO	;ZERO
1727)   2E73 7C          		        		LD      A,H	;
1728)   2E74 B7          		        		OR      A	;
1729)   2E75 FC BF 2D    		        		CALL    M,NEGATE	;
1730)   2E78 0E 9F       		        		LD      C,159	;
1731)   2E7A CD 52 2E    		        		CALL    FLOAT	;
1732)   2E7D B7          		        		OR      A	;
1733)   2E7E F8          		        		RET     M               ;NEGATIVE	;NEGATIVE
1734)   2E7F CB BC       		        		RES     7,H	;
1735)   2E81 C9          		        		RET	;
1741)   2E82 D9          		ADD1:			EXX	;
1742)   2E83 01 01 00    		        		LD      BC,1	;
1743)   2E86 09          		        		ADD     HL,BC	;
1744)   2E87 D9          		        		EXX	;
1745)   2E88 D0          		        		RET     NC	;
1746)   2E89 C5          		        		PUSH    BC	;
1747)   2E8A 01 01 00    		        		LD      BC,1	;
1748)   2E8D 09          		        		ADD     HL,BC	;
1749)   2E8E C1          		        		POP     BC	;
1750)   2E8F C9          		        		RET	;
1757)   2E90 B7          		ODD:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
1758)   2E91 D9          		        		EXX	;
1759)   2E92 CB C5       		        		SET     0,L             ;MAKE ODD	;MAKE ODD
1760)   2E94 D9          		        		EXX	;
1761)   2E95 C9          		        		RET	;
1769)   2E96 79          		SWAP:			LD      A,C	;
1770)   2E97 48          		        		LD      C,B	;
1771)   2E98 47          		        		LD      B,A	;
1772)   2E99 EB          		SWAP1:			EX      DE,HL	;
1773)   2E9A D9          		        		EXX	;
1774)   2E9B EB          		        		EX      DE,HL	;
1775)   2E9C D9          		        		EXX	;
1776)   2E9D C9          		        		RET	;
1782)   2E9E CD 3C 2F    		DIV2:			CALL    D2	;
1783)   2EA1 D9          		        		EXX	;
1784)   2EA2 CB 18       		        		RR      B	;
1785)   2EA4 CB 19       		        		RR      C	;
1786)   2EA6 08          		        		EX      AF,AF'	;
1787)   2EA7 B0          		        		OR      B	;
1788)   2EA8 08          		        		EX      AF,AF'	;
1789)   2EA9 D9          		        		EXX	;
1790)   2EAA 0C          		INCC:			INC     C	;
1791)   2EAB C0          		        		RET     NZ	;
1792)   2EAC 3E 14       		OFLOW:			LD      A,TOOBIG	;
1793)   2EAE C3 CF 24    		        		JP      ERROR           ;"Too big"	;"Too big"
1798)   2EB1 CD BB 2E    		FTEST:			CALL    TEST	;
1799)   2EB4 C8          		        		RET     Z	;
1800)   2EB5 7C          		        		LD      A,H	;
1801)   2EB6 E6 80       		        		AND     10000000B	;
1802)   2EB8 F6 40       		        		OR      01000000B	;
1803)   2EBA C9          		        		RET	;
1809)   2EBB 7C          		TEST:			LD      A,H	;
1810)   2EBC B5          		        		OR      L	;
1811)   2EBD D9          		        		EXX	;
1812)   2EBE B4          		        		OR      H	;
1813)   2EBF B5          		        		OR      L	;
1814)   2EC0 D9          		        		EXX	;
1815)   2EC1 C9          		        		RET	;
1820)   2EC2 78          		FCOMP:			LD      A,B	;
1821)   2EC3 B1          		        		OR      C               ;Both integer?	;Both integer?
1822)   2EC4 20 0A       		        		JR      NZ,FCOMP1	;
1823)   2EC6 CD D8 2E    		        		CALL    ICP	;
1824)   2EC9 3E 00       		FCOMP0:			LD      A,0	;
1825)   2ECB C8          		        		RET     Z               ;Equal	;Equal
1826)   2ECC 3E 80       		        		LD      A,80H	;
1827)   2ECE 1F          		        		RRA	;
1828)   2ECF C9          		        		RET	;
1830)   2ED0 CD 63 2E    		FCOMP1:			CALL    FLOAT2          ;Float both	;Float both
1831)   2ED3 CD E5 2E    		        		CALL    FCP	;
1832)   2ED6 18 F1       		        		JR      FCOMP0	;
1842)   2ED8 CD 04 2F    		ICP:			CALL    ICP1	;
1843)   2EDB 3E 00       		ZERO:			LD      A,0	;
1844)   2EDD D9          		        		EXX	;
1845)   2EDE 67          		        		LD      H,A	;
1846)   2EDF 6F          		        		LD      L,A	;
1847)   2EE0 D9          		        		EXX	;
1848)   2EE1 67          		        		LD      H,A	;
1849)   2EE2 6F          		        		LD      L,A	;
1850)   2EE3 4F          		        		LD      C,A	;
1851)   2EE4 C9          		        		RET	;
1853)   2EE5 CD F7 2E    		FCP:			CALL    FCP1	;
1854)   2EE8 18 F1       		        		JR      ZERO            ;PRESET FALSE	;PRESET FALSE
1856)   2EEA 79          		FCP0:			LD      A,C	;
1857)   2EEB B8          		        		CP      B               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
1858)   2EEC C0          		        		RET     NZ	;
1859)   2EED ED 52       		ICP0:			SBC     HL,DE           ;COMP MANTISSA MSB	;COMP MANTISSA MSB
1860)   2EEF 19          		        		ADD     HL,DE	;
1861)   2EF0 C0          		        		RET     NZ	;
1862)   2EF1 D9          		        		EXX	;
1863)   2EF2 ED 52       		        		SBC     HL,DE           ;COMP MANTISSA LSB	;COMP MANTISSA LSB
1864)   2EF4 19          		        		ADD     HL,DE	;
1865)   2EF5 D9          		        		EXX	;
1866)   2EF6 C9          		        		RET	;
1868)   2EF7 7C          		FCP1:			LD      A,H	;
1869)   2EF8 AA          		        		XOR     D	;
1870)   2EF9 7C          		        		LD      A,H	;
1871)   2EFA 17          		        		RLA	;
1872)   2EFB F8          		        		RET     M	;
1873)   2EFC 30 EC       		        		JR      NC,FCP0	;
1874)   2EFE CD EA 2E    		        		CALL    FCP0	;
1875)   2F01 C8          		        		RET     Z               ;** V0.1 BUG FIX	;** V0.1 BUG FIX
1876)   2F02 3F          		        		CCF	;
1877)   2F03 C9          		        		RET	;
1879)   2F04 7C          		ICP1:			LD      A,H	;
1880)   2F05 AA          		        		XOR     D	;
1881)   2F06 F2 ED 2E    		        		JP      P,ICP0	;
1882)   2F09 7C          		        		LD      A,H	;
1883)   2F0A 17          		        		RLA	;
1884)   2F0B C9          		        		RET	;
1890)   2F0C 05          		X10B:			DEC     B	;
1891)   2F0D 0C          		        		INC     C	;
1892)   2F0E CD 48 2F    		X5:			CALL    COPY0	;
1893)   2F11 CD 3B 2F    		        		CALL    D2C	;
1894)   2F14 CD 3B 2F    		        		CALL    D2C	;
1895)   2F17 08          		        		EX      AF,AF'          ;SAVE CARRY	;SAVE CARRY
1896)   2F18 D9          		ADD:			EXX	;
1897)   2F19 19          		        		ADD     HL,DE	;
1898)   2F1A D9          		        		EXX	;
1899)   2F1B ED 5A       		        		ADC     HL,DE	;
1900)   2F1D C9          		        		RET	;
1906)   2F1E D9          		SUB:			EXX	;
1907)   2F1F B7          		        		OR      A	;
1908)   2F20 ED 52       		        		SBC     HL,DE	;
1909)   2F22 D9          		        		EXX	;
1910)   2F23 ED 52       		        		SBC     HL,DE	;
1911)   2F25 C9          		        		RET	;
1924)   2F26 CD 48 2F    		X10:			CALL    COPY0           ;DED'E'=HLH'L'	;DED'E'=HLH'L'
1925)   2F29 CD 35 2F    		        		CALL    X2	;
1926)   2F2C D8          		        		RET     C               ;TOO BIG	;TOO BIG
1927)   2F2D CD 35 2F    		        		CALL    X2	;
1928)   2F30 D8          		        		RET     C	;
1929)   2F31 CD 18 2F    		        		CALL    ADD	;
1930)   2F34 D8          		        		RET     C	;
1931)   2F35 D9          		X2:			EXX	;
1932)   2F36 29          		        		ADD     HL,HL	;
1933)   2F37 D9          		        		EXX	;
1934)   2F38 ED 6A       		        		ADC     HL,HL	;
1935)   2F3A C9          		        		RET	;
1941)   2F3B 0C          		D2C:			INC     C	;
1942)   2F3C CB 3C       		D2:			SRL     H	;
1943)   2F3E CB 1D       		        		RR      L	;
1944)   2F40 D9          		        		EXX	;
1945)   2F41 CB 1C       		        		RR      H	;
1946)   2F43 CB 1D       		        		RR      L	;
1947)   2F45 D9          		        		EXX	;
1948)   2F46 C9          		        		RET	;
1953)   2F47 41          		COPY:			LD      B,C	;
1954)   2F48 54          		COPY0:			LD      D,H	;
1955)   2F49 5D          		        		LD      E,L	;
1956)   2F4A D9          		        		EXX	;
1957)   2F4B 54          		        		LD      D,H	;
1958)   2F4C 5D          		        		LD      E,L	;
1959)   2F4D D9          		        		EXX	;
1960)   2F4E C9          		        		RET	;
1966)   2F4F CD 47 2F    		SQUARE:			CALL    COPY	;
1967)   2F52 CD E7 26    		        		CALL    FMUL	;
1968)   2F55 DD E1       		PUSH5:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1969)   2F57 C5          		        		PUSH    BC	;
1970)   2F58 E5          		        		PUSH    HL	;
1971)   2F59 D9          		        		EXX	;
1972)   2F5A E5          		        		PUSH    HL	;
1973)   2F5B D9          		        		EXX	;
1974)   2F5C DD E9       		        		JP      (IX)            ;"RETURN"	;"RETURN"
1979)   2F5E DD E1       		POP5:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1980)   2F60 D9          		        		EXX	;
1981)   2F61 D1          		        		POP     DE	;
1982)   2F62 D9          		        		EXX	;
1983)   2F63 D1          		        		POP     DE	;
1984)   2F64 79          		        		LD      A,C	;
1985)   2F65 C1          		        		POP     BC	;
1986)   2F66 41          		        		LD      B,C	;
1987)   2F67 4F          		        		LD      C,A	;
1988)   2F68 DD E9       		        		JP      (IX)            ;"RETURN"	;"RETURN"
1995)   2F6A CD 55 2F    		RATIO:			CALL    PUSH5           ;SAVE X	;SAVE X
1996)   2F6D CD AA 29    		        		CALL    DONE	;
1997)   2F70 CD FC 25    		        		CALL    FADD	;
1998)   2F73 CD 5E 2F    		        		CALL    POP5            ;RESTORE X	;RESTORE X
1999)   2F76 CD 55 2F    		        		CALL    PUSH5           ;SAVE X+1	;SAVE X+1
2000)   2F79 CD 96 2E    		        		CALL    SWAP	;
2001)   2F7C CD AA 29    		        		CALL    DONE	;
2002)   2F7F CD E6 25    		        		CALL    FSUB	;
2003)   2F82 CD 5E 2F    		        		CALL    POP5            ;RESTORE X+1	;RESTORE X+1
2004)   2F85 C3 54 26    		        		JP      FDIV	;
2015)   2F88 DD 21 02 00 		POLY:			LD      IX,2	;
2016)   2F8C DD 39       		        		ADD     IX,SP	;
2017)   2F8E DD E3       		        		EX      (SP),IX	;
2018)   2F90 CD DB 2C    		        		CALL    DLOAD5          ;FIRST COEFFICIENT	;FIRST COEFFICIENT
2019)   2F93 CD E7 26    		POLY1:			CALL    FMUL	;
2020)   2F96 11 05 00    		        		LD      DE,5	;
2021)   2F99 DD 19       		        		ADD     IX,DE	;
2022)   2F9B CD DB 2C    		        		CALL    DLOAD5          ;NEXT COEFFICIENT	;NEXT COEFFICIENT
2023)   2F9E DD E3       		        		EX      (SP),IX	;
2024)   2FA0 04          		        		INC     B	;
2025)   2FA1 05          		        		DEC     B               ;TEST	;TEST
2026)   2FA2 FA FC 25    		        		JP      M,FADD	;
2027)   2FA5 CD FC 25    		        		CALL    FADD	;
2028)   2FA8 CD DB 2C    		        		CALL    DLOAD5          ;X	;X
2029)   2FAB DD E3       		        		EX      (SP),IX	;
2030)   2FAD 18 E4       		        		JR      POLY1	;
2039)   2FAF 3C          		POWR10:			INC     A	;
2040)   2FB0 08          		        		EX      AF,AF'	;
2041)   2FB1 E5          		        		PUSH    HL	;
2042)   2FB2 D9          		        		EXX	;
2043)   2FB3 E5          		        		PUSH    HL	;
2044)   2FB4 D9          		        		EXX	;
2045)   2FB5 CD AA 29    		        		CALL    DONE	;
2046)   2FB8 CD 96 2E    		        		CALL    SWAP	;
2047)   2FBB AF          		        		XOR     A	;
2048)   2FBC 08          		POWR11:			EX      AF,AF'	;
2049)   2FBD 3D          		        		DEC     A	;
2050)   2FBE 28 20       		        		JR      Z,POWR14        ;EXIT TYPE 1	;EXIT TYPE 1
2051)   2FC0 F2 C7 2F    		        		JP      P,POWR13	;
2052)   2FC3 B9          		        		CP      C	;
2053)   2FC4 38 1A       		        		JR      C,POWR14        ;EXIT TYPE 2	;EXIT TYPE 2
2054)   2FC6 3C          		        		INC     A	;
2055)   2FC7 08          		POWR13:			EX      AF,AF'	;
2056)   2FC8 3C          		        		INC     A	;
2057)   2FC9 CB FC       		        		SET     7,H	;
2058)   2FCB CD 0E 2F    		        		CALL    X5	;
2059)   2FCE 30 05       		        		JR      NC,POWR12	;
2060)   2FD0 08          		        		EX      AF,AF'	;
2061)   2FD1 CD 3B 2F    		        		CALL    D2C	;
2062)   2FD4 08          		        		EX      AF,AF'	;
2063)   2FD5 08          		POWR12:			EX      AF,AF'	;
2064)   2FD6 DC 82 2E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
2065)   2FD9 0C          		        		INC     C	;
2066)   2FDA FA BC 2F    		        		JP      M,POWR11	;
2067)   2FDD C3 AC 2E    		        		JP      OFLOW	;
2068)   2FE0 CD 96 2E    		POWR14:			CALL    SWAP	;
2069)   2FE3 CB BA       		        		RES     7,D	;
2070)   2FE5 D9          		        		EXX	;
2071)   2FE6 E1          		        		POP     HL	;
2072)   2FE7 D9          		        		EXX	;
2073)   2FE8 E1          		        		POP     HL	;
2074)   2FE9 08          		        		EX      AF,AF'	;
2075)   2FEA C9          		        		RET	;
2083)   2FEB B7          		DIVA:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
2084)   2FEC ED 42       		DIV0:			SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2085)   2FEE D9          		        		EXX	;
2086)   2FEF ED 42       		        		SBC     HL,BC	;
2087)   2FF1 D9          		        		EXX	;
2088)   2FF2 30 05       		        		JR      NC,DIV1	;
2089)   2FF4 09          		        		ADD     HL,BC           ;DIVIDEND+DIVISOR	;DIVIDEND+DIVISOR
2090)   2FF5 D9          		        		EXX	;
2091)   2FF6 ED 4A       		        		ADC     HL,BC	;
2092)   2FF8 D9          		        		EXX	;
2093)   2FF9 3F          		DIV1:			CCF	;
2094)   2FFA CB 13       		DIVC:			RL      E               ;SHIFT RESULT INTO DE	;SHIFT RESULT INTO DE
2095)   2FFC CB 12       		        		RL      D	;
2096)   2FFE D9          		        		EXX	;
2097)   2FFF CB 13       		        		RL      E	;
2098)   3001 CB 12       		        		RL      D	;
2099)   3003 D9          		        		EXX	;
2100)   3004 3C          		        		INC     A	;
2101)   3005 F0          		        		RET     P	;
2102)   3006 ED 6A       		DIVB:			ADC     HL,HL           ;DIVIDEND*2	;DIVIDEND*2
2103)   3008 D9          		        		EXX	;
2104)   3009 ED 6A       		        		ADC     HL,HL	;
2105)   300B D9          		        		EXX	;
2106)   300C 30 DE       		        		JR      NC,DIV0	;
2107)   300E B7          		        		OR      A	;
2108)   300F ED 42       		        		SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2109)   3011 D9          		        		EXX	;
2110)   3012 ED 42       		        		SBC     HL,BC	;
2111)   3014 D9          		        		EXX	;
2112)   3015 37          		        		SCF	;
2113)   3016 C3 FA 2F    		        		JP      DIVC	;
2121)   3019 B7          		MULA:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
2122)   301A D9          		MUL0:			EXX	;
2123)   301B CB 1A       		        		RR      D               ;MULTIPLIER/2	;MULTIPLIER/2
2124)   301D CB 1B       		        		RR      E	;
2125)   301F D9          		        		EXX	;
2126)   3020 CB 1A       		        		RR      D	;
2127)   3022 CB 1B       		        		RR      E	;
2128)   3024 30 05       		        		JR      NC,MUL1	;
2129)   3026 09          		        		ADD     HL,BC           ;ADD IN MULTIPLICAND	;ADD IN MULTIPLICAND
2130)   3027 D9          		        		EXX	;
2131)   3028 ED 4A       		        		ADC     HL,BC	;
2132)   302A D9          		        		EXX	;
2133)   302B 3C          		MUL1:			INC     A	;
2134)   302C F0          		        		RET     P	;
2135)   302D D9          		MULB:			EXX	;
2136)   302E CB 1C       		        		RR      H               ;PRODUCT/2	;PRODUCT/2
2137)   3030 CB 1D       		        		RR      L	;
2138)   3032 D9          		        		EXX	;
2139)   3033 CB 1C       		        		RR      H	;
2140)   3035 CB 1D       		        		RR      L	;
2141)   3037 C3 1A 30    		        		JP      MUL0	;
2149)   303A ED 42       		SQR1:		SBC     HL,BC	;
2150)   303C D9          		        		EXX	;
2151)   303D ED 42       		        		SBC     HL,BC	;
2152)   303F D9          		        		EXX	;
2153)   3040 0C          		        		INC     C	;
2154)   3041 30 07       		        		JR      NC,SQR2	;
2155)   3043 0D          		        		DEC     C	;
2156)   3044 09          		        		ADD     HL,BC	;
2157)   3045 D9          		        		EXX	;
2158)   3046 ED 4A       		        		ADC     HL,BC	;
2159)   3048 D9          		        		EXX	;
2160)   3049 0D          		        		DEC     C	;
2161)   304A 3C          		SQR2:			INC     A	;
2162)   304B F0          		        		RET     P	;
2163)   304C CB 21       		SQRA:			SLA     C	;
2164)   304E CB 10       		        		RL      B	;
2165)   3050 D9          		        		EXX	;
2166)   3051 CB 11       		        		RL      C	;
2167)   3053 CB 10       		        		RL      B	;
2168)   3055 D9          		        		EXX	;
2169)   3056 0C          		        		INC     C	;
2170)   3057 CB 23       		        		SLA     E	;
2171)   3059 CB 12       		        		RL      D	;
2172)   305B D9          		        		EXX	;
2173)   305C CB 13       		        		RL      E	;
2174)   305E CB 12       		        		RL      D	;
2175)   3060 D9          		        		EXX	;
2176)   3061 ED 6A       		        		ADC     HL,HL	;
2177)   3063 D9          		        		EXX	;
2178)   3064 ED 6A       		        		ADC     HL,HL	;
2179)   3066 D9          		        		EXX	;
2180)   3067 CB 23       		        		SLA     E	;
2181)   3069 CB 12       		        		RL      D	;
2182)   306B D9          		        		EXX	;
2183)   306C CB 13       		        		RL      E	;
2184)   306E CB 12       		        		RL      D	;
2185)   3070 D9          		        		EXX	;
2186)   3071 ED 6A       		        		ADC     HL,HL	;
2187)   3073 D9          		        		EXX	;
2188)   3074 ED 6A       		        		ADC     HL,HL	;
2189)   3076 D9          		        		EXX	;
2190)   3077 D2 3A 30    		        		JP      NC,SQR1	;
2191)   307A B7          		SQR3:			OR      A	;
2192)   307B ED 42       		        		SBC     HL,BC	;
2193)   307D D9          		        		EXX	;
2194)   307E ED 42       		        		SBC     HL,BC	;
2195)   3080 D9          		        		EXX	;
2196)   3081 0C          		        		INC     C	;
2197)   3082 C3 4A 30    		        		JP      SQR2	;
2199)   3085 29          		SQRB:			ADD     HL,HL	;
2200)   3086 D9          		        		EXX	;
2201)   3087 ED 6A       		        		ADC     HL,HL	;
2202)   3089 D9          		        		EXX	;
2203)   308A 38 EE       		        		JR      C,SQR3	;
2204)   308C 3C          		        		INC     A	;
2205)   308D 0C          		        		INC     C	;
2206)   308E ED 42       		        		SBC     HL,BC	;
2207)   3090 D9          		        		EXX	;
2208)   3091 ED 42       		        		SBC     HL,BC	;
2209)   3093 D9          		        		EXX	;
2210)   3094 D0          		        		RET     NC	;
2211)   3095 09          		        		ADD     HL,BC	;
2212)   3096 D9          		        		EXX	;
2213)   3097 ED 4A       		        		ADC     HL,BC	;
2214)   3099 D9          		        		EXX	;
2215)   309A 0D          		        		DEC     C	;
2216)   309B C9          		        		RET	;
2218)   309C DD 7E 00    		DIGITQ:			LD      A,(IX)	;
2219)   309F FE 3A       		        		CP      '9'+1	;
2220)   30A1 3F          		        		CCF	;
2221)   30A2 D8          		        		RET     C	;
2222)   30A3 FE 30       		        		CP      '0'	;
2223)   30A5 C9          		        		RET	;
2225)   30A6 DD 7E 00    		SIGNQ:			LD      A,(IX)	;
2226)   30A9 DD 23       		        		INC     IX	;
2227)   30AB FE 20       		        		CP      ' '	;
2228)   30AD 28 F7       		        		JR      Z,SIGNQ	;
2229)   30AF FE 2B       		        		CP      '+'	;
2230)   30B1 C8          		        		RET     Z	;
2231)   30B2 FE 2D       		        		CP      '-'	;
2232)   30B4 C8          		        		RET     Z	;
2233)   30B5 DD 2B       		        		DEC     IX	;
2234)   30B7 C9          		        		RET	;
 16)   6000 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6004 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6008 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   600C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6010 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6014 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6018 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   601C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6020 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6024 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6028 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   602C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6030 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6034 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6038 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   603C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6040 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6044 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6048 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   604C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6050 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6054 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6058 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   605C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6060 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6064 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6068 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   606C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6070 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6074 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6078 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   607C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6080 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6084 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6088 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   608C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6090 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6094 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   6098 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   609C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60A0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60A4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60A8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60AC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60B0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60B4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60B8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60BC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60C0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60C4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60C8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60CC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60D0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60D4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60D8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60DC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60E0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60E4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60E8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60EC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60F0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60F4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60F8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   60FC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 17)   6100 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6104 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6108 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   610C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6110 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6114 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6118 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   611C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6120 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6124 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6128 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   612C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6130 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6134 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6138 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   613C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6140 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6144 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6148 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   614C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6150 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6154 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6158 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   615C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6160 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6164 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6168 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   616C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6170 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6174 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6178 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   617C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6180 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6184 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6188 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   618C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6190 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6194 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   6198 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   619C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61A0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61A4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61A8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61AC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61B0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61B4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61B8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61BC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61C0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61C4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61C8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61CC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61D0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61D4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61D8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61DC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61E0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61E4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61E8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61EC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61F0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61F4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61F8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   61FC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 18)   6200 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6204 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6208 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   620C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6210 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6214 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6218 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   621C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6220 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6224 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6228 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   622C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6230 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6234 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6238 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   623C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6240 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6244 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6248 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   624C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6250 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6254 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6258 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   625C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6260 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6264 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   6268 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 21)   626C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6270 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6274 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6278 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   627C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6280 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6284 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6288 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   628C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6290 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6294 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   6298 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   629C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62A0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62A4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62A8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62AC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62B0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62B4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62B8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62BC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62C0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62C4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62C8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62CC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62D0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   62D4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 22)   62D8 00 00       		@FNPTR:  		DEFS    2               ;DYN. FUNCTION POINTER	;DYN. FUNCTION POINTER
 23)   62DA 00 00       		@PROPTR: 		DEFS    2               ;DYN. PROCEDURE POINTER	;DYN. PROCEDURE POINTER
 25)   62DC 00 00       		@PAGE:   		DEFS    2               ;START OF USER PROGRAM	;START OF USER PROGRAM
 26)   62DE 00 00       		@TOP:    		DEFS    2               ;FIRST LOCN AFTER PROG.	;FIRST LOCN AFTER PROG.
 27)   62E0 00 00       		@LOMEM:  		DEFS    2               ;START OF DYN. STORAGE	;START OF DYN. STORAGE
 28)   62E2 00 00       		@FREE:   		DEFS    2               ;FIRST FREE-SPACE BYTE	;FIRST FREE-SPACE BYTE
 29)   62E4 00 00       		@HIMEM:  		DEFS    2               ;FIRST PROTECTED BYTE	;FIRST PROTECTED BYTE
 31)   62E6 00 00       		@LINENO: 		DEFS    2               ;LINE NUMBER	;LINE NUMBER
 32)   62E8 00 00       		@TRACEN:		DEFS    2               ;TRACE FLAG	;TRACE FLAG
 33)   62EA 00 00       		@AUTONO:		DEFS    2               ;AUTO FLAG	;AUTO FLAG
 34)   62EC 00 00       		@ERRTRP:		DEFS    2               ;ERROR TRAP	;ERROR TRAP
 35)   62EE 00 00       		@ERRTXT:		DEFS    2               ;ERROR MESSAGE POINTER	;ERROR MESSAGE POINTER
 36)   62F0 00 00       		@DATPTR:		DEFS    2               ;DATA POINTER	;DATA POINTER
 37)   62F2 00 00       		@ERL:			DEFS    2               ;ERROR LINE	;ERROR LINE
 38)   62F4 00 00       		@ERRLIN:		DEFS    2               ;"ON ERROR" LINE	;"ON ERROR" LINE
 39)   62F6 00 00 00 00 		@RANDOM:		DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 39)   62FA 00          		@RANDOM:		DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 40)   62FB 00          		@COUNT:			DEFS    1               ;PRINT POSITION	;PRINT POSITION
 41)   62FC 00          		@WIDTH:			DEFS    1               ;PRINT WIDTH	;PRINT WIDTH
 42)   62FD 00          		@ERR:			DEFS    1               ;ERROR NUMBER	;ERROR NUMBER
 43)   62FE 00          		@LISTON:		DEFS    1               ;LISTO & OPT FLAG	;LISTO & OPT FLAG
 44)   62FF 00          		@INCREM:		DEFS    1               ;AUTO INCREMENT	;AUTO INCREMENT
