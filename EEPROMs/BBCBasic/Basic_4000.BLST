 38)   4000 21 00 FD    		COLD:  LD      HL,STAVAR       ;COLD START	;COLD START
 39)   4003 F9          		  LD      SP,HL	;
 40)   4004 36 0A       		  LD      (HL),10	;
 41)   4006 2C          		  INC     L	;
 42)   4007 36 09       		  LD      (HL),9	;
 43)   4009 2C          		  INC     L	;
 44)   400A AF          		  XOR     A	;
 45)   400B 77          		PURGE:  LD      (HL),A          ;CLEAR SCRATCHPAD	;CLEAR SCRATCHPAD
 46)   400C 2C          		  INC     L	;
 47)   400D 20 FC       		  JR      NZ,PURGE	;
 48)   400F 3E 37       		  LD      A,37H           ;V3.0	;V3.0
 49)   4011 32 FE FD    		  LD      (LISTON),A	;
 50)   4014 21 4B 40    		  LD      HL,NOTICE	;
 51)   4017 22 EE FD    		  LD      (ERRTXT),HL	;
 52)   401A CD 19 73    		  CALL    OSINIT	;
 53)   401D ED 53 E4 FD 		  LD      (HIMEM),DE	;
 54)   4021 22 DC FD    		  LD      (PAGE),HL	;
 55)   4024 CD C4 47    		  CALL    NEWIT	;
 56)   4027 C2 B0 4C    		  JP      NZ,CHAIN0       ;AUTO-RUN	;AUTO-RUN
 57)   402A CD 2B 4C    		  CALL    TELL	;
 58)   402D 42 42 43 20 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   4031 42 41 53 49 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   4035 43 20 28 5A 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   4039 38 30 29 20 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   403D 56 65 72 73 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   4041 69 6F 6E 20 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 58)   4045 33 2E 30 30 		  DEFM    "BBC BASIC (Z80) Version 3.00"	;
 59)   4049 0A 0D       		  DEFB 0AH,0DH	;
 60)   404B 28 43 29 20 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   404F 43 6F 70 79 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   4053 72 69 67 68 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   4057 74 20 52 2E 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   405B 54 2E 52 75 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   405F 73 73 65 6C 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   4063 6C 20 31 39 		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 60)   4067 38 37       		NOTICE:  DEFM    "(C) Copyright R.T.Russell 1987"	;
 61)   4069 0A 0D 0A 0D 		  DEFB 0AH,0DH,0AH,0DH	;
 62)   406D 00          		  DEFB    0	;
 63)   406E F6          		@WARM:  DEFB    0F6H	;
 64)   406F 37          		@CLOOP:  SCF	;
 65)   4070 ED 7B E4 FD 		  LD      SP,(HIMEM)	;
 66)   4074 CD A9 72    		  CALL    PROMPT          ;PROMPT USER	;PROMPT USER
 67)   4077 21 FE FD    		  LD      HL,LISTON	;
 68)   407A 7E          		  LD      A,(HL)	;
 69)   407B E6 0F       		  AND     0FH             ;LISTO	;LISTO
 70)   407D F6 30       		  OR      30H             ;OPT 3	;OPT 3
 71)   407F 77          		  LD      (HL),A	;
 72)   4080 ED 62       		  SBC     HL,HL           ;HL <- 0 (V3.0)	;HL <- 0 (V3.0)
 73)   4082 22 EC FD    		  LD      (ERRTRP),HL	;
 74)   4085 22 F4 FD    		  LD      (ERRLIN),HL	;
 75)   4088 2A EA FD    		  LD      HL,(AUTONO)	;
 76)   408B 22 E6 FD    		  LD      (LINENO),HL	;
 77)   408E 7C          		  LD      A,H	;
 78)   408F B5          		  OR      L	;
 79)   4090 28 17       		  JR      Z,NOAUTO	;
 80)   4092 E5          		  PUSH    HL	;
 81)   4093 CD 05 49    		  CALL    PBCD            ;AUTO NUMBER	;AUTO NUMBER
 82)   4096 E1          		  POP     HL	;
 83)   4097 ED 4B FF FD 		  LD      BC,(INCREM)	;
 84)   409B 06 00       		  LD      B,0	;
 85)   409D 09          		  ADD     HL,BC	;
 86)   409E DA E6 4A    		  JP      C,TOOBIG	;
 87)   40A1 22 EA FD    		  LD      (AUTONO),HL	;
 88)   40A4 3E 20       		  LD      A,' '	;
 89)   40A6 CD 74 48    		  CALL    OUTCHR	;
 90)   40A9 21 00 FB    		NOAUTO:  LD      HL,ACCS	;
 91)   40AC CD CB 74    		  CALL    OSLINE          ;GET CONSOLE INPUT	;GET CONSOLE INPUT
 92)   40AF AF          		  XOR     A	;
 93)   40B0 32 FB FD    		  LD      (COUNT),A	;
 94)   40B3 FD 21 00 FB 		  LD      IY,ACCS	;
 95)   40B7 CD C1 4A    		  CALL    LINNUM	;
 96)   40BA CD 78 64    		  CALL    NXT	;
 97)   40BD 7C          		  LD      A,H	;
 98)   40BE B5          		  OR      L	;
 99)   40BF 28 03       		  JR      Z,LNZERO        ;FOR AUTO (NON-MAPPED)	;FOR AUTO (NON-MAPPED)
100)   40C1 22 E6 FD    		  LD      (LINENO),HL	;
101)   40C4 11 00 FC    		LNZERO:  LD      DE,BUFFER	;
102)   40C7 0E 01       		  LD      C,1             ;LEFT MODE	;LEFT MODE
103)   40C9 CD 55 4B    		  CALL    LEXAN2          ;LEXICAL ANALYSIS	;LEXICAL ANALYSIS
104)   40CC 12          		  LD      (DE),A          ;TERMINATOR	;TERMINATOR
105)   40CD AF          		  XOR     A	;
106)   40CE 47          		  LD      B,A	;
107)   40CF 4B          		  LD      C,E             ;BC=LINE LENGTH	;BC=LINE LENGTH
108)   40D0 13          		  INC     DE	;
109)   40D1 12          		  LD      (DE),A          ;ZERO NEXT	;ZERO NEXT
110)   40D2 2A E6 FD    		  LD      HL,(LINENO)	;
111)   40D5 7C          		  LD      A,H	;
112)   40D6 B5          		  OR      L	;
113)   40D7 FD 21 00 FC 		  LD      IY,BUFFER       ;FOR XEQ	;FOR XEQ
114)   40DB CA E8 4C    		  JP      Z,XEQ           ;DIRECT MODE	;DIRECT MODE
115)   40DE C5          		  PUSH    BC	;
116)   40DF E5          		  PUSH    HL	;
117)   40E0 CD A8 47    		  CALL    SETTOP          ;SET TOP	;SET TOP
118)   40E3 E1          		  POP     HL	;
119)   40E4 CD AB 48    		  CALL    FINDL	;
120)   40E7 CC 68 47    		  CALL    Z,DEL	;
121)   40EA C1          		  POP     BC	;
122)   40EB 79          		  LD      A,C	;
123)   40EC B7          		  OR      A	;
124)   40ED CA 6F 40    		  JP      Z,CLOOP         ;DELETE LINE ONLY	;DELETE LINE ONLY
125)   40F0 C6 04       		  ADD     A,4	;
126)   40F2 4F          		  LD      C,A             ;LENGTH INCLUSIVE	;LENGTH INCLUSIVE
127)   40F3 D5          		  PUSH    DE              ;LINE NUMBER	;LINE NUMBER
128)   40F4 C5          		  PUSH    BC              ;SAVE LINE LENGTH	;SAVE LINE LENGTH
129)   40F5 EB          		  EX      DE,HL	;
130)   40F6 2A DE FD    		  LD      HL,(TOP)	;
131)   40F9 E5          		  PUSH    HL	;
132)   40FA 09          		  ADD     HL,BC	;
133)   40FB E5          		  PUSH    HL	;
134)   40FC 24          		  INC     H	;
135)   40FD AF          		  XOR     A	;
136)   40FE ED 72       		  SBC     HL,SP	;
137)   4100 E1          		  POP     HL	;
138)   4101 D2 DB 46    		  JP      NC,ERROR        ;"No room"	;"No room"
139)   4104 22 DE FD    		  LD      (TOP),HL	;
140)   4107 E3          		  EX      (SP),HL	;
141)   4108 E5          		  PUSH    HL	;
142)   4109 23          		  INC     HL	;
143)   410A B7          		  OR      A	;
144)   410B ED 52       		  SBC     HL,DE	;
145)   410D 44          		  LD      B,H             ;BC=AMOUNT TO MOVE	;BC=AMOUNT TO MOVE
146)   410E 4D          		  LD      C,L	;
147)   410F E1          		  POP     HL	;
148)   4110 D1          		  POP     DE	;
149)   4111 28 02       		  JR      Z,ATEND	;
150)   4113 ED B8       		  LDDR                    ;MAKE SPACE	;MAKE SPACE
151)   4115 C1          		ATEND:  POP     BC              ;LINE LENGTH	;LINE LENGTH
152)   4116 D1          		  POP     DE              ;LINE NUMBER	;LINE NUMBER
153)   4117 23          		  INC     HL	;
154)   4118 71          		  LD      (HL),C          ;STORE LENGTH	;STORE LENGTH
155)   4119 23          		  INC     HL	;
156)   411A 73          		  LD      (HL),E          ;STORE LINE NUMBER	;STORE LINE NUMBER
157)   411B 23          		  INC     HL	;
158)   411C 72          		  LD      (HL),D	;
159)   411D 23          		  INC     HL	;
160)   411E 11 00 FC    		  LD      DE,BUFFER	;
161)   4121 EB          		  EX      DE,HL	;
162)   4122 0D          		  DEC     C	;
163)   4123 0D          		  DEC     C	;
164)   4124 0D          		  DEC     C	;
165)   4125 ED B0       		  LDIR                    ;ADD LINE	;ADD LINE
166)   4127 CD 9D 47    		  CALL    CLEAN	;
167)   412A C3 6F 40    		  JP      CLOOP 	;
174)   412D 80          		KEYWDS:  DEFB    80H	;
175)   412E 41 4E 44    		  DEFM    'AND'	;
176)   4131 94          		  DEFB    94H	;
177)   4132 41 42 53    		  DEFM    'ABS'	;
178)   4135 95          		  DEFB    95H	;
179)   4136 41 43 53    		  DEFM    'ACS'	;
180)   4139 96          		  DEFB    96H	;
181)   413A 41 44 56 41 		  DEFM    'ADVAL'	;
181)   413E 4C          		  DEFM    'ADVAL'	;
182)   413F 97          		  DEFB    97H	;
183)   4140 41 53 43    		  DEFM    'ASC'	;
184)   4143 98          		  DEFB    98H	;
185)   4144 41 53 4E    		  DEFM    'ASN'	;
186)   4147 99          		  DEFB    99H	;
187)   4148 41 54 4E    		  DEFM    'ATN'	;
188)   414B C6          		  DEFB    0C6H	;
189)   414C 41 55 54 4F 		  DEFM    'AUTO'	;
190)   4150 9A          		  DEFB    9AH	;
191)   4151 42 47 45 54 		  DEFM    'BGET'	;
192)   4155 00          		  DEFB    0	;
193)   4156 D5          		  DEFB    0D5H	;
194)   4157 42 50 55 54 		  DEFM    'BPUT'	;
195)   415B 00          		  DEFB    0	;
196)   415C FB          		  DEFB    0FBH	;
197)   415D 43 4F 4C 4F 		  DEFM    'COLOUR'	;
197)   4161 55 52       		  DEFM    'COLOUR'	;
198)   4163 FB          		  DEFB    0FBH	;
199)   4164 43 4F 4C 4F 		  DEFM    'COLOR'	;
199)   4168 52          		  DEFM    'COLOR'	;
200)   4169 D6          		  DEFB    0D6H	;
201)   416A 43 41 4C 4C 		  DEFM    'CALL'	;
202)   416E D7          		  DEFB    0D7H	;
203)   416F 43 48 41 49 		  DEFM    'CHAIN'	;
203)   4173 4E          		  DEFM    'CHAIN'	;
204)   4174 BD          		  DEFB    0BDH	;
205)   4175 43 48 52 24 		  DEFM    'CHR$'	;
206)   4179 D8          		  DEFB    0D8H	;
207)   417A 43 4C 45 41 		  DEFM    'CLEAR'	;
207)   417E 52          		  DEFM    'CLEAR'	;
208)   417F 00          		  DEFB    0	;
209)   4180 D9          		  DEFB    0D9H	;
210)   4181 43 4C 4F 53 		  DEFM    'CLOSE'	;
210)   4185 45          		  DEFM    'CLOSE'	;
211)   4186 00          		  DEFB    0	;
212)   4187 DA          		  DEFB    0DAH	;
213)   4188 43 4C 47    		  DEFM    'CLG'	;
214)   418B 00          		  DEFB    0	;
215)   418C DB          		  DEFB    0DBH	;
216)   418D 43 4C 53    		  DEFM    'CLS'	;
217)   4190 00          		  DEFB    0	;
218)   4191 9B          		  DEFB    9BH	;
219)   4192 43 4F 53    		  DEFM    'COS'	;
220)   4195 9C          		  DEFB    9CH	;
221)   4196 43 4F 55 4E 		  DEFM    'COUNT'	;
221)   419A 54          		  DEFM    'COUNT'	;
222)   419B 00          		  DEFB    0	;
223)   419C DC          		  DEFB    0DCH	;
224)   419D 44 41 54 41 		  DEFM    'DATA'	;
225)   41A1 9D          		  DEFB    9DH	;
226)   41A2 44 45 47    		  DEFM    'DEG'	;
227)   41A5 DD          		  DEFB    0DDH	;
228)   41A6 44 45 46    		  DEFM    'DEF'	;
229)   41A9 C7          		  DEFB    0C7H	;
230)   41AA 44 45 4C 45 		  DEFM    'DELETE'	;
230)   41AE 54 45       		  DEFM    'DELETE'	;
231)   41B0 81          		  DEFB    81H	;
232)   41B1 44 49 56    		  DEFM    'DIV'	;
233)   41B4 DE          		  DEFB    0DEH	;
234)   41B5 44 49 4D    		  DEFM    'DIM'	;
235)   41B8 DF          		  DEFB    0DFH	;
236)   41B9 44 52 41 57 		  DEFM    'DRAW'	;
237)   41BD E1          		  DEFB    0E1H	;
238)   41BE 45 4E 44 50 		  DEFM    'ENDPROC'	;
238)   41C2 52 4F 43    		  DEFM    'ENDPROC'	;
239)   41C5 00          		  DEFB    0	;
240)   41C6 E0          		  DEFB    0E0H	;
241)   41C7 45 4E 44    		  DEFM    'END'	;
242)   41CA 00          		  DEFB    0	;
243)   41CB E2          		  DEFB    0E2H	;
244)   41CC 45 4E 56 45 		  DEFM    'ENVELOPE'	;
244)   41D0 4C 4F 50 45 		  DEFM    'ENVELOPE'	;
245)   41D4 8B          		  DEFB    8BH	;
246)   41D5 45 4C 53 45 		  DEFM    'ELSE'	;
247)   41D9 A0          		  DEFB    0A0H	;
248)   41DA 45 56 41 4C 		  DEFM    'EVAL'	;
249)   41DE 9E          		  DEFB    9EH	;
250)   41DF 45 52 4C    		  DEFM    'ERL'	;
251)   41E2 00          		  DEFB    0	;
252)   41E3 85          		  DEFB    85H	;
253)   41E4 45 52 52 4F 		  DEFM    'ERROR'	;
253)   41E8 52          		  DEFM    'ERROR'	;
254)   41E9 C5          		  DEFB    0C5H	;
255)   41EA 45 4F 46    		  DEFM    'EOF'	;
256)   41ED 00          		  DEFB    0	;
257)   41EE 82          		  DEFB    82H	;
258)   41EF 45 4F 52    		  DEFM    'EOR'	;
259)   41F2 9F          		  DEFB    9FH	;
260)   41F3 45 52 52    		  DEFM    'ERR'	;
261)   41F6 00          		  DEFB    0	;
262)   41F7 A1          		  DEFB    0A1H	;
263)   41F8 45 58 50    		  DEFM    'EXP'	;
264)   41FB A2          		  DEFB    0A2H	;
265)   41FC 45 58 54    		  DEFM    'EXT'	;
266)   41FF 00          		  DEFB    0	;
267)   4200 E3          		  DEFB    0E3H	;
268)   4201 46 4F 52    		  DEFM    'FOR'	;
269)   4204 A3          		  DEFB    0A3H	;
270)   4205 46 41 4C 53 		  DEFM    'FALSE'	;
270)   4209 45          		  DEFM    'FALSE'	;
271)   420A 00          		  DEFB    0	;
272)   420B A4          		  DEFB    0A4H	;
273)   420C 46 4E       		  DEFM    'FN'	;
274)   420E E5          		  DEFB    0E5H	;
275)   420F 47 4F 54 4F 		  DEFM    'GOTO'	;
276)   4213 BE          		  DEFB    0BEH	;
277)   4214 47 45 54 24 		  DEFM    'GET$'	;
278)   4218 A5          		  DEFB    0A5H	;
279)   4219 47 45 54    		  DEFM    'GET'	;
280)   421C E4          		  DEFB    0E4H	;
281)   421D 47 4F 53 55 		  DEFM    'GOSUB'	;
281)   4221 42          		  DEFM    'GOSUB'	;
282)   4222 E6          		  DEFB    0E6H	;
283)   4223 47 43 4F 4C 		  DEFM    'GCOL'	;
284)   4227 93          		  DEFB    93H	;
285)   4228 48 49 4D 45 		  DEFM    'HIMEM'	;
285)   422C 4D          		  DEFM    'HIMEM'	;
286)   422D 00          		  DEFB    0	;
287)   422E E8          		  DEFB    0E8H	;
288)   422F 49 4E 50 55 		  DEFM    'INPUT'	;
288)   4233 54          		  DEFM    'INPUT'	;
289)   4234 E7          		  DEFB    0E7H	;
290)   4235 49 46       		  DEFM    'IF'	;
291)   4237 BF          		  DEFB    0BFH	;
292)   4238 49 4E 4B 45 		  DEFM    'INKEY$'	;
292)   423C 59 24       		  DEFM    'INKEY$'	;
293)   423E A6          		  DEFB    0A6H	;
294)   423F 49 4E 4B 45 		  DEFM    'INKEY'	;
294)   4243 59          		  DEFM    'INKEY'	;
295)   4244 A8          		  DEFB    0A8H	;
296)   4245 49 4E 54    		  DEFM    'INT'	;
297)   4248 A7          		  DEFB    0A7H	;
298)   4249 49 4E 53 54 		  DEFM    'INSTR('	;
298)   424D 52 28       		  DEFM    'INSTR('	;
299)   424F C9          		  DEFB    0C9H	;
300)   4250 4C 49 53 54 		  DEFM    'LIST'	;
301)   4254 86          		  DEFB    86H	;
302)   4255 4C 49 4E 45 		  DEFM    'LINE'	;
303)   4259 C8          		  DEFB    0C8H	;
304)   425A 4C 4F 41 44 		  DEFM    'LOAD'	;
305)   425E 92          		  DEFB    92H	;
306)   425F 4C 4F 4D 45 		  DEFM    'LOMEM'	;
306)   4263 4D          		  DEFM    'LOMEM'	;
307)   4264 00          		  DEFB    0	;
308)   4265 EA          		  DEFB    0EAH	;
309)   4266 4C 4F 43 41 		  DEFM    'LOCAL'	;
309)   426A 4C          		  DEFM    'LOCAL'	;
310)   426B C0          		  DEFB    0C0H	;
311)   426C 4C 45 46 54 		  DEFM    'LEFT$('	;
311)   4270 24 28       		  DEFM    'LEFT$('	;
312)   4272 A9          		  DEFB    0A9H	;
313)   4273 4C 45 4E    		  DEFM    'LEN'	;
314)   4276 E9          		  DEFB    0E9H	;
315)   4277 4C 45 54    		  DEFM    'LET'	;
316)   427A AB          		  DEFB    0ABH	;
317)   427B 4C 4F 47    		  DEFM    'LOG'	;
318)   427E AA          		  DEFB    0AAH	;
319)   427F 4C 4E       		  DEFM    'LN'	;
320)   4281 C1          		  DEFB    0C1H	;
321)   4282 4D 49 44 24 		  DEFM    'MID$('	;
321)   4286 28          		  DEFM    'MID$('	;
322)   4287 EB          		  DEFB    0EBH	;
323)   4288 4D 4F 44 45 		  DEFM    'MODE'	;
324)   428C 83          		  DEFB    83H	;
325)   428D 4D 4F 44    		  DEFM    'MOD'	;
326)   4290 EC          		  DEFB    0ECH	;
327)   4291 4D 4F 56 45 		  DEFM    'MOVE'	;
328)   4295 ED          		  DEFB    0EDH	;
329)   4296 4E 45 58 54 		  DEFM    'NEXT'	;
330)   429A CA          		  DEFB    0CAH	;
331)   429B 4E 45 57    		  DEFM    'NEW'	;
332)   429E 00          		  DEFB    0	;
333)   429F AC          		  DEFB    0ACH	;
334)   42A0 4E 4F 54    		  DEFM    'NOT'	;
335)   42A3 CB          		  DEFB    0CBH	;
336)   42A4 4F 4C 44    		  DEFM    'OLD'	;
337)   42A7 00          		  DEFB    0	;
338)   42A8 EE          		  DEFB    0EEH	;
339)   42A9 4F 4E       		  DEFM    'ON'	;
340)   42AB 87          		  DEFB    87H	;
341)   42AC 4F 46 46    		  DEFM    'OFF'	;
342)   42AF 84          		  DEFB    84H	;
343)   42B0 4F 52       		  DEFM    'OR'	;
344)   42B2 8E          		  DEFB    8EH	;
345)   42B3 4F 50 45 4E 		  DEFM    'OPENIN'	;
345)   42B7 49 4E       		  DEFM    'OPENIN'	;
346)   42B9 AE          		  DEFB    0AEH	;
347)   42BA 4F 50 45 4E 		  DEFM    'OPENOUT'	;
347)   42BE 4F 55 54    		  DEFM    'OPENOUT'	;
348)   42C1 AD          		  DEFB    0ADH	;
349)   42C2 4F 50 45 4E 		  DEFM    'OPENUP'	;
349)   42C6 55 50       		  DEFM    'OPENUP'	;
350)   42C8 FF          		  DEFB    0FFH	;
351)   42C9 4F 53 43 4C 		  DEFM    'OSCLI'	;
351)   42CD 49          		  DEFM    'OSCLI'	;
352)   42CE F1          		  DEFB    0F1H	;
353)   42CF 50 52 49 4E 		  DEFM    'PRINT'	;
353)   42D3 54          		  DEFM    'PRINT'	;
354)   42D4 90          		  DEFB    90H	;
355)   42D5 50 41 47 45 		  DEFM    'PAGE'	;
356)   42D9 00          		  DEFB    0	;
357)   42DA 8F          		  DEFB    8FH	;
358)   42DB 50 54 52    		  DEFM    'PTR'	;
359)   42DE 00          		  DEFB    0	;
360)   42DF AF          		  DEFB    0AFH	;
361)   42E0 50 49       		  DEFM    'PI'	;
362)   42E2 00          		  DEFB    0	;
363)   42E3 F0          		  DEFB    0F0H	;
364)   42E4 50 4C 4F 54 		  DEFM    'PLOT'	;
365)   42E8 B0          		  DEFB    0B0H	;
366)   42E9 50 4F 49 4E 		  DEFM    'POINT('	;
366)   42ED 54 28       		  DEFM    'POINT('	;
367)   42EF F2          		  DEFB    0F2H	;
368)   42F0 50 52 4F 43 		  DEFM    'PROC'	;
369)   42F4 B1          		  DEFB    0B1H	;
370)   42F5 50 4F 53    		  DEFM    'POS'	;
371)   42F8 00          		  DEFB    0	;
372)   42F9 CE          		  DEFB    0CEH	;
373)   42FA 50 55 54    		  DEFM    'PUT'	;
374)   42FD F8          		  DEFB    0F8H	;
375)   42FE 52 45 54 55 		  DEFM    'RETURN'	;
375)   4302 52 4E       		  DEFM    'RETURN'	;
376)   4304 00          		  DEFB    0	;
377)   4305 F5          		  DEFB    0F5H	;
378)   4306 52 45 50 45 		  DEFM    'REPEAT'	;
378)   430A 41 54       		  DEFM    'REPEAT'	;
379)   430C F6          		  DEFB    0F6H	;
380)   430D 52 45 50 4F 		  DEFM    'REPORT'	;
380)   4311 52 54       		  DEFM    'REPORT'	;
381)   4313 00          		  DEFB    0	;
382)   4314 F3          		  DEFB    0F3H	;
383)   4315 52 45 41 44 		  DEFM    'READ'	;
384)   4319 F4          		  DEFB    0F4H	;
385)   431A 52 45 4D    		  DEFM    'REM'	;
386)   431D F9          		  DEFB    0F9H	;
387)   431E 52 55 4E    		  DEFM    'RUN'	;
388)   4321 00          		  DEFB    0	;
389)   4322 B2          		  DEFB    0B2H	;
390)   4323 52 41 44    		  DEFM    'RAD'	;
391)   4326 F7          		  DEFB    0F7H	;
392)   4327 52 45 53 54 		  DEFM    'RESTORE'	;
392)   432B 4F 52 45    		  DEFM    'RESTORE'	;
393)   432E C2          		  DEFB    0C2H	;
394)   432F 52 49 47 48 		  DEFM    'RIGHT$('	;
394)   4333 54 24 28    		  DEFM    'RIGHT$('	;
395)   4336 B3          		  DEFB    0B3H	;
396)   4337 52 4E 44    		  DEFM    'RND'	;
397)   433A 00          		  DEFB    0	;
398)   433B CC          		  DEFB    0CCH	;
399)   433C 52 45 4E 55 		  DEFM    'RENUMBER'	;
399)   4340 4D 42 45 52 		  DEFM    'RENUMBER'	;
400)   4344 88          		  DEFB    88H	;
401)   4345 53 54 45 50 		  DEFM    'STEP'	;
402)   4349 CD          		  DEFB    0CDH	;
403)   434A 53 41 56 45 		  DEFM    'SAVE'	;
404)   434E B4          		  DEFB    0B4H	;
405)   434F 53 47 4E    		  DEFM    'SGN'	;
406)   4352 B5          		  DEFB    0B5H	;
407)   4353 53 49 4E    		  DEFM    'SIN'	;
408)   4356 B6          		  DEFB    0B6H	;
409)   4357 53 51 52    		  DEFM    'SQR'	;
410)   435A 89          		  DEFB    89H	;
411)   435B 53 50 43    		  DEFM    'SPC'	;
412)   435E C3          		  DEFB    0C3H	;
413)   435F 53 54 52 24 		  DEFM    'STR$'	;
414)   4363 C4          		  DEFB    0C4H	;
415)   4364 53 54 52 49 		  DEFM    'STRING$('	;
415)   4368 4E 47 24 28 		  DEFM    'STRING$('	;
416)   436C D4          		  DEFB    0D4H	;
417)   436D 53 4F 55 4E 		  DEFM    'SOUND'	;
417)   4371 44          		  DEFM    'SOUND'	;
418)   4372 FA          		  DEFB    0FAH	;
419)   4373 53 54 4F 50 		  DEFM    'STOP'	;
420)   4377 00          		  DEFB    0	;
421)   4378 B7          		  DEFB    0B7H	;
422)   4379 54 41 4E    		  DEFM    'TAN'	;
423)   437C 8C          		  DEFB    8CH	;
424)   437D 54 48 45 4E 		  DEFM    'THEN'	;
425)   4381 B8          		  DEFB    0B8H	;
426)   4382 54 4F       		  DEFM    'TO'	;
427)   4384 8A          		  DEFB    8AH	;
428)   4385 54 41 42 28 		  DEFM    'TAB('	;
429)   4389 FC          		  DEFB    0FCH	;
430)   438A 54 52 41 43 		  DEFM    'TRACE'	;
430)   438E 45          		  DEFM    'TRACE'	;
431)   438F 91          		  DEFB    91H	;
432)   4390 54 49 4D 45 		  DEFM    'TIME'	;
433)   4394 00          		  DEFB    0	;
434)   4395 B9          		  DEFB    0B9H	;
435)   4396 54 52 55 45 		  DEFM    'TRUE'	;
436)   439A 00          		  DEFB    0	;
437)   439B FD          		  DEFB    0FDH	;
438)   439C 55 4E 54 49 		  DEFM    'UNTIL'	;
438)   43A0 4C          		  DEFM    'UNTIL'	;
439)   43A1 BA          		  DEFB    0BAH	;
440)   43A2 55 53 52    		  DEFM    'USR'	;
441)   43A5 EF          		  DEFB    0EFH	;
442)   43A6 56 44 55    		  DEFM    'VDU'	;
443)   43A9 BB          		  DEFB    0BBH	;
444)   43AA 56 41 4C    		  DEFM    'VAL'	;
445)   43AD BC          		  DEFB    0BCH	;
446)   43AE 56 50 4F 53 		  DEFM    'VPOS'	;
447)   43B2 00          		  DEFB    0	;
448)   43B3 FE          		  DEFB    0FEH	;
449)   43B4 57 49 44 54 		  DEFM    'WIDTH'	;
449)   43B8 48          		  DEFM    'WIDTH'	;
450)   43B9 D3          		  DEFB    0D3H	;
451)   43BA 48 49 4D 45 		  DEFM    'HIMEM'	;
451)   43BE 4D          		  DEFM    'HIMEM'	;
452)   43BF D2          		  DEFB    0D2H	;
453)   43C0 4C 4F 4D 45 		  DEFM    'LOMEM'	;
453)   43C4 4D          		  DEFM    'LOMEM'	;
454)   43C5 D0          		  DEFB    0D0H	;
455)   43C6 50 41 47 45 		  DEFM    'PAGE'	;
456)   43CA CF          		  DEFB    0CFH	;
457)   43CB 50 54 52    		  DEFM    'PTR'	;
458)   43CE D1          		  DEFB    0D1H	;
459)   43CF 54 49 4D 45 		  DEFM    'TIME'	;
460)   43D3 01          		  DEFB    1	;
461)   43D4 4D 69 73 73 		  DEFM    'Missing '	;
461)   43D8 69 6E 67 20 		  DEFM    'Missing '	;
462)   43DC 02          		  DEFB    2	;
463)   43DD 4E 6F 20 73 		  DEFM    'No such '	;
463)   43E1 75 63 68 20 		  DEFM    'No such '	;
464)   43E5 03          		  DEFB    3	;
465)   43E6 42 61 64 20 		  DEFM    'Bad '	;
466)   43EA 04          		  DEFB    4	;
467)   43EB 20 72 61 6E 		  DEFM    ' range'	;
467)   43EF 67 65       		  DEFM    ' range'	;
468)   43F1 05          		  DEFB    5	;
469)   43F2 76 61 72 69 		  DEFM    'variable'	;
469)   43F6 61 62 6C 65 		  DEFM    'variable'	;
470)   43FA 06          		  DEFB    6	;
471)   43FB 4F 75 74 20 		  DEFM    'Out of'	;
471)   43FF 6F 66       		  DEFM    'Out of'	;
472)   4401 07          		  DEFB    7	;
473)   4402 4E 6F 20    		  DEFM    'No '	;
474)   4405 08          		  DEFB    8	;
475)   4406 20 73 70 61 		  DEFM    ' space'	;
475)   440A 63 65       		  DEFM    ' space'	;
477)   440C FF FF       		  DEFW    -1	;
481)   440E 07          		ERRWDS:  DEFB    7	;
482)   440F 72 6F 6F 6D 		  DEFM    'room'	;
483)   4413 00          		  DEFB    0	;
484)   4414 06          		  DEFB    6	;
485)   4415 04          		  DEFB    4	;
486)   4416 00          		  DEFB    0	;
487)   4417 00 00       		  DEFW    0	;
488)   4419 4D 69 73 74 		  DEFM    'Mistake'	;
488)   441D 61 6B 65    		  DEFM    'Mistake'	;
489)   4420 00          		  DEFB    0	;
490)   4421 01          		  DEFB    1	;
491)   4422 2C          		  DEFM    ','	;
492)   4423 00          		  DEFB    0	;
493)   4424 54 79 70 65 		  DEFM    'Type mismatch'	;
493)   4428 20 6D 69 73 		  DEFM    'Type mismatch'	;
493)   442C 6D 61 74 63 		  DEFM    'Type mismatch'	;
493)   4430 68          		  DEFM    'Type mismatch'	;
494)   4431 00          		  DEFB    0	;
495)   4432 07          		  DEFB    7	;
496)   4433 A4          		  DEFB    FN	;
497)   4434 00 00       		  DEFW    0	;
498)   4436 01          		  DEFB    1	;
499)   4437 22          		  DEFB    34  ;ASCII ""	;ASCII ""
500)   4438 00          		  DEFB    0	;
501)   4439 03          		  DEFB    3	;
502)   443A DE          		  DEFB    DIM	;
503)   443B 00          		  DEFB    0	;
504)   443C DE          		  DEFB    DIM	;
505)   443D 08          		  DEFB    8	;
506)   443E 00          		  DEFB    0	;
507)   443F 4E 6F 74 20 		  DEFM    'Not '	;
508)   4443 EA          		  DEFB    LOCAL	;
509)   4444 00          		  DEFB    0	;
510)   4445 07          		  DEFB    7	;
511)   4446 F2          		  DEFB    PROC	;
512)   4447 00          		  DEFB    0	;
513)   4448 41 72 72 61 		  DEFM    'Array'	;
513)   444C 79          		  DEFM    'Array'	;
514)   444D 00          		  DEFB    0	;
515)   444E 53 75 62 73 		  DEFM    'Subscript'	;
515)   4452 63 72 69 70 		  DEFM    'Subscript'	;
515)   4456 74          		  DEFM    'Subscript'	;
516)   4457 00          		  DEFB    0	;
517)   4458 53 79 6E 74 		  DEFM    'Syntax error'	;
517)   445C 61 78 20 65 		  DEFM    'Syntax error'	;
517)   4460 72 72 6F 72 		  DEFM    'Syntax error'	;
518)   4464 00          		  DEFB    0	;
519)   4465 45 73 63 61 		  DEFM    'Escape'	;
519)   4469 70 65       		  DEFM    'Escape'	;
520)   446B 00          		  DEFB    0	;
521)   446C 44 69 76 69 		  DEFM    'Division by zero'	;
521)   4470 73 69 6F 6E 		  DEFM    'Division by zero'	;
521)   4474 20 62 79 20 		  DEFM    'Division by zero'	;
521)   4478 7A 65 72 6F 		  DEFM    'Division by zero'	;
522)   447C 00          		  DEFB    0	;
523)   447D 53 74 72 69 		  DEFM    'String too long'	;
523)   4481 6E 67 20 74 		  DEFM    'String too long'	;
523)   4485 6F 6F 20 6C 		  DEFM    'String too long'	;
523)   4489 6F 6E 67    		  DEFM    'String too long'	;
524)   448C 00          		  DEFB    0	;
525)   448D 54 6F 6F 20 		  DEFM    'Too big'	;
525)   4491 62 69 67    		  DEFM    'Too big'	;
526)   4494 00          		  DEFB    0	;
527)   4495 2D 76 65 20 		  DEFM    '-ve root'	;
527)   4499 72 6F 6F 74 		  DEFM    '-ve root'	;
528)   449D 00          		  DEFB    0	;
529)   449E 4C 6F 67    		  DEFM    'Log'	;
530)   44A1 04          		  DEFB    4	;
531)   44A2 00          		  DEFB    0	;
532)   44A3 41 63 63 75 		  DEFM    'Accuracy lost'	;
532)   44A7 72 61 63 79 		  DEFM    'Accuracy lost'	;
532)   44AB 20 6C 6F 73 		  DEFM    'Accuracy lost'	;
532)   44AF 74          		  DEFM    'Accuracy lost'	;
533)   44B0 00          		  DEFB    0	;
534)   44B1 45 78 70    		  DEFM    'Exp'	;
535)   44B4 04          		  DEFB    4	;
536)   44B5 00 00       		  DEFW    0	;
537)   44B7 02          		  DEFB    2	;
538)   44B8 05          		  DEFB    5	;
539)   44B9 00          		  DEFB    0	;
540)   44BA 01          		  DEFB    1	;
541)   44BB 29          		  DEFM    ')'	;
542)   44BC 00          		  DEFB    0	;
543)   44BD 03          		  DEFB    3	;
544)   44BE 48 45 58    		  DEFM    'HEX'	;
545)   44C1 00          		  DEFB    0	;
546)   44C2 02          		  DEFB    2	;
547)   44C3 A4          		  DEFB    FN	;
548)   44C4 2F          		  DEFM    '/'	;
549)   44C5 F2          		  DEFB    PROC	;
550)   44C6 00          		  DEFB    0	;
551)   44C7 03          		  DEFB    3	;
552)   44C8 63 61 6C 6C 		  DEFM    'call'	;
553)   44CC 00          		  DEFB    0	;
554)   44CD 41 72 67 75 		  DEFM    'Arguments'	;
554)   44D1 6D 65 6E 74 		  DEFM    'Arguments'	;
554)   44D5 73          		  DEFM    'Arguments'	;
555)   44D6 00          		  DEFB    0	;
556)   44D7 07          		  DEFB    7	;
557)   44D8 E3          		  DEFB    FOR	;
558)   44D9 00          		  DEFB    0	;
559)   44DA 43 61 6E 27 		  DEFM    'Can't match '	;
559)   44DE 74 20 6D 61 		  DEFM    'Can't match '	;
559)   44E2 74 63 68 20 		  DEFM    'Can't match '	;
560)   44E6 E3          		  DEFB    FOR	;
561)   44E7 00          		  DEFB    0	;
562)   44E8 E3          		  DEFB    FOR	;
563)   44E9 20          		  DEFM    ' '	;
564)   44EA 05          		  DEFB    5	;
565)   44EB 00 00       		  DEFW    0	;
566)   44ED 07          		  DEFB    7	;
567)   44EE B8          		  DEFB    TO	;
568)   44EF 00 00       		  DEFW    0	;
569)   44F1 07          		  DEFB    7	;
570)   44F2 E4          		  DEFB    GOSUB	;
571)   44F3 00          		  DEFB    0	;
572)   44F4 EE          		  DEFB    ON	;
573)   44F5 20 73 79 6E 		  DEFM    ' syntax'	;
573)   44F9 74 61 78    		  DEFM    ' syntax'	;
574)   44FC 00          		  DEFB    0	;
575)   44FD EE          		  DEFB    ON	;
576)   44FE 04          		  DEFB    4	;
577)   44FF 00          		  DEFB    0	;
578)   4500 02          		  DEFB    2	;
579)   4501 6C 69 6E 65 		  DEFM    'line'	;
580)   4505 00          		  DEFB    0	;
581)   4506 06          		  DEFB    6	;
582)   4507 20          		  DEFM    ' '	;
583)   4508 DC          		  DEFB    DATA	;
584)   4509 00          		  DEFB    0	;
585)   450A 07          		  DEFB    7	;
586)   450B F5          		  DEFB    REPEAT	;
587)   450C 00 00       		  DEFW    0	;
588)   450E 01          		  DEFB    1	;
589)   450F 23          		  DEFM    '#'	;
590)   4510 00          		  DEFB    0	;
596)   4511 CD A8 47    		@DELETE: CALL    SETTOP          ;SET TOP	;SET TOP
597)   4514 CD 0E 4B    		  CALL    DLPAIR	;
598)   4517 7E          		DELET1:  LD      A,(HL)	;
599)   4518 B7          		  OR      A	;
600)   4519 28 71       		  JR      Z,WARMNC	;
601)   451B 23          		  INC     HL	;
602)   451C 5E          		  LD      E,(HL)	;
603)   451D 23          		  INC     HL	;
604)   451E 56          		  LD      D,(HL)	;
605)   451F 7A          		  LD      A,D	;
606)   4520 B3          		  OR      E	;
607)   4521 28 1A       		  JR      Z,CLOOP1        ;LINE NUMBER ZERO	;LINE NUMBER ZERO
608)   4523 2B          		  DEC     HL	;
609)   4524 2B          		  DEC     HL	;
610)   4525 EB          		  EX      DE,HL	;
611)   4526 37          		  SCF	;
612)   4527 ED 42       		  SBC     HL,BC	;
613)   4529 EB          		  EX      DE,HL	;
614)   452A 30 60       		  JR      NC,WARMNC	;
615)   452C C5          		  PUSH    BC	;
616)   452D CD 68 47    		  CALL    DEL	;
617)   4530 C1          		  POP     BC	;
618)   4531 18 E4       		  JR      DELET1	;
622)   4533 FD 23       		LISTO:  INC     IY              ;SKIP "O"	;SKIP "O"
623)   4535 CD 94 5E    		  CALL    EXPRI	;
624)   4538 D9          		  EXX	;
625)   4539 7D          		  LD      A,L	;
626)   453A 32 FE FD    		  LD      (LISTON),A	;
627)   453D C3 6F 40    		CLOOP1:  JP      CLOOP	;
635)   4540 FE 4F       		@LIST:  CP      'O'	;
636)   4542 28 EF       		  JR      Z,LISTO	;
637)   4544 CD 0E 4B    		  CALL    DLPAIR	;
638)   4547 CD 78 64    		  CALL    NXT	;
639)   454A FE E7       		  CP      TIF             ;IF CLAUSE ?	;IF CLAUSE ?
640)   454C 3E 00       		  LD      A,0             ;INIT IF-CLAUSE LENGTH	;INIT IF-CLAUSE LENGTH
641)   454E 20 15       		  JR      NZ,LISTB	;
642)   4550 FD 23       		  INC     IY              ;SKIP IF	;SKIP IF
643)   4552 CD 78 64    		  CALL    NXT             ;SKIP SPACES (IF ANY)	;SKIP SPACES (IF ANY)
644)   4555 EB          		  EX      DE,HL	;
645)   4556 FD E5       		  PUSH    IY	;
646)   4558 E1          		  POP     HL              ;HL ADDRESSES IF CLAUSE	;HL ADDRESSES IF CLAUSE
647)   4559 3E 0D       		  LD      A,CR	;
648)   455B C5          		  PUSH    BC	;
649)   455C 01 00 01    		  LD      BC,256	;
650)   455F ED B1       		  CPIR                    ;LOCATE CR	;LOCATE CR
651)   4561 79          		  LD      A,C	;
652)   4562 2F          		  CPL                     ;A = SUBSTRING LENGTH	;A = SUBSTRING LENGTH
653)   4563 C1          		  POP     BC	;
654)   4564 EB          		  EX      DE,HL	;
655)   4565 5F          		LISTB:  LD      E,A             ;IF-CLAUSE LENGTH	;IF-CLAUSE LENGTH
656)   4566 78          		  LD      A,B	;
657)   4567 B1          		  OR      C	;
658)   4568 20 01       		  JR      NZ,LISTA	;
659)   456A 0B          		  DEC     BC	;
660)   456B D9          		LISTA:  EXX	;
661)   456C DD 21 FE FD 		  LD      IX,LISTON	;
662)   4570 01 00 00    		  LD      BC,0            ;INDENTATION COUNT	;INDENTATION COUNT
663)   4573 D9          		  EXX	;
664)   4574 3E 14       		  LD      A,20	;
666)   4576 C5          		LISTC:  PUSH    BC              ;SAVE HIGH LINE NUMBER	;SAVE HIGH LINE NUMBER
667)   4577 D5          		  PUSH    DE              ;SAVE IF-CLAUSE LENGTH	;SAVE IF-CLAUSE LENGTH
668)   4578 E5          		  PUSH    HL              ;SAVE PROGRAM POINTER	;SAVE PROGRAM POINTER
669)   4579 08          		  EX      AF,AF'	;
670)   457A 7E          		  LD      A,(HL)	;
671)   457B B7          		  OR      A	;
672)   457C 28 0E       		  JR      Z,WARMNC	;
676)   457E 7B          		  LD      A,E             ;A = IF-CLAUSE LENGTH	;A = IF-CLAUSE LENGTH
677)   457F 23          		  INC     HL	;
678)   4580 5E          		  LD      E,(HL)	;
679)   4581 23          		  INC     HL	;
680)   4582 56          		  LD      D,(HL)          ;DE = LINE NUMBER	;DE = LINE NUMBER
681)   4583 2B          		  DEC     HL	;
682)   4584 2B          		  DEC     HL	;
683)   4585 D5          		  PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
684)   4586 EB          		  EX      DE,HL	;
685)   4587 37          		  SCF	;
686)   4588 ED 42       		  SBC     HL,BC	;
687)   458A EB          		  EX      DE,HL	;
688)   458B D1          		  POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
689)   458C D2 6E 40    		WARMNC:  JP      NC,WARM	;
690)   458F 4E          		  LD      C,(HL)          ;C = LINE LENGTH + 4	;C = LINE LENGTH + 4
691)   4590 47          		  LD      B,A             ;B = IF-CLAUSE LENGTH	;B = IF-CLAUSE LENGTH
695)   4591 7A          		  LD      A,D	;
696)   4592 B3          		  OR      E	;
697)   4593 CA 6F 40    		  JP      Z,CLOOP	;
701)   4596 23          		  INC     HL	;
702)   4597 23          		  INC     HL	;
703)   4598 23          		  INC     HL              ;HL ADDRESSES LINE TEXT	;HL ADDRESSES LINE TEXT
704)   4599 0D          		  DEC     C	;
705)   459A 0D          		  DEC     C	;
706)   459B 0D          		  DEC     C	;
707)   459C 0D          		  DEC     C               ;C = LINE LENGTH	;C = LINE LENGTH
708)   459D D5          		  PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
709)   459E E5          		  PUSH    HL              ;SAVE LINE ADDRESS	;SAVE LINE ADDRESS
710)   459F AF          		  XOR     A               ;A <- 0	;A <- 0
711)   45A0 B8          		  CP      B               ;WAS THERE AN IF-CLAUSE	;WAS THERE AN IF-CLAUSE
712)   45A1 FD E5       		  PUSH    IY	;
713)   45A3 D1          		  POP     DE              ;DE ADDRESSES IF-CLAUSE	;DE ADDRESSES IF-CLAUSE
714)   45A4 C4 33 62    		  CALL    NZ,SEARCH       ;SEARCH FOR IF CLAUSE	;SEARCH FOR IF CLAUSE
715)   45A7 E1          		  POP     HL              ;RESTORE LINE ADDRESS	;RESTORE LINE ADDRESS
716)   45A8 D1          		  POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
717)   45A9 FD E5       		  PUSH    IY	;
718)   45AB CC E4 47    		  CALL    Z,LISTIT        ;LIST IF MATCH	;LIST IF MATCH
719)   45AE FD E1       		  POP     IY	;
721)   45B0 08          		  EX      AF,AF'	;
722)   45B1 3D          		  DEC     A	;
723)   45B2 CD 0C 73    		  CALL    LTRAP	;
724)   45B5 E1          		  POP     HL              ;RESTORE POINTER	;RESTORE POINTER
725)   45B6 5E          		  LD      E,(HL)	;
726)   45B7 16 00       		  LD      D,0	;
727)   45B9 19          		  ADD     HL,DE           ;ADDRESS NEXT LINE	;ADDRESS NEXT LINE
728)   45BA D1          		  POP     DE              ;RESTORE IF-CLAUSE LEN	;RESTORE IF-CLAUSE LEN
729)   45BB C1          		  POP     BC              ;RESTORE HI LINE NUMBER	;RESTORE HI LINE NUMBER
730)   45BC 18 B8       		  JR      LISTC	;
737)   45BE CD CC 47    		@RENUM:  CALL    CLEAR           ;USES DYNAMIC AREA	;USES DYNAMIC AREA
738)   45C1 CD EB 4A    		  CALL    PAIR            ;LOAD HL,BC	;LOAD HL,BC
739)   45C4 D9          		  EXX	;
740)   45C5 2A DC FD    		  LD      HL,(PAGE)	;
741)   45C8 ED 5B E0 FD 		  LD      DE,(LOMEM)	;
742)   45CC 7E          		RENUM1:  LD      A,(HL)          ;BUILD TABLE	;BUILD TABLE
743)   45CD B7          		  OR      A	;
744)   45CE 28 30       		  JR      Z,RENUM2	;
745)   45D0 23          		  INC     HL	;
746)   45D1 4E          		  LD      C,(HL)          ;OLD LINE NUMBER	;OLD LINE NUMBER
747)   45D2 23          		  INC     HL	;
748)   45D3 46          		  LD      B,(HL)	;
749)   45D4 78          		  LD      A,B	;
750)   45D5 B1          		  OR      C	;
751)   45D6 CA 6F 40    		  JP      Z,CLOOP         ;LINE NUMBER ZERO	;LINE NUMBER ZERO
752)   45D9 EB          		  EX      DE,HL	;
753)   45DA 71          		  LD      (HL),C	;
754)   45DB 23          		  INC     HL	;
755)   45DC 70          		  LD      (HL),B	;
756)   45DD 23          		  INC     HL	;
757)   45DE D9          		  EXX	;
758)   45DF E5          		  PUSH    HL	;
759)   45E0 09          		  ADD     HL,BC           ;ADD INCREMENT	;ADD INCREMENT
760)   45E1 DA E6 4A    		  JP      C,TOOBIG        ;"Too big"	;"Too big"
761)   45E4 D9          		  EXX	;
762)   45E5 C1          		  POP     BC	;
763)   45E6 71          		  LD      (HL),C	;
764)   45E7 23          		  INC     HL	;
765)   45E8 70          		  LD      (HL),B	;
766)   45E9 23          		  INC     HL	;
767)   45EA EB          		  EX      DE,HL	;
768)   45EB 2B          		  DEC     HL	;
769)   45EC 2B          		  DEC     HL	;
770)   45ED AF          		  XOR     A	;
771)   45EE 47          		  LD      B,A	;
772)   45EF 4E          		  LD      C,(HL)	;
773)   45F0 09          		  ADD     HL,BC           ;NEXT LINE	;NEXT LINE
774)   45F1 EB          		  EX      DE,HL	;
775)   45F2 E5          		  PUSH    HL	;
776)   45F3 24          		  INC     H	;
777)   45F4 ED 72       		  SBC     HL,SP	;
778)   45F6 E1          		  POP     HL	;
779)   45F7 EB          		  EX      DE,HL	;
780)   45F8 38 D2       		  JR      C,RENUM1        ;CONTINUE	;CONTINUE
781)   45FA CD F0 46    		  CALL    EXTERR          ;"RENUMBER space'	;"RENUMBER space'
782)   45FD CC          		  DEFB    REN	;
783)   45FE 08          		  DEFB    8	;
784)   45FF 00          		  DEFB    0	;
786)   4600 EB          		RENUM2:  EX      DE,HL	;
787)   4601 36 FF       		  LD      (HL),-1	;
788)   4603 23          		  INC     HL	;
789)   4604 36 FF       		  LD      (HL),-1	;
790)   4606 ED 5B E0 FD 		  LD      DE,(LOMEM)	;
791)   460A D9          		  EXX	;
792)   460B 2A DC FD    		  LD      HL,(PAGE)	;
793)   460E 4E          		RENUM3:  LD      C,(HL)	;
794)   460F 79          		  LD      A,C	;
795)   4610 B7          		  OR      A	;
796)   4611 CA 6E 40    		  JP      Z,WARM	;
797)   4614 D9          		  EXX	;
798)   4615 EB          		  EX      DE,HL	;
799)   4616 23          		  INC     HL	;
800)   4617 23          		  INC     HL	;
801)   4618 5E          		  LD      E,(HL)	;
802)   4619 23          		  INC     HL	;
803)   461A 56          		  LD      D,(HL)	;
804)   461B 23          		  INC     HL	;
805)   461C D5          		  PUSH    DE	;
806)   461D EB          		  EX      DE,HL	;
807)   461E 22 E6 FD    		  LD      (LINENO),HL	;
808)   4621 D9          		  EXX	;
809)   4622 D1          		  POP     DE	;
810)   4623 23          		  INC     HL	;
811)   4624 73          		  LD      (HL),E          ;NEW LINE NUMBER	;NEW LINE NUMBER
812)   4625 23          		  INC     HL	;
813)   4626 72          		  LD      (HL),D	;
814)   4627 23          		  INC     HL	;
815)   4628 0D          		  DEC     C	;
816)   4629 0D          		  DEC     C	;
817)   462A 0D          		  DEC     C	;
818)   462B 06 00       		  LD      B,0	;
819)   462D 3E 8D       		RENUM7:  LD      A,LINO	;
820)   462F ED B1       		  CPIR                    ;SEARCH FOR LINE NUMBER	;SEARCH FOR LINE NUMBER
821)   4631 20 DB       		  JR      NZ,RENUM3	;
822)   4633 C5          		  PUSH    BC	;
823)   4634 E5          		  PUSH    HL	;
824)   4635 E5          		  PUSH    HL	;
825)   4636 FD E1       		  POP     IY	;
826)   4638 D9          		  EXX	;
827)   4639 CD 26 63    		  CALL    DECODE          ;DECODE LINE NUMBER	;DECODE LINE NUMBER
828)   463C D9          		  EXX	;
829)   463D 44          		  LD      B,H	;
830)   463E 4D          		  LD      C,L	;
831)   463F 2A E0 FD    		  LD      HL,(LOMEM)	;
832)   4642 5E          		RENUM4:  LD      E,(HL)          ;CROSS-REFERENCE TABLE	;CROSS-REFERENCE TABLE
833)   4643 23          		  INC     HL	;
834)   4644 56          		  LD      D,(HL)	;
835)   4645 23          		  INC     HL	;
836)   4646 EB          		  EX      DE,HL	;
837)   4647 B7          		  OR      A               ;CLEAR CARRY	;CLEAR CARRY
838)   4648 ED 42       		  SBC     HL,BC	;
839)   464A EB          		  EX      DE,HL	;
840)   464B 5E          		  LD      E,(HL)          ;NEW NUMBER	;NEW NUMBER
841)   464C 23          		  INC     HL	;
842)   464D 56          		  LD      D,(HL)	;
843)   464E 23          		  INC     HL	;
844)   464F 38 F1       		  JR      C,RENUM4	;
845)   4651 EB          		  EX      DE,HL	;
846)   4652 28 19       		  JR      Z,RENUM5        ;FOUND	;FOUND
847)   4654 CD 2B 4C    		  CALL    TELL	;
848)   4657 46 61 69 6C 		  DEFM    'Failed at '	;
848)   465B 65 64 20 61 		  DEFM    'Failed at '	;
848)   465F 74 20       		  DEFM    'Failed at '	;
849)   4661 00          		  DEFB    0	;
850)   4662 2A E6 FD    		  LD      HL,(LINENO)	;
851)   4665 CD 01 49    		  CALL    PBCDL	;
852)   4668 CD 6D 48    		  CALL    CRLF	;
853)   466B 18 06       		  JR      RENUM6	;
854)   466D D1          		RENUM5:  POP     DE	;
855)   466E D5          		  PUSH    DE	;
856)   466F 1B          		  DEC     DE	;
857)   4670 CD F9 4B    		  CALL    ENCODE          ;RE-WRITE NUMBER	;RE-WRITE NUMBER
858)   4673 E1          		RENUM6:  POP     HL	;
859)   4674 C1          		  POP     BC	;
860)   4675 18 B6       		  JR      RENUM7	;
867)   4677 CD EB 4A    		@AUTO:  CALL    PAIR	;
868)   467A 22 EA FD    		  LD      (AUTONO),HL	;
869)   467D 79          		  LD      A,C	;
870)   467E 32 FF FD    		  LD      (INCREM),A	;
871)   4681 18 29       		  JR      CLOOP0	;
876)   4683 CD 2B 4C    		BAD:  CALL    TELL            ;"Bad program'	;"Bad program'
877)   4686 03          		  DEFB    3	;
878)   4687 70 72 6F 67 		  DEFM    'program'	;
878)   468B 72 61 6D    		  DEFM    'program'	;
879)   468E 0D          		  DEFB    CR	;
880)   468F 0A          		  DEFB    LF	;
881)   4690 00          		  DEFB    0	;
882)   4691 CD C4 47    		@NEW:  CALL    NEWIT	;
883)   4694 18 16       		  JR      CLOOP0	;
887)   4696 2A DC FD    		@OLD:  LD      HL,(PAGE)	;
888)   4699 E5          		  PUSH    HL	;
889)   469A 23          		  INC     HL	;
890)   469B 23          		  INC     HL	;
891)   469C 23          		  INC     HL	;
892)   469D 01 FC 00    		  LD      BC,252	;
893)   46A0 3E 0D       		  LD      A,CR	;
894)   46A2 ED B1       		  CPIR	;
895)   46A4 20 DD       		  JR      NZ,BAD	;
896)   46A6 7D          		  LD      A,L	;
897)   46A7 E1          		  POP     HL	;
898)   46A8 77          		  LD      (HL),A	;
899)   46A9 CD 9D 47    		  CALL    CLEAN	;
900)   46AC C3 6F 40    		CLOOP0:  JP      CLOOP	;
904)   46AF CD 9D 5E    		@LOAD:  CALL    EXPRS           ;GET FILENAME	;GET FILENAME
905)   46B2 3E 0D       		  LD      A,CR	;
906)   46B4 12          		  LD      (DE),A	;
907)   46B5 CD 83 47    		  CALL    LOAD0	;
908)   46B8 CD CC 47    		  CALL    CLEAR	;
909)   46BB 18 1B       		  JR      WARM0	;
913)   46BD CD A8 47    		@SAVE:  CALL    SETTOP          ;SET TOP	;SET TOP
914)   46C0 CD 9D 5E    		  CALL    EXPRS           ;FILENAME	;FILENAME
915)   46C3 3E 0D       		  LD      A,CR	;
916)   46C5 12          		  LD      (DE),A	;
917)   46C6 ED 5B DC FD 		  LD      DE,(PAGE)	;
918)   46CA 2A DE FD    		  LD      HL,(TOP)	;
919)   46CD B7          		  OR      A	;
920)   46CE ED 52       		  SBC     HL,DE	;
921)   46D0 44          		  LD      B,H             ;LENGTH OF PROGRAM	;LENGTH OF PROGRAM
922)   46D1 4D          		  LD      C,L	;
923)   46D2 21 00 FB    		  LD      HL,ACCS	;
924)   46D5 CD 49 7A    		  CALL    OSSAVE	;
925)   46D8 C3 6E 40    		WARM0:  JP      WARM	;
929)   46DB ED 7B E4 FD 		@ERROR:  LD      SP,(HIMEM)	;
930)   46DF 21 0E 44    		  LD      HL,ERRWDS	;
931)   46E2 B7          		  OR      A	;
932)   46E3 28 0A       		  JR      Z,ERROR1	;
933)   46E5 47          		  LD      B,A             ;ERROR NUMBER	;ERROR NUMBER
934)   46E6 08          		  EX      AF,AF'	;
935)   46E7 AF          		  XOR     A	;
936)   46E8 BE          		ERROR0:  CP      (HL)	;
937)   46E9 23          		  INC     HL	;
938)   46EA 20 FC       		  JR      NZ,ERROR0	;
939)   46EC 10 FA       		  DJNZ    ERROR0	;
940)   46EE 08          		  EX      AF,AF'	;
941)   46EF E5          		ERROR1:  PUSH    HL	;
942)   46F0 E1          		@EXTERR: POP     HL	;
943)   46F1 22 EE FD    		  LD      (ERRTXT),HL	;
944)   46F4 ED 7B E4 FD 		  LD      SP,(HIMEM)	;
945)   46F8 32 FD FD    		  LD      (ERR),A	;
946)   46FB CD C4 48    		  CALL    SETLIN	;
947)   46FE 22 F2 FD    		  LD      (ERL),HL	;
948)   4701 B7          		  OR      A	;
949)   4702 28 0B       		  JR      Z,ERROR2	;
950)   4704 2A EC FD    		  LD      HL,(ERRTRP)	;
951)   4707 7C          		  LD      A,H	;
952)   4708 B5          		  OR      L	;
953)   4709 E5          		  PUSH    HL	;
954)   470A FD E1       		  POP     IY	;
955)   470C C2 E8 4C    		  JP      NZ,XEQ          ;ERROR TRAPPED	;ERROR TRAPPED
956)   470F 21 00 00    		ERROR2:  LD      HL,0	;
957)   4712 22 EA FD    		  LD      (AUTONO),HL	;
958)   4715 22 E8 FD    		  LD      (TRACEN),HL     ;CANCEL TRACE	;CANCEL TRACE
959)   4718 CD 3D 74    		  CALL    RESET           ;RESET OPSYS	;RESET OPSYS
960)   471B CD 6D 48    		  CALL    CRLF	;
961)   471E CD 1F 4C    		  CALL    REPORT          ;MESSAGE	;MESSAGE
962)   4721 CD EE 48    		  CALL    SAYLN	;
963)   4724 1E 80       		  LD      E,128  ;WAS 0 (CHANGED BY CDESP)	;WAS 0 (CHANGED BY CDESP)
964)   4726 DC 1F 74    		  CALL    C,OSSHUT        ;CLOSE ALL FILES	;CLOSE ALL FILES
965)   4729 CD 6D 48    		  CALL    CRLF	;
966)   472C C3 6F 40    		  JP      CLOOP	;
979)   472F 21 2D 41    		LEX:  LD      HL,KEYWDS	;
980)   4732 FD 7E 00    		LEX0:  LD      A,(IY)	;
981)   4735 46          		  LD      B,(HL)	;
982)   4736 23          		  INC     HL	;
983)   4737 BE          		  CP      (HL)	;
984)   4738 28 08       		  JR      Z,LEX2	;
985)   473A D8          		  RET     C               ;FAIL EXIT	;FAIL EXIT
986)   473B 23          		LEX1:  INC     HL	;
987)   473C CB 7E       		  BIT     7,(HL)	;
988)   473E 28 FB       		  JR      Z,LEX1	;
989)   4740 18 F0       		  JR      LEX0	;
990)   4742 FD E5       		LEX2:  PUSH    IY              ;SAVE POINTER	;SAVE POINTER
991)   4744 23          		LEX3:  INC     HL	;
992)   4745 CB 7E       		  BIT     7,(HL)	;
993)   4747 20 1B       		  JR      NZ,LEX6         ;FOUND	;FOUND
994)   4749 FD 23       		  INC     IY	;
995)   474B FD 7E 00    		  LD      A,(IY)	;
996)   474E FE 2E       		  CP      '.'	;
997)   4750 28 12       		  JR      Z,LEX6          ;FOUND (ABBREV.)	;FOUND (ABBREV.)
998)   4752 BE          		  CP      (HL)	;
999)   4753 28 EF       		  JR      Z,LEX3	;
1000)   4755 CD 32 4B    		  CALL    RANGE1	;
1001)   4758 38 04       		  JR      C,LEX5	;
1002)   475A FD E1       		LEX4:  POP     IY              ;RESTORE POINTER	;RESTORE POINTER
1003)   475C 18 DD       		  JR      LEX1	;
1004)   475E 7E          		LEX5:  LD      A,(HL)	;
1005)   475F B7          		  OR      A	;
1006)   4760 20 F8       		  JR      NZ,LEX4	;
1007)   4762 FD 2B       		  DEC     IY	;
1008)   4764 F1          		LEX6:  POP     AF	;
1009)   4765 AF          		  XOR     A	;
1010)   4766 78          		  LD      A,B	;
1011)   4767 C9          		  RET	;
1017)   4768 D5          		DEL:  PUSH    DE	;
1018)   4769 E5          		  PUSH    HL	;
1019)   476A E5          		  PUSH    HL	;
1020)   476B 06 00       		  LD      B,0	;
1021)   476D 4E          		  LD      C,(HL)	;
1022)   476E 09          		  ADD     HL,BC	;
1023)   476F E5          		  PUSH    HL	;
1024)   4770 EB          		  EX      DE,HL	;
1025)   4771 2A DE FD    		  LD      HL,(TOP)	;
1026)   4774 ED 52       		  SBC     HL,DE	;
1027)   4776 44          		  LD      B,H	;
1028)   4777 4D          		  LD      C,L	;
1029)   4778 E1          		  POP     HL	;
1030)   4779 D1          		  POP     DE	;
1031)   477A ED B0       		  LDIR                    ;DELETE LINE	;DELETE LINE
1032)   477C ED 53 DE FD 		  LD      (TOP),DE	;
1033)   4780 E1          		  POP     HL	;
1034)   4781 D1          		  POP     DE	;
1035)   4782 C9          		  RET	;
1045)   4783 ED 5B DC FD 		@LOAD0:  LD      DE,(PAGE)	;
1046)   4787 21 00 FF    		  LD      HL,-256	;
1047)   478A 39          		  ADD     HL,SP	;
1048)   478B ED 52       		  SBC     HL,DE           ;FIND AVAILABLE SPACE	;FIND AVAILABLE SPACE
1049)   478D 44          		  LD      B,H	;
1050)   478E 4D          		  LD      C,L	;
1051)   478F 21 00 FB    		  LD      HL,ACCS	;
1052)   4792 CD 89 7A    		  CALL    OSLOAD          ;LOAD	;LOAD
1053)   4795 D4 C4 47    		  CALL    NC,NEWIT	;
1054)   4798 3E 00       		  LD      A,0	;
1055)   479A D2 DB 46    		  JP      NC,ERROR        ;"No room"	;"No room"
1056)   479D CD A8 47    		CLEAN:  CALL    SETTOP	;
1057)   47A0 2B          		  DEC     HL	;
1058)   47A1 36 FF       		  LD      (HL),-1         ;WRITE &FFFF	;WRITE &FFFF
1059)   47A3 2B          		  DEC     HL	;
1060)   47A4 36 FF       		  LD      (HL),-1	;
1061)   47A6 18 24       		  JR      CLEAR	;
1063)   47A8 2A DC FD    		SETTOP:  LD      HL,(PAGE)	;
1064)   47AB 06 00       		  LD      B,0	;
1065)   47AD 3E 0D       		  LD      A,CR	;
1066)   47AF 4E          		SETOP1:  LD      C,(HL)	;
1067)   47B0 0C          		  INC     C	;
1068)   47B1 0D          		  DEC     C	;
1069)   47B2 28 09       		  JR      Z,SETOP2	;
1070)   47B4 09          		  ADD     HL,BC	;
1071)   47B5 2B          		  DEC     HL	;
1072)   47B6 BE          		  CP      (HL)	;
1073)   47B7 23          		  INC     HL	;
1074)   47B8 28 F5       		  JR      Z,SETOP1	;
1075)   47BA C3 83 46    		  JP      BAD	;
1076)   47BD 23          		SETOP2:  INC     HL              ;N.B. CALLED FROM NEWIT	;N.B. CALLED FROM NEWIT
1077)   47BE 23          		  INC     HL	;
1078)   47BF 23          		  INC     HL	;
1079)   47C0 22 DE FD    		  LD      (TOP),HL	;
1080)   47C3 C9          		  RET	;
1089)   47C4 2A DC FD    		NEWIT:  LD      HL,(PAGE)	;
1090)   47C7 36 00       		  LD      (HL),0	;
1091)   47C9 CD BD 47    		  CALL    SETOP2	;
1092)   47CC E5          		@CLEAR:  PUSH    HL	;
1093)   47CD 2A DE FD    		  LD      HL,(TOP)	;
1094)   47D0 22 E0 FD    		  LD      (LOMEM),HL	;
1095)   47D3 22 E2 FD    		  LD      (FREE),HL	;
1096)   47D6 21 6C FD    		  LD      HL,DYNVAR	;
1097)   47D9 C5          		  PUSH    BC	;
1098)   47DA 06 70       		  LD      B,2*(54+2)	;
1099)   47DC 36 00       		CLEAR1:  LD      (HL),0	;
1100)   47DE 23          		  INC     HL	;
1101)   47DF 10 FB       		  DJNZ    CLEAR1	;
1102)   47E1 C1          		  POP     BC	;
1103)   47E2 E1          		  POP     HL	;
1104)   47E3 C9          		  RET	;
1112)   47E4 E5          		LISTIT:  PUSH    HL	;
1113)   47E5 EB          		  EX      DE,HL	;
1114)   47E6 C5          		  PUSH    BC	;
1115)   47E7 CD 05 49    		  CALL    PBCD	;
1116)   47EA C1          		  POP     BC	;
1117)   47EB E1          		  POP     HL	;
1118)   47EC 7E          		  LD      A,(HL)	;
1119)   47ED FE ED       		  CP      NEXT	;
1120)   47EF CC 50 48    		  CALL    Z,INDENT	;
1121)   47F2 FE FD       		  CP      UNTIL	;
1122)   47F4 CC 50 48    		  CALL    Z,INDENT	;
1123)   47F7 D9          		  EXX	;
1124)   47F8 3E 20       		  LD      A,' '	;
1125)   47FA DD CB 00 46 		  BIT     0,(IX)	;
1126)   47FE C4 74 48    		  CALL    NZ,OUTCHR	;
1127)   4801 78          		  LD      A,B	;
1128)   4802 87          		  ADD     A,A	;
1129)   4803 DD CB 00 4E 		  BIT     1,(IX)	;
1130)   4807 C4 2A 57    		  CALL    NZ,FILL	;
1131)   480A 79          		  LD      A,C	;
1132)   480B 87          		  ADD     A,A	;
1133)   480C DD CB 00 56 		  BIT     2,(IX)	;
1134)   4810 C4 2A 57    		  CALL    NZ,FILL	;
1135)   4813 D9          		  EXX	;
1136)   4814 7E          		  LD      A,(HL)	;
1137)   4815 FE E3       		  CP      FOR	;
1138)   4817 CC 50 48    		  CALL    Z,INDENT	;
1139)   481A FE F5       		  CP      REPEAT	;
1140)   481C CC 50 48    		  CALL    Z,INDENT	;
1141)   481F 1E 00       		  LD      E,0	;
1142)   4821 7E          		LIST8:  LD      A,(HL)	;
1143)   4822 23          		  INC     HL	;
1144)   4823 FE 0D       		  CP      CR	;
1145)   4825 28 46       		  JR      Z,CRLF	;
1146)   4827 FE 22       		  CP      34  ;ASCII ""	;ASCII ""
1147)   4829 20 01       		  JR      NZ,LIST7	;
1148)   482B 1C          		  INC     E	;
1149)   482C CD 44 48    		LIST7:  CALL    LOUT	;
1150)   482F 18 F0       		  JR      LIST8	;
1152)   4831 E5          		PRLINO:  PUSH    HL	;
1153)   4832 FD E1       		  POP     IY	;
1154)   4834 C5          		  PUSH    BC	;
1155)   4835 CD 26 63    		  CALL    DECODE	;
1156)   4838 C1          		  POP     BC	;
1157)   4839 D9          		  EXX	;
1158)   483A C5          		  PUSH    BC	;
1159)   483B CD 01 49    		  CALL    PBCDL	;
1160)   483E C1          		  POP     BC	;
1161)   483F D9          		  EXX	;
1162)   4840 FD E5       		  PUSH    IY	;
1163)   4842 E1          		  POP     HL	;
1164)   4843 C9          		  RET	;
1166)   4844 CB 43       		LOUT:  BIT     0,E	;
1167)   4846 20 2C       		  JR      NZ,OUTCHR	;
1168)   4848 FE 8D       		  CP      LINO	;
1169)   484A 28 E5       		  JR      Z,PRLINO	;
1170)   484C CD 8D 48    		  CALL    OUT	;
1171)   484F 7E          		  LD      A,(HL)	;
1172)   4850 D9          		INDENT:  EXX	;
1173)   4851 FE E3       		  CP      FOR	;
1174)   4853 28 08       		  JR      Z,IND1	;
1175)   4855 FE ED       		  CP      NEXT	;
1176)   4857 20 05       		  JR      NZ,IND2	;
1177)   4859 05          		  DEC     B	;
1178)   485A F2 5E 48    		  JP      P,IND2	;
1179)   485D 04          		IND1:  INC     B	;
1180)   485E FE F5       		IND2:  CP      REPEAT	;
1181)   4860 28 08       		  JR      Z,IND3	;
1182)   4862 FE FD       		  CP      UNTIL	;
1183)   4864 20 05       		  JR      NZ,IND4	;
1184)   4866 0D          		  DEC     C	;
1185)   4867 F2 6B 48    		  JP      P,IND4	;
1186)   486A 0C          		IND3:  INC     C	;
1187)   486B D9          		IND4:  EXX	;
1188)   486C C9          		  RET	;
1196)   486D 3E 0D       		@CRLF:  LD      A,CR	;
1197)   486F CD 74 48    		  CALL    OUTCHR	;
1198)   4872 3E 0A       		  LD      A,LF	;
1199)   4874 CD ED 70    		@OUTCHR: CALL    OSWRCH	;
1200)   4877 D6 0D       		  SUB     CR	;
1201)   4879 28 05       		  JR      Z,CARRET	;
1202)   487B D8          		  RET     C               ;NON-PRINTING	;NON-PRINTING
1203)   487C 3A FB FD    		  LD      A,(COUNT)	;
1204)   487F 3C          		  INC     A	;
1205)   4880 32 FB FD    		CARRET:  LD      (COUNT),A	;
1206)   4883 C8          		  RET     Z	;
1207)   4884 E5          		  PUSH    HL	;
1208)   4885 2A FC FD    		  LD      HL,(WIDTH)	;
1209)   4888 BD          		  CP      L	;
1210)   4889 E1          		  POP     HL	;
1211)   488A C0          		  RET     NZ	;
1212)   488B 18 E0       		  JR      CRLF	;
1219)   488D FE 8A       		@OUT:  CP      138	;
1220)   488F EA 74 48    		  JP      PE,OUTCHR	;
1221)   4892 C5          		  PUSH    BC	;
1222)   4893 E5          		  PUSH    HL	;
1223)   4894 21 2D 41    		  LD      HL,KEYWDS	;
1224)   4897 01 DF 02    		  LD      BC,KEYWDL	;
1225)   489A ED B1       		  CPIR	;
1226)   489C 7E          		TOKEN1:  LD      A,(HL)	;
1227)   489D 23          		  INC     HL	;
1228)   489E FE 8A       		  CP      138	;
1229)   48A0 F5          		  PUSH    AF	;
1230)   48A1 EC 74 48    		  CALL    PE,OUTCHR	;
1231)   48A4 F1          		  POP     AF	;
1232)   48A5 EA 9C 48    		  JP      PE,TOKEN1	;
1233)   48A8 E1          		  POP     HL	;
1234)   48A9 C1          		  POP     BC	;
1235)   48AA C9          		  RET	;
1244)   48AB EB          		@FINDL:  EX      DE,HL	;
1245)   48AC 2A DC FD    		  LD      HL,(PAGE)	;
1246)   48AF AF          		  XOR     A               ;A=0	;A=0
1247)   48B0 BE          		  CP      (HL)	;
1248)   48B1 3C          		  INC     A	;
1249)   48B2 D0          		  RET     NC	;
1250)   48B3 AF          		  XOR     A               ;CLEAR CARRY	;CLEAR CARRY
1251)   48B4 47          		  LD      B,A	;
1252)   48B5 4E          		FINDL1:  LD      C,(HL)	;
1253)   48B6 E5          		  PUSH    HL	;
1254)   48B7 23          		  INC     HL	;
1255)   48B8 7E          		  LD      A,(HL)	;
1256)   48B9 23          		  INC     HL	;
1257)   48BA 66          		  LD      H,(HL)	;
1258)   48BB 6F          		  LD      L,A	;
1259)   48BC ED 52       		  SBC     HL,DE	;
1260)   48BE E1          		  POP     HL	;
1261)   48BF D0          		  RET     NC              ;FOUND OR PAST	;FOUND OR PAST
1262)   48C0 09          		  ADD     HL,BC	;
1263)   48C1 C3 B5 48    		  JP      FINDL1	;
1271)   48C4 06 00       		@SETLIN: LD      B,0	;
1272)   48C6 ED 5B F4 FD 		  LD      DE,(ERRLIN)	;
1273)   48CA 2A DC FD    		  LD      HL,(PAGE)	;
1274)   48CD B7          		  OR      A	;
1275)   48CE ED 52       		  SBC     HL,DE	;
1276)   48D0 19          		  ADD     HL,DE	;
1277)   48D1 30 16       		  JR      NC,SET3	;
1278)   48D3 4E          		SET1:  LD      C,(HL)	;
1279)   48D4 0C          		  INC     C	;
1280)   48D5 0D          		  DEC     C	;
1281)   48D6 28 11       		  JR      Z,SET3	;
1282)   48D8 09          		  ADD     HL,BC	;
1283)   48D9 ED 52       		  SBC     HL,DE	;
1284)   48DB 19          		  ADD     HL,DE	;
1285)   48DC 38 F5       		  JR      C,SET1	;
1286)   48DE ED 42       		  SBC     HL,BC	;
1287)   48E0 23          		  INC     HL	;
1288)   48E1 5E          		  LD      E,(HL)          ;LINE NUMBER	;LINE NUMBER
1289)   48E2 23          		  INC     HL	;
1290)   48E3 56          		  LD      D,(HL)	;
1291)   48E4 EB          		  EX      DE,HL	;
1292)   48E5 22 E6 FD    		SET2:  LD      (LINENO),HL	;
1293)   48E8 C9          		  RET	;
1294)   48E9 21 00 00    		SET3:  LD      HL,0	;
1295)   48EC 18 F7       		  JR      SET2	;
1302)   48EE 2A E6 FD    		@SAYLN:  LD      HL,(LINENO)	;
1303)   48F1 7C          		  LD      A,H	;
1304)   48F2 B5          		  OR      L	;
1305)   48F3 C8          		  RET     Z	;
1306)   48F4 CD 2B 4C    		  CALL    TELL	;
1307)   48F7 20 61 74 20 		  DEFM    ' at line '	;
1307)   48FB 6C 69 6E 65 		  DEFM    ' at line '	;
1307)   48FF 20          		  DEFM    ' at line '	;
1308)   4900 00          		  DEFB    0	;
1309)   4901 0E 00       		@PBCDL:  LD      C,0	;
1310)   4903 18 02       		  JR      PBCD0	;
1317)   4905 0E 20       		PBCD:  LD      C,' '	;
1318)   4907 06 05       		PBCD0:  LD      B,5	;
1319)   4909 11 10 27    		  LD      DE,10000	;
1320)   490C AF          		PBCD1:  XOR     A	;
1321)   490D ED 52       		PBCD2:  SBC     HL,DE	;
1322)   490F 3C          		  INC     A	;
1323)   4910 30 FB       		  JR      NC,PBCD2	;
1324)   4912 19          		  ADD     HL,DE	;
1325)   4913 3D          		  DEC     A	;
1326)   4914 28 04       		  JR      Z,PBCD3	;
1327)   4916 CB E1       		  SET     4,C	;
1328)   4918 CB E9       		  SET     5,C	;
1329)   491A B1          		PBCD3:  OR      C	;
1330)   491B C4 74 48    		  CALL    NZ,OUTCHR	;
1331)   491E 78          		  LD      A,B	;
1332)   491F FE 05       		  CP      5	;
1333)   4921 28 06       		  JR      Z,PBCD4	;
1334)   4923 29          		  ADD     HL,HL	;
1335)   4924 54          		  LD      D,H	;
1336)   4925 5D          		  LD      E,L	;
1337)   4926 29          		  ADD     HL,HL	;
1338)   4927 29          		  ADD     HL,HL	;
1339)   4928 19          		  ADD     HL,DE	;
1340)   4929 11 E8 03    		PBCD4:  LD      DE,1000	;
1341)   492C 10 DE       		  DJNZ    PBCD1	;
1342)   492E 37          		  SCF	;
1343)   492F C9          		  RET	;
1350)   4930 CD 7D 4A    		@PUTVAR: CALL    CREATE	;
1351)   4933 FD 7E 00    		  LD      A,(IY)	;
1352)   4936 FE 28       		  CP      '('	;
1353)   4938 20 68       		  JR      NZ,GETVZ        ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1354)   493A 3E 0E       		ARRAY:  LD      A,14            ;'Array'	;'Array'
1355)   493C C3 DB 46    		ERROR3:  JP      ERROR	;
1368)   493F FD 7E 00    		@GETVAR: LD      A,(IY)	;
1369)   4942 FE 24       		  CP      '$'	;
1370)   4944 28 62       		  JR      Z,GETV4	;
1371)   4946 FE 21       		  CP      '!'	;
1372)   4948 28 62       		  JR      Z,GETV5	;
1373)   494A FE 3F       		  CP      '?'	;
1374)   494C 28 62       		  JR      Z,GETV6	;
1375)   494E CD F5 49    		  CALL    LOCATE	;
1376)   4951 C0          		  RET     NZ	;
1377)   4952 FD 7E 00    		  LD      A,(IY)	;
1378)   4955 FE 28       		  CP      '('             ;ARRAY?	;ARRAY?
1379)   4957 20 41       		  JR      NZ,GETVX        ;EXIT	;EXIT
1380)   4959 D5          		  PUSH    DE              ;SAVE TYPE	;SAVE TYPE
1381)   495A 7E          		  LD      A,(HL)          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
1382)   495B B7          		  OR      A	;
1383)   495C 28 DC       		  JR      Z,ARRAY	;
1384)   495E 23          		  INC     HL	;
1385)   495F 11 00 00    		  LD      DE,0            ;ACCUMULATOR	;ACCUMULATOR
1386)   4962 F5          		  PUSH    AF	;
1387)   4963 FD 23       		  INC     IY              ;SKIP (	;SKIP (
1388)   4965 18 04       		  JR      GETV3	;
1389)   4967 F5          		GETV2:  PUSH    AF	;
1390)   4968 CD 30 64    		  CALL    COMMA	;
1391)   496B E5          		GETV3:  PUSH    HL	;
1392)   496C D5          		  PUSH    DE	;
1393)   496D CD 94 5E    		  CALL    EXPRI           ;SUBSCRIPT	;SUBSCRIPT
1394)   4970 D9          		  EXX	;
1395)   4971 D1          		  POP     DE	;
1396)   4972 E3          		  EX      (SP),HL	;
1397)   4973 4E          		  LD      C,(HL)	;
1398)   4974 23          		  INC     HL	;
1399)   4975 46          		  LD      B,(HL)	;
1400)   4976 23          		  INC     HL	;
1401)   4977 E3          		  EX      (SP),HL	;
1402)   4978 EB          		  EX      DE,HL	;
1403)   4979 D5          		  PUSH    DE	;
1404)   497A CD A3 57    		  CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
1405)   497D D1          		  POP     DE	;
1406)   497E 19          		  ADD     HL,DE	;
1407)   497F EB          		  EX      DE,HL	;
1408)   4980 B7          		  OR      A	;
1409)   4981 ED 42       		  SBC     HL,BC	;
1410)   4983 3E 0F       		  LD      A,15	;
1411)   4985 30 B5       		  JR      NC,ERROR3       ;"Subscript"	;"Subscript"
1412)   4987 E1          		  POP     HL	;
1413)   4988 F1          		  POP     AF	;
1414)   4989 3D          		  DEC     A               ;DIMENSION COUNTER	;DIMENSION COUNTER
1415)   498A 20 DB       		  JR      NZ,GETV2	;
1416)   498C CD 3C 64    		  CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
1417)   498F F1          		  POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1418)   4990 E5          		  PUSH    HL	;
1419)   4991 CD 96 57    		  CALL    X4OR5           ;DE=DE*n	;DE=DE*n
1420)   4994 E1          		  POP     HL	;
1421)   4995 19          		  ADD     HL,DE	;
1422)   4996 57          		  LD      D,A             ;TYPE	;TYPE
1423)   4997 FD 7E 00    		  LD      A,(IY)	;
1424)   499A FE 3F       		GETVX:  CP      '?'	;
1425)   499C 28 1D       		  JR      Z,GETV9	;
1426)   499E FE 21       		  CP      '!'	;
1427)   49A0 28 15       		  JR      Z,GETV8	;
1428)   49A2 E5          		GETVZ:  PUSH    HL              ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1429)   49A3 DD E1       		  POP     IX	;
1430)   49A5 7A          		  LD      A,D	;
1431)   49A6 BF          		  CP      A	;
1432)   49A7 C9          		  RET	;
1436)   49A8 3E 80       		GETV4:  LD      A,128           ;STATIC STRING	;STATIC STRING
1437)   49AA 18 05       		  JR      GETV7	;
1438)   49AC 3E 04       		GETV5:  LD      A,4             ;UNARY 32-BIT INDIRN.	;UNARY 32-BIT INDIRN.
1439)   49AE 18 01       		  JR      GETV7	;
1440)   49B0 AF          		GETV6:  XOR     A               ;UNARY 8-BIT INDIRECTION	;UNARY 8-BIT INDIRECTION
1441)   49B1 21 00 00    		GETV7:  LD      HL,0	;
1442)   49B4 F5          		  PUSH    AF	;
1443)   49B5 18 15       		  JR      GETV0	;
1445)   49B7 06 04       		GETV8:  LD      B,4             ;32-BIT BINARY INDIRN.	;32-BIT BINARY INDIRN.
1446)   49B9 18 02       		  JR      GETVA	;
1447)   49BB 06 00       		GETV9:  LD      B,0             ;8-BIT BINARY INDIRN.	;8-BIT BINARY INDIRN.
1448)   49BD E5          		GETVA:  PUSH    HL	;
1449)   49BE DD E1       		  POP     IX	;
1450)   49C0 7A          		  LD      A,D             ;TYPE	;TYPE
1451)   49C1 FE 81       		  CP      129	;
1452)   49C3 C8          		  RET     Z               ;STRING!	;STRING!
1453)   49C4 C5          		  PUSH    BC	;
1454)   49C5 CD 4D 5F    		  CALL    LOADN           ;LEFT OPERAND	;LEFT OPERAND
1455)   49C8 CD 3B 61    		  CALL    SFIX	;
1456)   49CB D9          		  EXX	;
1457)   49CC E5          		GETV0:  PUSH    HL	;
1458)   49CD FD 23       		  INC     IY	;
1459)   49CF CD AB 5E    		  CALL    ITEMI	;
1460)   49D2 D9          		  EXX	;
1461)   49D3 D1          		  POP     DE	;
1462)   49D4 F1          		  POP     AF	;
1463)   49D5 19          		  ADD     HL,DE	;
1464)   49D6 E5          		  PUSH    HL	;
1465)   49D7 DD E1       		  POP     IX	;
1466)   49D9 BF          		  CP      A	;
1467)   49DA C9          		  RET	;
1477)   49DB FD 7E 01    		@GETDEF: LD      A,(IY+1)	;
1478)   49DE CD 32 4B    		  CALL    RANGE1	;
1479)   49E1 D8          		  RET     C	;
1480)   49E2 FD 7E 00    		  LD      A,(IY)	;
1481)   49E5 21 D8 FD    		  LD      HL,FNPTR	;
1482)   49E8 FE A4       		  CP      FN	;
1483)   49EA 28 43       		  JR      Z,LOC2	;
1484)   49EC 21 DA FD    		  LD      HL,PROPTR	;
1485)   49EF FE F2       		  CP      PROC	;
1486)   49F1 28 3C       		  JR      Z,LOC2	;
1487)   49F3 37          		  SCF	;
1488)   49F4 C9          		  RET	;
1504)   49F5 D6 40       		LOCATE:  SUB     '@'	;
1505)   49F7 D8          		  RET     C	;
1506)   49F8 26 00       		  LD      H,0	;
1507)   49FA FE 1B       		  CP      'Z'-'@'+1	;
1508)   49FC 30 1D       		  JR      NC,LOC0         ;NOT STATIC	;NOT STATIC
1509)   49FE 87          		  ADD     A,A	;
1510)   49FF 6F          		  LD      L,A	;
1511)   4A00 FD 7E 01    		  LD      A,(IY+1)        ;2nd CHARACTER	;2nd CHARACTER
1512)   4A03 FE 25       		  CP      '%'	;
1513)   4A05 20 20       		  JR      NZ,LOC1         ;NOT STATIC	;NOT STATIC
1514)   4A07 FD 7E 02    		  LD      A,(IY+2)	;
1515)   4A0A FE 28       		  CP      '('	;
1516)   4A0C 28 19       		  JR      Z,LOC1          ;NOT STATIC	;NOT STATIC
1517)   4A0E 29          		  ADD     HL,HL	;
1518)   4A0F 11 00 FD    		  LD      DE,STAVAR       ;STATIC VARIABLES	;STATIC VARIABLES
1519)   4A12 19          		  ADD     HL,DE	;
1520)   4A13 FD 23       		  INC     IY	;
1521)   4A15 FD 23       		  INC     IY	;
1522)   4A17 16 04       		  LD      D,4             ;INTEGER TYPE	;INTEGER TYPE
1523)   4A19 AF          		  XOR     A	;
1524)   4A1A C9          		  RET	;
1526)   4A1B FE 1F       		LOC0:  CP      '_'-'@'	;
1527)   4A1D D8          		  RET     C	;
1528)   4A1E FE 3B       		  CP      'z'-'@'+1	;
1529)   4A20 3F          		  CCF	;
1530)   4A21 3D          		  DEC     A               ;SET NZ	;SET NZ
1531)   4A22 D8          		  RET     C	;
1532)   4A23 D6 03       		  SUB     3	;
1533)   4A25 87          		  ADD     A,A	;
1534)   4A26 6F          		  LD      L,A	;
1535)   4A27 11 6C FD    		LOC1:  LD      DE,DYNVAR       ;DYNAMIC VARIABLES	;DYNAMIC VARIABLES
1536)   4A2A 2D          		  DEC     L	;
1537)   4A2B 2D          		  DEC     L	;
1538)   4A2C 37          		  SCF	;
1539)   4A2D F8          		  RET     M	;
1540)   4A2E 19          		  ADD     HL,DE	;
1541)   4A2F 5E          		LOC2:  LD      E,(HL)	;
1542)   4A30 23          		  INC     HL	;
1543)   4A31 56          		  LD      D,(HL)	;
1544)   4A32 7A          		  LD      A,D	;
1545)   4A33 B3          		  OR      E	;
1546)   4A34 28 45       		  JR      Z,LOC6          ;UNDEFINED VARIABLE	;UNDEFINED VARIABLE
1547)   4A36 62          		  LD      H,D	;
1548)   4A37 6B          		  LD      L,E	;
1549)   4A38 23          		  INC     HL              ;SKIP LINK	;SKIP LINK
1550)   4A39 23          		  INC     HL	;
1551)   4A3A FD E5       		  PUSH    IY	;
1552)   4A3C 7E          		LOC3:  LD      A,(HL)          ;COMPARE	;COMPARE
1553)   4A3D 23          		  INC     HL	;
1554)   4A3E FD 23       		  INC     IY	;
1555)   4A40 FD BE 00    		  CP      (IY)	;
1556)   4A43 28 F7       		  JR      Z,LOC3	;
1557)   4A45 B7          		  OR      A               ;0=TERMINATOR	;0=TERMINATOR
1558)   4A46 28 06       		  JR      Z,LOC5          ;FOUND (MAYBE)	;FOUND (MAYBE)
1559)   4A48 FD E1       		LOC4:  POP     IY	;
1560)   4A4A EB          		  EX      DE,HL	;
1561)   4A4B C3 2F 4A    		  JP      LOC2            ;TRY NEXT ENTRY	;TRY NEXT ENTRY
1563)   4A4E FD 2B       		LOC5:  DEC     IY	;
1564)   4A50 FD 7E 00    		  LD      A,(IY)	;
1565)   4A53 FE 28       		  CP      '('	;
1566)   4A55 28 13       		  JR      Z,LOC5A         ;FOUND	;FOUND
1567)   4A57 FD 23       		  INC     IY	;
1568)   4A59 CD 26 4B    		  CALL    RANGE	;
1569)   4A5C 38 0C       		  JR      C,LOC5A         ;FOUND	;FOUND
1570)   4A5E FE 28       		  CP      '('	;
1571)   4A60 28 E6       		  JR      Z,LOC4          ;KEEP LOOKING	;KEEP LOOKING
1572)   4A62 FD 7E FF    		  LD      A,(IY-1)	;
1573)   4A65 CD 32 4B    		  CALL    RANGE1	;
1574)   4A68 30 DE       		  JR      NC,LOC4         ;KEEP LOOKING	;KEEP LOOKING
1575)   4A6A D1          		LOC5A:  POP     DE	;
1576)   4A6B FD 7E FF    		TYPE:  LD      A,(IY-1)	;
1577)   4A6E FE 24       		  CP      '$'	;
1578)   4A70 16 81       		  LD      D,129	;
1579)   4A72 C8          		  RET     Z               ;STRING	;STRING
1580)   4A73 FE 25       		  CP      '%'	;
1581)   4A75 16 04       		  LD      D,4	;
1582)   4A77 C8          		  RET     Z               ;INTEGER	;INTEGER
1583)   4A78 14          		  INC     D	;
1584)   4A79 BF          		  CP      A	;
1585)   4A7A C9          		  RET	;
1587)   4A7B 3C          		LOC6:  INC     A               ;SET NZ	;SET NZ
1588)   4A7C C9          		  RET	;
1595)   4A7D AF          		@CREATE: XOR     A	;
1596)   4A7E ED 5B E2 FD 		  LD      DE,(FREE)	;
1597)   4A82 72          		  LD      (HL),D	;
1598)   4A83 2B          		  DEC     HL	;
1599)   4A84 73          		  LD      (HL),E	;
1600)   4A85 EB          		  EX      DE,HL	;
1601)   4A86 77          		  LD      (HL),A	;
1602)   4A87 23          		  INC     HL	;
1603)   4A88 77          		  LD      (HL),A	;
1604)   4A89 23          		  INC     HL	;
1605)   4A8A FD 23       		LOC7:  INC     IY	;
1606)   4A8C CD 26 4B    		  CALL    RANGE           ;END OF VARIABLE?	;END OF VARIABLE?
1607)   4A8F 38 14       		  JR      C,LOC8	;
1608)   4A91 77          		  LD      (HL),A	;
1609)   4A92 23          		  INC     HL	;
1610)   4A93 CD 32 4B    		  CALL    RANGE1	;
1611)   4A96 30 F2       		  JR      NC,LOC7	;
1612)   4A98 FE 28       		  CP      '('	;
1613)   4A9A 28 09       		  JR      Z,LOC8	;
1614)   4A9C FD 7E 01    		  LD      A,(IY+1)	;
1615)   4A9F FE 28       		  CP      '('	;
1616)   4AA1 28 E7       		  JR      Z,LOC7	;
1617)   4AA3 FD 23       		  INC     IY	;
1618)   4AA5 36 00       		LOC8:  LD      (HL),0          ;TERMINATOR	;TERMINATOR
1619)   4AA7 23          		  INC     HL	;
1620)   4AA8 E5          		  PUSH    HL	;
1621)   4AA9 CD 6B 4A    		  CALL    TYPE	;
1622)   4AAC 3E 05       		  LD      A,5	;
1623)   4AAE BA          		  CP      D	;
1624)   4AAF 28 01       		  JR      Z,LOC9	;
1625)   4AB1 3D          		  DEC     A	;
1626)   4AB2 36 00       		LOC9:  LD      (HL),0          ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1627)   4AB4 23          		  INC     HL	;
1628)   4AB5 3D          		  DEC     A	;
1629)   4AB6 20 FA       		  JR      NZ,LOC9	;
1630)   4AB8 22 E2 FD    		  LD      (FREE),HL	;
1631)   4ABB CD BF 55    		  CALL    CHECK	;
1632)   4ABE E1          		  POP     HL	;
1633)   4ABF AF          		  XOR     A	;
1634)   4AC0 C9          		  RET	;
1642)   4AC1 CD 78 64    		LINNUM:  CALL    NXT	;
1643)   4AC4 21 00 00    		  LD      HL,0	;
1644)   4AC7 FD 7E 00    		LINNM1:  LD      A,(IY)	;
1645)   4ACA D6 30       		  SUB     '0'	;
1646)   4ACC D8          		  RET     C	;
1647)   4ACD FE 0A       		  CP      10	;
1648)   4ACF D0          		  RET     NC	;
1649)   4AD0 FD 23       		  INC     IY	;
1650)   4AD2 54          		  LD      D,H	;
1651)   4AD3 5D          		  LD      E,L	;
1652)   4AD4 29          		  ADD     HL,HL           ;*2	;*2
1653)   4AD5 38 0F       		  JR      C,TOOBIG	;
1654)   4AD7 29          		  ADD     HL,HL           ;*4	;*4
1655)   4AD8 38 0C       		  JR      C,TOOBIG	;
1656)   4ADA 19          		  ADD     HL,DE           ;*5	;*5
1657)   4ADB 38 09       		  JR      C,TOOBIG	;
1658)   4ADD 29          		  ADD     HL,HL           ;*10	;*10
1659)   4ADE 38 06       		  JR      C,TOOBIG	;
1660)   4AE0 5F          		  LD      E,A	;
1661)   4AE1 16 00       		  LD      D,0	;
1662)   4AE3 19          		  ADD     HL,DE           ;ADD IN DIGIT	;ADD IN DIGIT
1663)   4AE4 30 E1       		  JR      NC,LINNM1       	;
1664)   4AE6 3E 14       		TOOBIG:  LD      A,20	;
1665)   4AE8 C3 DB 46    		  JP      ERROR           ;"Too big"	;"Too big"
1673)   4AEB CD C1 4A    		PAIR:  CALL    LINNUM          ;FIRST	;FIRST
1674)   4AEE 7C          		  LD      A,H	;
1675)   4AEF B5          		  OR      L	;
1676)   4AF0 20 02       		  JR      NZ,PAIR1	;
1677)   4AF2 2E 0A       		  LD      L,10	;
1678)   4AF4 CD C2 56    		PAIR1:  CALL    TERM?	;
1679)   4AF7 FD 23       		  INC     IY	;
1680)   4AF9 E5          		  PUSH    HL	;
1681)   4AFA 21 0A 00    		  LD      HL,10	;
1682)   4AFD C4 C1 4A    		  CALL    NZ,LINNUM       ;SECOND	;SECOND
1683)   4B00 E3          		  EX      (SP),HL	;
1684)   4B01 C1          		  POP     BC	;
1685)   4B02 78          		  LD      A,B	;
1686)   4B03 B1          		  OR      C	;
1687)   4B04 C0          		  RET     NZ	;
1688)   4B05 CD F0 46    		  CALL    EXTERR	;
1689)   4B08 53 69 6C 6C 		  DEFM    'Silly'	;
1689)   4B0C 79          		  DEFM    'Silly'	;
1690)   4B0D 00          		  DEFB    0	;
1698)   4B0E CD C1 4A    		DLPAIR:  CALL    LINNUM	;
1699)   4B11 E5          		  PUSH    HL	;
1700)   4B12 CD C2 56    		  CALL    TERM?	;
1701)   4B15 28 09       		  JR      Z,DLP1	;
1702)   4B17 FE E7       		  CP      TIF	;
1703)   4B19 28 05       		  JR      Z,DLP1	;
1704)   4B1B FD 23       		  INC     IY	;
1705)   4B1D CD C1 4A    		  CALL    LINNUM	;
1706)   4B20 E3          		DLP1:  EX      (SP),HL	;
1707)   4B21 CD AB 48    		  CALL    FINDL	;
1708)   4B24 C1          		  POP     BC	;
1709)   4B25 C9          		  RET	;
1716)   4B26 FD 7E 00    		@RANGE:  LD      A,(IY)	;
1717)   4B29 FE 24       		  CP      '$'	;
1718)   4B2B C8          		  RET     Z	;
1719)   4B2C FE 25       		  CP      '%'	;
1720)   4B2E C8          		  RET     Z	;
1721)   4B2F FE 28       		  CP      '('	;
1722)   4B31 C8          		  RET     Z	;
1723)   4B32 FE 30       		RANGE1:  CP      '0'	;
1724)   4B34 D8          		  RET     C	;
1725)   4B35 FE 3A       		  CP      '9'+1	;
1726)   4B37 3F          		  CCF	;
1727)   4B38 D0          		  RET     NC	;
1728)   4B39 FE 40       		  CP      '@'             ;V2.4	;V2.4
1729)   4B3B C8          		  RET     Z	;
1730)   4B3C FE 41       		RANGE2:  CP      'A'	;
1731)   4B3E D8          		  RET     C	;
1732)   4B3F FE 5B       		  CP      'Z'+1	;
1733)   4B41 3F          		  CCF	;
1734)   4B42 D0          		  RET     NC	;
1735)   4B43 FE 5F       		  CP      '_'	;
1736)   4B45 D8          		  RET     C	;
1737)   4B46 FE 7B       		  CP      'z'+1	;
1738)   4B48 3F          		  CCF	;
1739)   4B49 C9          		  RET	;
1741)   4B4A AF          		SPACE:   XOR     A	;
1742)   4B4B CD F0 46    		  CALL    EXTERR          ;"LINE space"	;"LINE space"
1743)   4B4E 86          		  DEFB    LINE	;
1744)   4B4F 08          		  DEFB    8	;
1745)   4B50 00          		  DEFB    0	;
1761)   4B51 12          		LEXAN1:  LD      (DE),A          ;TRANSFER TO BUFFER	;TRANSFER TO BUFFER
1762)   4B52 13          		  INC     DE              ;INCREMENT POINTERS	;INCREMENT POINTERS
1763)   4B53 FD 23       		  INC     IY	;
1764)   4B55 7B          		@LEXAN2: LD      A,E             ;MAIN ENTRY	;MAIN ENTRY
1765)   4B56 FE FC       		  CP      252             ;TEST LENGTH	;TEST LENGTH
1766)   4B58 30 F0       		  JR      NC,SPACE        ;LINE TOO LONG	;LINE TOO LONG
1767)   4B5A FD 7E 00    		  LD      A,(IY)	;
1768)   4B5D FE 0D       		  CP      CR	;
1769)   4B5F C8          		  RET     Z               ;END OF LINE	;END OF LINE
1770)   4B60 CD 32 4B    		  CALL    RANGE1	;
1771)   4B63 30 04       		  JR      NC,LEXAN3	;
1772)   4B65 CB A9       		  RES     5,C             ;NOT IN VARIABLE	;NOT IN VARIABLE
1773)   4B67 CB 99       		  RES     3,C             ;NOT IN HEX	;NOT IN HEX
1774)   4B69 FE 20       		LEXAN3:  CP      ' '	;
1775)   4B6B 28 E4       		  JR      Z,LEXAN1        ;PASS SPACES	;PASS SPACES
1776)   4B6D FE 2C       		  CP      ','	;
1777)   4B6F 28 E0       		  JR      Z,LEXAN1        ;PASS COMMAS	;PASS COMMAS
1778)   4B71 FE 47       		  CP      'G'	;
1779)   4B73 38 02       		  JR      C,LEXAN4	;
1780)   4B75 CB 99       		  RES     3,C             ;NOT IN HEX	;NOT IN HEX
1781)   4B77 FE 22       		LEXAN4:  CP      34  ;ASCII ""	;ASCII ""
1782)   4B79 20 05       		  JR      NZ,LEXAN5	;
1783)   4B7B CB 11       		  RL      C	;
1784)   4B7D 3F          		  CCF                     ;TOGGLE C7	;TOGGLE C7
1785)   4B7E CB 19       		  RR      C	;
1786)   4B80 CB 61       		LEXAN5:  BIT     4,C	;
1787)   4B82 28 10       		  JR      Z,LEXAN6	;
1788)   4B84 CB A1       		  RES     4,C	;
1789)   4B86 C5          		  PUSH    BC	;
1790)   4B87 D5          		  PUSH    DE	;
1791)   4B88 CD C1 4A    		  CALL    LINNUM          ;GET LINE NUMBER	;GET LINE NUMBER
1792)   4B8B D1          		  POP     DE	;
1793)   4B8C C1          		  POP     BC	;
1794)   4B8D 7C          		  LD      A,H	;
1795)   4B8E B5          		  OR      L	;
1796)   4B8F C4 F9 4B    		  CALL    NZ,ENCODE       ;ENCODE LINE NUMBER	;ENCODE LINE NUMBER
1797)   4B92 18 C1       		  JR      LEXAN2          ;CONTINUE	;CONTINUE
1799)   4B94 0D          		LEXAN6:  DEC     C	;
1800)   4B95 28 09       		  JR      Z,LEXAN7        ;C=1 (LEFT)	;C=1 (LEFT)
1801)   4B97 0C          		  INC     C	;
1802)   4B98 20 B7       		  JR      NZ,LEXAN1	;
1803)   4B9A B7          		  OR      A	;
1804)   4B9B F4 2F 47    		  CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1805)   4B9E 18 12       		  JR      LEXAN8	;
1807)   4BA0 FE 2A       		LEXAN7:  CP      '*'	;
1808)   4BA2 28 16       		  JR      Z,LEXAN9	;
1809)   4BA4 B7          		  OR      A	;
1810)   4BA5 F4 2F 47    		  CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1811)   4BA8 FE 8F       		  CP      TOKLO	;
1812)   4BAA 38 06       		  JR      C,LEXAN8	;
1813)   4BAC FE 94       		  CP      TOKHI+1	;
1814)   4BAE 30 02       		  JR      NC,LEXAN8	;
1815)   4BB0 C6 40       		  ADD     A,OFFSET        ;LEFT VERSION	;LEFT VERSION
1816)   4BB2 FE F4       		LEXAN8:  CP      REM	;
1817)   4BB4 28 04       		  JR      Z,LEXAN9	;
1818)   4BB6 FE DC       		  CP      DATA	;
1819)   4BB8 20 02       		  JR      NZ,LEXANA	;
1820)   4BBA CB F1       		LEXAN9:  SET     6,C             ;QUIT TOKENISING	;QUIT TOKENISING
1821)   4BBC FE A4       		LEXANA:  CP      FN	;
1822)   4BBE 28 09       		  JR      Z,LEXANB	;
1823)   4BC0 FE F2       		  CP      PROC	;
1824)   4BC2 28 05       		  JR      Z,LEXANB	;
1825)   4BC4 CD 3C 4B    		  CALL    RANGE2	;
1826)   4BC7 38 02       		  JR      C,LEXANC	;
1827)   4BC9 CB E9       		LEXANB:  SET     5,C             ;IN VARIABLE/FN/PROC	;IN VARIABLE/FN/PROC
1828)   4BCB FE 26       		LEXANC:  CP      '&'	;
1829)   4BCD 20 02       		  JR      NZ,LEXAND	;
1830)   4BCF CB D9       		  SET     3,C             ;IN HEX	;IN HEX
1831)   4BD1 21 F0 4B    		LEXAND:  LD      HL,LIST1	;
1832)   4BD4 C5          		  PUSH    BC	;
1833)   4BD5 01 06 00    		  LD      BC,LIST1L	;
1834)   4BD8 ED B1       		  CPIR	;
1835)   4BDA C1          		  POP     BC	;
1836)   4BDB 20 02       		  JR      NZ,LEXANE	;
1837)   4BDD CB E1       		  SET     4,C             ;ACCEPT LINE NUMBER	;ACCEPT LINE NUMBER
1838)   4BDF 21 F4 4B    		LEXANE:  LD      HL,LIST2	;
1839)   4BE2 C5          		  PUSH    BC	;
1840)   4BE3 01 05 00    		  LD      BC,LIST2L	;
1841)   4BE6 ED B1       		  CPIR	;
1842)   4BE8 C1          		  POP     BC	;
1843)   4BE9 20 02       		  JR      NZ,LEXANF	;
1844)   4BEB CB C1       		  SET     0,C             ;ENTER LEFT MODE	;ENTER LEFT MODE
1845)   4BED C3 51 4B    		LEXANF:  JP      LEXAN1	;
1847)   4BF0 E5          		LIST1:  DEFB    GOTO	;
1848)   4BF1 E4          		  DEFB    GOSUB	;
1849)   4BF2 F7          		  DEFB    RESTOR	;
1850)   4BF3 FC          		  DEFB    TRACE	;
1851)   4BF4 8C          		LIST2:  DEFB    THEN	;
1852)   4BF5 8B          		  DEFB    ELSE	;
1854)   4BF6 F5          		  DEFB    REPEAT	;
1855)   4BF7 85          		  DEFB    TERROR	;
1856)   4BF8 3A          		  DEFB    ':'	;
1864)   4BF9 CB E1       		ENCODE:  SET     4,C	;
1865)   4BFB EB          		  EX      DE,HL	;
1866)   4BFC 36 8D       		  LD      (HL),LINO	;
1867)   4BFE 23          		  INC     HL	;
1868)   4BFF 7A          		  LD      A,D	;
1869)   4C00 E6 C0       		  AND     0C0H	;
1870)   4C02 0F          		  RRCA	;
1871)   4C03 0F          		  RRCA	;
1872)   4C04 47          		  LD      B,A	;
1873)   4C05 7B          		  LD      A,E	;
1874)   4C06 E6 C0       		  AND     0C0H	;
1875)   4C08 B0          		  OR      B	;
1876)   4C09 0F          		  RRCA	;
1877)   4C0A 0F          		  RRCA	;
1878)   4C0B EE 54       		  XOR     01010100B	;
1879)   4C0D 77          		  LD      (HL),A	;
1880)   4C0E 23          		  INC     HL	;
1881)   4C0F 7B          		  LD      A,E	;
1882)   4C10 E6 3F       		  AND     3FH	;
1883)   4C12 F6 40       		  OR      '@'	;
1884)   4C14 77          		  LD      (HL),A	;
1885)   4C15 23          		  INC     HL	;
1886)   4C16 7A          		  LD      A,D	;
1887)   4C17 E6 3F       		  AND     3FH	;
1888)   4C19 F6 40       		  OR      '@'	;
1889)   4C1B 77          		  LD      (HL),A	;
1890)   4C1C 23          		  INC     HL	;
1891)   4C1D EB          		  EX      DE,HL	;
1892)   4C1E C9          		  RET	;
1899)   4C1F 2A EE FD    		@REPORT: LD      HL,(ERRTXT)	;
1900)   4C22 7E          		TEXT:  LD      A,(HL)	;
1901)   4C23 23          		  INC     HL	;
1902)   4C24 B7          		  OR      A	;
1903)   4C25 C8          		  RET     Z	;
1904)   4C26 CD 8D 48    		  CALL    OUT	;
1905)   4C29 18 F7       		  JR      TEXT	;
1911)   4C2B E3          		@TELL:  EX      (SP),HL         ;GET RETURN ADDRESS	;GET RETURN ADDRESS
1912)   4C2C CD 22 4C    		  CALL    TEXT	;
1913)   4C2F E3          		  EX      (SP),HL	;
1914)   4C30 C9          		  RET	;
 33)   4C31 77 46       		CMDTAB:  DEFW    AUTO	;
 34)   4C33 11 45       		  DEFW    DELETE	;
 35)   4C35 AF 46       		  DEFW    LOAD	;
 36)   4C37 40 45       		  DEFW    LIST	;
 37)   4C39 91 46       		  DEFW    NEW	;
 38)   4C3B 96 46       		  DEFW    OLD	;
 39)   4C3D BE 45       		  DEFW    RENUM	;
 40)   4C3F BD 46       		  DEFW    SAVE	;
 41)   4C41 38 55       		  DEFW    PUT	;
 42)   4C43 EE 53       		  DEFW    PTR	;
 43)   4C45 03 54       		  DEFW    PAGEV	;
 44)   4C47 12 54       		  DEFW    TIMEV	;
 45)   4C49 33 54       		  DEFW    LOMEMV	;
 46)   4C4B 46 54       		  DEFW    HIMEMV	;
 47)   4C4D 8E 74       		  DEFW    SOUND	;
 48)   4C4F BA 54       		  DEFW    BPUT	;
 49)   4C51 CD 54       		  DEFW    CALL	;
 50)   4C53 AA 4C       		  DEFW    CHAIN	;
 51)   4C55 C8 53       		  DEFW    CLR	;
 52)   4C57 B1 54       		  DEFW    CLOSE	;
 53)   4C59 45 74       		  DEFW    CLG	;
 54)   4C5B A5 53       		  DEFW    CLS	;
 55)   4C5D 61 4D       		  DEFW    REM             ;DATA	;DATA
 56)   4C5F 61 4D       		  DEFW    REM             ;DEF	;DEF
 57)   4C61 0E 4E       		  DEFW    DIM	;
 58)   4C63 68 74       		  DEFW    DRAW	;
 59)   4C65 10 4D       		  DEFW    END	;
 60)   4C67 FD 51       		  DEFW    ENDPRO	;
 61)   4C69 8E 74       		  DEFW    ENVEL	;
 62)   4C6B 52 50       		  DEFW    FOR	;
 63)   4C6D 0D 50       		  DEFW    GOSUB	;
 64)   4C6F F6 4F       		  DEFW    GOTO	;
 65)   4C71 51 74       		  DEFW    GCOL	;
 66)   4C73 78 53       		  DEFW    IF	;
 67)   4C75 88 52       		  DEFW    INPUT	;
 68)   4C77 81 4D       		  DEFW    LET	;
 69)   4C79 AF 51       		  DEFW    LOCAL	;
 70)   4C7B 3E 74       		  DEFW    MODE	;
 71)   4C7D 72 74       		  DEFW    MOVE	;
 72)   4C7F 97 50       		  DEFW    NEXT	;
 73)   4C81 90 4F       		  DEFW    ON	;
 74)   4C83 90 54       		  DEFW    VDU	;
 75)   4C85 7C 74       		  DEFW    PLOT	;
 76)   4C87 BB 4E       		  DEFW    PRINT	;
 77)   4C89 20 51       		  DEFW    PROC	;
 78)   4C8B 27 53       		  DEFW    READ	;
 79)   4C8D 61 4D       		  DEFW    REM	;
 80)   4C8F 28 50       		  DEFW    REPEAT	;
 81)   4C91 C2 53       		  DEFW    REPOR	;
 82)   4C93 D0 53       		  DEFW    RESTOR	;
 83)   4C95 18 50       		  DEFW    RETURN	;
 84)   4C97 A5 4C       		  DEFW    RUN	;
 85)   4C99 AF 53       		  DEFW    STOP	;
 86)   4C9B 5D 74       		  DEFW    COLOUR	;
 87)   4C9D 76 54       		  DEFW    TRACE	;
 88)   4C9F 30 50       		  DEFW    UNTIL	;
 89)   4CA1 6B 54       		  DEFW    WIDTHV	;
 90)   4CA3 4D 4D       		  DEFW    CLI             ;OSCLI	;OSCLI
 92)   4CA5 CD C2 56    		RUN:  CALL    TERM?	;
 93)   4CA8 28 0D       		  JR      Z,RUN0	;
 94)   4CAA CD 9D 5E    		CHAIN:  CALL    EXPRS	;
 95)   4CAD 3E 0D       		  LD      A,CR	;
 96)   4CAF 12          		  LD      (DE),A	;
 97)   4CB0 ED 7B E4 FD 		@CHAIN0: LD      SP,(HIMEM)	;
 98)   4CB4 CD 83 47    		  CALL    LOAD0	;
 99)   4CB7 ED 7B E4 FD 		@RUN0:  LD      SP,(HIMEM)      ;PREPARE FOR RUN	;PREPARE FOR RUN
100)   4CBB DD 21 F6 FD 		  LD      IX,RANDOM	;
104)   4CBF ED 5F       		  ld      a, r	;
105)   4CC1 20 1D       		  jr      nz, 1F	;
106)   4CC3 3C          		  inc     a	;
108)   4CC4 07          		L1:  RLCA	;
109)   4CC5 07          		  RLCA	;
110)   4CC6 DD 77 03    		  LD      (IX+3),A	;
111)   4CC9 9F          		  SBC     A,A	;
112)   4CCA DD 77 04    		  LD      (IX+4),A	;
113)   4CCD CD CC 47    		  CALL    CLEAR	;
114)   4CD0 21 00 00    		  LD      HL,0	;
115)   4CD3 22 EC FD    		  LD      (ERRTRP),HL	;
116)   4CD6 2A DC FD    		  LD      HL,(PAGE)	;
117)   4CD9 3E DC       		  LD      A,DATA	;
118)   4CDB CD 80 57    		  CALL    SEARCH          ;LOOK FOR "DATA"	;LOOK FOR "DATA"
119)   4CDE 22 F0 FD    		  LD      (DATPTR),HL     ;SET DATA POINTER	;SET DATA POINTER
120)   4CE1 FD 2A DC FD 		  LD      IY,(PAGE)	;
121)   4CE5 CD 20 4D    		XEQ0:  CALL    NEWLIN	;
122)   4CE8 FD 22 F4 FD 		@XEQ:  LD      (ERRLIN),IY     ;ERROR POINTER	;ERROR POINTER
123)   4CEC CD 09 73    		  CALL    TRAP            ;CHECK KEYBOARD	;CHECK KEYBOARD
124)   4CEF CD 78 64    		XEQ1:  CALL    NXT	;
125)   4CF2 FD 23       		  INC     IY	;
126)   4CF4 FE 3A       		  CP      ':'             ;SEPARATOR	;SEPARATOR
127)   4CF6 28 F7       		  JR      Z,XEQ1	;
128)   4CF8 FE 0D       		  CP      CR	;
129)   4CFA 28 E9       		  JR      Z,XEQ0          ;NEW PROGRAM LINE	;NEW PROGRAM LINE
130)   4CFC D6 C6       		  SUB     TCMD	;
131)   4CFE 38 6F       		  JR      C,LET0          ;IMPLIED "LET"	;IMPLIED "LET"
132)   4D00 87          		  ADD     A,A	;
133)   4D01 4F          		  LD      C,A	;
134)   4D02 06 00       		  LD      B,0	;
135)   4D04 21 31 4C    		  LD      HL,CMDTAB	;
136)   4D07 09          		  ADD     HL,BC	;
137)   4D08 7E          		  LD      A,(HL)          ;TABLE ENTRY	;TABLE ENTRY
138)   4D09 23          		  INC     HL	;
139)   4D0A 66          		  LD      H,(HL)	;
140)   4D0B 6F          		  LD      L,A	;
141)   4D0C CD 78 64    		  CALL    NXT	;
142)   4D0F E9          		  JP      (HL)            ;EXECUTE STATEMENT	;EXECUTE STATEMENT
146)   4D10 CD C4 48    		END:  CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
147)   4D13 7C          		  LD      A,H	;
148)   4D14 B5          		  OR      L               ;DIRECT?	;DIRECT?
149)   4D15 CA 6F 40    		  JP      Z,CLOOP	;
150)   4D18 1E 00       		  LD      E,0	;
151)   4D1A CD 1F 74    		  CALL    OSSHUT          ;CLOSE ALL FILES	;CLOSE ALL FILES
152)   4D1D C3 6E 40    		  JP      WARM            ;"Ready"	;"Ready"
154)   4D20 FD 7E 00    		NEWLIN:  LD      A,(IY+0)        ;A=LINE LENGTH	;A=LINE LENGTH
155)   4D23 01 03 00    		  LD      BC,3	;
156)   4D26 FD 09       		  ADD     IY,BC	;
157)   4D28 B7          		  OR      A	;
158)   4D29 28 E5       		  JR      Z,END           ;LENGTH=0, EXIT	;LENGTH=0, EXIT
159)   4D2B 2A E8 FD    		  LD      HL,(TRACEN)	;
160)   4D2E 7C          		  LD      A,H	;
161)   4D2F B5          		  OR      L	;
162)   4D30 C8          		  RET     Z	;
163)   4D31 FD 56 FF    		  LD      D,(IY-1)        ;DE = LINE NUMBER	;DE = LINE NUMBER
164)   4D34 FD 5E FE    		  LD      E,(IY-2)	;
165)   4D37 ED 52       		  SBC     HL,DE	;
166)   4D39 D8          		  RET     C	;
167)   4D3A EB          		  EX      DE,HL	;
168)   4D3B 3E 5B       		  LD      A,'['           ;TRACE	;TRACE
169)   4D3D CD 74 48    		  CALL    OUTCHR	;
170)   4D40 CD 01 49    		  CALL    PBCDL	;
171)   4D43 3E 5D       		  LD      A,']'	;
172)   4D45 CD 74 48    		  CALL    OUTCHR	;
173)   4D48 3E 20       		  LD      A,' '	;
174)   4D4A C3 74 48    		  JP      OUTCHR	;
180)   4D4D CD 9D 5E    		CLI:  CALL    EXPRS	;
181)   4D50 3E 0D       		  LD      A,CR	;
182)   4D52 12          		  LD      (DE),A	;
183)   4D53 21 00 FB    		  LD      HL,ACCS	;
184)   4D56 CD 9B 73    		  CALL    OSCLI	;
185)   4D59 18 8D       		  JR      XEQ	;
189)   4D5B FD E5       		EXT:  PUSH    IY	;
190)   4D5D E1          		  POP     HL	;
191)   4D5E CD 9B 73    		  CALL    OSCLI	;
192)   4D61 FD E5       		REM:  PUSH    IY	;
193)   4D63 E1          		  POP     HL	;
194)   4D64 3E 0D       		  LD      A,CR	;
195)   4D66 47          		  LD      B,A	;
196)   4D67 ED B1       		  CPIR                    ;FIND LINE END	;FIND LINE END
197)   4D69 E5          		  PUSH    HL	;
198)   4D6A FD E1       		  POP     IY	;
199)   4D6C C3 E5 4C    		  JP      XEQ0	;
203)   4D6F FE C5       		LET0:  CP      ELSE-TCMD	;
204)   4D71 28 EE       		  JR      Z,REM	;
205)   4D73 FE 64       		  CP      ('*'-TCMD) AND 0xFF	;
206)   4D75 28 E4       		  JR      Z,EXT	;
207)   4D77 FE 77       		  CP      ('='-TCMD) AND 0xFF	;
208)   4D79 28 4C       		  JR      Z,FNEND	;
209)   4D7B FE 95       		  CP      ('['-TCMD) AND 0xFF	;
210)   4D7D 28 1E       		  JR      Z,ASM	;
211)   4D7F FD 2B       		  DEC     IY	;
212)   4D81 CD 4A 55    		LET:  CALL    ASSIGN	;
213)   4D84 CA E8 4C    		  JP      Z,XEQ	;
214)   4D87 38 36       		  JR      C,SYNTAX        ;"Syntax error"	;"Syntax error"
215)   4D89 F5          		  PUSH    AF              ;SAVE STRING TYPE	;SAVE STRING TYPE
216)   4D8A CD D6 56    		  CALL    EQUALS	;
217)   4D8D E5          		  PUSH    HL	;
218)   4D8E CD 9D 5E    		  CALL    EXPRS	;
219)   4D91 DD E1       		  POP     IX	;
220)   4D93 F1          		  POP     AF	;
221)   4D94 CD 87 55    		  CALL    STACCS	;
222)   4D97 C3 E8 4C    		XEQR:  JP      XEQ	;
224)   4D9A CD 20 4D    		ASM0:  CALL    NEWLIN	;
225)   4D9D FD 22 F4 FD 		ASM:  LD      (ERRLIN),IY	;
226)   4DA1 CD 09 73    		  CALL    TRAP	;
227)   4DA4 CD C9 57    		  CALL    ASSEM	;
228)   4DA7 38 16       		  JR      C,SYNTAX	;
229)   4DA9 FE 0D       		  CP      CR	;
230)   4DAB 28 ED       		  JR      Z,ASM0	;
231)   4DAD 21 FE FD    		  LD      HL,LISTON	;
232)   4DB0 7E          		  LD      A,(HL)	;
233)   4DB1 E6 0F       		  AND     0FH	;
234)   4DB3 F6 30       		  OR      30H	;
235)   4DB5 77          		  LD      (HL),A	;
236)   4DB6 18 DF       		  JR      XEQR	;
238)   4DB8 CD 3F 49    		VAR:  CALL    GETVAR	;
239)   4DBB C8          		  RET     Z	;
240)   4DBC D2 30 49    		  JP      NC,PUTVAR	;
241)   4DBF 3E 10       		@SYNTAX: LD      A,16            ;"Syntax error"	;"Syntax error"
242)   4DC1 21          		  DEFB    21H	;
243)   4DC2 3E 11       		@ESCAPE: LD      A,17            ;"Escape"	;"Escape"
244)   4DC4 C3 DB 46    		ERROR0:  JP      ERROR	;
248)   4DC7 CD 84 5D    		FNEND:  CALL    EXPR            ;FUNCTION RESULT	;FUNCTION RESULT
249)   4DCA 43          		  LD      B,E	;
250)   4DCB EB          		  EX      DE,HL	;
251)   4DCC D9          		  EXX                     ;SAVE RESULT	;SAVE RESULT
252)   4DCD EB          		  EX      DE,HL           ; IN DEB'C'D'E'	; IN DEB'C'D'E'
253)   4DCE C1          		FNEND5:  POP     BC	;
254)   4DCF 21 A2 56    		  LD      HL,LOCCHK	;
255)   4DD2 B7          		  OR      A	;
256)   4DD3 ED 42       		  SBC     HL,BC	;
257)   4DD5 28 19       		  JR      Z,FNEND0        ;LOCAL VARIABLE	;LOCAL VARIABLE
258)   4DD7 21 20 51    		  LD      HL,FNCHK	;
259)   4DDA B7          		  OR      A	;
260)   4DDB ED 42       		  SBC     HL,BC	;
261)   4DDD 3E 07       		  LD      A,7	;
262)   4DDF 20 E3       		  JR      NZ,ERROR0       ;"No FN"	;"No FN"
263)   4DE1 FD E1       		  POP     IY	;
264)   4DE3 FD 22 F4 FD 		  LD      (ERRLIN),IY     ;IN CASE OF ERROR	;IN CASE OF ERROR
265)   4DE7 EB          		  EX      DE,HL	;
266)   4DE8 D9          		  EXX	;
267)   4DE9 EB          		  EX      DE,HL	;
268)   4DEA 11 00 FB    		  LD      DE,ACCS	;
269)   4DED 58          		  LD      E,B	;
270)   4DEE 08          		  EX      AF,AF'	;
271)   4DEF C9          		  RET	;
273)   4DF0 DD E1       		FNEND0:  POP     IX	;
274)   4DF2 C1          		  POP     BC	;
275)   4DF3 78          		  LD      A,B	;
276)   4DF4 B7          		  OR      A	;
277)   4DF5 FA 01 4E    		  JP      M,FNEND1        ;STRING	;STRING
278)   4DF8 E1          		  POP     HL	;
279)   4DF9 D9          		  EXX	;
280)   4DFA E1          		  POP     HL	;
281)   4DFB D9          		  EXX	;
282)   4DFC CD 5E 55    		  CALL    STORE	;
283)   4DFF 18 CD       		  JR      FNEND5	;
284)   4E01 21 00 00    		FNEND1:  LD      HL,0	;
285)   4E04 39          		  ADD     HL,SP	;
286)   4E05 D5          		  PUSH    DE	;
287)   4E06 59          		  LD      E,C	;
288)   4E07 CD 8A 55    		  CALL    STORES	;
289)   4E0A D1          		  POP     DE	;
290)   4E0B F9          		  LD      SP,HL	;
291)   4E0C 18 C0       		  JR      FNEND5	;
296)   4E0E CD 3F 49    		DIM:  CALL    GETVAR          ;VARIABLE	;VARIABLE
297)   4E11 38 7B       		  JR      C,BADDIM	;
298)   4E13 CA 96 4E    		  JP      Z,DIM4	;
299)   4E16 CD 7D 4A    		  CALL    CREATE	;
300)   4E19 E5          		  PUSH    HL	;
301)   4E1A DD E1       		  POP     IX	;
302)   4E1C FD 7E 00    		  LD      A,(IY)	;
303)   4E1F FE 28       		  CP      '('	;
304)   4E21 7A          		  LD      A,D	;
305)   4E22 20 72       		  JR      NZ,DIM4	;
306)   4E24 E5          		  PUSH    HL	;
307)   4E25 F5          		  PUSH    AF              ;SAVE TYPE	;SAVE TYPE
308)   4E26 11 01 00    		  LD      DE,1	;
309)   4E29 42          		  LD      B,D             ;DIMENSION COUNTER	;DIMENSION COUNTER
310)   4E2A FD 23       		DIM1:  INC     IY	;
311)   4E2C C5          		  PUSH    BC	;
312)   4E2D D5          		  PUSH    DE	;
313)   4E2E DD E5       		  PUSH    IX	;
314)   4E30 CD 94 5E    		  CALL    EXPRI           ;DIMENSION SIZE	;DIMENSION SIZE
315)   4E33 CB 7C       		  BIT     7,H	;
316)   4E35 20 57       		  JR      NZ,BADDIM	;
317)   4E37 D9          		  EXX	;
318)   4E38 23          		  INC     HL	;
319)   4E39 DD E1       		  POP     IX	;
320)   4E3B DD 23       		  INC     IX	;
321)   4E3D DD 75 00    		  LD      (IX),L          ;SAVE SIZE	;SAVE SIZE
322)   4E40 DD 23       		  INC     IX	;
323)   4E42 DD 74 00    		  LD      (IX),H	;
324)   4E45 C1          		  POP     BC	;
325)   4E46 CD A3 57    		  CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
326)   4E49 38 46       		  JR      C,NOROOM        ;TOO LARGE	;TOO LARGE
327)   4E4B EB          		  EX      DE,HL           ;DE=PRODUCT	;DE=PRODUCT
328)   4E4C C1          		  POP     BC	;
329)   4E4D 04          		  INC     B               ;DIMENSION COUNTER	;DIMENSION COUNTER
330)   4E4E FD 7E 00    		  LD      A,(IY)	;
331)   4E51 FE 2C       		  CP      ','             ;ANOTHER	;ANOTHER
332)   4E53 28 D5       		  JR      Z,DIM1	;
333)   4E55 CD 3C 64    		  CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
334)   4E58 F1          		  POP     AF              ;RESTORE TYPE	;RESTORE TYPE
335)   4E59 DD 23       		  INC     IX	;
336)   4E5B DD E3       		  EX      (SP),IX	;
337)   4E5D DD 70 00    		  LD      (IX),B          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
338)   4E60 CD 96 57    		  CALL    X4OR5           ;DE=DE*n	;DE=DE*n
339)   4E63 E1          		  POP     HL	;
340)   4E64 38 2B       		  JR      C,NOROOM	;
341)   4E66 19          		DIM3:  ADD     HL,DE	;
342)   4E67 38 28       		  JR      C,NOROOM	;
343)   4E69 E5          		  PUSH    HL	;
344)   4E6A 24          		  INC     H	;
345)   4E6B 28 24       		  JR      Z,NOROOM	;
346)   4E6D ED 72       		  SBC     HL,SP	;
347)   4E6F 30 20       		  JR      NC,NOROOM       ;OUT OF SPACE	;OUT OF SPACE
348)   4E71 E1          		  POP     HL	;
349)   4E72 22 E2 FD    		  LD      (FREE),HL	;
350)   4E75 7A          		DIM2:  LD      A,D	;
351)   4E76 B3          		  OR      E	;
352)   4E77 28 06       		  JR      Z,DIM5	;
353)   4E79 2B          		  DEC     HL	;
354)   4E7A 36 00       		  LD      (HL),0          ;INITIALISE ARRAY	;INITIALISE ARRAY
355)   4E7C 1B          		  DEC     DE	;
356)   4E7D 18 F6       		  JR      DIM2	;
357)   4E7F CD 78 64    		DIM5:  CALL    NXT	;
358)   4E82 FE 2C       		  CP      ','             ;ANOTHER VARIABLE?	;ANOTHER VARIABLE?
359)   4E84 C2 E8 4C    		  JP      NZ,XEQ	;
360)   4E87 FD 23       		  INC     IY	;
361)   4E89 CD 78 64    		  CALL    NXT	;
362)   4E8C 18 80       		  JR      DIM	;
364)   4E8E 3E 0A       		BADDIM:  LD      A,10            ;"Bad DIM"	;"Bad DIM"
365)   4E90 21          		  DEFB    21H	;
366)   4E91 3E 0B       		NOROOM:  LD      A,11            ;"DIM space"	;"DIM space"
367)   4E93 C3 DB 46    		ERROR1:  JP      ERROR	;
369)   4E96 B7          		DIM4:  OR      A	;
370)   4E97 28 F5       		  JR      Z,BADDIM	;
371)   4E99 FA 8E 4E    		  JP      M,BADDIM        	;
372)   4E9C 47          		  LD      B,A	;
373)   4E9D FD 7E FF    		  LD      A,(IY-1)	;
374)   4EA0 FE 29       		  CP      ')'	;
375)   4EA2 78          		  LD      A,B	;
376)   4EA3 28 E9       		  JR      Z,BADDIM	;
377)   4EA5 2A E2 FD    		  LD      HL,(FREE)	;
378)   4EA8 D9          		  EXX	;
379)   4EA9 21 00 00    		  LD      HL,0	;
380)   4EAC 4C          		  LD      C,H	;
381)   4EAD CD 5E 55    		  CALL    STORE           ;RESERVED AREA	;RESERVED AREA
382)   4EB0 CD 94 5E    		  CALL    EXPRI	;
383)   4EB3 D9          		  EXX	;
384)   4EB4 23          		  INC     HL	;
385)   4EB5 EB          		  EX      DE,HL	;
386)   4EB6 2A E2 FD    		  LD      HL,(FREE)	;
387)   4EB9 18 AB       		  JR      DIM3	;
392)   4EBB FE 23       		PRINT:  CP      '#'	;
393)   4EBD 20 6B       		  JR      NZ,PRINT0	;
394)   4EBF CD C1 57    		  CALL    CHNL            ;CHANNEL NO. = E	;CHANNEL NO. = E
395)   4EC2 CD 78 64    		PRNTN1:  CALL    NXT	;
396)   4EC5 FE 2C       		  CP      ','	;
397)   4EC7 C2 E8 4C    		  JP      NZ,XEQ	;
398)   4ECA FD 23       		  INC     IY	;
399)   4ECC D5          		  PUSH    DE	;
400)   4ECD CD 84 5D    		  CALL    EXPR            ;ITEM TO PRINT	;ITEM TO PRINT
401)   4ED0 08          		  EX      AF,AF'	;
402)   4ED1 FA F1 4E    		  JP      M,PRNTN2        ;STRING	;STRING
403)   4ED4 D1          		  POP     DE	;
404)   4ED5 C5          		  PUSH    BC	;
405)   4ED6 D9          		  EXX	;
406)   4ED7 7D          		  LD      A,L	;
407)   4ED8 D9          		  EXX	;
408)   4ED9 CD E7 73    		  CALL    OSBPUT	;
409)   4EDC D9          		  EXX	;
410)   4EDD 7C          		  LD      A,H	;
411)   4EDE D9          		  EXX	;
412)   4EDF CD E7 73    		  CALL    OSBPUT	;
413)   4EE2 7D          		  LD      A,L	;
414)   4EE3 CD E7 73    		  CALL    OSBPUT	;
415)   4EE6 7C          		  LD      A,H	;
416)   4EE7 CD E7 73    		  CALL    OSBPUT	;
417)   4EEA C1          		  POP     BC	;
418)   4EEB 79          		  LD      A,C	;
419)   4EEC CD E7 73    		  CALL    OSBPUT	;
420)   4EEF 18 D1       		  JR      PRNTN1	;
421)   4EF1 4B          		PRNTN2:  LD      C,E	;
422)   4EF2 D1          		  POP     DE	;
423)   4EF3 21 00 FB    		  LD      HL,ACCS	;
424)   4EF6 0C          		  INC     C	;
425)   4EF7 0D          		PRNTN3:  DEC     C	;
426)   4EF8 28 09       		  JR      Z,PRNTN4	;
427)   4EFA 7E          		  LD      A,(HL)	;
428)   4EFB 23          		  INC     HL	;
429)   4EFC C5          		  PUSH    BC	;
430)   4EFD CD E7 73    		  CALL    OSBPUT	;
431)   4F00 C1          		  POP     BC	;
432)   4F01 18 F4       		  JR      PRNTN3	;
433)   4F03 3E 0D       		PRNTN4:  LD      A,CR	;
434)   4F05 CD E7 73    		  CALL    OSBPUT	;
435)   4F08 18 B8       		  JR      PRNTN1	;
437)   4F0A 06 02       		PRINT6:  LD      B,2	;
438)   4F0C 18 22       		  JR      PRINTC	;
439)   4F0E 01 00 01    		PRINT8:  LD      BC,100H	;
440)   4F11 18 1D       		  JR      PRINTC	;
441)   4F13 21 00 FD    		PRINT9:  LD      HL,STAVAR	;
442)   4F16 AF          		  XOR     A	;
443)   4F17 BE          		  CP      (HL)	;
444)   4F18 28 10       		  JR      Z,PRINT0	;
445)   4F1A 3A FB FD    		  LD      A,(COUNT)	;
446)   4F1D B7          		  OR      A	;
447)   4F1E 28 0A       		  JR      Z,PRINT0	;
448)   4F20 96          		PRINTA:  SUB     (HL)	;
449)   4F21 28 07       		  JR      Z,PRINT0	;
450)   4F23 30 FB       		  JR      NC,PRINTA	;
451)   4F25 ED 44       		  NEG	;
452)   4F27 CD 2A 57    		  CALL    FILL	;
453)   4F2A 3A 00 FD    		PRINT0:  LD      A,(STAVAR)	;
454)   4F2D 4F          		  LD      C,A             ;PRINTS	;PRINTS
455)   4F2E 06 00       		  LD      B,0             ;PRINTF	;PRINTF
456)   4F30 CD C2 56    		PRINTC:  CALL    TERM?	;
457)   4F33 28 38       		  JR      Z,PRINT4	;
458)   4F35 CB 80       		  RES     0,B	;
459)   4F37 FD 23       		  INC     IY	;
460)   4F39 FE 7E       		  CP      '~'	;
461)   4F3B 28 CD       		  JR      Z,PRINT6	;
462)   4F3D FE 3B       		  CP      ';'	;
463)   4F3F 28 CD       		  JR      Z,PRINT8	;
464)   4F41 FE 2C       		  CP      ','	;
465)   4F43 28 CE       		  JR      Z,PRINT9	;
466)   4F45 CD E3 56    		  CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
467)   4F48 28 E6       		  JR      Z,PRINTC	;
468)   4F4A FD 2B       		  DEC     IY	;
469)   4F4C C5          		  PUSH    BC	;
470)   4F4D CD 84 5D    		  CALL    EXPR            ;VARIABLE TYPE	;VARIABLE TYPE
471)   4F50 08          		  EX      AF,AF'	;
472)   4F51 FA 67 4F    		  JP      M,PRINT3        ;STRING	;STRING
473)   4F54 D1          		  POP     DE	;
474)   4F55 D5          		  PUSH    DE	;
475)   4F56 CB 4A       		  BIT     1,D	;
476)   4F58 F5          		  PUSH    AF	;
477)   4F59 CC 96 63    		  CALL    Z,STR           ;DECIMAL	;DECIMAL
478)   4F5C F1          		  POP     AF	;
479)   4F5D C4 53 63    		  CALL    NZ,HEXSTR       ;HEX	;HEX
480)   4F60 C1          		  POP     BC	;
481)   4F61 C5          		  PUSH    BC	;
482)   4F62 79          		  LD      A,C	;
483)   4F63 93          		  SUB     E	;
484)   4F64 D4 2A 57    		  CALL    NC,FILL         ;RIGHT JUSTIFY	;RIGHT JUSTIFY
485)   4F67 C1          		PRINT3:  POP     BC	;
486)   4F68 CD 38 57    		  CALL    PTEXT           ;PRINT	;PRINT
487)   4F6B 18 C3       		  JR      PRINTC	;
488)   4F6D CB 40       		PRINT4:  BIT     0,B	;
489)   4F6F CC 6D 48    		  CALL    Z,CRLF	;
490)   4F72 C3 E8 4C    		  JP      XEQ	;
493)   4F75 FD 23       		ONERR:  INC     IY              ;SKIP "ERROR"	;SKIP "ERROR"
494)   4F77 21 00 00    		  LD      HL,0	;
495)   4F7A 22 EC FD    		  LD      (ERRTRP),HL	;
496)   4F7D CD 78 64    		  CALL    NXT	;
497)   4F80 FE 87       		  CP      OFF	;
498)   4F82 FD 23       		  INC     IY	;
499)   4F84 CA E8 4C    		  JP      Z,XEQ	;
500)   4F87 FD 2B       		  DEC     IY	;
501)   4F89 FD 22 EC FD 		  LD      (ERRTRP),IY	;
502)   4F8D C3 61 4D    		  JP      REM	;
512)   4F90 FE 85       		ON:  CP      TERROR	;
513)   4F92 28 E1       		  JR      Z,ONERR         ;"ON ERROR"	;"ON ERROR"
514)   4F94 CD 94 5E    		  CALL    EXPRI	;
515)   4F97 FD 7E 00    		  LD      A,(IY)	;
516)   4F9A FD 23       		  INC     IY	;
517)   4F9C 1E 2C       		  LD      E,','           ;SEPARATOR	;SEPARATOR
518)   4F9E FE E5       		  CP      TGOTO	;
519)   4FA0 28 0B       		  JR      Z,ON1	;
520)   4FA2 FE E4       		  CP      TGOSUB	;
521)   4FA4 28 07       		  JR      Z,ON1	;
522)   4FA6 1E F2       		  LD      E,TPROC	;
523)   4FA8 BB          		  CP      E	;
524)   4FA9 3E 27       		  LD      A,39	;
525)   4FAB 20 41       		  JR      NZ,ERROR2       ;"ON syntax"	;"ON syntax"
526)   4FAD 57          		ON1:  LD      D,A	;
527)   4FAE D9          		  EXX	;
528)   4FAF E5          		  PUSH    HL	;
529)   4FB0 D9          		  EXX	;
530)   4FB1 C1          		  POP     BC              ;ON INDEX	;ON INDEX
531)   4FB2 78          		  LD      A,B	;
532)   4FB3 B4          		  OR      H	;
533)   4FB4 B5          		  OR      L	;
534)   4FB5 20 27       		  JR      NZ,ON4          ;OUT OF RANGE	;OUT OF RANGE
535)   4FB7 B1          		  OR      C	;
536)   4FB8 28 24       		  JR      Z,ON4	;
537)   4FBA 0D          		  DEC     C	;
538)   4FBB 28 0D       		  JR      Z,ON3           ;INDEX=1	;INDEX=1
539)   4FBD CD C2 56    		ON2:  CALL    TERM?	;
540)   4FC0 28 1C       		  JR      Z,ON4           ;OUT OF RANGE	;OUT OF RANGE
541)   4FC2 FD 23       		  INC     IY              ;SKIP DELIMITER	;SKIP DELIMITER
542)   4FC4 BB          		  CP      E	;
543)   4FC5 20 F6       		  JR      NZ,ON2	;
544)   4FC7 0D          		  DEC     C	;
545)   4FC8 20 F3       		  JR      NZ,ON2	;
546)   4FCA 7B          		ON3:  LD      A,E	;
547)   4FCB FE F2       		  CP      TPROC	;
548)   4FCD 28 22       		  JR      Z,ONPROC	;
549)   4FCF D5          		  PUSH    DE	;
550)   4FD0 CD AB 5E    		  CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
551)   4FD3 D1          		  POP     DE	;
552)   4FD4 7A          		  LD      A,D	;
553)   4FD5 FE E5       		  CP      TGOTO	;
554)   4FD7 28 26       		  JR      Z,GOTO2	;
555)   4FD9 CD CE 56    		  CALL    SPAN            ;SKIP REST OF LIST	;SKIP REST OF LIST
556)   4FDC 18 32       		  JR      GOSUB1	;
558)   4FDE FD 7E 00    		ON4:  LD      A,(IY)	;
559)   4FE1 FD 23       		  INC     IY	;
560)   4FE3 FE 8B       		  CP      ELSE	;
561)   4FE5 CA 8A 53    		  JP      Z,IF1           ;ELSE CLAUSE	;ELSE CLAUSE
562)   4FE8 FE 0D       		  CP      CR	;
563)   4FEA 20 F2       		  JR      NZ,ON4	;
564)   4FEC 3E 28       		  LD      A,40	;
565)   4FEE C3 DB 46    		ERROR2:  JP      ERROR           ;"ON range"	;"ON range"
567)   4FF1 3E EE       		ONPROC:  LD      A,TON	;
568)   4FF3 C3 20 51    		  JP      PROC	;
572)   4FF6 CD AB 5E    		GOTO:  CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
573)   4FF9 CD C2 56    		GOTO1:  CALL    TERM?	;
574)   4FFC C2 BF 4D    		  JP      NZ,SYNTAX	;
575)   4FFF D9          		GOTO2:  EXX	;
576)   5000 CD AB 48    		  CALL    FINDL	;
577)   5003 E5          		  PUSH    HL	;
578)   5004 FD E1       		  POP     IY	;
579)   5006 CA E5 4C    		  JP      Z,XEQ0	;
580)   5009 3E 29       		  LD      A,41	;
581)   500B 18 E1       		  JR      ERROR2          ;"No such line"	;"No such line"
585)   500D CD AB 5E    		GOSUB:  CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
586)   5010 FD E5       		GOSUB1:  PUSH    IY              ;TEXT POINTER	;TEXT POINTER
587)   5012 CD BF 55    		  CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
588)   5015 CD F9 4F    		  CALL    GOTO1           ;SAVE MARKER	;SAVE MARKER
593)   5018 D1          		RETURN:  POP     DE              ;MARKER	;MARKER
594)   5019 21 18 50    		  LD      HL,GOSCHK	;
595)   501C B7          		  OR      A	;
596)   501D ED 52       		  SBC     HL,DE	;
597)   501F FD E1       		  POP     IY	;
598)   5021 CA E8 4C    		  JP      Z,XEQ	;
599)   5024 3E 26       		  LD      A,38	;
600)   5026 18 C6       		  JR      ERROR2          ;"No GOSUB"	;"No GOSUB"
604)   5028 FD E5       		REPEAT:  PUSH    IY	;
605)   502A CD BF 55    		  CALL    CHECK	;
606)   502D CD E8 4C    		  CALL    XEQ	;
611)   5030 C1          		UNTIL:  POP     BC	;
612)   5031 C5          		  PUSH    BC	;
613)   5032 21 30 50    		  LD      HL,REPCHK	;
614)   5035 B7          		  OR      A	;
615)   5036 ED 42       		  SBC     HL,BC	;
616)   5038 3E 2B       		  LD      A,43	;
617)   503A 20 B2       		  JR      NZ,ERROR2       ;"No REPEAT"	;"No REPEAT"
618)   503C CD 94 5E    		  CALL    EXPRI	;
619)   503F CD 1F 63    		  CALL    TEST	;
620)   5042 C1          		  POP     BC	;
621)   5043 D1          		  POP     DE	;
622)   5044 20 05       		  JR      NZ,XEQ2         ;TRUE	;TRUE
623)   5046 D5          		  PUSH    DE	;
624)   5047 C5          		  PUSH    BC	;
625)   5048 D5          		  PUSH    DE	;
626)   5049 FD E1       		  POP     IY	;
627)   504B C3 E8 4C    		XEQ2:  JP      XEQ	;
631)   504E 3E 22       		FORVAR:  LD      A,34	;
632)   5050 18 9C       		  JR      ERROR2          ;"FOR variable"	;"FOR variable"
634)   5052 CD 4A 55    		FOR:  CALL    ASSIGN	;
635)   5055 20 F7       		  JR      NZ,FORVAR       ;"FOR variable"	;"FOR variable"
636)   5057 F5          		  PUSH    AF              ;SAVE TYPE	;SAVE TYPE
637)   5058 FD 7E 00    		  LD      A,(IY)	;
638)   505B FE B8       		  CP      TO	;
639)   505D 3E 24       		  LD      A,36	;
640)   505F 20 8D       		  JR      NZ,ERROR2       ;"No TO"	;"No TO"
641)   5061 FD 23       		  INC     IY	;
642)   5063 DD E5       		  PUSH    IX	;
643)   5065 CD 8D 5E    		  CALL    EXPRN           ;LIMIT	;LIMIT
644)   5068 DD E1       		  POP     IX	;
645)   506A F1          		  POP     AF	;
646)   506B 47          		  LD      B,A             ;TYPE	;TYPE
647)   506C C5          		  PUSH    BC              ;SAVE ON STACK	;SAVE ON STACK
648)   506D E5          		  PUSH    HL	;
649)   506E 21 00 00    		  LD      HL,0	;
650)   5071 4C          		  LD      C,H	;
651)   5072 D9          		  EXX	;
652)   5073 E5          		  PUSH    HL	;
653)   5074 21 01 00    		  LD      HL,1            ;PRESET STEP	;PRESET STEP
654)   5077 D9          		  EXX	;
655)   5078 FD 7E 00    		  LD      A,(IY)	;
656)   507B FE 88       		  CP      STEP	;
657)   507D 20 09       		  JR      NZ,FOR1	;
658)   507F FD 23       		  INC     IY	;
659)   5081 DD E5       		  PUSH    IX	;
660)   5083 CD 8D 5E    		  CALL    EXPRN           ;STEP	;STEP
661)   5086 DD E1       		  POP     IX	;
662)   5088 C5          		FOR1:  PUSH    BC	;
663)   5089 E5          		  PUSH    HL	;
664)   508A D9          		  EXX	;
665)   508B E5          		  PUSH    HL	;
666)   508C D9          		  EXX	;
667)   508D FD E5       		  PUSH    IY              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
668)   508F DD E5       		  PUSH    IX              ;LOOP VARIABLE	;LOOP VARIABLE
669)   5091 CD BF 55    		  CALL    CHECK	;
670)   5094 CD E8 4C    		  CALL    XEQ	;
675)   5097 C1          		NEXT:  POP     BC              ;MARKER	;MARKER
676)   5098 21 97 50    		  LD      HL,FORCHK	;
677)   509B B7          		  OR      A	;
678)   509C ED 42       		  SBC     HL,BC	;
679)   509E 3E 20       		  LD      A,32	;
680)   50A0 20 77       		  JR      NZ,ERROR3       ;"No FOR"	;"No FOR"
681)   50A2 CD C2 56    		  CALL    TERM?	;
682)   50A5 E1          		  POP     HL	;
683)   50A6 E5          		  PUSH    HL	;
684)   50A7 C5          		  PUSH    BC	;
685)   50A8 E5          		  PUSH    HL	;
686)   50A9 C4 3F 49    		  CALL    NZ,GETVAR       ;VARIABLE	;VARIABLE
687)   50AC D1          		  POP     DE	;
688)   50AD EB          		  EX      DE,HL	;
689)   50AE B7          		  OR      A	;
690)   50AF ED 52       		NEXT0:  SBC     HL,DE	;
691)   50B1 20 54       		  JR      NZ,NEXT1	;
692)   50B3 D5          		  PUSH    DE	;
693)   50B4 DD 21 08 00 		  LD      IX,6+2	;
694)   50B8 DD 39       		  ADD     IX,SP	;
695)   50BA CD C5 5F    		  CALL    DLOAD5          ;STEP	;STEP
696)   50BD DD 7E 0B    		  LD      A,(IX+11)       ;TYPE	;TYPE
697)   50C0 DD E1       		  POP     IX	;
698)   50C2 CD 4D 5F    		  CALL    LOADN           ;LOOP VARIABLE	;LOOP VARIABLE
699)   50C5 CB 7A       		  BIT     7,D             ;SIGN?	;SIGN?
700)   50C7 F5          		  PUSH    AF	;
701)   50C8 3E 0B       		  LD      A,'+' AND 0FH	;
702)   50CA CD 9C 64    		  CALL    FPP             ;ADD STEP	;ADD STEP
703)   50CD 38 4A       		  JR      C,ERROR3	;
704)   50CF F1          		  POP     AF              ;RESTORE TYPE	;RESTORE TYPE
705)   50D0 F5          		  PUSH    AF	;
706)   50D1 CD 5E 55    		  CALL    STORE           ;UPDATE VARIABLE	;UPDATE VARIABLE
707)   50D4 DD 21 0E 00 		  LD      IX,12+2	;
708)   50D8 DD 39       		  ADD     IX,SP	;
709)   50DA CD C5 5F    		  CALL    DLOAD5          ;LIMIT	;LIMIT
710)   50DD F1          		  POP     AF	;
711)   50DE CC 17 63    		  CALL    Z,SWAP	;
712)   50E1 3E 08       		  LD      A,0+('<'-4) AND 0FH	;
713)   50E3 CD 9C 64    		  CALL    FPP             ;TEST AGAINST LIMIT	;TEST AGAINST LIMIT
714)   50E6 38 31       		  JR      C,ERROR3	;
715)   50E8 24          		  INC     H	;
716)   50E9 20 11       		  JR      NZ,LOOP         ;KEEP LOOPING	;KEEP LOOPING
717)   50EB 21 12 00    		  LD      HL,18	;
718)   50EE 39          		  ADD     HL,SP	;
719)   50EF F9          		  LD      SP,HL	;
720)   50F0 CD 78 64    		  CALL    NXT	;
721)   50F3 FE 2C       		  CP      ','	;
722)   50F5 C2 E8 4C    		  JP      NZ,XEQ	;
723)   50F8 FD 23       		  INC     IY	;
724)   50FA 18 9B       		  JR      NEXT	;
726)   50FC C1          		LOOP:  POP     BC	;
727)   50FD D1          		  POP     DE	;
728)   50FE FD E1       		  POP     IY	;
729)   5100 FD E5       		  PUSH    IY	;
730)   5102 D5          		  PUSH    DE	;
731)   5103 C5          		  PUSH    BC	;
732)   5104 C3 E8 4C    		  JP      XEQ	;
734)   5107 21 12 00    		NEXT1:  LD      HL,18	;
735)   510A 39          		  ADD     HL,SP	;
736)   510B F9          		  LD      SP,HL           ;"POP" THE STACK	;"POP" THE STACK
737)   510C C1          		  POP     BC	;
738)   510D 21 97 50    		  LD      HL,FORCHK	;
739)   5110 ED 42       		  SBC     HL,BC	;
740)   5112 E1          		  POP     HL              ;VARIABLE POINTER	;VARIABLE POINTER
741)   5113 E5          		  PUSH    HL	;
742)   5114 C5          		  PUSH    BC	;
743)   5115 28 98       		  JR      Z,NEXT0	;
744)   5117 3E 21       		  LD      A,33	;
745)   5119 C3 DB 46    		ERROR3:  JP      ERROR           ;"Can't match FOR"	;"Can't match FOR"
750)   511C F5          		@FN:  PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
751)   511D CD 24 51    		  CALL    PROC1	;
757)   5120 F5          		PROC:  PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
758)   5121 CD 24 51    		  CALL    PROC1	;
760)   5124 CD BF 55    		PROC1::  CALL    CHECK	;
761)   5127 FD 2B       		  DEC     IY	;
762)   5129 FD E5       		  PUSH    IY	;
763)   512B CD DB 49    		  CALL    GETDEF	;
764)   512E C1          		  POP     BC	;
765)   512F 28 39       		  JR      Z,PROC4	;
766)   5131 3E 1E       		  LD      A,30	;
767)   5133 38 E4       		  JR      C,ERROR3        ;"Bad call"	;"Bad call"
768)   5135 C5          		  PUSH    BC	;
769)   5136 2A DC FD    		  LD      HL,(PAGE)	;
770)   5139 3E DD       		PROC2:  LD      A,DEF	;
771)   513B CD 80 57    		  CALL    SEARCH          ;LOOK FOR "DEF"	;LOOK FOR "DEF"
772)   513E 38 21       		  JR      C,PROC3	;
773)   5140 E5          		  PUSH    HL	;
774)   5141 FD E1       		  POP     IY	;
775)   5143 FD 23       		  INC     IY              ;SKIP DEF	;SKIP DEF
776)   5145 CD 78 64    		  CALL    NXT	;
777)   5148 CD DB 49    		  CALL    GETDEF	;
778)   514B FD E5       		  PUSH    IY	;
779)   514D D1          		  POP     DE	;
780)   514E 38 09       		  JR      C,PROC6	;
781)   5150 C4 7D 4A    		  CALL    NZ,CREATE	;
782)   5153 FD E5       		  PUSH    IY	;
783)   5155 D1          		  POP     DE	;
784)   5156 73          		  LD      (HL),E	;
785)   5157 23          		  INC     HL	;
786)   5158 72          		  LD      (HL),D          ;SAVE ADDRESS	;SAVE ADDRESS
787)   5159 EB          		PROC6:  EX      DE,HL	;
788)   515A 3E 0D       		  LD      A,CR	;
789)   515C 47          		  LD      B,A	;
790)   515D ED B1       		  CPIR                    ;SKIP TO END OF LINE	;SKIP TO END OF LINE
791)   515F 18 D8       		  JR      PROC2	;
792)   5161 FD E1       		PROC3:  POP     IY              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
793)   5163 CD DB 49    		  CALL    GETDEF	;
794)   5166 3E 1D       		  LD      A,29	;
795)   5168 20 AF       		  JR      NZ,ERROR3       ;"No such FN/PROC"	;"No such FN/PROC"
796)   516A 5E          		PROC4:  LD      E,(HL)	;
797)   516B 23          		  INC     HL	;
798)   516C 56          		  LD      D,(HL)          ;GET ADDRESS	;GET ADDRESS
799)   516D 21 02 00    		  LD      HL,2	;
800)   5170 39          		  ADD     HL,SP	;
801)   5171 CD 78 64    		  CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
802)   5174 D5          		  PUSH    DE              ;EXCHANGE DE,IY	;EXCHANGE DE,IY
803)   5175 FD E3       		  EX      (SP),IY	;
804)   5177 D1          		  POP     DE	;
805)   5178 FE 28       		  CP      '('             ;ARGUMENTS?	;ARGUMENTS?
806)   517A 20 1B       		  JR      NZ,PROC5	;
807)   517C CD 78 64    		  CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
808)   517F FE 28       		  CP      '('	;
809)   5181 C2 BF 4D    		  JP      NZ,SYNTAX       ;"Syntax error"	;"Syntax error"
810)   5184 FD E5       		  PUSH    IY	;
811)   5186 C1          		  POP     BC              ;SAVE IY IN BC	;SAVE IY IN BC
812)   5187 D9          		  EXX	;
813)   5188 CD 50 56    		  CALL    SAVLOC          ;SAVE DUMMY VARIABLES	;SAVE DUMMY VARIABLES
814)   518B CD 3C 64    		  CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
815)   518E D9          		  EXX	;
816)   518F C5          		  PUSH    BC	;
817)   5190 FD E1       		  POP     IY              ;RESTORE IY	;RESTORE IY
818)   5192 E5          		  PUSH    HL	;
819)   5193 CD DB 55    		  CALL    ARGUE           ;TRANSFER ARGUMENTS	;TRANSFER ARGUMENTS
820)   5196 E1          		  POP     HL	;
821)   5197 73          		PROC5:  LD      (HL),E          ;SAVE "RETURN ADDRESS"	;SAVE "RETURN ADDRESS"
822)   5198 23          		  INC     HL	;
823)   5199 7E          		  LD      A,(HL)	;
824)   519A 72          		  LD      (HL),D	;
825)   519B FE EE       		  CP      TON             ;WAS IT "ON PROC" ?	;WAS IT "ON PROC" ?
826)   519D C2 E8 4C    		  JP      NZ,XEQ	;
827)   51A0 D5          		  PUSH    DE	;
828)   51A1 FD E3       		  EX      (SP),IY	;
829)   51A3 CD CE 56    		  CALL    SPAN            ;SKIP REST OF ON LIST	;SKIP REST OF ON LIST
830)   51A6 FD E3       		  EX      (SP),IY	;
831)   51A8 D1          		  POP     DE	;
832)   51A9 72          		  LD      (HL),D	;
833)   51AA 2B          		  DEC     HL	;
834)   51AB 73          		  LD      (HL),E	;
835)   51AC C3 E8 4C    		  JP      XEQ	;
839)   51AF C1          		LOCAL:  POP     BC	;
840)   51B0 C5          		  PUSH    BC	;
841)   51B1 21 20 51    		  LD      HL,FNCHK	;
842)   51B4 B7          		  OR      A	;
843)   51B5 ED 42       		  SBC     HL,BC	;
844)   51B7 28 13       		  JR      Z,LOCAL1	;
845)   51B9 21 24 51    		  LD      HL,PROCHK	;
846)   51BC B7          		  OR      A	;
847)   51BD ED 42       		  SBC     HL,BC	;
848)   51BF 28 0B       		  JR      Z,LOCAL1	;
849)   51C1 21 A2 56    		  LD      HL,LOCCHK	;
850)   51C4 B7          		  OR      A	;
851)   51C5 ED 42       		  SBC     HL,BC	;
852)   51C7 3E 0C       		  LD      A,12	;
853)   51C9 C2 DB 46    		  JP      NZ,ERROR        ;"Not LOCAL"	;"Not LOCAL"
854)   51CC FD E5       		LOCAL1:  PUSH    IY	;
855)   51CE C1          		  POP     BC	;
856)   51CF D9          		  EXX	;
857)   51D0 FD 2B       		  DEC     IY	;
858)   51D2 CD 50 56    		  CALL    SAVLOC	;
859)   51D5 D9          		  EXX	;
860)   51D6 C5          		  PUSH    BC	;
861)   51D7 FD E1       		  POP     IY	;
862)   51D9 CD 3F 49    		LOCAL2:  CALL    GETVAR	;
863)   51DC C2 BF 4D    		  JP      NZ,SYNTAX	;
864)   51DF B7          		  OR      A               ;TYPE	;TYPE
865)   51E0 08          		  EX      AF,AF'	;
866)   51E1 CD BE 63    		  CALL    ZERO	;
867)   51E4 08          		  EX      AF,AF'	;
868)   51E5 F5          		  PUSH    AF	;
869)   51E6 F4 5E 55    		  CALL    P,STORE         ;ZERO	;ZERO
870)   51E9 F1          		  POP     AF	;
871)   51EA 59          		  LD      E,C	;
872)   51EB FC 8A 55    		  CALL    M,STORES	;
873)   51EE CD 78 64    		  CALL    NXT	;
874)   51F1 FE 2C       		  CP      ','	;
875)   51F3 C2 E8 4C    		  JP      NZ,XEQ	;
876)   51F6 FD 23       		  INC     IY	;
877)   51F8 CD 78 64    		  CALL    NXT	;
878)   51FB 18 DC       		  JR      LOCAL2	;
882)   51FD C1          		ENDPRO:  POP     BC	;
883)   51FE 21 A2 56    		  LD      HL,LOCCHK	;
884)   5201 B7          		  OR      A	;
885)   5202 ED 42       		  SBC     HL,BC	;
886)   5204 28 10       		  JR      Z,UNSTK         ;LOCAL VARIABLE	;LOCAL VARIABLE
887)   5206 21 24 51    		  LD      HL,PROCHK       ;PROC MARKER	;PROC MARKER
888)   5209 B7          		  OR      A	;
889)   520A ED 42       		  SBC     HL,BC	;
890)   520C FD E1       		  POP     IY	;
891)   520E CA E8 4C    		  JP      Z,XEQ	;
892)   5211 3E 0D       		  LD      A,13	;
893)   5213 C3 DB 46    		  JP      ERROR           ;"No PROC"	;"No PROC"
895)   5216 DD E1       		UNSTK:  POP     IX	;
896)   5218 C1          		  POP     BC	;
897)   5219 78          		  LD      A,B	;
898)   521A B7          		  OR      A	;
899)   521B FA 27 52    		  JP      M,UNSTK1        ;STRING	;STRING
900)   521E E1          		  POP     HL	;
901)   521F D9          		  EXX	;
902)   5220 E1          		  POP     HL	;
903)   5221 D9          		  EXX	;
904)   5222 CD 5E 55    		  CALL    STORE	;
905)   5225 18 D6       		  JR      ENDPRO	;
906)   5227 21 00 00    		UNSTK1:  LD      HL,0	;
907)   522A 39          		  ADD     HL,SP	;
908)   522B 59          		  LD      E,C	;
909)   522C CD 8A 55    		  CALL    STORES	;
910)   522F F9          		  LD      SP,HL	;
911)   5230 18 CB       		  JR      ENDPRO	;
915)   5232 CD C1 57    		INPUTN:  CALL    CHNL            ;E = CHANNEL NUMBER	;E = CHANNEL NUMBER
916)   5235 CD 78 64    		INPN1:  CALL    NXT	;
917)   5238 FE 2C       		  CP      ','	;
918)   523A C2 E8 4C    		  JP      NZ,XEQ	;
919)   523D FD 23       		  INC     IY	;
920)   523F CD 78 64    		  CALL    NXT	;
921)   5242 D5          		  PUSH    DE	;
922)   5243 CD B8 4D    		  CALL    VAR	;
923)   5246 D1          		  POP     DE	;
924)   5247 F5          		  PUSH    AF              ;SAVE TYPE	;SAVE TYPE
925)   5248 E5          		  PUSH    HL              ;VARPTR	;VARPTR
926)   5249 B7          		  OR      A	;
927)   524A FA 6F 52    		  JP      M,INPN2         ;STRING	;STRING
928)   524D CD F7 73    		  CALL    OSBGET	;
929)   5250 D9          		  EXX	;
930)   5251 6F          		  LD      L,A	;
931)   5252 D9          		  EXX	;
932)   5253 CD F7 73    		  CALL    OSBGET	;
933)   5256 D9          		  EXX	;
934)   5257 67          		  LD      H,A	;
935)   5258 D9          		  EXX	;
936)   5259 CD F7 73    		  CALL    OSBGET	;
937)   525C 6F          		  LD      L,A	;
938)   525D CD F7 73    		  CALL    OSBGET	;
939)   5260 67          		  LD      H,A	;
940)   5261 CD F7 73    		  CALL    OSBGET	;
941)   5264 4F          		  LD      C,A	;
942)   5265 DD E1       		  POP     IX	;
943)   5267 F1          		  POP     AF              ;RESTORE TYPE	;RESTORE TYPE
944)   5268 D5          		  PUSH    DE              ;SAVE CHANNEL	;SAVE CHANNEL
945)   5269 CD 5E 55    		  CALL    STORE	;
946)   526C D1          		  POP     DE	;
947)   526D 18 C6       		  JR      INPN1	;
948)   526F 21 00 FB    		INPN2:  LD      HL,ACCS	;
949)   5272 CD F7 73    		INPN3:  CALL    OSBGET	;
950)   5275 FE 0D       		  CP      CR	;
951)   5277 28 04       		  JR      Z,INPN4	;
952)   5279 77          		  LD      (HL),A	;
953)   527A 2C          		  INC     L	;
954)   527B 20 F5       		  JR      NZ,INPN3	;
955)   527D DD E1       		INPN4:  POP     IX	;
956)   527F F1          		  POP     AF	;
957)   5280 D5          		  PUSH    DE	;
958)   5281 EB          		  EX      DE,HL	;
959)   5282 CD 87 55    		  CALL    STACCS	;
960)   5285 D1          		  POP     DE	;
961)   5286 18 AD       		  JR      INPN1	;
966)   5288 FE 23       		INPUT:  CP      '#'	;
967)   528A 28 A6       		  JR      Z,INPUTN	;
968)   528C 0E 00       		  LD      C,0             ;FLAG PROMPT	;FLAG PROMPT
969)   528E FE 86       		  CP      LINE	;
970)   5290 20 04       		  JR      NZ,INPUT0	;
971)   5292 FD 23       		  INC     IY              ;SKIP "LINE"	;SKIP "LINE"
972)   5294 0E 80       		  LD      C,80H	;
973)   5296 21 00 FC    		INPUT0:  LD      HL,BUFFER	;
974)   5299 36 0D       		  LD      (HL),CR         ;INITIALISE EMPTY	;INITIALISE EMPTY
975)   529B CD C2 56    		INPUT1:  CALL    TERM?	;
976)   529E CA E8 4C    		  JP      Z,XEQ           ;DONE	;DONE
977)   52A1 FD 23       		  INC     IY	;
978)   52A3 FE 2C       		  CP      ','	;
979)   52A5 28 51       		  JR      Z,INPUT3        ;SKIP COMMA	;SKIP COMMA
980)   52A7 FE 3B       		  CP      ';'	;
981)   52A9 28 4D       		  JR      Z,INPUT3	;
982)   52AB E5          		  PUSH    HL              ;SAVE BUFFER POINTER	;SAVE BUFFER POINTER
983)   52AC FE 22       		  CP      34  ;ASCII ""	;ASCII ""
984)   52AE 20 0A       		  JR      NZ,INPUT6	;
985)   52B0 C5          		  PUSH    BC	;
986)   52B1 CD 8F 5F    		  CALL    CONS	;
987)   52B4 C1          		  POP     BC	;
988)   52B5 CD 38 57    		  CALL    PTEXT           ;PRINT PROMPT	;PRINT PROMPT
989)   52B8 18 05       		  JR      INPUT9	;
990)   52BA CD E3 56    		INPUT6:  CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
991)   52BD 20 05       		  JR      NZ,INPUT2	;
992)   52BF E1          		INPUT9:  POP     HL	;
993)   52C0 CB C1       		  SET     0,C             ;FLAG NO PROMPT	;FLAG NO PROMPT
994)   52C2 18 D2       		  JR      INPUT0	;
995)   52C4 FD 2B       		INPUT2:  DEC     IY	;
996)   52C6 C5          		  PUSH    BC	;
997)   52C7 CD B8 4D    		  CALL    VAR	;
998)   52CA C1          		  POP     BC	;
999)   52CB E1          		  POP     HL	;
1000)   52CC F5          		  PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1001)   52CD 7E          		  LD      A,(HL)	;
1002)   52CE 23          		  INC     HL	;
1003)   52CF FE 0D       		  CP      CR              ;BUFFER EMPTY?	;BUFFER EMPTY?
1004)   52D1 CC FC 52    		  CALL    Z,REFILL	;
1005)   52D4 CB 79       		  BIT     7,C	;
1006)   52D6 F5          		  PUSH    AF	;
1007)   52D7 C4 56 57    		  CALL    NZ,LINES	;
1008)   52DA F1          		  POP     AF	;
1009)   52DB CC 45 57    		  CALL    Z,FETCHS	;
1010)   52DE F1          		  POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1011)   52DF C5          		  PUSH    BC	;
1012)   52E0 E5          		  PUSH    HL	;
1013)   52E1 B7          		  OR      A	;
1014)   52E2 FA F3 52    		  JP      M,INPUT4        ;STRING	;STRING
1015)   52E5 F5          		  PUSH    AF	;
1016)   52E6 DD E5       		  PUSH    IX	;
1017)   52E8 CD 46 61    		  CALL    VAL0	;
1018)   52EB DD E1       		  POP     IX	;
1019)   52ED F1          		  POP     AF	;
1020)   52EE CD 5E 55    		  CALL    STORE	;
1021)   52F1 18 03       		  JR      INPUT5	;
1022)   52F3 CD 87 55    		INPUT4:  CALL    STACCS	;
1023)   52F6 E1          		INPUT5:  POP     HL	;
1024)   52F7 C1          		  POP     BC	;
1025)   52F8 CB 81       		INPUT3:  RES     0,C	;
1026)   52FA 18 9F       		  JR      INPUT1	;
1028)   52FC CB 41       		REFILL:  BIT     0,C	;
1029)   52FE 20 0A       		  JR      NZ,REFIL0       ;NO PROMPT	;NO PROMPT
1030)   5300 3E 3F       		  LD      A,'?'	;
1031)   5302 CD 74 48    		  CALL    OUTCHR          ;PROMPT	;PROMPT
1032)   5305 3E 20       		  LD      A,' '	;
1033)   5307 CD 74 48    		  CALL    OUTCHR	;
1034)   530A 21 00 FC    		REFIL0:  LD      HL,BUFFER	;
1035)   530D C5          		  PUSH    BC	;
1036)   530E E5          		  PUSH    HL	;
1037)   530F DD E5       		  PUSH    IX	;
1038)   5311 CD CB 74    		  CALL    OSLINE	;
1039)   5314 DD E1       		  POP     IX	;
1040)   5316 E1          		  POP     HL	;
1041)   5317 C1          		  POP     BC	;
1042)   5318 47          		  LD      B,A             ;POS AT ENTRY	;POS AT ENTRY
1043)   5319 AF          		  XOR     A	;
1044)   531A 32 FB FD    		  LD      (COUNT),A	;
1045)   531D B8          		  CP      B	;
1046)   531E C8          		  RET     Z	;
1047)   531F 7E          		REFIL1:  LD      A,(HL)	;
1048)   5320 FE 0D       		  CP      CR	;
1049)   5322 C8          		  RET     Z	;
1050)   5323 23          		  INC     HL	;
1051)   5324 10 F9       		  DJNZ    REFIL1	;
1052)   5326 C9          		  RET	;
1056)   5327 FE 23       		READ:  CP      '#'	;
1057)   5329 CA 32 52    		  JP      Z,INPUTN	;
1058)   532C 2A F0 FD    		  LD      HL,(DATPTR)	;
1059)   532F 7E          		READ0:  LD      A,(HL)	;
1060)   5330 23          		  INC     HL              ;SKIP COMMA OR "DATA"	;SKIP COMMA OR "DATA"
1061)   5331 FE 0D       		  CP      CR              ;END OF DATA STMT?	;END OF DATA STMT?
1062)   5333 CC 6C 53    		  CALL    Z,GETDAT	;
1063)   5336 E5          		  PUSH    HL	;
1064)   5337 CD B8 4D    		  CALL    VAR	;
1065)   533A E1          		  POP     HL	;
1066)   533B B7          		  OR      A	;
1067)   533C FA 52 53    		  JP      M,READ1         ;STRING	;STRING
1068)   533F E5          		  PUSH    HL	;
1069)   5340 FD E3       		  EX      (SP),IY	;
1070)   5342 F5          		  PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1071)   5343 DD E5       		  PUSH    IX	;
1072)   5345 CD 8D 5E    		  CALL    EXPRN	;
1073)   5348 DD E1       		  POP     IX	;
1074)   534A F1          		  POP     AF	;
1075)   534B CD 5E 55    		  CALL    STORE	;
1076)   534E FD E3       		  EX      (SP),IY	;
1077)   5350 18 07       		  JR      READ2	;
1078)   5352 CD 45 57    		READ1:  CALL    FETCHS	;
1079)   5355 E5          		  PUSH    HL	;
1080)   5356 CD 87 55    		  CALL    STACCS	;
1081)   5359 E1          		READ2:  POP     HL	;
1082)   535A 22 F0 FD    		  LD      (DATPTR),HL	;
1083)   535D CD 78 64    		  CALL    NXT	;
1084)   5360 FE 2C       		  CP      ','	;
1085)   5362 C2 E8 4C    		  JP      NZ,XEQ	;
1086)   5365 FD 23       		  INC     IY	;
1087)   5367 CD 78 64    		  CALL    NXT	;
1088)   536A 18 C3       		  JR      READ0	;
1090)   536C 3E DC       		GETDAT:  LD      A,DATA	;
1091)   536E CD 80 57    		  CALL    SEARCH	;
1092)   5371 23          		  INC     HL	;
1093)   5372 D0          		  RET     NC	;
1094)   5373 3E 2A       		  LD      A,42	;
1095)   5375 C3 DB 46    		ERROR4:  JP      ERROR           ;"Out of DATA"	;"Out of DATA"
1101)   5378 CD 94 5E    		IF:  CALL    EXPRI	;
1102)   537B CD 1F 63    		  CALL    TEST	;
1103)   537E 28 15       		  JR      Z,IFNOT         ;FALSE	;FALSE
1104)   5380 FD 7E 00    		  LD      A,(IY)	;
1105)   5383 FE 8C       		  CP      THEN	;
1106)   5385 C2 E8 4C    		  JP      NZ,XEQ	;
1107)   5388 FD 23       		  INC     IY              ;SKIP "THEN"	;SKIP "THEN"
1108)   538A CD 78 64    		IF1:  CALL    NXT	;
1109)   538D FE 8D       		  CP      LINO	;
1110)   538F C2 E8 4C    		  JP      NZ,XEQ          ;STATEMENT FOLLOWS	;STATEMENT FOLLOWS
1111)   5392 C3 F6 4F    		  JP      GOTO            ;LINE NO. FOLLOWS	;LINE NO. FOLLOWS
1112)   5395 FD 7E 00    		IFNOT:  LD      A,(IY)	;
1113)   5398 FE 0D       		  CP      CR	;
1114)   539A FD 23       		  INC     IY	;
1115)   539C CA E5 4C    		  JP      Z,XEQ0          ;END OF LINE	;END OF LINE
1116)   539F FE 8B       		  CP      ELSE	;
1117)   53A1 20 F2       		  JR      NZ,IFNOT	;
1118)   53A3 18 E5       		  JR      IF1	;
1122)   53A5 CD 96 70    		CLS:  CALL    CLRSCN	;
1123)   53A8 AF          		  XOR     A	;
1124)   53A9 32 FB FD    		  LD      (COUNT),A	;
1125)   53AC C3 E8 4C    		  JP      XEQ	;
1129)   53AF CD 2B 4C    		STOP:  CALL    TELL	;
1130)   53B2 0D          		  DEFB    CR	;
1131)   53B3 0A          		  DEFB    LF	;
1132)   53B4 FA          		  DEFB    TSTOP	;
1133)   53B5 00          		  DEFB    0	;
1134)   53B6 CD C4 48    		  CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
1135)   53B9 CD EE 48    		  CALL    SAYLN	;
1136)   53BC CD 6D 48    		  CALL    CRLF	;
1137)   53BF C3 6F 40    		  JP      CLOOP	;
1141)   53C2 CD 1F 4C    		REPOR:  CALL    REPORT	;
1142)   53C5 C3 E8 4C    		  JP      XEQ	;
1146)   53C8 CD CC 47    		CLR:  CALL    CLEAR	;
1147)   53CB 2A DC FD    		  LD      HL,(PAGE)	;
1148)   53CE 18 13       		  JR      RESTR1	;
1152)   53D0 2A DC FD    		RESTOR:  LD      HL,(PAGE)	;
1153)   53D3 CD C2 56    		  CALL    TERM?	;
1154)   53D6 28 0B       		  JR      Z,RESTR1	;
1155)   53D8 CD AB 5E    		  CALL    ITEMI	;
1156)   53DB D9          		  EXX	;
1157)   53DC CD AB 48    		  CALL    FINDL           ;SEARCH FOR LINE	;SEARCH FOR LINE
1158)   53DF 3E 29       		  LD      A,41	;
1159)   53E1 20 92       		  JR      NZ,ERROR4       ;"No such line"	;"No such line"
1160)   53E3 3E DC       		RESTR1:  LD      A,DATA	;
1161)   53E5 CD 80 57    		  CALL    SEARCH	;
1162)   53E8 22 F0 FD    		  LD      (DATPTR),HL	;
1163)   53EB C3 E8 4C    		  JP      XEQ	;
1171)   53EE CD B7 57    		PTR:  CALL    CHANEL	;
1172)   53F1 CD D6 56    		  CALL    EQUALS	;
1173)   53F4 7B          		  LD      A,E	;
1174)   53F5 F5          		  PUSH    AF	;
1175)   53F6 CD 94 5E    		  CALL    EXPRI	;
1176)   53F9 E5          		  PUSH    HL	;
1177)   53FA D9          		  EXX	;
1178)   53FB D1          		  POP     DE	;
1179)   53FC F1          		  POP     AF	;
1180)   53FD CD 16 74    		  CALL    PUTPTR	;
1181)   5400 C3 E8 4C    		  JP      XEQ	;
1183)   5403 CD D6 56    		PAGEV:  CALL    EQUALS	;
1184)   5406 CD 94 5E    		  CALL    EXPRI	;
1185)   5409 D9          		  EXX	;
1186)   540A 2E 00       		  LD      L,0	;
1187)   540C 22 DC FD    		  LD      (PAGE),HL	;
1188)   540F C3 E8 4C    		  JP      XEQ	;
1190)   5412 FE 24       		TIMEV:  CP      '$'	;
1191)   5414 28 0F       		  JR      Z,TIMEVS	;
1192)   5416 CD D6 56    		  CALL    EQUALS	;
1193)   5419 CD 94 5E    		  CALL    EXPRI	;
1194)   541C E5          		  PUSH    HL	;
1195)   541D D9          		  EXX	;
1196)   541E D1          		  POP     DE	;
1197)   541F CD 99 70    		  CALL    PUTIME	;
1198)   5422 C3 E8 4C    		  JP      XEQ	;
1200)   5425 FD 23       		TIMEVS:  INC     IY              ;SKIP '$'	;SKIP '$'
1201)   5427 CD D6 56    		  CALL    EQUALS	;
1202)   542A CD 9D 5E    		  CALL    EXPRS	;
1203)   542D CD 8E 74    		  CALL    PUTIMS	;
1204)   5430 C3 E8 4C    		  JP      XEQ	;
1206)   5433 CD D6 56    		LOMEMV:  CALL    EQUALS	;
1207)   5436 CD 94 5E    		  CALL    EXPRI	;
1208)   5439 CD CC 47    		  CALL    CLEAR	;
1209)   543C D9          		  EXX	;
1210)   543D 22 E0 FD    		  LD      (LOMEM),HL	;
1211)   5440 22 E2 FD    		  LD      (FREE),HL	;
1212)   5443 C3 E8 4C    		  JP      XEQ	;
1214)   5446 CD D6 56    		HIMEMV:  CALL    EQUALS	;
1215)   5449 CD 94 5E    		  CALL    EXPRI	;
1216)   544C D9          		  EXX	;
1217)   544D ED 5B E2 FD 		  LD      DE,(FREE)	;
1218)   5451 14          		  INC     D	;
1219)   5452 AF          		  XOR     A	;
1220)   5453 ED 52       		  SBC     HL,DE	;
1221)   5455 19          		  ADD     HL,DE	;
1222)   5456 DA DB 46    		  JP      C,ERROR         ;"No room"	;"No room"
1223)   5459 ED 5B E4 FD 		  LD      DE,(HIMEM)	;
1224)   545D 22 E4 FD    		  LD      (HIMEM),HL	;
1225)   5460 EB          		  EX      DE,HL	;
1226)   5461 ED 72       		  SBC     HL,SP	;
1227)   5463 C2 E8 4C    		  JP      NZ,XEQ	;
1228)   5466 EB          		  EX      DE,HL	;
1229)   5467 F9          		  LD      SP,HL           ;LOAD STACK POINTER	;LOAD STACK POINTER
1230)   5468 C3 E8 4C    		  JP      XEQ	;
1234)   546B CD 94 5E    		WIDTHV:  CALL    EXPRI	;
1235)   546E D9          		  EXX	;
1236)   546F 7D          		  LD      A,L	;
1237)   5470 32 FC FD    		  LD      (WIDTH),A	;
1238)   5473 C3 E8 4C    		  JP      XEQ	;
1244)   5476 FD 23       		TRACE:  INC     IY	;
1245)   5478 21 00 00    		  LD      HL,0	;
1246)   547B FE EE       		  CP      TON	;
1247)   547D 28 0A       		  JR      Z,TRACE0	;
1248)   547F FE 87       		  CP      OFF	;
1249)   5481 28 07       		  JR      Z,TRACE1	;
1250)   5483 FD 2B       		  DEC     IY	;
1251)   5485 CD 94 5E    		  CALL    EXPRI	;
1252)   5488 D9          		  EXX	;
1253)   5489 2B          		TRACE0:  DEC     HL	;
1254)   548A 22 E8 FD    		TRACE1:  LD      (TRACEN),HL	;
1255)   548D C3 E8 4C    		  JP      XEQ	;
1259)   5490 CD 94 5E    		VDU:  CALL    EXPRI	;
1260)   5493 D9          		  EXX	;
1261)   5494 7D          		  LD      A,L	;
1262)   5495 CD ED 70    		  CALL    OSWRCH	;
1263)   5498 FD 7E 00    		  LD      A,(IY)	;
1264)   549B FE 2C       		  CP      ','	;
1265)   549D 28 08       		  JR      Z,VDU2	;
1266)   549F FE 3B       		  CP      ';'	;
1267)   54A1 20 06       		  JR      NZ,VDU3	;
1268)   54A3 7C          		  LD      A,H	;
1269)   54A4 CD ED 70    		  CALL    OSWRCH	;
1270)   54A7 FD 23       		VDU2:  INC     IY	;
1271)   54A9 CD C2 56    		VDU3:  CALL    TERM?	;
1272)   54AC 20 E2       		  JR      NZ,VDU	;
1273)   54AE C3 E8 4C    		  JP      XEQ	;
1277)   54B1 CD B7 57    		CLOSE:  CALL    CHANEL	;
1278)   54B4 CD 1F 74    		  CALL    OSSHUT	;
1279)   54B7 C3 E8 4C    		  JP      XEQ	;
1283)   54BA CD B7 57    		BPUT:  CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
1284)   54BD D5          		  PUSH    DE	;
1285)   54BE CD 30 64    		  CALL    COMMA	;
1286)   54C1 CD 94 5E    		  CALL    EXPRI           ;BYTE	;BYTE
1287)   54C4 D9          		  EXX	;
1288)   54C5 7D          		  LD      A,L	;
1289)   54C6 D1          		  POP     DE	;
1290)   54C7 CD E7 73    		  CALL    OSBPUT	;
1291)   54CA C3 E8 4C    		  JP      XEQ	;
1295)   54CD CD 94 5E    		CALL:  CALL    EXPRI           ;ADDRESS	;ADDRESS
1296)   54D0 D9          		  EXX	;
1297)   54D1 E5          		  PUSH    HL              ;SAVE IT	;SAVE IT
1298)   54D2 06 00       		  LD      B,0             ;PARAMETER COUNTER	;PARAMETER COUNTER
1299)   54D4 11 00 FC    		  LD      DE,BUFFER       ;VECTOR	;VECTOR
1300)   54D7 CD 78 64    		CALL1:  CALL    NXT	;
1301)   54DA FE 2C       		  CP      ','	;
1302)   54DC 20 17       		  JR      NZ,CALL2	;
1303)   54DE FD 23       		  INC     IY	;
1304)   54E0 04          		  INC     B	;
1305)   54E1 CD 78 64    		  CALL    NXT	;
1306)   54E4 C5          		  PUSH    BC	;
1307)   54E5 D5          		  PUSH    DE	;
1308)   54E6 CD B8 4D    		  CALL    VAR	;
1309)   54E9 D1          		  POP     DE	;
1310)   54EA C1          		  POP     BC	;
1311)   54EB 13          		  INC     DE	;
1312)   54EC 12          		  LD      (DE),A          ;PARAMETER TYPE	;PARAMETER TYPE
1313)   54ED 13          		  INC     DE	;
1314)   54EE EB          		  EX      DE,HL	;
1315)   54EF 73          		  LD      (HL),E          ;PARAMETER ADDRESS	;PARAMETER ADDRESS
1316)   54F0 23          		  INC     HL	;
1317)   54F1 72          		  LD      (HL),D	;
1318)   54F2 EB          		  EX      DE,HL	;
1319)   54F3 18 E2       		  JR      CALL1	;
1320)   54F5 78          		CALL2:  LD      A,B	;
1321)   54F6 32 00 FC    		  LD      (BUFFER),A      ;PARAMETER COUNT	;PARAMETER COUNT
1322)   54F9 E1          		  POP     HL              ;RESTORE ADDRESS	;RESTORE ADDRESS
1323)   54FA CD 04 55    		  CALL    USR1	;
1324)   54FD C3 E8 4C    		  JP      XEQ	;
1328)   5500 CD AB 5E    		@USR:  CALL    ITEMI	;
1329)   5503 D9          		  EXX	;
1330)   5504 E5          		USR1:  PUSH    HL              ;ADDRESS ON STACK	;ADDRESS ON STACK
1331)   5505 FD E3       		  EX      (SP),IY	;
1332)   5507 24          		  INC     H               ;PAGE &FF?	;PAGE &FF?
1333)   5508 21 33 55    		  LD      HL,USR2         ;RETURN ADDRESS	;RETURN ADDRESS
1334)   550B E5          		  PUSH    HL	;
1335)   550C DD 21 00 FD 		  LD      IX,STAVAR	;
1336)   5510 CC 3C 74    		  CALL    Z,OSCALL        ;INTERCEPT PAGE &FF	;INTERCEPT PAGE &FF
1337)   5513 DD 4E 18    		  LD      C,(IX+24)	;
1338)   5516 C5          		  PUSH    BC	;
1339)   5517 F1          		  POP     AF              ;LOAD FLAGS	;LOAD FLAGS
1340)   5518 DD 7E 04    		  LD      A,(IX+4)        ;LOAD Z80 REGISTERS	;LOAD Z80 REGISTERS
1341)   551B DD 46 08    		  LD      B,(IX+8)	;
1342)   551E DD 4E 0C    		  LD      C,(IX+12)	;
1343)   5521 DD 56 10    		  LD      D,(IX+16)	;
1344)   5524 DD 5E 14    		  LD      E,(IX+20)	;
1345)   5527 DD 66 20    		  LD      H,(IX+32)	;
1346)   552A DD 6E 30    		  LD      L,(IX+48)	;
1347)   552D DD 21 00 FC 		  LD      IX,BUFFER	;
1348)   5531 FD E9       		  JP      (IY)            ;OFF TO USER ROUTINE	;OFF TO USER ROUTINE
1349)   5533 FD E1       		USR2:  POP     IY	;
1350)   5535 AF          		  XOR     A	;
1351)   5536 4F          		  LD      C,A	;
1352)   5537 C9          		  RET	;
1356)   5538 CD 94 5E    		PUT:  CALL    EXPRI           ;PORT ADDRESS	;PORT ADDRESS
1357)   553B D9          		  EXX	;
1358)   553C E5          		  PUSH    HL	;
1359)   553D CD 30 64    		  CALL    COMMA	;
1360)   5540 CD 94 5E    		  CALL    EXPRI           ;DATA	;DATA
1361)   5543 D9          		  EXX	;
1362)   5544 C1          		  POP     BC	;
1363)   5545 ED 69       		  OUT     (C),L           ;OUTPUT TO PORT BC	;OUTPUT TO PORT BC
1364)   5547 C3 E8 4C    		  JP      XEQ	;
1373)   554A CD 3F 49    		ASSIGN:  CALL    GETVAR          ;VARIABLE	;VARIABLE
1374)   554D D8          		  RET     C               ;ILLEGAL VARIABLE	;ILLEGAL VARIABLE
1375)   554E C4 30 49    		  CALL    NZ,PUTVAR	;
1376)   5551 B7          		  OR      A	;
1377)   5552 F8          		  RET     M               ;STRING VARIABLE	;STRING VARIABLE
1378)   5553 F5          		  PUSH    AF              ;NUMERIC TYPE	;NUMERIC TYPE
1379)   5554 CD D6 56    		  CALL    EQUALS	;
1380)   5557 E5          		  PUSH    HL	;
1381)   5558 CD 8D 5E    		  CALL    EXPRN	;
1382)   555B DD E1       		  POP     IX	;
1383)   555D F1          		  POP     AF	;
1384)   555E CB 47       		STORE:  BIT     0,A	;
1385)   5560 28 13       		  JR      Z,STOREI	;
1386)   5562 BF          		  CP      A               ;SET ZERO	;SET ZERO
1387)   5563 DD 71 04    		@STORE5: LD      (IX+4),C	;
1388)   5566 D9          		@STORE4: EXX	;
1389)   5567 DD 75 00    		  LD      (IX+0),L	;
1390)   556A DD 74 01    		  LD      (IX+1),H	;
1391)   556D D9          		  EXX	;
1392)   556E DD 75 02    		  LD      (IX+2),L	;
1393)   5571 DD 74 03    		  LD      (IX+3),H	;
1394)   5574 C9          		  RET	;
1395)   5575 F5          		STOREI:  PUSH    AF	;
1396)   5576 0C          		  INC     C               ;SPEED - & PRESERVE F'	;SPEED - & PRESERVE F'
1397)   5577 0D          		  DEC     C               ; WHEN CALLED BY FNEND0	; WHEN CALLED BY FNEND0
1398)   5578 C4 3B 61    		  CALL    NZ,SFIX         ;CONVERT TO INTEGER	;CONVERT TO INTEGER
1399)   557B F1          		  POP     AF	;
1400)   557C FE 04       		  CP      4	;
1401)   557E 28 E6       		  JR      Z,STORE4	;
1402)   5580 BF          		  CP      A               ;SET ZERO	;SET ZERO
1403)   5581 D9          		STORE1:  EXX	;
1404)   5582 DD 75 00    		  LD      (IX+0),L	;
1405)   5585 D9          		  EXX	;
1406)   5586 C9          		  RET	;
1408)   5587 21 00 FB    		STACCS:  LD      HL,ACCS	;
1409)   558A 1F          		STORES:  RRA	;
1410)   558B 30 3F       		  JR      NC,STORS3       ;FIXED STRING	;FIXED STRING
1411)   558D E5          		  PUSH    HL	;
1412)   558E CD 59 5F    		  CALL    LOAD4	;
1413)   5591 7B          		  LD      A,E             ;LENGTH OF STRING	;LENGTH OF STRING
1414)   5592 D9          		  EXX	;
1415)   5593 6F          		  LD      L,A	;
1416)   5594 7C          		  LD      A,H             ;LENGTH ALLOCATED	;LENGTH ALLOCATED
1417)   5595 D9          		  EXX	;
1418)   5596 BB          		  CP      E	;
1419)   5597 30 14       		  JR      NC,STORS1       ;ENOUGH ROOM	;ENOUGH ROOM
1420)   5599 D9          		  EXX	;
1421)   559A 65          		  LD      H,L	;
1422)   559B D9          		  EXX	;
1423)   559C E5          		  PUSH    HL	;
1424)   559D 06 00       		  LD      B,0	;
1425)   559F 4F          		  LD      C,A	;
1426)   55A0 09          		  ADD     HL,BC	;
1427)   55A1 ED 4B E2 FD 		  LD      BC,(FREE)	;
1428)   55A5 ED 42       		  SBC     HL,BC           ;IS STRING LAST?	;IS STRING LAST?
1429)   55A7 E1          		  POP     HL	;
1430)   55A8 37          		  SCF	;
1431)   55A9 28 02       		  JR      Z,STORS1	;
1432)   55AB 60          		  LD      H,B	;
1433)   55AC 69          		  LD      L,C	;
1434)   55AD CD 66 55    		STORS1:  CALL    STORE4          ;PRESERVES CARRY!	;PRESERVES CARRY!
1435)   55B0 06 00       		  LD      B,0	;
1436)   55B2 4B          		  LD      C,E	;
1437)   55B3 EB          		  EX      DE,HL	;
1438)   55B4 E1          		  POP     HL	;
1439)   55B5 0D          		  DEC     C	;
1440)   55B6 0C          		  INC     C	;
1441)   55B7 C8          		  RET     Z               ;NULL STRING	;NULL STRING
1442)   55B8 ED B0       		  LDIR	;
1443)   55BA D0          		  RET     NC              ;STRING REPLACED	;STRING REPLACED
1444)   55BB ED 53 E2 FD 		  LD      (FREE),DE	;
1445)   55BF E5          		@CHECK:  PUSH    HL	;
1446)   55C0 2A E2 FD    		  LD      HL,(FREE)	;
1447)   55C3 24          		  INC     H	;
1448)   55C4 ED 72       		  SBC     HL,SP	;
1449)   55C6 E1          		  POP     HL	;
1450)   55C7 D8          		  RET     C	;
1451)   55C8 AF          		  XOR     A	;
1452)   55C9 C3 DB 46    		  JP      ERROR           ;"No room"	;"No room"
1454)   55CC 4B          		STORS3:  LD      C,E	;
1455)   55CD DD E5       		  PUSH    IX	;
1456)   55CF D1          		  POP     DE	;
1457)   55D0 AF          		  XOR     A	;
1458)   55D1 47          		  LD      B,A	;
1459)   55D2 B9          		  CP      C	;
1460)   55D3 28 02       		  JR      Z,STORS5	;
1461)   55D5 ED B0       		  LDIR	;
1462)   55D7 3E 0D       		STORS5:  LD      A,CR	;
1463)   55D9 12          		  LD      (DE),A	;
1464)   55DA C9          		  RET	;
1475)   55DB 3E FF       		ARGUE:  LD      A,-1	;
1476)   55DD F5          		  PUSH    AF              ;PUT MARKER ON STACK	;PUT MARKER ON STACK
1477)   55DE FD 23       		ARGUE1:  INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1478)   55E0 13          		  INC     DE	;
1479)   55E1 D5          		  PUSH    DE	;
1480)   55E2 CD 78 64    		  CALL    NXT	;
1481)   55E5 CD 3F 49    		  CALL    GETVAR	;
1482)   55E8 38 38       		  JR      C,ARGERR	;
1483)   55EA C4 30 49    		  CALL    NZ,PUTVAR	;
1484)   55ED D1          		  POP     DE	;
1485)   55EE E5          		  PUSH    HL              ;VARPTR	;VARPTR
1486)   55EF B7          		  OR      A               ;TYPE	;TYPE
1487)   55F0 F5          		  PUSH    AF	;
1488)   55F1 D5          		  PUSH    DE	;
1489)   55F2 FD E3       		  EX      (SP),IY	;
1490)   55F4 FA 09 56    		  JP      M,ARGUE2        ;STRING	;STRING
1491)   55F7 CD 8D 5E    		  CALL    EXPRN           ;PARAMETER VALUE	;PARAMETER VALUE
1492)   55FA FD E3       		  EX      (SP),IY	;
1493)   55FC D1          		  POP     DE	;
1494)   55FD F1          		  POP     AF	;
1495)   55FE D9          		  EXX	;
1496)   55FF E5          		  PUSH    HL	;
1497)   5600 D9          		  EXX	;
1498)   5601 E5          		  PUSH    HL	;
1499)   5602 47          		  LD      B,A	;
1500)   5603 C5          		  PUSH    BC	;
1501)   5604 CD BF 55    		  CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
1502)   5607 18 0D       		  JR      ARGUE4	;
1503)   5609 CD 9D 5E    		ARGUE2:  CALL    EXPRS	;
1504)   560C FD E3       		  EX      (SP),IY	;
1505)   560E D9          		  EXX	;
1506)   560F D1          		  POP     DE	;
1507)   5610 D9          		  EXX	;
1508)   5611 F1          		  POP     AF	;
1509)   5612 CD DF 63    		  CALL    PUSHS	;
1510)   5615 D9          		  EXX	;
1511)   5616 CD 78 64    		ARGUE4:  CALL    NXT	;
1512)   5619 FE 2C       		  CP      ','	;
1513)   561B 20 0A       		  JR      NZ,ARGUE5	;
1514)   561D 1A          		  LD      A,(DE)	;
1515)   561E FE 2C       		  CP      ','	;
1516)   5620 28 BC       		  JR      Z,ARGUE1        ;ANOTHER	;ANOTHER
1517)   5622 3E 1F       		ARGERR:  LD      A,31	;
1518)   5624 C3 DB 46    		  JP      ERROR           ;"Arguments"	;"Arguments"
1519)   5627 CD 3C 64    		ARGUE5:  CALL    BRAKET	;
1520)   562A 1A          		  LD      A,(DE)	;
1521)   562B FE 29       		  CP      ')'	;
1522)   562D 20 F3       		  JR      NZ,ARGERR	;
1523)   562F 13          		  INC     DE	;
1524)   5630 D9          		  EXX	;
1525)   5631 C1          		ARGUE6:  POP     BC	;
1526)   5632 78          		  LD      A,B	;
1527)   5633 3C          		  INC     A	;
1528)   5634 D9          		  EXX	;
1529)   5635 C8          		  RET     Z               ;MARKER POPPED	;MARKER POPPED
1530)   5636 D9          		  EXX	;
1531)   5637 3D          		  DEC     A	;
1532)   5638 FA 46 56    		  JP      M,ARGUE7        ;STRING	;STRING
1533)   563B E1          		  POP     HL	;
1534)   563C D9          		  EXX	;
1535)   563D E1          		  POP     HL	;
1536)   563E D9          		  EXX	;
1537)   563F DD E1       		  POP     IX	;
1538)   5641 CD 5E 55    		  CALL    STORE           ;WRITE TO DUMMY	;WRITE TO DUMMY
1539)   5644 18 EB       		  JR      ARGUE6	;
1540)   5646 CD FE 63    		ARGUE7:  CALL    POPS	;
1541)   5649 DD E1       		  POP     IX	;
1542)   564B CD 87 55    		  CALL    STACCS	;
1543)   564E 18 E1       		  JR      ARGUE6	;
1552)   5650 D1          		SAVLOC:  POP     DE              ;RETURN ADDRESS	;RETURN ADDRESS
1553)   5651 FD 23       		SAVLO1:  INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1554)   5653 CD 78 64    		  CALL    NXT	;
1555)   5656 D5          		  PUSH    DE	;
1556)   5657 D9          		  EXX	;
1557)   5658 C5          		  PUSH    BC	;
1558)   5659 D5          		  PUSH    DE	;
1559)   565A E5          		  PUSH    HL	;
1560)   565B D9          		  EXX	;
1561)   565C CD B8 4D    		  CALL    VAR             ;DUMMY VARIABLE	;DUMMY VARIABLE
1562)   565F D9          		  EXX	;
1563)   5660 E1          		  POP     HL	;
1564)   5661 D1          		  POP     DE	;
1565)   5662 C1          		  POP     BC	;
1566)   5663 D9          		  EXX	;
1567)   5664 D1          		  POP     DE	;
1568)   5665 B7          		  OR      A               ;TYPE	;TYPE
1569)   5666 FA 77 56    		  JP      M,SAVLO2        ;STRING	;STRING
1570)   5669 D9          		  EXX	;
1571)   566A E5          		  PUSH    HL              ;SAVE H'L'	;SAVE H'L'
1572)   566B D9          		  EXX	;
1573)   566C 47          		  LD      B,A             ;TYPE	;TYPE
1574)   566D CD 4D 5F    		  CALL    LOADN	;
1575)   5670 D9          		  EXX	;
1576)   5671 E3          		  EX      (SP),HL	;
1577)   5672 D9          		  EXX	;
1578)   5673 E5          		  PUSH    HL	;
1579)   5674 C5          		  PUSH    BC	;
1580)   5675 18 26       		  JR      SAVLO4	;
1581)   5677 F5          		SAVLO2:  PUSH    AF              ;STRING TYPE	;STRING TYPE
1582)   5678 D5          		  PUSH    DE	;
1583)   5679 D9          		  EXX	;
1584)   567A E5          		  PUSH    HL	;
1585)   567B D9          		  EXX	;
1586)   567C CD D7 5F    		  CALL    LOADS	;
1587)   567F D9          		  EXX	;
1588)   5680 E1          		  POP     HL	;
1589)   5681 D9          		  EXX	;
1590)   5682 4B          		  LD      C,E	;
1591)   5683 D1          		  POP     DE	;
1592)   5684 CD BF 55    		  CALL    CHECK	;
1593)   5687 F1          		  POP     AF              ;LEVEL STACK	;LEVEL STACK
1594)   5688 21 00 00    		  LD      HL,0	;
1595)   568B 45          		  LD      B,L	;
1596)   568C ED 42       		  SBC     HL,BC	;
1597)   568E 39          		  ADD     HL,SP	;
1598)   568F F9          		  LD      SP,HL	;
1599)   5690 47          		  LD      B,A             ;TYPE	;TYPE
1600)   5691 C5          		  PUSH    BC	;
1601)   5692 28 09       		  JR      Z,SAVLO4	;
1602)   5694 D5          		  PUSH    DE	;
1603)   5695 11 00 FB    		  LD      DE,ACCS	;
1604)   5698 EB          		  EX      DE,HL	;
1605)   5699 45          		  LD      B,L	;
1606)   569A ED B0       		  LDIR                    ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1607)   569C D1          		  POP     DE	;
1608)   569D DD E5       		SAVLO4:  PUSH    IX              ;VARPTR	;VARPTR
1609)   569F CD A2 56    		  CALL    SAVLO5	;
1611)   56A2 CD BF 55    		SAVLO5:  CALL    CHECK	;
1612)   56A5 CD 78 64    		  CALL    NXT	;
1613)   56A8 FE 2C       		  CP      ','             ;MORE?	;MORE?
1614)   56AA 28 A5       		  JR      Z,SAVLO1	;
1615)   56AC EB          		  EX      DE,HL	;
1616)   56AD E9          		  JP      (HL)            ;"RETURN"	;"RETURN"
1618)   56AE FD 7E 00    		DELIM:  LD      A,(IY)          ;ASSEMBLER DELIMITER	;ASSEMBLER DELIMITER
1619)   56B1 FE 20       		  CP      ' '	;
1620)   56B3 C8          		  RET     Z	;
1621)   56B4 FE 2C       		  CP      ','	;
1622)   56B6 C8          		  RET     Z	;
1623)   56B7 FE 29       		  CP      ')'	;
1624)   56B9 C8          		  RET     Z	;
1625)   56BA FE 3B       		TERM:  CP      ';'             ;ASSEMBLER TERMINATOR	;ASSEMBLER TERMINATOR
1626)   56BC C8          		  RET     Z	;
1627)   56BD FE 5C       		  CP      '\'	;
1628)   56BF C8          		  RET     Z	;
1629)   56C0 18 06       		  JR      TERM0	;
1631)   56C2 CD 78 64    		@TERM?:  CALL    NXT	;
1632)   56C5 FE 8B       		  CP      ELSE	;
1633)   56C7 D0          		  RET     NC	;
1634)   56C8 FE 3A       		TERM0:  CP      ':'             ;ASSEMBLER SEPARATOR	;ASSEMBLER SEPARATOR
1635)   56CA D0          		  RET     NC	;
1636)   56CB FE 0D       		  CP      CR	;
1637)   56CD C9          		  RET	;
1639)   56CE CD C2 56    		SPAN:  CALL    TERM?	;
1640)   56D1 C8          		  RET     Z	;
1641)   56D2 FD 23       		  INC     IY	;
1642)   56D4 18 F8       		  JR      SPAN	;
1644)   56D6 CD 78 64    		EQUALS:  CALL    NXT	;
1645)   56D9 FD 23       		  INC     IY	;
1646)   56DB FE 3D       		  CP      '='	;
1647)   56DD C8          		  RET     Z	;
1648)   56DE 3E 04       		  LD      A,4	;
1649)   56E0 C3 DB 46    		  JP      ERROR           ;"Mistake"	;"Mistake"
1651)   56E3 FE 8A       		FORMAT:  CP      TAB	;
1652)   56E5 28 0C       		  JR      Z,DOTAB	;
1653)   56E7 FE 89       		  CP      SPC	;
1654)   56E9 28 38       		  JR      Z,DOSPC	;
1655)   56EB FE 27       		  CP      ''''	;
1656)   56ED C0          		  RET     NZ	;
1657)   56EE CD 6D 48    		  CALL    CRLF	;
1658)   56F1 AF          		  XOR     A	;
1659)   56F2 C9          		  RET	;
1661)   56F3 C5          		DOTAB:  PUSH    BC	;
1662)   56F4 CD 94 5E    		  CALL    EXPRI	;
1663)   56F7 D9          		  EXX	;
1664)   56F8 C1          		  POP     BC	;
1665)   56F9 FD 7E 00    		  LD      A,(IY)	;
1666)   56FC FE 2C       		  CP      ','	;
1667)   56FE 28 11       		  JR      Z,DOTAB1	;
1668)   5700 CD 3C 64    		  CALL    BRAKET	;
1669)   5703 7D          		  LD      A,L	;
1670)   5704 21 FB FD    		TABIT:  LD      HL,COUNT	;
1671)   5707 BE          		  CP      (HL)	;
1672)   5708 C8          		  RET     Z	;
1673)   5709 F5          		  PUSH    AF	;
1674)   570A DC 6D 48    		  CALL    C,CRLF	;
1675)   570D F1          		  POP     AF	;
1676)   570E 96          		  SUB     (HL)	;
1677)   570F 18 19       		  JR      FILL	;
1678)   5711 FD 23       		DOTAB1:  INC     IY	;
1679)   5713 C5          		  PUSH    BC	;
1680)   5714 E5          		  PUSH    HL	;
1681)   5715 CD 94 5E    		  CALL    EXPRI	;
1682)   5718 D9          		  EXX	;
1683)   5719 D1          		  POP     DE	;
1684)   571A C1          		  POP     BC	;
1685)   571B CD 3C 64    		  CALL    BRAKET	;
1686)   571E CD BB 70    		  CALL    PUTCSR	;
1687)   5721 AF          		  XOR     A	;
1688)   5722 C9          		  RET	;
1690)   5723 C5          		DOSPC:  PUSH    BC	;
1691)   5724 CD AB 5E    		  CALL    ITEMI	;
1692)   5727 D9          		  EXX	;
1693)   5728 7D          		  LD      A,L	;
1694)   5729 C1          		  POP     BC	;
1695)   572A B7          		@FILL:  OR      A	;
1696)   572B C8          		  RET     Z	;
1697)   572C C5          		  PUSH    BC	;
1698)   572D 47          		  LD      B,A	;
1699)   572E 3E 20       		FILL1:  LD      A,' '	;
1700)   5730 CD 74 48    		  CALL    OUTCHR	;
1701)   5733 10 F9       		  DJNZ    FILL1	;
1702)   5735 C1          		  POP     BC	;
1703)   5736 AF          		  XOR     A	;
1704)   5737 C9          		  RET	;
1706)   5738 21 00 FB    		PTEXT:  LD      HL,ACCS	;
1707)   573B 1C          		  INC     E	;
1708)   573C 1D          		PTEXT1:  DEC     E	;
1709)   573D C8          		  RET     Z	;
1710)   573E 7E          		  LD      A,(HL)	;
1711)   573F 23          		  INC     HL	;
1712)   5740 CD 74 48    		  CALL    OUTCHR	;
1713)   5743 18 F7       		  JR      PTEXT1	;
1715)   5745 F5          		FETCHS:  PUSH    AF	;
1716)   5746 C5          		  PUSH    BC	;
1717)   5747 E5          		  PUSH    HL	;
1718)   5748 FD E3       		  EX      (SP),IY	;
1719)   574A CD 62 57    		  CALL    XTRACT	;
1720)   574D CD 78 64    		  CALL    NXT	;
1721)   5750 FD E3       		  EX      (SP),IY	;
1722)   5752 E1          		  POP     HL	;
1723)   5753 C1          		  POP     BC	;
1724)   5754 F1          		  POP     AF	;
1725)   5755 C9          		  RET	;
1727)   5756 11 00 FB    		LINES:  LD      DE,ACCS	;
1728)   5759 7E          		LINE1S:  LD      A,(HL)	;
1729)   575A 12          		  LD      (DE),A	;
1730)   575B FE 0D       		  CP      CR	;
1731)   575D C8          		  RET     Z	;
1732)   575E 23          		  INC     HL	;
1733)   575F 1C          		  INC     E	;
1734)   5760 18 F7       		  JR      LINE1S	;
1736)   5762 CD 78 64    		XTRACT:  CALL    NXT	;
1737)   5765 FE 22       		  CP      34  ;ASCII ""	;ASCII ""
1738)   5767 FD 23       		  INC     IY	;
1739)   5769 CA 8F 5F    		  JP      Z,CONS	;
1740)   576C FD 2B       		  DEC     IY	;
1741)   576E 11 00 FB    		  LD      DE,ACCS	;
1742)   5771 FD 7E 00    		XTRAC1:  LD      A,(IY)	;
1743)   5774 12          		  LD      (DE),A	;
1744)   5775 FE 2C       		  CP      ','	;
1745)   5777 C8          		  RET     Z	;
1746)   5778 FE 0D       		  CP      CR	;
1747)   577A C8          		  RET     Z	;
1748)   577B FD 23       		  INC     IY	;
1749)   577D 1C          		  INC     E	;
1750)   577E 18 F1       		  JR      XTRAC1	;
1752)   5780 06 00       		SEARCH:  LD      B,0	;
1753)   5782 4E          		SRCH1:  LD      C,(HL)	;
1754)   5783 0C          		  INC     C	;
1755)   5784 0D          		  DEC     C	;
1756)   5785 28 0C       		  JR      Z,SRCH2         ;FAIL	;FAIL
1757)   5787 23          		  INC     HL	;
1758)   5788 23          		  INC     HL	;
1759)   5789 23          		  INC     HL	;
1760)   578A BE          		  CP      (HL)	;
1761)   578B C8          		  RET     Z	;
1762)   578C 0D          		  DEC     C	;
1763)   578D 0D          		  DEC     C	;
1764)   578E 0D          		  DEC     C	;
1765)   578F 09          		  ADD     HL,BC	;
1766)   5790 C3 82 57    		  JP      SRCH1	;
1767)   5793 2B          		SRCH2:  DEC     HL              ;POINT TO CR	;POINT TO CR
1768)   5794 37          		  SCF	;
1769)   5795 C9          		  RET	;
1771)   5796 FE 05       		@X4OR5:  CP      5	;
1772)   5798 62          		  LD      H,D	;
1773)   5799 6B          		  LD      L,E	;
1774)   579A 29          		  ADD     HL,HL	;
1775)   579B D8          		  RET     C	;
1776)   579C 29          		  ADD     HL,HL	;
1777)   579D D8          		  RET     C	;
1778)   579E EB          		  EX      DE,HL	;
1779)   579F C0          		  RET     NZ	;
1780)   57A0 19          		  ADD     HL,DE	;
1781)   57A1 EB          		  EX      DE,HL	;
1782)   57A2 C9          		  RET	;
1784)   57A3 EB          		@MUL16:  EX      DE,HL	;
1785)   57A4 21 00 00    		  LD      HL,0	;
1786)   57A7 3E 10       		  LD      A,16	;
1787)   57A9 29          		MUL161:  ADD     HL,HL	;
1788)   57AA D8          		  RET     C               ;OVERFLOW	;OVERFLOW
1789)   57AB CB 23       		  SLA     E	;
1790)   57AD CB 12       		  RL      D	;
1791)   57AF 30 02       		  JR      NC,MUL162	;
1792)   57B1 09          		  ADD     HL,BC	;
1793)   57B2 D8          		  RET     C	;
1794)   57B3 3D          		MUL162:  DEC     A	;
1795)   57B4 20 F3       		  JR      NZ,MUL161	;
1796)   57B6 C9          		  RET	;
1798)   57B7 CD 78 64    		@CHANEL: CALL    NXT	;
1799)   57BA FE 23       		  CP      '#'	;
1800)   57BC 3E 2D       		  LD      A,45	;
1801)   57BE C2 DB 46    		  JP      NZ,ERROR        ;"Missing #"	;"Missing #"
1802)   57C1 FD 23       		CHNL:  INC     IY              ;SKIP '#'	;SKIP '#'
1803)   57C3 CD AB 5E    		  CALL    ITEMI	;
1804)   57C6 D9          		  EXX	;
1805)   57C7 EB          		  EX      DE,HL	;
1806)   57C8 C9          		  RET	;
1812)   57C9 CD 3F 5B    		ASSEM:  CALL    SKIP	;
1813)   57CC FD 23       		  INC     IY	;
1814)   57CE FE 3A       		  CP      ':'	;
1815)   57D0 28 F7       		  JR      Z,ASSEM	;
1816)   57D2 FE 5D       		  CP      ']'	;
1817)   57D4 C8          		  RET     Z	;
1818)   57D5 FE 0D       		  CP      CR	;
1819)   57D7 C8          		  RET     Z	;
1820)   57D8 FD 2B       		  DEC     IY	;
1821)   57DA DD 2A 40 FD 		  LD      IX,(PC)         ;PROGRAM COUNTER	;PROGRAM COUNTER
1822)   57DE 21 FE FD    		  LD      HL,LISTON	;
1823)   57E1 CB 76       		  BIT     6,(HL)	;
1824)   57E3 28 04       		  JR      Z,ASSEM0	;
1825)   57E5 DD 2A 3C FD 		  LD      IX,(OC)         ;ORIGIN of CODE	;ORIGIN of CODE
1826)   57E9 DD E5       		ASSEM0:  PUSH    IX	;
1827)   57EB FD E5       		  PUSH    IY	;
1828)   57ED CD 7D 58    		  CALL    ASMB	;
1829)   57F0 C1          		  POP     BC	;
1830)   57F1 D1          		  POP     DE	;
1831)   57F2 D8          		  RET     C	;
1832)   57F3 CD 3F 5B    		  CALL    SKIP	;
1833)   57F6 37          		  SCF	;
1834)   57F7 C0          		  RET     NZ	;
1835)   57F8 FD 2B       		  DEC     IY	;
1836)   57FA FD 23       		ASSEM3:  INC     IY	;
1837)   57FC FD 7E 00    		  LD      A,(IY)	;
1838)   57FF CD C8 56    		  CALL    TERM0	;
1839)   5802 20 F6       		  JR      NZ,ASSEM3	;
1840)   5804 3A FE FD    		  LD      A,(LISTON)	;
1841)   5807 DD E5       		  PUSH    IX	;
1842)   5809 E1          		  POP     HL	;
1843)   580A B7          		  OR      A	;
1844)   580B ED 52       		  SBC     HL,DE	;
1845)   580D EB          		  EX      DE,HL           ;DE= NO. OF BYTES	;DE= NO. OF BYTES
1846)   580E E5          		  PUSH    HL	;
1847)   580F 2A 40 FD    		  LD      HL,(PC)	;
1848)   5812 E5          		  PUSH    HL	;
1849)   5813 19          		  ADD     HL,DE	;
1850)   5814 22 40 FD    		  LD      (PC),HL         ;UPDATE PC	;UPDATE PC
1851)   5817 CB 77       		  BIT     6,A	;
1852)   5819 28 07       		  JR      Z,ASSEM5	;
1853)   581B 2A 3C FD    		  LD      HL,(OC)	;
1854)   581E 19          		  ADD     HL,DE	;
1855)   581F 22 3C FD    		  LD      (OC),HL         ;UPDATE OC	;UPDATE OC
1856)   5822 E1          		ASSEM5:  POP     HL              ;OLD PC	;OLD PC
1857)   5823 DD E1       		  POP     IX              ;CODE HERE	;CODE HERE
1858)   5825 CB 67       		  BIT     4,A	;
1859)   5827 28 A0       		  JR      Z,ASSEM	;
1860)   5829 7C          		  LD      A,H	;
1861)   582A CD 69 58    		  CALL    HEX	;
1862)   582D 7D          		  LD      A,L	;
1863)   582E CD 62 58    		  CALL    HEXSP	;
1864)   5831 AF          		  XOR     A	;
1865)   5832 BB          		  CP      E	;
1866)   5833 28 15       		  JR      Z,ASSEM2	;
1867)   5835 3A FB FD    		ASSEM1:  LD      A,(COUNT)	;
1868)   5838 FE 11       		  CP      17	;
1869)   583A 3E 05       		  LD      A,5	;
1870)   583C D4 04 57    		  CALL    NC,TABIT        ;NEXT LINE	;NEXT LINE
1871)   583F DD 7E 00    		  LD      A,(IX)	;
1872)   5842 CD 62 58    		  CALL    HEXSP	;
1873)   5845 DD 23       		  INC     IX	;
1874)   5847 1D          		  DEC     E	;
1875)   5848 20 EB       		  JR      NZ,ASSEM1	;
1876)   584A 3E 12       		ASSEM2:  LD      A,18	;
1877)   584C CD 04 57    		  CALL    TABIT	;
1878)   584F FD E5       		  PUSH    IY	;
1879)   5851 E1          		  POP     HL	;
1880)   5852 ED 42       		  SBC     HL,BC	;
1881)   5854 0A          		ASSEM4:  LD      A,(BC)	;
1882)   5855 CD 8D 48    		  CALL    OUT	;
1883)   5858 03          		  INC     BC	;
1884)   5859 2D          		  DEC     L	;
1885)   585A 20 F8       		  JR      NZ,ASSEM4	;
1886)   585C CD 6D 48    		  CALL    CRLF	;
1887)   585F C3 C9 57    		  JP      ASSEM	;
1889)   5862 CD 69 58    		HEXSP:  CALL    HEX	;
1890)   5865 3E 20       		  LD      A,' '	;
1891)   5867 18 11       		  JR      OUTCH1	;
1892)   5869 F5          		HEX:  PUSH    AF	;
1893)   586A 0F          		  RRCA	;
1894)   586B 0F          		  RRCA	;
1895)   586C 0F          		  RRCA	;
1896)   586D 0F          		  RRCA	;
1897)   586E CD 72 58    		  CALL    HEXOUT	;
1898)   5871 F1          		  POP     AF	;
1899)   5872 E6 0F       		HEXOUT:  AND     0FH	;
1900)   5874 C6 90       		  ADD     A,90H	;
1901)   5876 27          		  DAA	;
1902)   5877 CE 40       		  ADC     A,40H	;
1903)   5879 27          		  DAA	;
1904)   587A C3 8D 48    		OUTCH1:  JP      OUT	;
1918)   587D FE 2E       		ASMB:  CP      '.'	;
1919)   587F 20 16       		  JR      NZ,ASMB1	;
1920)   5881 FD 23       		  INC     IY	;
1921)   5883 DD E5       		  PUSH    IX	;
1922)   5885 CD B8 4D    		  CALL    VAR	;
1923)   5888 F5          		  PUSH    AF	;
1924)   5889 CD BE 63    		  CALL    ZERO	;
1925)   588C D9          		  EXX	;
1926)   588D 2A 40 FD    		  LD      HL,(PC)	;
1927)   5890 D9          		  EXX	;
1928)   5891 F1          		  POP     AF	;
1929)   5892 CD 5E 55    		  CALL    STORE	;
1930)   5895 DD E1       		  POP     IX	;
1931)   5897 CD 3F 5B    		ASMB1:  CALL    SKIP	;
1932)   589A C8          		  RET     Z	;
1933)   589B FE D6       		  CP      TCALL	;
1934)   589D 0E C4       		  LD      C,0C4H	;
1935)   589F FD 23       		  INC     IY	;
1936)   58A1 CA 8E 59    		  JP      Z,GRPC	;
1937)   58A4 FD 2B       		  DEC     IY	;
1938)   58A6 21 51 5B    		  LD      HL,OPCODS	;
1939)   58A9 CD F6 5A    		  CALL    FIND	;
1940)   58AC D8          		  RET     C	;
1941)   58AD 48          		  LD      C,B     ;ROOT OPCODE	;ROOT OPCODE
1942)   58AE 16 00       		  LD      D,0     ;CLEAR IX/IY FLAG	;CLEAR IX/IY FLAG
1947)   58B0 D6 27       		  SUB     39	;
1948)   58B2 30 07       		  JR      NC,GROUP2	;
1949)   58B4 FE E8       		  CP      15-39	;
1950)   58B6 D4 5C 5A    		  CALL    NC,ED	;
1951)   58B9 18 68       		  JR      BYTE0	;
1956)   58BB D6 0A       		GROUP2:  SUB     10	;
1957)   58BD 30 0F       		  JR      NC,GROUP4	;
1958)   58BF FE F9       		  CP      3-10	;
1959)   58C1 DC E6 5A    		  CALL    C,BIT	;
1960)   58C4 D8          		  RET     C	;
1961)   58C5 CD BB 5A    		  CALL    REGLO	;
1962)   58C8 D8          		  RET     C	;
1963)   58C9 CD 60 5A    		  CALL    CB	;
1964)   58CC 18 55       		  JR      BYTE0	;
1968)   58CE D6 03       		GROUP4:  SUB     3	;
1969)   58D0 30 06       		  JR      NC,GROUP5	;
1970)   58D2 CD DA 5A    		G4:  CALL    PAIR	;
1971)   58D5 D8          		  RET     C	;
1972)   58D6 18 4B       		  JR      BYTE0	;
1977)   58D8 D6 0A       		GROUP5:  SUB     8+2	;
1978)   58DA 30 32       		  JR      NC,GROUP7	;
1979)   58DC FE FD       		  CP      5-8	;
1980)   58DE 06 07       		  LD      B,7	;
1981)   58E0 D4 6E 5A    		  CALL    NC,OPND	;
1982)   58E3 78          		  LD      A,B	;
1983)   58E4 FE 07       		  CP      7	;
1984)   58E6 20 10       		  JR      NZ,G6HL	;
1985)   58E8 CD BB 5A    		G6:  CALL    REGLO	;
1986)   58EB 79          		  LD      A,C	;
1987)   58EC 30 28       		  JR      NC,BIND1	;
1988)   58EE EE 46       		  XOR     46H	;
1989)   58F0 CD 62 5A    		  CALL    BIND	;
1990)   58F3 CD 9E 5A    		DB:  CALL    NUMBER	;
1991)   58F6 18 78       		  JR      VAL8	;
1993)   58F8 E6 3F       		G6HL:  AND     3FH	;
1994)   58FA FE 0C       		  CP      12	;
1995)   58FC 37          		  SCF	;
1996)   58FD C0          		  RET     NZ	;
1997)   58FE 79          		  LD      A,C	;
1998)   58FF FE 80       		  CP      80H	;
1999)   5901 0E 09       		  LD      C,9	;
2000)   5903 28 CD       		  JR      Z,G4	;
2001)   5905 EE 1C       		  XOR     1CH	;
2002)   5907 0F          		  RRCA	;
2003)   5908 4F          		  LD      C,A	;
2004)   5909 CD 5C 5A    		  CALL    ED	;
2005)   590C 18 C4       		  JR      G4	;
2009)   590E D6 02       		GROUP7:  SUB     2	;
2010)   5910 30 14       		  JR      NC,GROUP8	;
2011)   5912 CD C1 5A    		  CALL    REGHI	;
2012)   5915 79          		  LD      A,C	;
2013)   5916 D2 62 5A    		BIND1:  JP      NC,BIND	;
2014)   5919 EE 64       		  XOR     64H	;
2015)   591B 07          		  RLCA	;
2016)   591C 07          		  RLCA	;
2017)   591D 07          		  RLCA	;
2018)   591E 4F          		  LD      C,A	;
2019)   591F CD DE 5A    		  CALL    PAIR1	;
2020)   5922 D8          		  RET     C	;
2021)   5923 79          		BYTE0:  LD      A,C	;
2022)   5924 18 7F       		  JR      BYTE2	;
2027)   5926 D6 02       		GROUP8:  SUB     2	;
2028)   5928 30 21       		  JR      NC,GROUPA	;
2029)   592A FE FF       		  CP      1-2	;
2030)   592C CC 51 5A    		  CALL    Z,CORN	;
2031)   592F 08          		  EX      AF,AF'	;
2032)   5930 CD C1 5A    		  CALL    REGHI	;
2033)   5933 D8          		  RET     C	;
2034)   5934 08          		  EX      AF,AF'	;
2035)   5935 DC 51 5A    		  CALL    C,CORN	;
2036)   5938 24          		  INC     H	;
2037)   5939 28 E8       		  JR      Z,BYTE0	;
2038)   593B 78          		  LD      A,B	;
2039)   593C FE 07       		  CP      7	;
2040)   593E 37          		  SCF	;
2041)   593F C0          		  RET     NZ	;
2042)   5940 79          		  LD      A,C	;
2043)   5941 EE 03       		  XOR     3	;
2044)   5943 07          		  RLCA	;
2045)   5944 07          		  RLCA	;
2046)   5945 07          		  RLCA	;
2047)   5946 CD 8E 5A    		  CALL    BYTE	;
2048)   5949 18 25       		  JR      VAL8	;
2052)   594B D6 02       		GROUPA:  SUB     2	;
2053)   594D 30 24       		  JR      NC,GROUPB	;
2054)   594F FE FF       		  CP      1-2	;
2055)   5951 C4 C7 5A    		  CALL    NZ,COND	;
2056)   5954 79          		  LD      A,C	;
2057)   5955 30 02       		  JR      NC,GRPA	;
2058)   5957 3E 18       		  LD      A,18H	;
2059)   5959 CD 8E 5A    		GRPA:  CALL    BYTE	;
2060)   595C CD 9E 5A    		  CALL    NUMBER	;
2061)   595F ED 5B 40 FD 		  LD      DE,(PC)	;
2062)   5963 13          		  INC     DE	;
2063)   5964 37          		  SCF	;
2064)   5965 ED 52       		  SBC     HL,DE	;
2065)   5967 7D          		  LD      A,L	;
2066)   5968 17          		  RLA	;
2067)   5969 9F          		  SBC     A,A	;
2068)   596A BC          		  CP      H	;
2069)   596B 3E 01       		TOOFAR:  LD      A,1	;
2070)   596D C2 DB 46    		  JP      NZ,ERROR        ;"Out of range"	;"Out of range"
2071)   5970 7D          		VAL8:  LD      A,L	;
2072)   5971 18 32       		  JR      BYTE2	;
2076)   5973 47          		GROUPB:  LD      B,A	;
2077)   5974 20 16       		  JR      NZ,GROUPC	;
2078)   5976 CD C7 5A    		  CALL    COND	;
2079)   5979 79          		  LD      A,C	;
2080)   597A 30 0B       		  JR      NC,GRPB	;
2081)   597C 78          		  LD      A,B	;
2082)   597D E6 3F       		  AND     3FH	;
2083)   597F FE 06       		  CP      6	;
2084)   5981 3E E9       		  LD      A,0E9H	;
2085)   5983 28 20       		  JR      Z,BYTE2	;
2086)   5985 3E C3       		  LD      A,0C3H	;
2087)   5987 CD 8E 5A    		GRPB:  CALL    BYTE	;
2088)   598A 18 05       		  JR      ADDR	;
2092)   598C 10 0C       		GROUPC:  DJNZ    GROUPD	;
2093)   598E CD A9 59    		GRPC:  CALL    GRPE	;
2094)   5991 CD 9E 5A    		ADDR:  CALL    NUMBER	;
2095)   5994 CD 70 59    		VAL16:  CALL    VAL8	;
2096)   5997 7C          		  LD      A,H	;
2097)   5998 18 0B       		  JR      BYTE2	;
2101)   599A 10 0B       		GROUPD:  DJNZ    GROUPE	;
2102)   599C CD 9E 5A    		  CALL    NUMBER	;
2103)   599F A1          		  AND     C	;
2104)   59A0 B4          		  OR      H	;
2105)   59A1 20 C8       		  JR      NZ,TOOFAR	;
2106)   59A3 7D          		  LD      A,L	;
2107)   59A4 B1          		  OR      C	;
2108)   59A5 18 78       		BYTE2:   JR      BYTE1	;
2112)   59A7 10 0A       		GROUPE:  DJNZ    GROUPF	;
2113)   59A9 CD C7 5A    		GRPE:  CALL    COND	;
2114)   59AC 79          		  LD      A,C	;
2115)   59AD 30 70       		  JR      NC,BYTE1	;
2116)   59AF F6 09       		  OR      9	;
2117)   59B1 18 6C       		  JR      BYTE1	;
2121)   59B3 10 6C       		GROUPF:  DJNZ    MISC	;
2122)   59B5 CD F3 5A    		  CALL    LDOP	;
2123)   59B8 30 5F       		  JR      NC,LDA	;
2124)   59BA CD C1 5A    		  CALL    REGHI	;
2125)   59BD 08          		  EX      AF,AF'	;
2126)   59BE CD 3F 5B    		  CALL    SKIP	;
2127)   59C1 FE 28       		  CP      '('	;
2128)   59C3 28 1D       		  JR      Z,LDIN	;
2129)   59C5 08          		  EX      AF,AF'	;
2130)   59C6 D2 E8 58    		  JP      NC,G6	;
2131)   59C9 0E 01       		  LD      C,1	;
2132)   59CB CD DE 5A    		  CALL    PAIR1	;
2133)   59CE D8          		  RET     C	;
2134)   59CF 3E 0E       		  LD      A,14	;
2135)   59D1 B8          		  CP      B	;
2136)   59D2 47          		  LD      B,A	;
2137)   59D3 CC DA 5A    		  CALL    Z,PAIR	;
2138)   59D6 78          		  LD      A,B	;
2139)   59D7 E6 3F       		  AND     3FH	;
2140)   59D9 FE 0C       		  CP      12	;
2141)   59DB 79          		  LD      A,C	;
2142)   59DC 20 A9       		  JR      NZ,GRPB	;
2143)   59DE 3E F9       		  LD      A,0F9H	;
2144)   59E0 18 3D       		  JR      BYTE1	;
2146)   59E2 08          		LDIN:  EX      AF,AF'	;
2147)   59E3 C5          		  PUSH    BC	;
2148)   59E4 D4 BB 5A    		  CALL    NC,REGLO	;
2149)   59E7 79          		  LD      A,C	;
2150)   59E8 C1          		  POP     BC	;
2151)   59E9 30 77       		  JR      NC,BIND	;
2152)   59EB 0E 0A       		  LD      C,0AH	;
2153)   59ED CD DE 5A    		  CALL    PAIR1	;
2154)   59F0 CD 38 5A    		  CALL    LD16	;
2155)   59F3 30 92       		  JR      NC,GRPB	;
2156)   59F5 CD 9E 5A    		  CALL    NUMBER	;
2157)   59F8 0E 02       		  LD      C,2	;
2158)   59FA CD DA 5A    		  CALL    PAIR	;
2159)   59FD CD 38 5A    		  CALL    LD16	;
2160)   5A00 D8          		  RET     C	;
2161)   5A01 CD 8E 5A    		  CALL    BYTE	;
2162)   5A04 18 8E       		  JR      VAL16	;
2166)   5A06 05          		OPT:  DEC     B	;
2167)   5A07 CA F3 58    		  JP      Z,DB	;
2168)   5A0A 10 85       		  DJNZ    ADDR	;
2169)   5A0C CD 9E 5A    		  CALL    NUMBER	;
2170)   5A0F 21 FE FD    		  LD      HL,LISTON	;
2171)   5A12 4F          		  LD      C,A	;
2172)   5A13 ED 6F       		  RLD	;
2173)   5A15 79          		  LD      A,C	;
2174)   5A16 ED 67       		  RRD	;
2175)   5A18 C9          		  RET	;
2177)   5A19 FE 04       		LDA:  CP      4	;
2178)   5A1B DC 5C 5A    		  CALL    C,ED	;
2179)   5A1E 78          		  LD      A,B	;
2180)   5A1F 18 6D       		BYTE1:  JR      BYTE	;
2184)   5A21 10 E3       		MISC:  DJNZ    OPT	;
2185)   5A23 DD E5       		  PUSH    IX	;
2186)   5A25 CD 9D 5E    		  CALL    EXPRS	;
2187)   5A28 DD E1       		  POP     IX	;
2188)   5A2A 21 00 FB    		  LD      HL,ACCS	;
2189)   5A2D AF          		DEFM1:  XOR     A	;
2190)   5A2E BB          		  CP      E	;
2191)   5A2F C8          		  RET     Z	;
2192)   5A30 7E          		  LD      A,(HL)	;
2193)   5A31 23          		  INC     HL	;
2194)   5A32 CD 8E 5A    		  CALL    BYTE	;
2195)   5A35 1D          		  DEC     E	;
2196)   5A36 18 F5       		  JR      DEFM1	;
2200)   5A38 78          		LD16:  LD      A,B	;
2201)   5A39 38 0E       		  JR      C,LD8	;
2202)   5A3B 78          		  LD      A,B	;
2203)   5A3C E6 3F       		  AND     3FH	;
2204)   5A3E FE 0C       		  CP      12	;
2205)   5A40 79          		  LD      A,C	;
2206)   5A41 C8          		  RET     Z	;
2207)   5A42 CD 5C 5A    		  CALL    ED	;
2208)   5A45 79          		  LD      A,C	;
2209)   5A46 F6 43       		  OR      43H	;
2210)   5A48 C9          		  RET	;
2212)   5A49 FE 07       		LD8:  CP      7	;
2213)   5A4B 37          		  SCF	;
2214)   5A4C C0          		  RET     NZ	;
2215)   5A4D 79          		  LD      A,C	;
2216)   5A4E F6 30       		  OR      30H	;
2217)   5A50 C9          		  RET	;
2219)   5A51 C5          		CORN:  PUSH    BC	;
2220)   5A52 CD 6E 5A    		  CALL    OPND	;
2221)   5A55 CB 68       		  BIT     5,B	;
2222)   5A57 C1          		  POP     BC	;
2223)   5A58 28 44       		  JR      Z,NUMBER	;
2224)   5A5A 26 FF       		  LD      H,-1	;
2225)   5A5C 3E ED       		ED:  LD      A,0EDH	;
2226)   5A5E 18 2E       		  JR      BYTE	;
2228)   5A60 3E CB       		CB:  LD      A,0CBH	;
2229)   5A62 FE 76       		BIND:  CP      76H	;
2230)   5A64 37          		  SCF	;
2231)   5A65 C8          		  RET     Z               ;REJECT LD (HL),(HL)	;REJECT LD (HL),(HL)
2232)   5A66 CD 8E 5A    		  CALL    BYTE	;
2233)   5A69 14          		  INC     D	;
2234)   5A6A F0          		  RET     P	;
2235)   5A6B 7B          		  LD      A,E	;
2236)   5A6C 18 20       		  JR      BYTE	;
2238)   5A6E E5          		OPND:  PUSH    HL	;
2239)   5A6F 21 98 5C    		  LD      HL,OPRNDS	;
2240)   5A72 CD F6 5A    		  CALL    FIND	;
2241)   5A75 E1          		  POP     HL	;
2242)   5A76 D8          		  RET     C	;
2243)   5A77 CB 78       		  BIT     7,B	;
2244)   5A79 C8          		  RET     Z	;
2245)   5A7A CB 58       		  BIT     3,B	;
2246)   5A7C E5          		  PUSH    HL	;
2247)   5A7D CC 95 5A    		  CALL    Z,OFFSET	;
2248)   5A80 5D          		  LD      E,L	;
2249)   5A81 E1          		  POP     HL	;
2250)   5A82 3E DD       		  LD      A,0DDH	;
2251)   5A84 CB 70       		  BIT     6,B	;
2252)   5A86 28 02       		  JR      Z,OP1	;
2253)   5A88 3E FD       		  LD      A,0FDH	;
2254)   5A8A B7          		OP1:  OR      A	;
2255)   5A8B 14          		  INC     D	;
2256)   5A8C 57          		  LD      D,A	;
2257)   5A8D F8          		  RET     M	;
2258)   5A8E DD 77 00    		BYTE:  LD      (IX),A	;
2259)   5A91 DD 23       		  INC     IX	;
2260)   5A93 B7          		  OR      A	;
2261)   5A94 C9          		  RET	;
2263)   5A95 FD 7E 00    		OFFSET:  LD      A,(IY)	;
2264)   5A98 FE 29       		  CP      ')'	;
2265)   5A9A 21 00 00    		  LD      HL,0	;
2266)   5A9D C8          		  RET     Z	;
2267)   5A9E CD 3F 5B    		NUMBER:  CALL    SKIP	;
2268)   5AA1 C5          		  PUSH    BC	;
2269)   5AA2 D5          		  PUSH    DE	;
2270)   5AA3 DD E5       		  PUSH    IX	;
2271)   5AA5 CD 94 5E    		  CALL    EXPRI	;
2272)   5AA8 DD E1       		  POP     IX	;
2273)   5AAA D9          		  EXX	;
2274)   5AAB D1          		  POP     DE	;
2275)   5AAC C1          		  POP     BC	;
2276)   5AAD 7D          		  LD      A,L	;
2277)   5AAE B7          		  OR      A	;
2278)   5AAF C9          		  RET	;
2280)   5AB0 CD 6E 5A    		REG:  CALL    OPND	;
2281)   5AB3 D8          		  RET     C	;
2282)   5AB4 78          		  LD      A,B	;
2283)   5AB5 E6 3F       		  AND     3FH	;
2284)   5AB7 FE 08       		  CP      8	;
2285)   5AB9 3F          		  CCF	;
2286)   5ABA C9          		  RET	;
2288)   5ABB CD B0 5A    		REGLO:  CALL    REG	;
2289)   5ABE D8          		  RET     C	;
2290)   5ABF 18 2F       		  JR      ORC	;
2292)   5AC1 CD B0 5A    		REGHI:  CALL    REG	;
2293)   5AC4 D8          		  RET     C	;
2294)   5AC5 18 26       		  JR      SHL3	;
2296)   5AC7 CD 6E 5A    		COND:  CALL    OPND	;
2297)   5ACA D8          		  RET     C	;
2298)   5ACB 78          		  LD      A,B	;
2299)   5ACC E6 1F       		  AND     1FH	;
2300)   5ACE D6 10       		  SUB     16	;
2301)   5AD0 30 1B       		  JR      NC,SHL3	;
2302)   5AD2 FE F1       		  CP      -15	;
2303)   5AD4 37          		  SCF	;
2304)   5AD5 C0          		  RET     NZ	;
2305)   5AD6 3E 03       		  LD      A,3	;
2306)   5AD8 18 13       		  JR      SHL3	;
2308)   5ADA CD 6E 5A    		PAIR:  CALL    OPND	;
2309)   5ADD D8          		  RET     C	;
2310)   5ADE 78          		PAIR1:  LD      A,B	;
2311)   5ADF E6 0F       		  AND     0FH	;
2312)   5AE1 D6 08       		  SUB     8	;
2313)   5AE3 D8          		  RET     C	;
2314)   5AE4 18 07       		  JR      SHL3	;
2316)   5AE6 CD 9E 5A    		BIT:  CALL    NUMBER	;
2317)   5AE9 FE 08       		  CP      8	;
2318)   5AEB 3F          		  CCF	;
2319)   5AEC D8          		  RET     C	;
2320)   5AED 07          		SHL3:  RLCA	;
2321)   5AEE 07          		  RLCA	;
2322)   5AEF 07          		  RLCA	;
2323)   5AF0 B1          		ORC:  OR      C	;
2324)   5AF1 4F          		  LD      C,A	;
2325)   5AF2 C9          		  RET	;
2327)   5AF3 21 DD 5C    		LDOP:  LD      HL,LDOPS	;
2328)   5AF6 CD 3F 5B    		FIND:  CALL    SKIP	;
2329)   5AF9 06 00       		EXIT:  LD      B,0	;
2330)   5AFB 37          		  SCF	;
2331)   5AFC C8          		  RET     Z	;
2332)   5AFD FE DD       		  CP      DEF	;
2333)   5AFF 28 04       		  JR      Z,FIND0	;
2334)   5B01 FE 85       		  CP      TOR+1	;
2335)   5B03 3F          		  CCF	;
2336)   5B04 D8          		  RET     C	;
2337)   5B05 7E          		FIND0:  LD      A,(HL)	;
2338)   5B06 B7          		  OR      A	;
2339)   5B07 28 F0       		  JR      Z,EXIT	;
2340)   5B09 FD AE 00    		  XOR     (IY)	;
2341)   5B0C E6 5F       		  AND     01011111B	;
2342)   5B0E 28 09       		  JR      Z,FIND2	;
2343)   5B10 CB 7E       		FIND1:  BIT     7,(HL)	;
2344)   5B12 23          		  INC     HL	;
2345)   5B13 28 FB       		  JR      Z,FIND1	;
2346)   5B15 23          		  INC     HL	;
2347)   5B16 04          		  INC     B	;
2348)   5B17 18 EC       		  JR      FIND0	;
2350)   5B19 FD E5       		FIND2:  PUSH    IY	;
2351)   5B1B CB 7E       		FIND3:  BIT     7,(HL)	;
2352)   5B1D FD 23       		  INC     IY	;
2353)   5B1F 23          		  INC     HL	;
2354)   5B20 20 10       		  JR      NZ,FIND5	;
2355)   5B22 BE          		  CP      (HL)	;
2356)   5B23 CC 3E 5B    		  CALL    Z,SKIP0	;
2357)   5B26 7E          		  LD      A,(HL)	;
2358)   5B27 FD AE 00    		  XOR     (IY)	;
2359)   5B2A E6 5F       		  AND     01011111B	;
2360)   5B2C 28 ED       		  JR      Z,FIND3	;
2361)   5B2E FD E1       		FIND4:  POP     IY	;
2362)   5B30 18 DE       		  JR      FIND1	;
2364)   5B32 CD AE 56    		FIND5:  CALL    DELIM	;
2365)   5B35 C4 4B 5B    		  CALL    NZ,SIGN	;
2366)   5B38 20 F4       		  JR      NZ,FIND4	;
2367)   5B3A 78          		FIND6:  LD      A,B	;
2368)   5B3B 46          		  LD      B,(HL)	;
2369)   5B3C E1          		  POP     HL	;
2370)   5B3D C9          		  RET	;
2372)   5B3E 23          		SKIP0:  INC     HL	;
2373)   5B3F CD AE 56    		SKIP:  CALL    DELIM	;
2374)   5B42 C0          		  RET     NZ	;
2375)   5B43 CD BA 56    		  CALL    TERM	;
2376)   5B46 C8          		  RET     Z	;
2377)   5B47 FD 23       		  INC     IY	;
2378)   5B49 18 F4       		  JR      SKIP	;
2380)   5B4B FE 2B       		SIGN:  CP      '+'	;
2381)   5B4D C8          		  RET     Z	;
2382)   5B4E FE 2D       		  CP      '-'	;
2383)   5B50 C9          		  RET	;
2386)   5B51 4E 4F       		OPCODS:  DEFM    'NO'	;
2387)   5B53 D0          		  DEFB    'P'+80H	;
2388)   5B54 00          		  DEFB    0	;
2389)   5B55 52 4C 43    		  DEFM    'RLC'	;
2390)   5B58 C1          		  DEFB    'A'+80H	;
2391)   5B59 07          		  DEFB    7	;
2392)   5B5A 45 58       		  DEFM    'EX'	;
2393)   5B5C 00          		  DEFB    0	;
2394)   5B5D 41 46       		  DEFM    'AF'	;
2395)   5B5F 00          		  DEFB    0	;
2396)   5B60 41 46       		  DEFM    'AF'	;
2397)   5B62 A7          		  DEFB    ''''+80H	;
2398)   5B63 08          		  DEFB    8	;
2399)   5B64 52 52 43    		  DEFM    'RRC'	;
2400)   5B67 C1          		  DEFB    'A'+80H	;
2401)   5B68 0F          		  DEFB    0FH	;
2402)   5B69 52 4C       		  DEFM    'RL'	;
2403)   5B6B C1          		  DEFB    'A'+80H	;
2404)   5B6C 17          		  DEFB    17H	;
2405)   5B6D 52 52       		  DEFM    'RR'	;
2406)   5B6F C1          		  DEFB    'A'+80H	;
2407)   5B70 1F          		  DEFB    1FH	;
2408)   5B71 44 41       		  DEFM    'DA'	;
2409)   5B73 C1          		  DEFB    'A'+80H	;
2410)   5B74 27          		  DEFB    27H	;
2411)   5B75 43 50       		  DEFM    'CP'	;
2412)   5B77 CC          		  DEFB    'L'+80H	;
2413)   5B78 2F          		  DEFB    2FH	;
2414)   5B79 53 43       		  DEFM    'SC'	;
2415)   5B7B C6          		  DEFB    'F'+80H	;
2416)   5B7C 37          		  DEFB    37H	;
2417)   5B7D 43 43       		  DEFM    'CC'	;
2418)   5B7F C6          		  DEFB    'F'+80H	;
2419)   5B80 3F          		  DEFB    3FH	;
2420)   5B81 48 41 4C    		  DEFM    'HAL'	;
2421)   5B84 D4          		  DEFB    'T'+80H	;
2422)   5B85 76          		  DEFB    76H	;
2423)   5B86 45 58       		  DEFM    'EX'	;
2424)   5B88 D8          		  DEFB    'X'+80H	;
2425)   5B89 D9          		  DEFB    0D9H	;
2426)   5B8A 45 58       		  DEFM    'EX'	;
2427)   5B8C 00          		  DEFB    0	;
2428)   5B8D 44 45       		  DEFM    'DE'	;
2429)   5B8F 00          		  DEFB    0	;
2430)   5B90 48          		  DEFM    'H'	;
2431)   5B91 CC          		  DEFB    'L'+80H	;
2432)   5B92 EB          		  DEFB    0EBH	;
2433)   5B93 44          		  DEFM    'D'	;
2434)   5B94 C9          		  DEFB    'I'+80H	;
2435)   5B95 F3          		  DEFB    0F3H	;
2436)   5B96 45          		  DEFM    'E'	;
2437)   5B97 C9          		  DEFB    'I'+80H	;
2438)   5B98 FB          		  DEFB    0FBH	;
2440)   5B99 4E 45       		  DEFM    'NE'	;
2441)   5B9B C7          		  DEFB    'G'+80H	;
2442)   5B9C 44          		  DEFB    44H	;
2443)   5B9D 49 4D       		  DEFM    'IM'	;
2444)   5B9F 00          		  DEFB    0	;
2445)   5BA0 B0          		  DEFB    '0'+80H	;
2446)   5BA1 46          		  DEFB    46H	;
2447)   5BA2 52 45 54    		  DEFM    'RET'	;
2448)   5BA5 CE          		  DEFB    'N'+80H	;
2449)   5BA6 45          		  DEFB    45H	;
2450)   5BA7 52 45 54    		  DEFM    'RET'	;
2451)   5BAA C9          		  DEFB    'I'+80H	;
2452)   5BAB 4D          		  DEFB    4DH	;
2453)   5BAC 49 4D       		  DEFM    'IM'	;
2454)   5BAE 00          		  DEFB    0	;
2455)   5BAF B1          		  DEFB    '1'+80H	;
2456)   5BB0 56          		  DEFB    56H	;
2457)   5BB1 49 4D       		  DEFM    'IM'	;
2458)   5BB3 00          		  DEFB    0	;
2459)   5BB4 B2          		  DEFB    '2'+80H	;
2460)   5BB5 5E          		  DEFB    5EH	;
2461)   5BB6 52 52       		  DEFM    'RR'	;
2462)   5BB8 C4          		  DEFB    'D'+80H	;
2463)   5BB9 67          		  DEFB    67H	;
2464)   5BBA 52 4C       		  DEFM    'RL'	;
2465)   5BBC C4          		  DEFB    'D'+80H	;
2466)   5BBD 6F          		  DEFB    6FH	;
2467)   5BBE 4C 44       		  DEFM    'LD'	;
2468)   5BC0 C9          		  DEFB    'I'+80H	;
2469)   5BC1 A0          		  DEFB    0A0H	;
2470)   5BC2 43 50       		  DEFM    'CP'	;
2471)   5BC4 C9          		  DEFB    'I'+80H	;
2472)   5BC5 A1          		  DEFB    0A1H	;
2473)   5BC6 49 4E       		  DEFM    'IN'	;
2474)   5BC8 C9          		  DEFB    'I'+80H	;
2475)   5BC9 A2          		  DEFB    0A2H	;
2476)   5BCA 4F 55 54    		  DEFM    'OUT'	;
2477)   5BCD C9          		  DEFB    'I'+80H	;
2478)   5BCE A3          		  DEFB    0A3H	;
2479)   5BCF 4C 44       		  DEFM    'LD'	;
2480)   5BD1 C4          		  DEFB    'D'+80H	;
2481)   5BD2 A8          		  DEFB    0A8H	;
2482)   5BD3 43 50       		  DEFM    'CP'	;
2483)   5BD5 C4          		  DEFB    'D'+80H	;
2484)   5BD6 A9          		  DEFB    0A9H	;
2485)   5BD7 49 4E       		  DEFM    'IN'	;
2486)   5BD9 C4          		  DEFB    'D'+80H	;
2487)   5BDA AA          		  DEFB    0AAH	;
2488)   5BDB 4F 55 54    		  DEFM    'OUT'	;
2489)   5BDE C4          		  DEFB    'D'+80H	;
2490)   5BDF AB          		  DEFB    0ABH	;
2491)   5BE0 4C 44 49    		  DEFM    'LDI'	;
2492)   5BE3 D2          		  DEFB    'R'+80H	;
2493)   5BE4 B0          		  DEFB    0B0H	;
2494)   5BE5 43 50 49    		  DEFM    'CPI'	;
2495)   5BE8 D2          		  DEFB    'R'+80H	;
2496)   5BE9 B1          		  DEFB    0B1H	;
2497)   5BEA 49 4E 49    		  DEFM    'INI'	;
2498)   5BED D2          		  DEFB    'R'+80H	;
2499)   5BEE B2          		  DEFB    0B2H	;
2500)   5BEF 4F 54 49    		  DEFM    'OTI'	;
2501)   5BF2 D2          		  DEFB    'R'+80H	;
2502)   5BF3 B3          		  DEFB    0B3H	;
2503)   5BF4 4C 44 44    		  DEFM    'LDD'	;
2504)   5BF7 D2          		  DEFB    'R'+80H	;
2505)   5BF8 B8          		  DEFB    0B8H	;
2506)   5BF9 43 50 44    		  DEFM    'CPD'	;
2507)   5BFC D2          		  DEFB    'R'+80H	;
2508)   5BFD B9          		  DEFB    0B9H	;
2509)   5BFE 49 4E 44    		  DEFM    'IND'	;
2510)   5C01 D2          		  DEFB    'R'+80H	;
2511)   5C02 BA          		  DEFB    0BAH	;
2512)   5C03 4F 54 44    		  DEFM    'OTD'	;
2513)   5C06 D2          		  DEFB    'R'+80H	;
2514)   5C07 BB          		  DEFB    0BBH	;
2516)   5C08 42 49       		  DEFM    'BI'	;
2517)   5C0A D4          		  DEFB    'T'+80H	;
2518)   5C0B 40          		  DEFB    40H	;
2519)   5C0C 52 45       		  DEFM    'RE'	;
2520)   5C0E D3          		  DEFB    'S'+80H	;
2521)   5C0F 80          		  DEFB    80H	;
2522)   5C10 53 45       		  DEFM    'SE'	;
2523)   5C12 D4          		  DEFB    'T'+80H	;
2524)   5C13 C0          		  DEFB    0C0H	;
2526)   5C14 52 4C       		  DEFM    'RL'	;
2527)   5C16 C3          		  DEFB    'C'+80H	;
2528)   5C17 00          		  DEFB    0	;
2529)   5C18 52 52       		  DEFM    'RR'	;
2530)   5C1A C3          		  DEFB    'C'+80H	;
2531)   5C1B 08          		  DEFB    8	;
2532)   5C1C 52          		  DEFM    'R'	;
2533)   5C1D CC          		  DEFB    'L'+80H	;
2534)   5C1E 10          		  DEFB    10H	;
2535)   5C1F 52          		  DEFM    'R'	;
2536)   5C20 D2          		  DEFB    'R'+80H	;
2537)   5C21 18          		  DEFB    18H	;
2538)   5C22 53 4C       		  DEFM    'SL'	;
2539)   5C24 C1          		  DEFB    'A'+80H	;
2540)   5C25 20          		  DEFB    20H	;
2541)   5C26 53 52       		  DEFM    'SR'	;
2542)   5C28 C1          		  DEFB    'A'+80H	;
2543)   5C29 28          		  DEFB    28H	;
2544)   5C2A 53 52       		  DEFM    'SR'	;
2545)   5C2C CC          		  DEFB    'L'+80H	;
2546)   5C2D 38          		  DEFB    38H	;
2548)   5C2E 50 4F       		  DEFM    'PO'	;
2549)   5C30 D0          		  DEFB    'P'+80H	;
2550)   5C31 C1          		  DEFB    0C1H	;
2551)   5C32 50 55 53    		  DEFM    'PUS'	;
2552)   5C35 C8          		  DEFB    'H'+80H	;
2553)   5C36 C5          		  DEFB    0C5H	;
2554)   5C37 45 58       		  DEFM    'EX'	;
2555)   5C39 00          		  DEFB    0	;
2556)   5C3A 28 53       		  DEFM    '(S'	;
2557)   5C3C D0          		  DEFB    'P'+80H	;
2558)   5C3D E3          		  DEFB    0E3H	;
2560)   5C3E 53 55       		  DEFM    'SU'	;
2561)   5C40 C2          		  DEFB    'B'+80H	;
2562)   5C41 90          		  DEFB    90H	;
2563)   5C42 41 4E       		  DEFM    'AN'	;
2564)   5C44 C4          		  DEFB    'D'+80H	;
2565)   5C45 A0          		  DEFB    0A0H	;
2566)   5C46 58 4F       		  DEFM    'XO'	;
2567)   5C48 D2          		  DEFB    'R'+80H	;
2568)   5C49 A8          		  DEFB    0A8H	;
2569)   5C4A 4F          		  DEFM    'O'	;
2570)   5C4B D2          		  DEFB    'R'+80H	;
2571)   5C4C B0          		  DEFB    0B0H	;
2572)   5C4D 43          		  DEFM    'C'	;
2573)   5C4E D0          		  DEFB    'P'+80H	;
2574)   5C4F B8          		  DEFB    0B8H	;
2575)   5C50 80          		  DEFB    TAND	;
2576)   5C51 A0          		  DEFB    0A0H	;
2577)   5C52 84          		  DEFB    TOR	;
2578)   5C53 B0          		  DEFB    0B0H	;
2580)   5C54 41 44       		  DEFM    'AD'	;
2581)   5C56 C4          		  DEFB    'D'+80H	;
2582)   5C57 80          		  DEFB    80H	;
2583)   5C58 41 44       		  DEFM    'AD'	;
2584)   5C5A C3          		  DEFB    'C'+80H	;
2585)   5C5B 88          		  DEFB    88H	;
2586)   5C5C 53 42       		  DEFM    'SB'	;
2587)   5C5E C3          		  DEFB    'C'+80H	;
2588)   5C5F 98          		  DEFB    98H	;
2590)   5C60 49 4E       		  DEFM    'IN'	;
2591)   5C62 C3          		  DEFB    'C'+80H	;
2592)   5C63 04          		  DEFB    4	;
2593)   5C64 44 45       		  DEFM    'DE'	;
2594)   5C66 C3          		  DEFB    'C'+80H	;
2595)   5C67 05          		  DEFB    5	;
2597)   5C68 49          		  DEFM    'I'	;
2598)   5C69 CE          		  DEFB    'N'+80H	;
2599)   5C6A 40          		  DEFB    40H	;
2600)   5C6B 4F 55       		  DEFM    'OU'	;
2601)   5C6D D4          		  DEFB    'T'+80H	;
2602)   5C6E 41          		  DEFB    41H	;
2604)   5C6F 4A          		  DEFM    'J'	;
2605)   5C70 D2          		  DEFB    'R'+80H	;
2606)   5C71 20          		  DEFB    20H	;
2607)   5C72 44 4A 4E    		  DEFM    'DJN'	;
2608)   5C75 DA          		  DEFB    'Z'+80H	;
2609)   5C76 10          		  DEFB    10H	;
2611)   5C77 4A          		  DEFM    'J'	;
2612)   5C78 D0          		  DEFB    'P'+80H	;
2613)   5C79 C2          		  DEFB    0C2H	;
2615)   5C7A 43 41 4C    		  DEFM    'CAL'	;
2616)   5C7D CC          		  DEFB    'L'+80H	;
2617)   5C7E C4          		  DEFB    0C4H	;
2619)   5C7F 52 53       		  DEFM    'RS'	;
2620)   5C81 D4          		  DEFB    'T'+80H	;
2621)   5C82 C7          		  DEFB    0C7H	;
2623)   5C83 52 45       		  DEFM    'RE'	;
2624)   5C85 D4          		  DEFB    'T'+80H	;
2625)   5C86 C0          		  DEFB    0C0H	;
2627)   5C87 4C          		  DEFM    'L'	;
2628)   5C88 C4          		  DEFB    'D'+80H	;
2629)   5C89 40          		  DEFB    40H	;
2631)   5C8A 5D          		  DEFB    DEF AND 7FH	;
2632)   5C8B CD          		  DEFB    'M'+80H	;
2633)   5C8C 00          		  DEFB    0	;
2635)   5C8D 5D          		  DEFB    DEF AND 7FH	;
2636)   5C8E C2          		  DEFB    'B'+80H	;
2637)   5C8F 00          		  DEFB    0	;
2639)   5C90 4F 50       		  DEFM    'OP'	;
2640)   5C92 D4          		  DEFB    'T'+80H	;
2641)   5C93 00          		  DEFB    0	;
2643)   5C94 5D          		  DEFB    DEF AND 7FH	;
2644)   5C95 D7          		  DEFB    'W'+80H	;
2645)   5C96 00          		  DEFB    0	;
2647)   5C97 00          		  DEFB    0	;
2649)   5C98 C2          		OPRNDS:  DEFB    'B'+80H	;
2650)   5C99 00          		  DEFB    0	;
2651)   5C9A C3          		  DEFB    'C'+80H	;
2652)   5C9B 01          		  DEFB    1	;
2653)   5C9C C4          		  DEFB    'D'+80H	;
2654)   5C9D 02          		  DEFB    2	;
2655)   5C9E C5          		  DEFB    'E'+80H	;
2656)   5C9F 03          		  DEFB    3	;
2657)   5CA0 C8          		  DEFB    'H'+80H	;
2658)   5CA1 04          		  DEFB    4	;
2659)   5CA2 CC          		  DEFB    'L'+80H	;
2660)   5CA3 05          		  DEFB    5	;
2661)   5CA4 28 48       		  DEFM    '(H'	;
2662)   5CA6 CC          		  DEFB    'L'+80H	;
2663)   5CA7 06          		  DEFB    6	;
2664)   5CA8 C1          		  DEFB    'A'+80H	;
2665)   5CA9 07          		  DEFB    7	;
2666)   5CAA 28 49       		  DEFM    '(I'	;
2667)   5CAC D8          		  DEFB    'X'+80H	;
2668)   5CAD 86          		  DEFB    86H	;
2669)   5CAE 28 49       		  DEFM    '(I'	;
2670)   5CB0 D9          		  DEFB    'Y'+80H	;
2671)   5CB1 C6          		  DEFB    0C6H	;
2673)   5CB2 42          		  DEFM    'B'	;
2674)   5CB3 C3          		  DEFB    'C'+80H	;
2675)   5CB4 08          		  DEFB    8	;
2676)   5CB5 44          		  DEFM    'D'	;
2677)   5CB6 C5          		  DEFB    'E'+80H	;
2678)   5CB7 0A          		  DEFB    10	;
2679)   5CB8 48          		  DEFM    'H'	;
2680)   5CB9 CC          		  DEFB    'L'+80H	;
2681)   5CBA 0C          		  DEFB    12	;
2682)   5CBB 49          		  DEFM    'I'	;
2683)   5CBC D8          		  DEFB    'X'+80H	;
2684)   5CBD 8C          		  DEFB    8CH	;
2685)   5CBE 49          		  DEFM    'I'	;
2686)   5CBF D9          		  DEFB    'Y'+80H	;
2687)   5CC0 CC          		  DEFB    0CCH	;
2688)   5CC1 41          		  DEFM    'A'	;
2689)   5CC2 C6          		  DEFB    'F'+80H	;
2690)   5CC3 0E          		  DEFB    14	;
2691)   5CC4 53          		  DEFM    'S'	;
2692)   5CC5 D0          		  DEFB    'P'+80H	;
2693)   5CC6 0E          		  DEFB    14	;
2695)   5CC7 4E          		  DEFM    'N'	;
2696)   5CC8 DA          		  DEFB    'Z'+80H	;
2697)   5CC9 10          		  DEFB    16	;
2698)   5CCA DA          		  DEFB    'Z'+80H	;
2699)   5CCB 11          		  DEFB    17	;
2700)   5CCC 4E          		  DEFM    'N'	;
2701)   5CCD C3          		  DEFB    'C'+80H	;
2702)   5CCE 12          		  DEFB    18	;
2703)   5CCF 50          		  DEFM    'P'	;
2704)   5CD0 CF          		  DEFB    'O'+80H	;
2705)   5CD1 14          		  DEFB    20	;
2706)   5CD2 50          		  DEFM    'P'	;
2707)   5CD3 C5          		  DEFB    'E'+80H	;
2708)   5CD4 15          		  DEFB    21	;
2709)   5CD5 D0          		  DEFB    'P'+80H	;
2710)   5CD6 16          		  DEFB    22	;
2711)   5CD7 CD          		  DEFB    'M'+80H	;
2712)   5CD8 17          		  DEFB    23	;
2714)   5CD9 28          		  DEFM    '('	;
2715)   5CDA C3          		  DEFB    'C'+80H	;
2716)   5CDB 20          		  DEFB    20H	;
2718)   5CDC 00          		  DEFB    0	;
2720)   5CDD 49          		LDOPS:  DEFM    'I'	;
2721)   5CDE 00          		  DEFB    0	;
2722)   5CDF C1          		  DEFB    'A'+80H	;
2723)   5CE0 47          		  DEFB    47H	;
2724)   5CE1 52          		  DEFM    'R'	;
2725)   5CE2 00          		  DEFB    0	;
2726)   5CE3 C1          		  DEFB    'A'+80H	;
2727)   5CE4 4F          		  DEFB    4FH	;
2728)   5CE5 41          		  DEFM    'A'	;
2729)   5CE6 00          		  DEFB    0	;
2730)   5CE7 C9          		  DEFB    'I'+80H	;
2731)   5CE8 57          		  DEFB    57H	;
2732)   5CE9 41          		  DEFM    'A'	;
2733)   5CEA 00          		  DEFB    0	;
2734)   5CEB D2          		  DEFB    'R'+80H	;
2735)   5CEC 5F          		  DEFB    5FH	;
2736)   5CED 28 42 43    		  DEFM    '(BC'	;
2737)   5CF0 00          		  DEFB    0	;
2738)   5CF1 C1          		  DEFB    'A'+80H	;
2739)   5CF2 02          		  DEFB    2	;
2740)   5CF3 28 44 45    		  DEFM    '(DE'	;
2741)   5CF6 00          		  DEFB    0	;
2742)   5CF7 C1          		  DEFB    'A'+80H	;
2743)   5CF8 12          		  DEFB    12H	;
2744)   5CF9 41          		  DEFM    'A'	;
2745)   5CFA 00          		  DEFB    0	;
2746)   5CFB 28 42       		  DEFM    '(B'	;
2747)   5CFD C3          		  DEFB    'C'+80H	;
2748)   5CFE 0A          		  DEFB    0AH	;
2749)   5CFF 41          		  DEFM    'A'	;
2750)   5D00 00          		  DEFB    0	;
2751)   5D01 28 44       		  DEFM    '(D'	;
2752)   5D03 C5          		  DEFB    'E'+80H	;
2753)   5D04 1A          		  DEFB    1AH	;
2755)   5D05 00          		  DEFB    0	;
 29)   5D06 26 63       		FUNTBL:  DEFW    DECODE          ;Line number	;Line number
 30)   5D08 7F 60       		  DEFW    OPENIN          ;OPENIN	;OPENIN
 31)   5D0A 9C 60       		  DEFW    PTR             ;PTR	;PTR
 32)   5D0C 51 60       		  DEFW    PAGEV           ;PAGE	;PAGE
 33)   5D0E A4 60       		  DEFW    TIMEV           ;TIME	;TIME
 34)   5D10 47 60       		  DEFW    LOMEMV          ;LOMEM	;LOMEM
 35)   5D12 4C 60       		  DEFW    HIMEMV          ;HIMEM	;HIMEM
 36)   5D14 F0 60       		  DEFW    ABS             ;ABS	;ABS
 37)   5D16 2C 61       		  DEFW    ACS             ;ACS	;ACS
 38)   5D18 8E 74       		  DEFW    ADVAL           ;ADVAL	;ADVAL
 39)   5D1A 34 60       		  DEFW    ASC             ;ASC	;ASC
 40)   5D1C 24 61       		  DEFW    ASN             ;ASN	;ASN
 41)   5D1E 28 61       		  DEFW    ATN             ;ATN	;ATN
 42)   5D20 10 60       		  DEFW    BGET            ;BGET	;BGET
 43)   5D22 10 61       		  DEFW    COS             ;COS	;COS
 44)   5D24 6F 60       		  DEFW    COUNTV          ;COUNT	;COUNT
 45)   5D26 F8 60       		  DEFW    DEG             ;DEG	;DEG
 46)   5D28 65 60       		  DEFW    ERLV            ;ERL	;ERL
 47)   5D2A 6A 60       		  DEFW    ERRV            ;ERR	;ERR
 48)   5D2C 50 61       		  DEFW    EVAL            ;EVAL	;EVAL
 49)   5D2E 18 61       		  DEFW    EXP             ;EXP	;EXP
 50)   5D30 94 60       		  DEFW    EXT             ;EXT	;EXT
 51)   5D32 BE 63       		  DEFW    ZERO            ;FALSE	;FALSE
 52)   5D34 1C 51       		  DEFW    FN              ;FN	;FN
 53)   5D36 1E 60       		  DEFW    GET             ;GET	;GET
 54)   5D38 19 60       		  DEFW    INKEY           ;INKEY	;INKEY
 55)   5D3A E9 61       		  DEFW    INSTR           ;INSTR(	;INSTR(
 56)   5D3C 04 61       		  DEFW    INT             ;INT	;INT
 57)   5D3E 41 60       		  DEFW    LEN             ;LEN	;LEN
 58)   5D40 1C 61       		  DEFW    LN              ;LN	;LN
 59)   5D42 20 61       		  DEFW    LOG             ;LOG	;LOG
 60)   5D44 F4 60       		  DEFW    NOTK            ;NOT	;NOT
 61)   5D46 7C 60       		  DEFW    OPENUP          ;OPENUP	;OPENUP
 62)   5D48 7A 60       		  DEFW    OPENOT          ;OPENOUT	;OPENOUT
 63)   5D4A EC 60       		  DEFW    PI              ;PI	;PI
 64)   5D4C 86 74       		  DEFW    POINT           ;POINT(	;POINT(
 65)   5D4E F9 5F       		  DEFW    POS             ;POS	;POS
 66)   5D50 FC 60       		  DEFW    RAD             ;RAD	;RAD
 67)   5D52 7D 61       		  DEFW    RND             ;RND	;RND
 68)   5D54 00 61       		  DEFW    SGN             ;SGN	;SGN
 69)   5D56 14 61       		  DEFW    SIN             ;SIN	;SIN
 70)   5D58 08 61       		  DEFW    SQR             ;SQR	;SQR
 71)   5D5A 0C 61       		  DEFW    TAN             ;TAN	;TAN
 72)   5D5C 56 60       		  DEFW    TOPV            ;TO(P)	;TO(P)
 73)   5D5E E1 60       		  DEFW    TRUE            ;TRUE	;TRUE
 74)   5D60 00 55       		  DEFW    USR             ;USR	;USR
 75)   5D62 43 61       		  DEFW    VAL             ;VAL	;VAL
 76)   5D64 FF 5F       		  DEFW    VPOS            ;VPOS	;VPOS
 77)   5D66 67 62       		  DEFW    CHRS            ;CHRS	;CHRS
 78)   5D68 6E 62       		  DEFW    GETS            ;GETS	;GETS
 79)   5D6A 74 62       		  DEFW    INKEYS          ;INKEYS	;INKEYS
 80)   5D6C B5 62       		  DEFW    LEFTS           ;LEFTS(	;LEFTS(
 81)   5D6E 84 62       		  DEFW    MIDS            ;MIDS(	;MIDS(
 82)   5D70 D0 62       		  DEFW    RIGHTS          ;RIGHTS(	;RIGHTS(
 83)   5D72 7E 63       		  DEFW    STRS            ;STR$	;STR$
 84)   5D74 E4 62       		  DEFW    STRING          ;STRINGS(	;STRINGS(
 85)   5D76 04 60       		  DEFW    EOF             ;EOF	;EOF
 95)   5D78 CF 60       		SOPTBL:  DEFW    SLE             ;<= (STRING)	;<= (STRING)
 96)   5D7A D7 60       		  DEFW    SNE             ;<>	;<>
 97)   5D7C C9 60       		  DEFW    SGE             ;>=	;>=
 98)   5D7E BC 60       		  DEFW    SLT             ;<	;<
 99)   5D80 DD 60       		  DEFW    SEQ             ;=	;=
100)   5D82 C2 60       		  DEFW    SGT             ;>	;>
119)   5D84 CD 99 5D    		@EXPR:  CALL    EXPR1           ;GET FIRST OPERAND	;GET FIRST OPERAND
120)   5D87 FE 82       		EXPR0A:  CP      EORK            ;CHECK OPERATOR	;CHECK OPERATOR
121)   5D89 28 03       		  JR      Z,EXPR0B	;
122)   5D8B FE 84       		  CP      ORK	;
123)   5D8D C0          		  RET     NZ	;
124)   5D8E CD 49 64    		EXPR0B:  CALL    SAVE            ;SAVE FIRST OPERAND	;SAVE FIRST OPERAND
125)   5D91 CD 99 5D    		  CALL    EXPR1           ;GET SECOND OPERAND	;GET SECOND OPERAND
126)   5D94 CD 57 64    		  CALL    DOIT            ;DO OPERATION	;DO OPERATION
127)   5D97 18 EE       		  JR      EXPR0A          ;CONTINUE	;CONTINUE
129)   5D99 CD AA 5D    		EXPR1:  CALL    EXPR2	;
130)   5D9C FE 80       		EXPR1A:  CP      ANDK	;
131)   5D9E C0          		  RET     NZ	;
132)   5D9F CD 49 64    		  CALL    SAVE	;
133)   5DA2 CD AA 5D    		  CALL    EXPR2	;
134)   5DA5 CD 57 64    		  CALL    DOIT	;
135)   5DA8 18 F2       		  JR      EXPR1A	;
137)   5DAA CD 09 5E    		EXPR2:  CALL    EXPR3	;
138)   5DAD CD 24 64    		  CALL    RELOP?	;
139)   5DB0 C0          		  RET     NZ	;
140)   5DB1 47          		  LD      B,A	;
141)   5DB2 FD 23       		  INC     IY              ;BUMP OVER OPERATOR	;BUMP OVER OPERATOR
142)   5DB4 CD 78 64    		  CALL    NXT	;
143)   5DB7 CD 24 64    		  CALL    RELOP?          ;COMPOUND OPERATOR?	;COMPOUND OPERATOR?
144)   5DBA 20 08       		  JR      NZ,EXPR2B	;
145)   5DBC FD 23       		  INC     IY	;
146)   5DBE B8          		  CP      B	;
147)   5DBF CA BF 4D    		  JP      Z,SYNTAX        ;ILLEGAL COMBINATION	;ILLEGAL COMBINATION
148)   5DC2 80          		  ADD     A,B	;
149)   5DC3 47          		  LD      B,A	;
150)   5DC4 78          		EXPR2B:  LD      A,B	;
151)   5DC5 08          		  EX      AF,AF'	;
152)   5DC6 FA DC 5D    		  JP      M,EXPR2S	;
153)   5DC9 08          		  EX      AF,AF'	;
154)   5DCA D6 04       		  SUB     4	;
155)   5DCC FE 3A       		  CP      '>'-4	;
156)   5DCE 20 02       		  JR      NZ,EXPR2C	;
157)   5DD0 C6 02       		  ADD     A,2	;
158)   5DD2 CD 4B 64    		EXPR2C:  CALL    SAVE1	;
159)   5DD5 CD 09 5E    		  CALL    EXPR3	;
160)   5DD8 CD 57 64    		  CALL    DOIT            ;Must NOT be "JP DOIT"	;Must NOT be "JP DOIT"
161)   5DDB C9          		  RET	;
163)   5DDC 08          		EXPR2S:  EX      AF,AF'	;
164)   5DDD 3D          		  DEC     A	;
165)   5DDE E6 07       		  AND     7	;
166)   5DE0 CD DF 63    		  CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
167)   5DE3 F5          		  PUSH    AF              ;SAVE OPERATOR	;SAVE OPERATOR
168)   5DE4 CD 09 5E    		  CALL    EXPR3           ;SECOND STRING	;SECOND STRING
169)   5DE7 08          		  EX      AF,AF'	;
170)   5DE8 F2 B9 5E    		  JP      P,TYPE	;
171)   5DEB F1          		  POP     AF	;
172)   5DEC 4B          		  LD      C,E             ;LENGTH OF STRING #2	;LENGTH OF STRING #2
173)   5DED D1          		  POP     DE	;
174)   5DEE 21 00 00    		  LD      HL,0	;
175)   5DF1 39          		  ADD     HL,SP	;
176)   5DF2 43          		  LD      B,E             ;LENGTH OF STRING #1	;LENGTH OF STRING #1
177)   5DF3 D5          		  PUSH    DE	;
178)   5DF4 11 00 FB    		  LD      DE,ACCS	;
179)   5DF7 EB          		  EX      DE,HL	;
180)   5DF8 CD 83 64    		  CALL    DISPT2	;
181)   5DFB D1          		  POP     DE	;
182)   5DFC EB          		  EX      DE,HL	;
183)   5DFD 26 00       		  LD      H,0	;
184)   5DFF 39          		  ADD     HL,SP	;
185)   5E00 F9          		  LD      SP,HL	;
186)   5E01 EB          		  EX      DE,HL	;
187)   5E02 AF          		  XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
188)   5E03 4F          		  LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
189)   5E04 08          		  EX      AF,AF'	;
190)   5E05 FD 7E 00    		  LD      A,(IY)	;
191)   5E08 C9          		  RET	;
193)   5E09 CD 58 5E    		EXPR3:  CALL    EXPR4	;
194)   5E0C FE 2D       		EXPR3A:  CP      '-'	;
195)   5E0E 28 08       		  JR      Z,EXPR3B	;
196)   5E10 FE 2B       		  CP      '+'	;
197)   5E12 C0          		  RET     NZ	;
198)   5E13 08          		  EX      AF,AF'	;
199)   5E14 FA 23 5E    		  JP      M,EXPR3S	;
200)   5E17 08          		  EX      AF,AF'	;
201)   5E18 CD 49 64    		EXPR3B:  CALL    SAVE	;
202)   5E1B CD 58 5E    		  CALL    EXPR4	;
203)   5E1E CD 57 64    		  CALL    DOIT	;
204)   5E21 18 E9       		  JR      EXPR3A	;
206)   5E23 08          		EXPR3S:  EX      AF,AF'	;
207)   5E24 FD 23       		  INC     IY              ;BUMP PAST '+'	;BUMP PAST '+'
208)   5E26 CD DF 63    		  CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
209)   5E29 CD 58 5E    		  CALL    EXPR4           ;SECOND STRING	;SECOND STRING
210)   5E2C 08          		  EX      AF,AF'	;
211)   5E2D F2 B9 5E    		  JP      P,TYPE	;
212)   5E30 4B          		  LD      C,E             ;C=LENGTH	;C=LENGTH
213)   5E31 D1          		  POP     DE	;
214)   5E32 D5          		  PUSH    DE	;
215)   5E33 21 00 FB    		  LD      HL,ACCS	;
216)   5E36 54          		  LD      D,H	;
217)   5E37 79          		  LD      A,C	;
218)   5E38 B7          		  OR      A	;
219)   5E39 28 0F       		  JR      Z,EXP3S3	;
220)   5E3B 45          		  LD      B,L	;
221)   5E3C 6F          		  LD      L,A             ;SOURCE	;SOURCE
222)   5E3D 83          		  ADD     A,E	;
223)   5E3E 5F          		  LD      E,A             ;DESTINATION	;DESTINATION
224)   5E3F 3E 13       		  LD      A,19	;
225)   5E41 DA DB 46    		  JP      C,ERROR         ;"String too long"	;"String too long"
226)   5E44 D5          		  PUSH    DE	;
227)   5E45 1D          		  DEC     E	;
228)   5E46 2D          		  DEC     L	;
229)   5E47 ED B8       		  LDDR                    ;COPY	;COPY
230)   5E49 D1          		  POP     DE	;
231)   5E4A D9          		EXP3S3:  EXX	;
232)   5E4B C1          		  POP     BC	;
233)   5E4C CD FE 63    		  CALL    POPS            ;RESTORE FROM STACK	;RESTORE FROM STACK
234)   5E4F D9          		  EXX	;
235)   5E50 F6 80       		  OR      80H             ;FLAG STRING	;FLAG STRING
236)   5E52 08          		  EX      AF,AF'	;
237)   5E53 FD 7E 00    		  LD      A,(IY)	;
238)   5E56 18 B4       		  JR      EXPR3A	;
240)   5E58 CD 75 5E    		EXPR4:  CALL    EXPR5	;
241)   5E5B FE 2A       		EXPR4A:  CP      '*'	;
242)   5E5D 28 0B       		  JR      Z,EXPR4B	;
243)   5E5F FE 2F       		  CP      '/'	;
244)   5E61 28 07       		  JR      Z,EXPR4B	;
245)   5E63 FE 83       		  CP      MODK	;
246)   5E65 28 03       		  JR      Z,EXPR4B	;
247)   5E67 FE 81       		  CP      DIVK	;
248)   5E69 C0          		  RET     NZ	;
249)   5E6A CD 49 64    		EXPR4B:  CALL    SAVE	;
250)   5E6D CD 75 5E    		  CALL    EXPR5	;
251)   5E70 CD 57 64    		  CALL    DOIT	;
252)   5E73 18 E6       		  JR      EXPR4A	;
254)   5E75 CD 10 5F    		EXPR5:  CALL    ITEM	;
255)   5E78 B7          		  OR      A               ;TEST TYPE	;TEST TYPE
256)   5E79 08          		  EX      AF,AF'          ;SAVE TYPE	;SAVE TYPE
257)   5E7A CD 78 64    		EXPR5A:  CALL    NXT	;
258)   5E7D FE 5E       		  CP      '^'	;
259)   5E7F C0          		  RET     NZ	;
260)   5E80 CD 49 64    		  CALL    SAVE	;
261)   5E83 CD 10 5F    		  CALL    ITEM	;
262)   5E86 B7          		  OR      A	;
263)   5E87 08          		  EX      AF,AF'	;
264)   5E88 CD 57 64    		  CALL    DOIT	;
265)   5E8B 18 ED       		  JR      EXPR5A	;
267)   5E8D CD 84 5D    		@EXPRN:  CALL    EXPR	;
268)   5E90 08          		  EX      AF,AF'	;
269)   5E91 F0          		  RET     P	;
270)   5E92 18 25       		  JR      TYPE	;
272)   5E94 CD 84 5D    		@EXPRI:  CALL    EXPR	;
273)   5E97 08          		  EX      AF,AF'	;
274)   5E98 F2 3B 61    		  JP      P,SFIX	;
275)   5E9B 18 1C       		  JR      TYPE	;
277)   5E9D CD 84 5D    		@EXPRS:  CALL    EXPR	;
278)   5EA0 08          		  EX      AF,AF'	;
279)   5EA1 F8          		  RET     M	;
280)   5EA2 18 15       		  JR      TYPE	;
283)   5EA4 CD 10 5F    		ITEMN:  CALL    ITEM	;
284)   5EA7 B7          		  OR      A	;
285)   5EA8 F0          		  RET     P	;
286)   5EA9 18 0E       		  JR      TYPE	;
288)   5EAB CD 10 5F    		@ITEMI:  CALL    ITEM	;
289)   5EAE B7          		  OR      A	;
290)   5EAF F2 3B 61    		  JP      P,SFIX	;
291)   5EB2 18 05       		  JR      TYPE	;
293)   5EB4 CD 10 5F    		ITEMS:  CALL    ITEM	;
294)   5EB7 B7          		  OR      A	;
295)   5EB8 F8          		  RET     M	;
296)   5EB9 3E 06       		TYPE:  LD      A,6	;
297)   5EBB C3 DB 46    		  JP      ERROR           ;"Type mismatch"	;"Type mismatch"
299)   5EBE CD 84 5D    		ITEM1:  CALL    EXPR            ;BRACKETED EXPR	;BRACKETED EXPR
300)   5EC1 CD 3C 64    		  CALL    BRAKET	;
301)   5EC4 08          		  EX      AF,AF'	;
302)   5EC5 C9          		  RET	;
309)   5EC6 CD BE 63    		HEX:  CALL    ZERO	;
310)   5EC9 CD 11 64    		  CALL    HEXDIG	;
311)   5ECC 38 18       		  JR      C,BADHEX	;
312)   5ECE FD 23       		HEX1:  INC     IY	;
313)   5ED0 E6 0F       		  AND     0FH	;
314)   5ED2 06 04       		  LD      B,4	;
315)   5ED4 D9          		HEX2:  EXX	;
316)   5ED5 29          		  ADD     HL,HL	;
317)   5ED6 D9          		  EXX	;
318)   5ED7 ED 6A       		  ADC     HL,HL	;
319)   5ED9 10 F9       		  DJNZ    HEX2	;
320)   5EDB D9          		  EXX	;
321)   5EDC B5          		  OR      L	;
322)   5EDD 6F          		  LD      L,A	;
323)   5EDE D9          		  EXX	;
324)   5EDF CD 11 64    		  CALL    HEXDIG	;
325)   5EE2 30 EA       		  JR      NC,HEX1	;
326)   5EE4 AF          		  XOR     A	;
327)   5EE5 C9          		  RET	;
329)   5EE6 3E 1C       		BADHEX:  LD      A,28	;
330)   5EE8 C3 DB 46    		  JP      ERROR           ;"Bad HEX"	;"Bad HEX"
337)   5EEB CD A4 5E    		MINUS:  CALL    ITEMN	;
338)   5EEE 0D          		MINUS0:  DEC     C	;
339)   5EEF 0C          		  INC     C	;
340)   5EF0 28 06       		  JR      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
341)   5EF2 7C          		  LD      A,H	;
342)   5EF3 EE 80       		  XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
343)   5EF5 67          		  LD      H,A	;
344)   5EF6 AF          		  XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
345)   5EF7 C9          		  RET	;
347)   5EF8 D9          		NEGATE:  EXX	;
348)   5EF9 7C          		  LD      A,H	;
349)   5EFA 2F          		  CPL	;
350)   5EFB 67          		  LD      H,A	;
351)   5EFC 7D          		  LD      A,L	;
352)   5EFD 2F          		  CPL	;
353)   5EFE 6F          		  LD      L,A	;
354)   5EFF D9          		  EXX	;
355)   5F00 7C          		  LD      A,H	;
356)   5F01 2F          		  CPL	;
357)   5F02 67          		  LD      H,A	;
358)   5F03 7D          		  LD      A,L	;
359)   5F04 2F          		  CPL	;
360)   5F05 6F          		  LD      L,A	;
361)   5F06 D9          		ADD1:  EXX	;
362)   5F07 23          		  INC     HL	;
363)   5F08 7C          		  LD      A,H	;
364)   5F09 B5          		  OR      L	;
365)   5F0A D9          		  EXX	;
366)   5F0B 3E 00       		  LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
367)   5F0D C0          		  RET     NZ	;
368)   5F0E 23          		  INC     HL	;
369)   5F0F C9          		  RET	;
378)   5F10 CD BF 55    		ITEM:  CALL    CHECK	;
379)   5F13 CD 78 64    		  CALL    NXT	;
380)   5F16 FD 23       		  INC     IY	;
381)   5F18 FE 26       		  CP      '&'	;
382)   5F1A 28 AA       		  JR      Z,HEX           ;HEX CONSTANT	;HEX CONSTANT
383)   5F1C FE 2D       		  CP      '-'	;
384)   5F1E 28 CB       		  JR      Z,MINUS         ;UNARY MINUS	;UNARY MINUS
385)   5F20 FE 2B       		  CP      '+'	;
386)   5F22 28 80       		  JR      Z,ITEMN         ;UNARY PLUS	;UNARY PLUS
387)   5F24 FE 28       		  CP      '('	;
388)   5F26 28 96       		  JR      Z,ITEM1         ;EXPRESSION	;EXPRESSION
389)   5F28 FE 22       		  CP      34  ;ASCII ""	;ASCII ""
390)   5F2A 28 63       		  JR      Z,CONS          ;STRING CONSTANT	;STRING CONSTANT
391)   5F2C FE C6       		  CP      TCMD	;
392)   5F2E D2 BF 4D    		  JP      NC,SYNTAX       ;SYNTAX ERROR	;SYNTAX ERROR
393)   5F31 FE 8D       		  CP      FUNTOK	;
394)   5F33 D2 89 64    		  JP      NC,DISPAT       ;FUNCTION	;FUNCTION
395)   5F36 FD 2B       		  DEC     IY	;
396)   5F38 FE 3A       		  CP      ':'	;
397)   5F3A 30 08       		  JR      NC,ITEM2        ;VARIABLE?	;VARIABLE?
398)   5F3C FE 30       		  CP      '0'	;
399)   5F3E 30 74       		  JR      NC,CON          ;NUMERIC CONSTANT	;NUMERIC CONSTANT
400)   5F40 FE 2E       		  CP      '.'	;
401)   5F42 28 70       		  JR      Z,CON           ;NUMERIC CONSTANT	;NUMERIC CONSTANT
402)   5F44 CD 3F 49    		ITEM2:  CALL    GETVAR          ;VARIABLE	;VARIABLE
403)   5F47 20 2B       		  JR      NZ,NOSUCH	;
404)   5F49 B7          		  OR      A	;
405)   5F4A FA D7 5F    		  JP      M,LOADS         ;STRING VARIABLE	;STRING VARIABLE
406)   5F4D B7          		@LOADN:  OR      A	;
407)   5F4E 28 18       		  JR      Z,LOAD1         ;BYTE VARIABLE	;BYTE VARIABLE
408)   5F50 0E 00       		  LD      C,0	;
409)   5F52 CB 47       		  BIT     0,A	;
410)   5F54 28 03       		  JR      Z,LOAD4         ;INTEGER VARIABLE	;INTEGER VARIABLE
411)   5F56 DD 4E 04    		LOAD5:  LD      C,(IX+4)	;
412)   5F59 D9          		@LOAD4:  EXX	;
413)   5F5A DD 6E 00    		  LD      L,(IX+0)	;
414)   5F5D DD 66 01    		  LD      H,(IX+1)	;
415)   5F60 D9          		  EXX	;
416)   5F61 DD 6E 02    		  LD      L,(IX+2)	;
417)   5F64 DD 66 03    		  LD      H,(IX+3)	;
418)   5F67 C9          		  RET	;
420)   5F68 21 00 00    		LOAD1:  LD      HL,0	;
421)   5F6B D9          		  EXX	;
422)   5F6C 26 00       		  LD      H,0	;
423)   5F6E DD 6E 00    		  LD      L,(IX+0)	;
424)   5F71 D9          		  EXX	;
425)   5F72 4C          		  LD      C,H	;
426)   5F73 C9          		  RET	;
428)   5F74 DA BF 4D    		NOSUCH:  JP      C,SYNTAX	;
429)   5F77 3A FE FD    		  LD      A,(LISTON)	;
430)   5F7A CB 6F       		  BIT     5,A	;
431)   5F7C 3E 1A       		  LD      A,26	;
432)   5F7E 20 23       		  JR      NZ,ERROR0       ;"No such variable"	;"No such variable"
433)   5F80 FD 23       		NOS1:  INC     IY	;
434)   5F82 CD 26 4B    		  CALL    RANGE	;
435)   5F85 30 F9       		  JR      NC,NOS1	;
436)   5F87 DD 21 40 FD 		  LD      IX,PC	;
437)   5F8B AF          		  XOR     A	;
438)   5F8C 4F          		  LD      C,A	;
439)   5F8D 18 CA       		  JR      LOAD4	;
448)   5F8F 11 00 FB    		@CONS:  LD      DE,ACCS	;
449)   5F92 FD 7E 00    		CONS3:  LD      A,(IY)	;
450)   5F95 FD 23       		  INC     IY	;
451)   5F97 FE 22       		  CP      34  ;ASCII ""	;ASCII ""
452)   5F99 28 0B       		  JR      Z,CONS2	;
453)   5F9B 12          		CONS1:  LD      (DE),A	;
454)   5F9C 1C          		  INC     E	;
455)   5F9D FE 0D       		  CP      CR	;
456)   5F9F 20 F1       		  JR      NZ,CONS3	;
457)   5FA1 3E 09       		  LD      A,9	;
458)   5FA3 C3 DB 46    		ERROR0:  JP      ERROR           ;"Missing """	;"Missing """
460)   5FA6 FD 7E 00    		CONS2:  LD      A,(IY)	;
461)   5FA9 FE 34       		  CP      0x34  ;ASCII "	;ASCII "
462)   5FAB FD 23       		  INC     IY	;
463)   5FAD 28 EC       		  JR      Z,CONS1	;
464)   5FAF FD 2B       		  DEC     IY	;
465)   5FB1 3E 80       		  LD      A,80H           ;STRING MARKER	;STRING MARKER
466)   5FB3 C9          		  RET	;
474)   5FB4 FD E5       		CON:  PUSH    IY	;
475)   5FB6 DD E1       		  POP     IX	;
476)   5FB8 3E 24       		  LD      A,36	;
477)   5FBA CD 9C 64    		  CALL    FPP	;
478)   5FBD 38 E4       		  JR      C,ERROR0	;
479)   5FBF DD E5       		  PUSH    IX	;
480)   5FC1 FD E1       		  POP     IY	;
481)   5FC3 AF          		  XOR     A	;
482)   5FC4 C9          		  RET	;
484)   5FC5 DD 46 04    		@DLOAD5: LD      B,(IX+4)	;
485)   5FC8 D9          		  EXX	;
486)   5FC9 DD 5E 00    		  LD      E,(IX+0)	;
487)   5FCC DD 56 01    		  LD      D,(IX+1)	;
488)   5FCF D9          		  EXX	;
489)   5FD0 DD 5E 02    		  LD      E,(IX+2)	;
490)   5FD3 DD 56 03    		  LD      D,(IX+3)	;
491)   5FD6 C9          		  RET	;
493)   5FD7 11 00 FB    		@LOADS:  LD      DE,ACCS	;
494)   5FDA 1F          		  RRA	;
495)   5FDB 30 10       		  JR      NC,LOADS2       ;FIXED STRING	;FIXED STRING
496)   5FDD CD 59 5F    		  CALL    LOAD4	;
497)   5FE0 D9          		  EXX	;
498)   5FE1 7D          		  LD      A,L	;
499)   5FE2 D9          		  EXX	;
500)   5FE3 B7          		  OR      A	;
501)   5FE4 4F          		  LD      C,A	;
502)   5FE5 3E 80       		  LD      A,80H           ;STRING MARKER	;STRING MARKER
503)   5FE7 C8          		  RET     Z	;
504)   5FE8 06 00       		  LD      B,0	;
505)   5FEA ED B0       		  LDIR	;
506)   5FEC C9          		  RET	;
507)   5FED 7E          		LOADS2:  LD      A,(HL)	;
508)   5FEE 12          		  LD      (DE),A	;
509)   5FEF 23          		  INC     HL	;
510)   5FF0 FE 0D       		  CP      CR	;
511)   5FF2 3E 80       		  LD      A,80H           ;STRING MARKER	;STRING MARKER
512)   5FF4 C8          		  RET     Z	;
513)   5FF5 1C          		  INC     E	;
514)   5FF6 20 F5       		  JR      NZ,LOADS2	;
515)   5FF8 C9          		  RET                     ;RETURN NULL STRING	;RETURN NULL STRING
545)   5FF9 CD D3 70    		POS:  CALL    GETCSR	;
546)   5FFC EB          		  EX      DE,HL	;
547)   5FFD 18 75       		  JR      COUNT1	;
548)   5FFF CD D3 70    		VPOS:  CALL    GETCSR	;
549)   6002 18 70       		  JR      COUNT1	;
550)   6004 CD B7 57    		EOF:  CALL    CHANEL	;
551)   6007 CD 24 74    		  CALL    OSSTAT	;
552)   600A CA E1 60    		  JP      Z,TRUE	;
553)   600D C3 BE 63    		  JP      ZERO	;
554)   6010 CD B7 57    		BGET:  CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
555)   6013 CD F7 73    		  CALL    OSBGET	;
556)   6016 6F          		  LD      L,A	;
557)   6017 18 59       		  JR      COUNT0	;
558)   6019 CD 74 62    		INKEY:  CALL    INKEYS	;
559)   601C 18 19       		  JR      ASC0	;
560)   601E CD 78 64    		GET:  CALL    NXT	;
561)   6021 FE 28       		  CP      '('	;
562)   6023 20 0A       		  JR      NZ,GET0	;
563)   6025 CD AB 5E    		  CALL    ITEMI           ;PORT ADDRESS	;PORT ADDRESS
564)   6028 D9          		  EXX	;
565)   6029 44          		  LD      B,H	;
566)   602A 4D          		  LD      C,L	;
567)   602B ED 68       		  IN      L,(C)           ;INPUT FROM PORT BC	;INPUT FROM PORT BC
568)   602D 18 43       		  JR      COUNT0	;
569)   602F CD 6E 62    		GET0:  CALL    GETS	;
570)   6032 18 08       		  JR      ASC1	;
571)   6034 CD B4 5E    		ASC:  CALL    ITEMS	;
572)   6037 AF          		ASC0:  XOR     A	;
573)   6038 BB          		  CP      E	;
574)   6039 CA E1 60    		  JP      Z,TRUE          ;NULL STRING	;NULL STRING
575)   603C 2A 00 FB    		ASC1:  LD      HL,(ACCS)	;
576)   603F 18 31       		  JR      COUNT0	;
577)   6041 CD B4 5E    		LEN:  CALL    ITEMS	;
578)   6044 EB          		  EX      DE,HL	;
579)   6045 18 2B       		  JR      COUNT0	;
580)   6047 2A E0 FD    		LOMEMV:  LD      HL,(LOMEM)	;
581)   604A 18 28       		  JR      COUNT1	;
582)   604C 2A E4 FD    		HIMEMV:  LD      HL,(HIMEM)	;
583)   604F 18 23       		  JR      COUNT1	;
584)   6051 2A DC FD    		PAGEV:  LD      HL,(PAGE)	;
585)   6054 18 1E       		  JR      COUNT1	;
586)   6056 FD 7E 00    		TOPV:  LD      A,(IY)	;
587)   6059 FD 23       		  INC     IY              ;SKIP "P"	;SKIP "P"
588)   605B FE 50       		  CP      'P'	;
589)   605D C2 BF 4D    		  JP      NZ,SYNTAX       ;"Syntax Error"	;"Syntax Error"
590)   6060 2A DE FD    		  LD      HL,(TOP)	;
591)   6063 18 0F       		  JR      COUNT1	;
592)   6065 2A F2 FD    		ERLV:  LD      HL,(ERL)	;
593)   6068 18 0A       		  JR      COUNT1	;
594)   606A 2A FD FD    		ERRV:  LD      HL,(ERR)	;
595)   606D 18 03       		  JR      COUNT0	;
596)   606F 2A FB FD    		COUNTV:  LD      HL,(COUNT)	;
597)   6072 26 00       		COUNT0:  LD      H,0	;
598)   6074 D9          		COUNT1:  EXX	;
599)   6075 AF          		  XOR     A	;
600)   6076 4F          		  LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
601)   6077 67          		  LD      H,A	;
602)   6078 6F          		  LD      L,A	;
603)   6079 C9          		  RET	;
610)   607A AF          		OPENOT:  XOR     A	;
611)   607B 21          		  DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
612)   607C 3E 02       		OPENUP:  LD      A,2	;
613)   607E 21          		  DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
614)   607F 3E 01       		OPENIN:  LD      A,1	;
615)   6081 F5          		  PUSH    AF              ;SAVE OPEN TYPE	;SAVE OPEN TYPE
616)   6082 CD B4 5E    		  CALL    ITEMS           ;FILENAME	;FILENAME
617)   6085 3E 0D       		  LD      A,CR	;
618)   6087 12          		  LD      (DE),A	;
619)   6088 F1          		  POP     AF              ;RESTORE OPEN TYPE	;RESTORE OPEN TYPE
620)   6089 C6 FF       		  ADD     A,-1            ;AFFECT FLAGS	;AFFECT FLAGS
621)   608B 21 00 FB    		  LD      HL,ACCS	;
622)   608E CD C0 73    		  CALL    OSOPEN	;
623)   6091 6F          		  LD      L,A	;
624)   6092 18 DE       		  JR      COUNT0	;
630)   6094 CD B7 57    		EXT:  CALL    CHANEL	;
631)   6097 CD 1A 74    		  CALL    GETEXT	;
632)   609A 18 12       		  JR      TIME0	;
634)   609C CD B7 57    		PTR:  CALL    CHANEL	;
635)   609F CD 11 74    		  CALL    GETPTR	;
636)   60A2 18 0A       		  JR      TIME0	;
641)   60A4 FD 7E 00    		TIMEV:  LD      A,(IY)	;
642)   60A7 FE 24       		  CP      '$'	;
643)   60A9 28 09       		  JR      Z,TIMEVS	;
644)   60AB CD AA 70    		  CALL    GETIME	;
645)   60AE D5          		TIME0:  PUSH    DE	;
646)   60AF D9          		  EXX	;
647)   60B0 E1          		  POP     HL	;
648)   60B1 AF          		  XOR     A	;
649)   60B2 4F          		  LD      C,A	;
650)   60B3 C9          		  RET	;
655)   60B4 FD 23       		TIMEVS:  INC     IY              ;SKIP $	;SKIP $
656)   60B6 CD BA 74    		  CALL    GETIMS	;
657)   60B9 3E 80       		  LD      A,80H           ;MARK STRING	;MARK STRING
658)   60BB C9          		  RET	;
662)   60BC CD BB 63    		SLT:  CALL    SCP	;
663)   60BF D0          		  RET     NC	;
664)   60C0 18 1F       		  JR      TRUE	;
666)   60C2 CD BB 63    		SGT:  CALL    SCP	;
667)   60C5 C8          		  RET     Z	;
668)   60C6 D8          		  RET     C	;
669)   60C7 18 18       		  JR      TRUE	;
671)   60C9 CD BB 63    		SGE:  CALL    SCP	;
672)   60CC D8          		  RET     C	;
673)   60CD 18 12       		  JR      TRUE	;
675)   60CF CD BB 63    		SLE:  CALL    SCP	;
676)   60D2 28 0D       		  JR      Z,TRUE	;
677)   60D4 D0          		  RET     NC	;
678)   60D5 18 0A       		  JR      TRUE	;
680)   60D7 CD BB 63    		SNE:  CALL    SCP	;
681)   60DA C8          		  RET     Z	;
682)   60DB 18 04       		  JR      TRUE	;
684)   60DD CD BB 63    		SEQ:  CALL    SCP	;
685)   60E0 C0          		  RET     NZ	;
686)   60E1 3E FF       		TRUE:  LD      A,-1	;
687)   60E3 D9          		  EXX	;
688)   60E4 67          		  LD      H,A	;
689)   60E5 6F          		  LD      L,A	;
690)   60E6 D9          		  EXX	;
691)   60E7 67          		  LD      H,A	;
692)   60E8 6F          		  LD      L,A	;
693)   60E9 3C          		  INC     A	;
694)   60EA 4F          		  LD      C,A	;
695)   60EB C9          		  RET	;
700)   60EC 3E 23       		PI:  LD      A,35	;
701)   60EE 18 43       		  JR      FPP1	;
706)   60F0 3E 10       		ABS:  LD      A,16	;
707)   60F2 18 3A       		  JR      FPPN	;
712)   60F4 3E 1A       		NOTK:  LD      A,26	;
713)   60F6 18 36       		  JR      FPPN	;
718)   60F8 3E 15       		DEG:  LD      A,21	;
719)   60FA 18 32       		  JR      FPPN	;
724)   60FC 3E 1B       		RAD:  LD      A,27	;
725)   60FE 18 2E       		  JR      FPPN	;
730)   6100 3E 1C       		SGN:  LD      A,28	;
731)   6102 18 2A       		  JR      FPPN	;
736)   6104 3E 17       		INT:  LD      A,23	;
737)   6106 18 26       		  JR      FPPN	;
742)   6108 3E 1E       		SQR:  LD      A,30	;
743)   610A 18 22       		  JR      FPPN	;
748)   610C 3E 1F       		TAN:  LD      A,31	;
749)   610E 18 1E       		  JR      FPPN	;
754)   6110 3E 14       		COS:  LD      A,20	;
755)   6112 18 1A       		  JR      FPPN	;
760)   6114 3E 1D       		SIN:  LD      A,29	;
761)   6116 18 16       		  JR      FPPN	;
766)   6118 3E 16       		EXP:  LD      A,22	;
767)   611A 18 12       		  JR      FPPN	;
772)   611C 3E 18       		LN:  LD      A,24	;
773)   611E 18 0E       		  JR      FPPN	;
778)   6120 3E 19       		LOG:  LD      A,25	;
779)   6122 18 0A       		  JR      FPPN	;
784)   6124 3E 12       		ASN:  LD      A,18	;
785)   6126 18 06       		  JR      FPPN	;
790)   6128 3E 13       		ATN:  LD      A,19	;
791)   612A 18 02       		  JR      FPPN	;
796)   612C 3E 11       		ACS:  LD      A,17	;
797)   612E F5          		FPPN:  PUSH    AF	;
798)   612F CD A4 5E    		  CALL    ITEMN	;
799)   6132 F1          		  POP     AF	;
800)   6133 CD 9C 64    		FPP1:  CALL    FPP	;
801)   6136 DA DB 46    		  JP      C,ERROR	;
802)   6139 AF          		  XOR     A	;
803)   613A C9          		  RET	;
807)   613B 3E 26       		@SFIX:  LD      A,38	;
808)   613D 18 F4       		  JR      FPP1	;
812)   613F 3E 27       		SFLOAT:  LD      A,39	;
813)   6141 18 F0       		  JR      FPP1	;
818)   6143 CD B4 5E    		VAL:  CALL    ITEMS	;
819)   6146 AF          		@VAL0:  XOR     A	;
820)   6147 12          		  LD      (DE),A	;
821)   6148 DD 21 00 FB 		  LD      IX,ACCS	;
822)   614C 3E 24       		  LD      A,36	;
823)   614E 18 E3       		  JR      FPP1	;
828)   6150 CD B4 5E    		EVAL:  CALL    ITEMS	;
829)   6153 3E 0D       		  LD      A,CR	;
830)   6155 12          		  LD      (DE),A	;
831)   6156 FD E5       		  PUSH    IY	;
832)   6158 11 00 FB    		  LD      DE,ACCS	;
833)   615B FD 21 00 FB 		  LD      IY,ACCS	;
834)   615F 0E 00       		  LD      C,0	;
835)   6161 CD 55 4B    		  CALL    LEXAN2          ;TOKENISE	;TOKENISE
836)   6164 12          		  LD      (DE),A	;
837)   6165 13          		  INC     DE	;
838)   6166 AF          		  XOR     A	;
839)   6167 CD DF 63    		  CALL    PUSHS           ;PUT ON STACK	;PUT ON STACK
840)   616A FD 21 02 00 		  LD      IY,2	;
841)   616E FD 39       		  ADD     IY,SP	;
842)   6170 CD 84 5D    		  CALL    EXPR	;
843)   6173 FD E1       		  POP     IY	;
844)   6175 FD 39       		  ADD     IY,SP	;
845)   6177 FD F9       		  LD      SP,IY           ;ADJUST STACK POINTER	;ADJUST STACK POINTER
846)   6179 FD E1       		  POP     IY	;
847)   617B 08          		  EX      AF,AF'	;
848)   617C C9          		  RET	;
857)   617D DD 21 F6 FD 		RND:  LD      IX,RANDOM	;
858)   6181 CD 78 64    		  CALL    NXT	;
859)   6184 FE 28       		  CP      '('	;
860)   6186 28 1C       		  JR      Z,RND5          ;ARGUMENT FOLLOWS	;ARGUMENT FOLLOWS
861)   6188 CD 56 5F    		  CALL    LOAD5	;
862)   618B CB 19       		RND1:  RR      C	;
863)   618D 06 20       		  LD      B,32	;
864)   618F D9          		RND2:  EXX                     ;CALCULATE NEXT	;CALCULATE NEXT
865)   6190 ED 6A       		  ADC     HL,HL	;
866)   6192 D9          		  EXX	;
867)   6193 ED 6A       		  ADC     HL,HL	;
868)   6195 CB 5D       		  BIT     3,L	;
869)   6197 28 01       		  JR      Z,RND3	;
870)   6199 3F          		  CCF	;
871)   619A 10 F3       		RND3:  DJNZ    RND2	;
872)   619C CB 11       		RND4:  RL      C               ;SAVE CARRY	;SAVE CARRY
873)   619E CD 63 55    		  CALL    STORE5          ;STORE NEW NUMBER	;STORE NEW NUMBER
874)   61A1 AF          		  XOR     A	;
875)   61A2 4F          		  LD      C,A	;
876)   61A3 C9          		  RET	;
877)   61A4 CD AB 5E    		RND5:  CALL    ITEMI	;
878)   61A7 DD 21 F6 FD 		  LD      IX,RANDOM	;
879)   61AB CB 7C       		  BIT     7,H             ;NEGATIVE?	;NEGATIVE?
880)   61AD 37          		  SCF	;
881)   61AE 20 EC       		  JR      NZ,RND4         ;SEED	;SEED
882)   61B0 CD 1F 63    		  CALL    TEST	;
883)   61B3 F5          		  PUSH    AF	;
884)   61B4 CD 17 63    		  CALL    SWAP	;
885)   61B7 D9          		  EXX	;
886)   61B8 CD 56 5F    		  CALL    LOAD5	;
887)   61BB C4 8B 61    		  CALL    NZ,RND1         ;NEXT IF NON-ZERO	;NEXT IF NON-ZERO
888)   61BE D9          		  EXX                     ;SCRAMBLE (CARE!)	;SCRAMBLE (CARE!)
889)   61BF 0E 7F       		  LD      C,7FH	;
890)   61C1 CB 7C       		RND6:  BIT     7,H             ;FLOAT	;FLOAT
891)   61C3 20 08       		  JR      NZ,RND7	;
892)   61C5 D9          		  EXX	;
893)   61C6 29          		  ADD     HL,HL	;
894)   61C7 D9          		  EXX	;
895)   61C8 ED 6A       		  ADC     HL,HL	;
896)   61CA 0D          		  DEC     C	;
897)   61CB 20 F4       		  JR      NZ,RND6	;
898)   61CD CB BC       		RND7:  RES     7,H             ;POSITIVE 0-0.999999	;POSITIVE 0-0.999999
899)   61CF F1          		  POP     AF	;
900)   61D0 C8          		  RET     Z               ;ZERO ARGUMENT	;ZERO ARGUMENT
901)   61D1 D9          		  EXX	;
902)   61D2 7B          		  LD      A,E	;
903)   61D3 3D          		  DEC     A	;
904)   61D4 B2          		  OR      D	;
905)   61D5 D9          		  EXX	;
906)   61D6 B3          		  OR      E	;
907)   61D7 B2          		  OR      D	;
908)   61D8 C8          		  RET     Z               ;ARGUMENT=1	;ARGUMENT=1
909)   61D9 06 00       		  LD      B,0             ;INTEGER MARKER	;INTEGER MARKER
910)   61DB 3E 0A       		  LD      A,10	;
911)   61DD CD 9C 64    		  CALL    FPP             ;MULTIPLY	;MULTIPLY
912)   61E0 DA DB 46    		  JP      C,ERROR	;
913)   61E3 CD 3B 61    		  CALL    SFIX	;
914)   61E6 C3 06 5F    		  JP      ADD1	;
919)   61E9 CD 2D 64    		INSTR:  CALL    EXPRSC          ;STRING TO SEARCH	;STRING TO SEARCH
920)   61EC CD DF 63    		  CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
921)   61EF CD 9D 5E    		  CALL    EXPRS           ;SUB-STRING	;SUB-STRING
922)   61F2 C1          		  POP     BC	;
923)   61F3 21 00 00    		  LD      HL,0	;
924)   61F6 39          		  ADD     HL,SP           ;HL ADDRESSES MAIN	;HL ADDRESSES MAIN
925)   61F7 C5          		  PUSH    BC              ;C = MAIN STRING LENGTH	;C = MAIN STRING LENGTH
926)   61F8 43          		  LD      B,E             ;B = SUB-STRING LENGTH	;B = SUB-STRING LENGTH
927)   61F9 CD 78 64    		  CALL    NXT	;
928)   61FC FE 2C       		  CP      ','	;
929)   61FE 3E 00       		  LD      A,0	;
930)   6200 20 17       		  JR      NZ,INSTR1	;
931)   6202 FD 23       		  INC     IY              ;SKIP COMMA	;SKIP COMMA
932)   6204 C5          		  PUSH    BC              ;SAVE LENGTHS	;SAVE LENGTHS
933)   6205 E5          		  PUSH    HL              ;SAVE MAIN ADDRESS	;SAVE MAIN ADDRESS
934)   6206 CD DF 63    		  CALL    PUSHS	;
935)   6209 CD 94 5E    		  CALL    EXPRI	;
936)   620C C1          		  POP     BC	;
937)   620D CD FE 63    		  CALL    POPS	;
938)   6210 E1          		  POP     HL              ;RESTORE MAIN ADDRESS	;RESTORE MAIN ADDRESS
939)   6211 C1          		  POP     BC              ;RESTORE LENGTHS	;RESTORE LENGTHS
940)   6212 D9          		  EXX	;
941)   6213 7D          		  LD      A,L	;
942)   6214 D9          		  EXX	;
943)   6215 B7          		  OR      A	;
944)   6216 28 01       		  JR      Z,INSTR1	;
945)   6218 3D          		  DEC     A	;
946)   6219 11 00 FB    		INSTR1:  LD      DE,ACCS         ;DE ADDRESSES SUB	;DE ADDRESSES SUB
947)   621C CD 33 62    		  CALL    SEARCH	;
948)   621F D1          		  POP     DE	;
949)   6220 28 03       		  JR      Z,INSTR2        ;N.B. CARRY CLEARED	;N.B. CARRY CLEARED
950)   6222 ED 62       		  SBC     HL,HL	;
951)   6224 39          		  ADD     HL,SP	;
952)   6225 ED 72       		INSTR2:  SBC     HL,SP	;
953)   6227 EB          		  EX      DE,HL	;
954)   6228 26 00       		  LD      H,0	;
955)   622A 39          		  ADD     HL,SP	;
956)   622B F9          		  LD      SP,HL	;
957)   622C EB          		  EX      DE,HL	;
958)   622D CD 3C 64    		  CALL    BRAKET	;
959)   6230 C3 74 60    		  JP      COUNT1	;
969)   6233 C5          		@SEARCH: PUSH    BC	;
970)   6234 06 00       		  LD      B,0	;
971)   6236 4F          		  LD      C,A	;
972)   6237 09          		  ADD     HL,BC           ;NEW START ADDRESS	;NEW START ADDRESS
973)   6238 C1          		  POP     BC	;
974)   6239 91          		  SUB     C	;
975)   623A 30 28       		  JR      NC,SRCH4	;
976)   623C ED 44       		  NEG	;
977)   623E 4F          		  LD      C,A             ;REMAINING LENGTH	;REMAINING LENGTH
978)   623F 1A          		SRCH1:  LD      A,(DE)	;
979)   6240 C5          		  PUSH    BC	;
980)   6241 06 00       		  LD      B,0	;
981)   6243 ED B1       		  CPIR                    ;FIND FIRST CHARACTER	;FIND FIRST CHARACTER
982)   6245 79          		  LD      A,C	;
983)   6246 C1          		  POP     BC	;
984)   6247 20 1B       		  JR      NZ,SRCH4	;
985)   6249 4F          		  LD      C,A	;
986)   624A 05          		  DEC     B               ;Bug fix	;Bug fix
987)   624B B8          		  CP      B               ;Bug fix	;Bug fix
988)   624C 04          		  INC     B               ;Bug fix	;Bug fix
989)   624D 38 15       		  JR      C,SRCH4         ;Bug fix	;Bug fix
990)   624F C5          		  PUSH    BC	;
991)   6250 D5          		  PUSH    DE	;
992)   6251 E5          		  PUSH    HL	;
993)   6252 05          		  DEC     B	;
994)   6253 28 08       		  JR      Z,SRCH3         ;FOUND !	;FOUND !
995)   6255 13          		SRCH2:  INC     DE	;
996)   6256 1A          		  LD      A,(DE)	;
997)   6257 BE          		  CP      (HL)	;
998)   6258 20 03       		  JR      NZ,SRCH3	;
999)   625A 23          		  INC     HL	;
1000)   625B 10 F8       		  DJNZ    SRCH2	;
1001)   625D E1          		SRCH3:  POP     HL	;
1002)   625E D1          		  POP     DE	;
1003)   625F C1          		  POP     BC	;
1004)   6260 20 DD       		  JR      NZ,SRCH1	;
1005)   6262 AF          		  XOR     A               ;Z, NC	;Z, NC
1006)   6263 C9          		  RET                     ;FOUND	;FOUND
1008)   6264 F6 FF       		SRCH4:  OR      0FFH            ;NZ, NC	;NZ, NC
1009)   6266 C9          		  RET                     ;NOT FOUND	;NOT FOUND
1014)   6267 CD AB 5E    		CHRS:  CALL    ITEMI	;
1015)   626A D9          		  EXX	;
1016)   626B 7D          		  LD      A,L	;
1017)   626C 18 03       		  JR      GET1	;
1022)   626E CD E2 70    		GETS:  CALL    OSRDCH	;
1023)   6271 37          		GET1:  SCF	;
1024)   6272 18 07       		  JR      INKEY1	;
1031)   6274 CD AB 5E    		INKEYS:  CALL    ITEMI	;
1032)   6277 D9          		  EXX	;
1033)   6278 CD D7 72    		  CALL    OSKEY	;
1034)   627B 11 00 FB    		INKEY1:  LD      DE,ACCS	;
1035)   627E 12          		  LD      (DE),A	;
1036)   627F 3E 80       		  LD      A,80H	;
1037)   6281 D0          		  RET     NC	;
1038)   6282 1C          		  INC     E	;
1039)   6283 C9          		  RET	;
1044)   6284 CD 2D 64    		MIDS:  CALL    EXPRSC	;
1045)   6287 CD DF 63    		  CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1046)   628A CD 94 5E    		  CALL    EXPRI	;
1047)   628D C1          		  POP     BC	;
1048)   628E CD FE 63    		  CALL    POPS	;
1049)   6291 D9          		  EXX	;
1050)   6292 7D          		  LD      A,L	;
1051)   6293 D9          		  EXX	;
1052)   6294 B7          		  OR      A	;
1053)   6295 28 0D       		  JR      Z,MIDS1	;
1054)   6297 3D          		  DEC     A	;
1055)   6298 6F          		  LD      L,A	;
1056)   6299 93          		  SUB     E	;
1057)   629A 1E 00       		  LD      E,0	;
1058)   629C 30 06       		  JR      NC,MIDS1	;
1059)   629E ED 44       		  NEG	;
1060)   62A0 4F          		  LD      C,A	;
1061)   62A1 CD DB 62    		  CALL    RIGHT1	;
1062)   62A4 CD 78 64    		MIDS1:  CALL    NXT	;
1063)   62A7 FE 2C       		  CP      ','	;
1064)   62A9 FD 23       		  INC     IY	;
1065)   62AB 28 0B       		  JR      Z,LEFT1	;
1066)   62AD FD 2B       		  DEC     IY	;
1067)   62AF CD 3C 64    		  CALL    BRAKET	;
1068)   62B2 3E 80       		  LD      A,80H	;
1069)   62B4 C9          		  RET	;
1075)   62B5 CD 2D 64    		LEFTS:  CALL    EXPRSC	;
1076)   62B8 CD DF 63    		LEFT1:  CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1077)   62BB CD 94 5E    		  CALL    EXPRI	;
1078)   62BE C1          		  POP     BC	;
1079)   62BF CD FE 63    		  CALL    POPS	;
1080)   62C2 CD 3C 64    		  CALL    BRAKET	;
1081)   62C5 D9          		  EXX	;
1082)   62C6 7D          		  LD      A,L	;
1083)   62C7 D9          		  EXX	;
1084)   62C8 BB          		  CP      E	;
1085)   62C9 30 02       		  JR      NC,LEFT3	;
1086)   62CB 6B          		  LD      L,E             ;FOR RIGHTS	;FOR RIGHTS
1087)   62CC 5F          		LEFT2:  LD      E,A	;
1088)   62CD 3E 80       		LEFT3:  LD      A,80H           ;STRING MARKER	;STRING MARKER
1089)   62CF C9          		  RET	;
1094)   62D0 CD B5 62    		RIGHTS:  CALL    LEFTS	;
1095)   62D3 D0          		  RET     NC	;
1096)   62D4 1C          		  INC     E	;
1097)   62D5 1D          		  DEC     E	;
1098)   62D6 C8          		  RET     Z	;
1099)   62D7 4B          		  LD      C,E	;
1100)   62D8 7D          		  LD      A,L	;
1101)   62D9 93          		  SUB     E	;
1102)   62DA 6F          		  LD      L,A	;
1103)   62DB 06 00       		RIGHT1:  LD      B,0	;
1104)   62DD 62          		  LD      H,D	;
1105)   62DE 58          		  LD      E,B	;
1106)   62DF ED B0       		  LDIR                    ;MOVE	;MOVE
1107)   62E1 3E 80       		  LD      A,80H	;
1108)   62E3 C9          		  RET	;
1113)   62E4 CD 94 5E    		STRING:  CALL    EXPRI	;
1114)   62E7 CD 30 64    		  CALL    COMMA	;
1115)   62EA D9          		  EXX	;
1116)   62EB 7D          		  LD      A,L	;
1117)   62EC D9          		  EXX	;
1118)   62ED F5          		  PUSH    AF	;
1119)   62EE CD 9D 5E    		  CALL    EXPRS	;
1120)   62F1 CD 3C 64    		  CALL    BRAKET	;
1121)   62F4 F1          		  POP     AF	;
1122)   62F5 B7          		  OR      A	;
1123)   62F6 28 D4       		  JR      Z,LEFT2         ;N=0	;N=0
1124)   62F8 3D          		  DEC     A	;
1125)   62F9 4F          		  LD      C,A	;
1126)   62FA 3E 80       		  LD      A,80H           ;STRING MARKER	;STRING MARKER
1127)   62FC C8          		  RET     Z	;
1128)   62FD 1C          		  INC     E	;
1129)   62FE 1D          		  DEC     E	;
1130)   62FF C8          		  RET     Z               ;NULL STRING	;NULL STRING
1131)   6300 43          		  LD      B,E	;
1132)   6301 62          		  LD      H,D	;
1133)   6302 2E 00       		  LD      L,0	;
1134)   6304 C5          		STRIN1:  PUSH    BC	;
1135)   6305 7E          		STRIN2:  LD      A,(HL)	;
1136)   6306 23          		  INC     HL	;
1137)   6307 12          		  LD      (DE),A	;
1138)   6308 1C          		  INC     E	;
1139)   6309 3E 13       		  LD      A,19	;
1140)   630B CA DB 46    		  JP      Z,ERROR         ;"String too long"	;"String too long"
1141)   630E 10 F5       		  DJNZ    STRIN2	;
1142)   6310 C1          		  POP     BC	;
1143)   6311 0D          		  DEC     C	;
1144)   6312 20 F0       		  JR      NZ,STRIN1	;
1145)   6314 3E 80       		  LD      A,80H	;
1146)   6316 C9          		  RET	;
1154)   6317 79          		@SWAP:  LD      A,C	;
1155)   6318 48          		  LD      C,B	;
1156)   6319 47          		  LD      B,A	;
1157)   631A EB          		  EX      DE,HL	;
1158)   631B D9          		  EXX	;
1159)   631C EB          		  EX      DE,HL	;
1160)   631D D9          		  EXX	;
1161)   631E C9          		  RET	;
1167)   631F 7C          		@TEST:  LD      A,H	;
1168)   6320 B5          		  OR      L	;
1169)   6321 D9          		  EXX	;
1170)   6322 B4          		  OR      H	;
1171)   6323 B5          		  OR      L	;
1172)   6324 D9          		  EXX	;
1173)   6325 C9          		  RET	;
1180)   6326 D9          		@DECODE: EXX	;
1181)   6327 FD 7E 00    		  LD      A,(IY)	;
1182)   632A FD 23       		  INC     IY	;
1183)   632C 17          		  RLA	;
1184)   632D 17          		  RLA	;
1185)   632E 67          		  LD      H,A	;
1186)   632F E6 C0       		  AND     0C0H	;
1187)   6331 FD AE 00    		  XOR     (IY)	;
1188)   6334 FD 23       		  INC     IY	;
1189)   6336 6F          		  LD      L,A	;
1190)   6337 7C          		  LD      A,H	;
1191)   6338 17          		  RLA	;
1192)   6339 17          		  RLA	;
1193)   633A E6 C0       		  AND     0C0H	;
1194)   633C FD AE 00    		  XOR     (IY)	;
1195)   633F FD 23       		  INC     IY	;
1196)   6341 67          		  LD      H,A	;
1197)   6342 D9          		  EXX	;
1198)   6343 AF          		  XOR     A	;
1199)   6344 4F          		  LD      C,A	;
1200)   6345 67          		  LD      H,A	;
1201)   6346 6F          		  LD      L,A	;
1202)   6347 C9          		  RET	;
1209)   6348 FD 23       		HEXSTS:  INC     IY              ;SKIP TILDE	;SKIP TILDE
1210)   634A CD A4 5E    		  CALL    ITEMN	;
1211)   634D CD 53 63    		  CALL    HEXSTR	;
1212)   6350 3E 80       		  LD      A,80H	;
1213)   6352 C9          		  RET	;
1215)   6353 CD 3B 61    		@HEXSTR: CALL    SFIX	;
1216)   6356 01 08 00    		  LD      BC,8	;
1217)   6359 11 00 FB    		  LD      DE,ACCS	;
1218)   635C C5          		HEXST1:  PUSH    BC	;
1219)   635D 06 04       		  LD      B,4	;
1220)   635F AF          		  XOR     A	;
1221)   6360 D9          		HEXST2:  EXX	;
1222)   6361 29          		  ADD     HL,HL	;
1223)   6362 D9          		  EXX	;
1224)   6363 ED 6A       		  ADC     HL,HL	;
1225)   6365 17          		  RLA	;
1226)   6366 10 F8       		  DJNZ    HEXST2	;
1227)   6368 C1          		  POP     BC	;
1228)   6369 0D          		  DEC     C	;
1229)   636A F8          		  RET     M	;
1230)   636B 28 06       		  JR      Z,HEXST3	;
1231)   636D B7          		  OR      A	;
1232)   636E 20 03       		  JR      NZ,HEXST3	;
1233)   6370 B8          		  CP      B	;
1234)   6371 28 E9       		  JR      Z,HEXST1	;
1235)   6373 C6 90       		HEXST3:  ADD     A,90H	;
1236)   6375 27          		  DAA	;
1237)   6376 CE 40       		  ADC     A,40H	;
1238)   6378 27          		  DAA	;
1239)   6379 12          		  LD      (DE),A	;
1240)   637A 13          		  INC     DE	;
1241)   637B 47          		  LD      B,A	;
1242)   637C 18 DE       		  JR      HEXST1	;
1252)   637E CD 78 64    		STRS:  CALL    NXT	;
1253)   6381 FE 7E       		  CP      '~'	;
1254)   6383 28 C3       		  JR      Z,HEXSTS	;
1255)   6385 CD A4 5E    		  CALL    ITEMN	;
1256)   6388 DD 21 00 FD 		  LD      IX,STAVAR	;
1257)   638C DD 7E 03    		  LD      A,(IX+3)	;
1258)   638F B7          		  OR      A	;
1259)   6390 DD 21 B8 63 		  LD      IX,G9-1         ;G9 FORMAT	;G9 FORMAT
1260)   6394 28 04       		  JR      Z,STR0	;
1261)   6396 DD 21 00 FD 		@STR:  LD      IX,STAVAR	;
1262)   639A 11 00 FB    		STR0:  LD      DE,ACCS	;
1263)   639D 3E 25       		  LD      A,37	;
1264)   639F CD 9C 64    		  CALL    FPP	;
1265)   63A2 DA DB 46    		  JP      C,ERROR	;
1266)   63A5 DD CB 02 46 		  BIT     0,(IX+2)	;
1267)   63A9 3E 80       		STR1:  LD      A,80H           ;STRING MARKER	;STRING MARKER
1268)   63AB C8          		  RET     Z	;
1269)   63AC 79          		  LD      A,C	;
1270)   63AD C6 04       		  ADD     A,4	;
1271)   63AF BB          		STR2:  CP      E	;
1272)   63B0 28 F7       		  JR      Z,STR1	;
1273)   63B2 EB          		  EX      DE,HL 	;
1274)   63B3 36 20       		  LD      (HL),' '        ;TRAILING SPACE	;TRAILING SPACE
1275)   63B5 23          		  INC     HL	;
1276)   63B6 EB          		  EX      DE,HL	;
1277)   63B7 18 F6       		  JR      STR2	;
1279)   63B9 09 00       		G9:  DEFW    9	;
1285)   63BB CD C8 63    		SCP:  CALL    SCP0	;
1286)   63BE 3E 00       		@ZERO:  LD      A,0	;
1287)   63C0 D9          		  EXX	;
1288)   63C1 67          		  LD      H,A	;
1289)   63C2 6F          		  LD      L,A	;
1290)   63C3 D9          		  EXX	;
1291)   63C4 67          		  LD      H,A	;
1292)   63C5 6F          		  LD      L,A	;
1293)   63C6 4F          		  LD      C,A	;
1294)   63C7 C9          		  RET	;
1296)   63C8 04          		SCP0:  INC     B	;
1297)   63C9 0C          		  INC     C	;
1298)   63CA 05          		SCP1:  DEC     B	;
1299)   63CB 28 0A       		  JR      Z,SCP2	;
1300)   63CD 0D          		  DEC     C	;
1301)   63CE 28 0C       		  JR      Z,SCP3	;
1302)   63D0 1A          		  LD      A,(DE)	;
1303)   63D1 BE          		  CP      (HL)	;
1304)   63D2 C0          		  RET     NZ	;
1305)   63D3 13          		  INC     DE	;
1306)   63D4 23          		  INC     HL	;
1307)   63D5 18 F3       		  JR      SCP1	;
1308)   63D7 B7          		SCP2:  OR      A	;
1309)   63D8 0D          		   DEC     C	;
1310)   63D9 C8          		  RET     Z	;
1311)   63DA 37          		  SCF	;
1312)   63DB C9          		  RET	;
1313)   63DC B7          		SCP3:  OR      A	;
1314)   63DD 0C          		  INC     C	;
1315)   63DE C9          		  RET	;
1323)   63DF CD BF 55    		@PUSHS:  CALL    CHECK	;
1324)   63E2 DD E1       		  POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1325)   63E4 B7          		  OR      A               ;CLEAR CARRY	;CLEAR CARRY
1326)   63E5 21 00 FB    		  LD      HL,ACCS	;
1327)   63E8 54          		  LD      D,H	;
1328)   63E9 45          		  LD      B,L             ;B=0	;B=0
1329)   63EA ED 52       		  SBC     HL,DE	;
1330)   63EC 39          		  ADD     HL,SP	;
1331)   63ED F9          		  LD      SP,HL	;
1332)   63EE 57          		  LD      D,A	;
1333)   63EF D5          		  PUSH    DE	;
1334)   63F0 28 0A       		  JR      Z,PUSHS1        ;ZERO LENGTH	;ZERO LENGTH
1335)   63F2 4B          		  LD      C,E	;
1336)   63F3 11 00 FB    		  LD      DE,ACCS	;
1337)   63F6 EB          		  EX      DE,HL	;
1338)   63F7 ED B0       		  LDIR                    ;COPY TO STACK	;COPY TO STACK
1339)   63F9 CD BF 55    		  CALL    CHECK	;
1340)   63FC DD E9       		PUSHS1:  JP      (IX)            ;"RETURN"	;"RETURN"
1348)   63FE DD E1       		@POPS:  POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1349)   6400 21 00 00    		  LD      HL,0	;
1350)   6403 44          		  LD      B,H             ;B=0	;B=0
1351)   6404 39          		  ADD     HL,SP	;
1352)   6405 11 00 FB    		  LD      DE,ACCS	;
1353)   6408 0C          		  INC     C	;
1354)   6409 0D          		  DEC     C	;
1355)   640A 28 02       		  JR      Z,POPS1         ;ZERO LENGTH	;ZERO LENGTH
1356)   640C ED B0       		  LDIR                    ;COPY FROM STACK	;COPY FROM STACK
1357)   640E F9          		POPS1:  LD      SP,HL	;
1358)   640F DD E9       		  JP      (IX)            ;"RETURN"	;"RETURN"
1360)   6411 FD 7E 00    		HEXDIG:  LD      A,(IY)	;
1361)   6414 FE 30       		  CP      '0'	;
1362)   6416 D8          		  RET     C	;
1363)   6417 FE 3A       		  CP      '9'+1	;
1364)   6419 3F          		  CCF	;
1365)   641A D0          		  RET     NC	;
1366)   641B FE 41       		  CP      'A'	;
1367)   641D D8          		  RET     C	;
1368)   641E D6 37       		  SUB     'A'-10	;
1369)   6420 FE 10       		  CP      16	;
1370)   6422 3F          		  CCF	;
1371)   6423 C9          		  RET	;
1373)   6424 FE 3E       		RELOP?:  CP      '>'	;
1374)   6426 D0          		  RET     NC	;
1375)   6427 FE 3D       		  CP      '='	;
1376)   6429 D0          		  RET     NC	;
1377)   642A FE 3C       		  CP      '<'	;
1378)   642C C9          		  RET	;
1380)   642D CD 9D 5E    		EXPRSC:  CALL    EXPRS	;
1381)   6430 CD 78 64    		@COMMA:  CALL    NXT	;
1382)   6433 FD 23       		  INC     IY	;
1383)   6435 FE 2C       		  CP      ','	;
1384)   6437 C8          		  RET     Z	;
1385)   6438 3E 05       		  LD      A,5	;
1386)   643A 18 0A       		  JR      ERROR1          ;"Missing ,"	;"Missing ,"
1388)   643C CD 78 64    		@BRAKET: CALL    NXT	;
1389)   643F FD 23       		  INC     IY	;
1390)   6441 FE 29       		  CP      ')'	;
1391)   6443 C8          		  RET     Z	;
1392)   6444 3E 1B       		  LD      A,27	;
1393)   6446 C3 DB 46    		ERROR1:  JP      ERROR           ;"Missing )"	;"Missing )"
1395)   6449 FD 23       		SAVE:  INC     IY	;
1396)   644B 08          		SAVE1:  EX      AF,AF'	;
1397)   644C FA B9 5E    		  JP      M,TYPE	;
1398)   644F 08          		  EX      AF,AF'	;
1399)   6450 E3          		  EX      (SP),HL	;
1400)   6451 D9          		  EXX	;
1401)   6452 E5          		  PUSH    HL	;
1402)   6453 D9          		  EXX	;
1403)   6454 F5          		  PUSH    AF	;
1404)   6455 C5          		  PUSH    BC	;
1405)   6456 E9          		  JP      (HL)	;
1407)   6457 08          		DOIT:  EX      AF,AF'	;
1408)   6458 FA B9 5E    		  JP      M,TYPE	;
1409)   645B D9          		  EXX	;
1410)   645C C1          		  POP     BC              ;RETURN ADDRESS	;RETURN ADDRESS
1411)   645D D9          		  EXX	;
1412)   645E 79          		  LD      A,C	;
1413)   645F C1          		  POP     BC	;
1414)   6460 47          		  LD      B,A	;
1415)   6461 F1          		  POP     AF              ;OPERATOR	;OPERATOR
1416)   6462 D9          		  EXX	;
1417)   6463 EB          		  EX      DE,HL	;
1418)   6464 E1          		  POP     HL	;
1419)   6465 D9          		  EXX	;
1420)   6466 EB          		  EX      DE,HL	;
1421)   6467 E1          		  POP     HL	;
1422)   6468 D9          		  EXX	;
1423)   6469 C5          		  PUSH    BC	;
1424)   646A D9          		  EXX	;
1425)   646B E6 0F       		  AND     0FH	;
1426)   646D CD 9C 64    		  CALL    FPP	;
1427)   6470 38 D4       		  JR      C,ERROR1	;
1428)   6472 AF          		  XOR     A	;
1429)   6473 08          		  EX      AF,AF'          ;TYPE	;TYPE
1430)   6474 FD 7E 00    		  LD      A,(IY)	;
1431)   6477 C9          		  RET	;
1433)   6478 FD 7E 00    		@NXT:  LD      A,(IY)	;
1434)   647B FE 20       		  CP      ' '	;
1435)   647D C0          		  RET     NZ	;
1436)   647E FD 23       		  INC     IY	;
1437)   6480 C3 78 64    		  JP      NXT	;
1439)   6483 E5          		DISPT2:  PUSH    HL	;
1440)   6484 21 78 5D    		  LD      HL,SOPTBL	;
1441)   6487 18 06       		  JR      DISPT0	;
1443)   6489 E5          		DISPAT:  PUSH    HL	;
1444)   648A D6 8D       		  SUB     FUNTOK	;
1445)   648C 21 06 5D    		  LD      HL,FUNTBL	;
1446)   648F C5          		DISPT0:  PUSH    BC	;
1447)   6490 87          		  ADD     A,A	;
1448)   6491 4F          		  LD      C,A	;
1449)   6492 06 00       		  LD      B,0	;
1450)   6494 09          		  ADD     HL,BC	;
1451)   6495 7E          		  LD      A,(HL)	;
1452)   6496 23          		  INC     HL	;
1453)   6497 66          		  LD      H,(HL)	;
1454)   6498 6F          		  LD      L,A	;
1455)   6499 C1          		  POP     BC	;
1456)   649A E3          		  EX      (SP),HL	;
1457)   649B C9          		  RET                     ;OFF TO ROUTINE	;OFF TO ROUTINE
 36)   649C FD E5       		@FPP:  PUSH    IY              ;Save IY	;Save IY
 37)   649E FD 21 00 00 		         LD      IY,0	;
 38)   64A2 FD 39       		         ADD     IY,SP           ;Save SP in IY	;Save SP in IY
 39)   64A4 CD B3 64    		         CALL    OP              ;Perform operation	;Perform operation
 40)   64A7 BF          		         CP      A               ;Good return (Z, NC)	;Good return (Z, NC)
 41)   64A8 FD E1       		EXIT:  POP     IY              ;Restore IY	;Restore IY
 42)   64AA C9          		         RET                     ;Return to caller	;Return to caller
 46)   64AB 3E 01       		BAD:  LD      A,BADOP         ;"Bad operation code"	;"Bad operation code"
 47)   64AD FD F9       		ERROR:  LD      SP,IY           ;Restore SP from IY	;Restore SP from IY
 48)   64AF B7          		         OR      A               ;Set NZ	;Set NZ
 49)   64B0 37          		         SCF                     ;Set C	;Set C
 50)   64B1 18 F5       		         JR      EXIT	;
 54)   64B3 FE 2A       		OP:  CP      (RTABLE-DTABLE)/2	;
 55)   64B5 30 F4       		         JR      NC,BAD	;
 56)   64B7 FE 10       		         CP      (FTABLE-DTABLE)/2	;
 57)   64B9 30 07       		         JR      NC,DISPAT	;
 58)   64BB 08          		         EX      AF,AF'	;
 59)   64BC 78          		         LD      A,B	;
 60)   64BD B1          		         OR      C               ;Both integer?	;Both integer?
 61)   64BE C4 3D 6E    		         CALL    NZ,FLOATA       ;No, so float both	;No, so float both
 62)   64C1 08          		         EX      AF,AF'	;
 63)   64C2 E5          		DISPAT:  PUSH    HL	;
 64)   64C3 21 D3 64    		         LD      HL,DTABLE	;
 65)   64C6 C5          		         PUSH    BC	;
 66)   64C7 87          		         ADD     A,A             ;A = op-code * 2	;A = op-code * 2
 67)   64C8 4F          		         LD      C,A	;
 68)   64C9 06 00       		         LD      B,0             ;BC = op-code * 2	;BC = op-code * 2
 69)   64CB 09          		         ADD     HL,BC	;
 70)   64CC 7E          		         LD      A,(HL)          ;Get low byte	;Get low byte
 71)   64CD 23          		         INC     HL	;
 72)   64CE 66          		         LD      H,(HL)          ;Get high byte	;Get high byte
 73)   64CF 6F          		         LD      L,A	;
 74)   64D0 C1          		         POP     BC	;
 75)   64D1 E3          		         EX      (SP),HL	;
 76)   64D2 C9          		         RET                     ;Off to routine	;Off to routine
 80)   64D3 4A 65       		DTABLE:  DEFW    IAND            ;AND (INTEGER)	;AND (INTEGER)
 81)   64D5 AD 65       		         DEFW    IBDIV           ;DIV	;DIV
 82)   64D7 5C 65       		         DEFW    IEOR            ;EOR	;EOR
 83)   64D9 80 65       		         DEFW    IMOD            ;MOD	;MOD
 84)   64DB 6E 65       		         DEFW    IOR             ;OR	;OR
 85)   64DD DC 67       		         DEFW    ILE             ;<=	;<=
 86)   64DF E9 67       		         DEFW    INE             ;<>	;<>
 87)   64E1 D1 67       		         DEFW    IGE             ;>=	;>=
 88)   64E3 BA 67       		         DEFW    ILT             ;<	;<
 89)   64E5 F4 67       		         DEFW    IEQ             ;=	;=
 90)   64E7 77 66       		         DEFW    IMUL            ;*	;*
 91)   64E9 D0 65       		         DEFW    IADD            ;+	;+
 92)   64EB C5 67       		         DEFW    IGT             ;>	;>
 93)   64ED BA 65       		         DEFW    ISUB            ;-	;-
 94)   64EF 15 67       		         DEFW    IPOW            ;^	;^
 95)   64F1 2F 66       		         DEFW    IDIV            ;/	;/
 97)   64F3 03 68       		FTABLE:  DEFW    ABS             ;ABS	;ABS
 98)   64F5 5F 6B       		         DEFW    ACS             ;ACS	;ACS
 99)   64F7 BB 6A       		         DEFW    ASN             ;ASN	;ASN
100)   64F9 E0 6A       		         DEFW    ATN             ;ATN	;ATN
101)   64FB F9 68       		         DEFW    COS             ;COS	;COS
102)   64FD 2D 68       		         DEFW    DEG             ;DEG	;DEG
103)   64FF 9E 69       		         DEFW    EXP             ;EXP	;EXP
104)   6501 73 68       		         DEFW    INT             ;INT	;INT
105)   6503 29 6A       		         DEFW    LN              ;LN	;LN
106)   6505 A9 6A       		         DEFW    LOG             ;LOG	;LOG
107)   6507 0E 68       		         DEFW    NOTK            ;NOT	;NOT
108)   6509 35 68       		         DEFW    RAD             ;RAD	;RAD
109)   650B 4B 68       		         DEFW    SGN             ;SGN	;SGN
110)   650D 04 69       		         DEFW    SIN             ;SIN	;SIN
111)   650F 89 68       		         DEFW    SQR             ;SQR	;SQR
112)   6511 DC 68       		         DEFW    TAN             ;TAN	;TAN
114)   6513 B9 6E       		         DEFW    ZERO            ;ZERO	;ZERO
115)   6515 7D 69       		         DEFW    FONE            ;FONE	;FONE
116)   6517 F8 67       		         DEFW    TRUE            ;TRUE	;TRUE
117)   6519 21 68       		         DEFW    PI              ;PI	;PI
119)   651B 5B 68       		         DEFW    VAL             ;VAL	;VAL
120)   651D 67 6B       		         DEFW    STR             ;STR$	;STR$
122)   651F 8E 6D       		         DEFW    SFIX            ;FIX	;FIX
123)   6521 4A 6E       		         DEFW    SFLOAT          ;FLOAT	;FLOAT
125)   6523 8F 6E       		         DEFW    FTEST           ;TEST	;TEST
126)   6525 A0 6E       		         DEFW    FCOMP           ;COMPARE	;COMPARE
128)   6527 47 65       		RTABLE:  DEFW    FAND            ;AND (FLOATING-POINT)	;AND (FLOATING-POINT)
129)   6529 AA 65       		         DEFW    FBDIV           ;DIV	;DIV
130)   652B 59 65       		         DEFW    FEOR            ;EOR	;EOR
131)   652D 7D 65       		         DEFW    FMOD            ;MOD	;MOD
132)   652F 6B 65       		         DEFW    FOR             ;OR	;OR
133)   6531 D7 67       		         DEFW    FLE             ;<= 	;<=
134)   6533 E4 67       		         DEFW    FNE             ;<>	;<>
135)   6535 CC 67       		         DEFW    FGE             ;>=	;>=
136)   6537 B5 67       		         DEFW    FLT             ;<	;<
137)   6539 EF 67       		         DEFW    FEQ             ;=	;=
138)   653B C5 66       		         DEFW    FMUL            ;*	;*
139)   653D DA 65       		         DEFW    FADD            ;+	;+
140)   653F C0 67       		         DEFW    FGT             ;>	;>
141)   6541 C4 65       		         DEFW    FSUB            ;-	;-
142)   6543 8B 67       		         DEFW    FPOW            ;^	;^
143)   6545 32 66       		         DEFW    FDIV            ;/	;/
156)   6547 CD 85 6D    		FAND:  CALL    FIX2	;
157)   654A 7C          		IAND:  LD      A,H	;
158)   654B A2          		         AND     D	;
159)   654C 67          		         LD      H,A	;
160)   654D 7D          		         LD      A,L	;
161)   654E A3          		         AND     E	;
162)   654F 6F          		         LD      L,A	;
163)   6550 D9          		         EXX	;
164)   6551 7C          		         LD      A,H	;
165)   6552 A2          		         AND     D	;
166)   6553 67          		         LD      H,A	;
167)   6554 7D          		         LD      A,L	;
168)   6555 A3          		         AND     E	;
169)   6556 6F          		         LD      L,A	;
170)   6557 D9          		         EXX	;
171)   6558 C9          		         RET	;
176)   6559 CD 85 6D    		FEOR:  CALL    FIX2	;
177)   655C 7C          		IEOR:  LD      A,H	;
178)   655D AA          		         XOR     D	;
179)   655E 67          		         LD      H,A	;
180)   655F 7D          		         LD      A,L	;
181)   6560 AB          		         XOR     E	;
182)   6561 6F          		         LD      L,A	;
183)   6562 D9          		         EXX	;
184)   6563 7C          		         LD      A,H	;
185)   6564 AA          		         XOR     D	;
186)   6565 67          		         LD      H,A	;
187)   6566 7D          		         LD      A,L	;
188)   6567 AB          		         XOR     E	;
189)   6568 6F          		         LD      L,A	;
190)   6569 D9          		         EXX	;
191)   656A C9          		         RET	;
196)   656B CD 85 6D    		FOR:  CALL    FIX2	;
197)   656E 7C          		IOR:  LD      A,H	;
198)   656F B2          		         OR      D	;
199)   6570 67          		         LD      H,A	;
200)   6571 7D          		         LD      A,L	;
201)   6572 B3          		         OR      E	;
202)   6573 6F          		         LD      L,A	;
203)   6574 D9          		         EXX	;
204)   6575 7C          		         LD      A,H	;
205)   6576 B2          		         OR      D	;
206)   6577 67          		         LD      H,A	;
207)   6578 7D          		         LD      A,L	;
208)   6579 B3          		         OR      E	;
209)   657A 6F          		         LD      L,A	;
210)   657B D9          		         EXX	;
211)   657C C9          		         RET	;
216)   657D CD 85 6D    		FMOD:  CALL    FIX2	;
217)   6580 7C          		IMOD:  LD      A,H	;
218)   6581 AA          		         XOR     D               ;DIV RESULT SIGN	;DIV RESULT SIGN
219)   6582 CB 7C       		         BIT     7,H	;
220)   6584 08          		         EX      AF,AF'	;
221)   6585 CB 7C       		         BIT     7,H	;
222)   6587 C4 9D 6D    		         CALL    NZ,NEGATE       ;MAKE ARGUMENTS +VE	;MAKE ARGUMENTS +VE
223)   658A CD 74 6E    		         CALL    SWAP	;
224)   658D CB 7C       		         BIT     7,H	;
225)   658F C4 9D 6D    		         CALL    NZ,NEGATE	;
226)   6592 44          		         LD      B,H	;
227)   6593 4D          		         LD      C,L	;
228)   6594 21 00 00    		         LD      HL,0	;
229)   6597 D9          		         EXX	;
230)   6598 44          		         LD      B,H	;
231)   6599 4D          		         LD      C,L	;
232)   659A 21 00 00    		         LD      HL,0	;
233)   659D 3E DF       		         LD      A,-33	;
234)   659F CD C9 6F    		         CALL    DIVA            ;DIVIDE	;DIVIDE
235)   65A2 D9          		         EXX	;
236)   65A3 0E 00       		         LD      C,0             ;INTEGER MARKER	;INTEGER MARKER
237)   65A5 08          		         EX      AF,AF'	;
238)   65A6 C8          		         RET     Z	;
239)   65A7 C3 9D 6D    		         JP      NEGATE	;
243)   65AA CD 85 6D    		FBDIV:  CALL    FIX2	;
244)   65AD CD 80 65    		IBDIV:  CALL    IMOD	;
245)   65B0 B7          		         OR      A	;
246)   65B1 CD 74 6E    		         CALL    SWAP	;
247)   65B4 0E 00       		         LD      C,0	;
248)   65B6 F0          		         RET     P	;
249)   65B7 C3 9D 6D    		         JP      NEGATE	;
254)   65BA CD FC 6E    		ISUB:  CALL    SUB	;
255)   65BD E0          		         RET     PO	;
256)   65BE CD F6 6E    		         CALL    ADD	;
257)   65C1 CD 41 6E    		         CALL    FLOAT2	;
258)   65C4 7A          		FSUB:  LD      A,D	;
259)   65C5 EE 80       		         XOR     80H             ;CHANGE SIGN THEN ADD	;CHANGE SIGN THEN ADD
260)   65C7 57          		         LD      D,A	;
261)   65C8 18 10       		         JR      FADD	;
265)   65CA 7C          		RSUB:  LD      A,H	;
266)   65CB EE 80       		         XOR     80H	;
267)   65CD 67          		         LD      H,A	;
268)   65CE 18 0A       		         JR      FADD	;
273)   65D0 CD F6 6E    		IADD:  CALL    ADD	;
274)   65D3 E0          		         RET     PO	;
275)   65D4 CD FC 6E    		         CALL    SUB	;
276)   65D7 CD 41 6E    		         CALL    FLOAT2	;
277)   65DA 05          		FADD:  DEC     B	;
278)   65DB 04          		         INC     B	;
279)   65DC C8          		         RET     Z               ;ARG 2 ZERO	;ARG 2 ZERO
280)   65DD 0D          		         DEC     C	;
281)   65DE 0C          		         INC     C	;
282)   65DF CA 74 6E    		         JP      Z,SWAP          ;ARG 1 ZERO	;ARG 1 ZERO
283)   65E2 D9          		         EXX	;
284)   65E3 01 00 00    		         LD      BC,0            ;INITIALISE	;INITIALISE
285)   65E6 D9          		         EXX	;
286)   65E7 7C          		         LD      A,H	;
287)   65E8 AA          		         XOR     D               ;XOR SIGNS	;XOR SIGNS
288)   65E9 F5          		         PUSH    AF	;
289)   65EA 78          		         LD      A,B	;
290)   65EB B9          		         CP      C               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
291)   65EC DC 74 6E    		         CALL    C,SWAP          ;MAKE DED'E'B LARGEST	;MAKE DED'E'B LARGEST
292)   65EF 78          		         LD      A,B	;
293)   65F0 CB FC       		         SET     7,H             ;IMPLIED 1	;IMPLIED 1
294)   65F2 C4 75 6D    		         CALL    NZ,FIX          ;ALIGN	;ALIGN
295)   65F5 F1          		         POP     AF	;
296)   65F6 7A          		         LD      A,D             ;SIGN OF LARGER	;SIGN OF LARGER
297)   65F7 CB FA       		         SET     7,D             ;IMPLIED 1	;IMPLIED 1
298)   65F9 FA 06 66    		         JP      M,FADD3         ;SIGNS DIFFERENT	;SIGNS DIFFERENT
299)   65FC CD F6 6E    		         CALL    ADD             ;HLH'L'=HLH'L'+DED'E'	;HLH'L'=HLH'L'+DED'E'
300)   65FF DC 7C 6E    		         CALL    C,DIV2          ;NORMALISE	;NORMALISE
301)   6602 CB FC       		         SET     7,H	;
302)   6604 18 0A       		         JR      FADD4	;
304)   6606 CD FC 6E    		FADD3:  CALL    SUB             ;HLH'L'=HLH'L'-DED'E'	;HLH'L'=HLH'L'-DED'E'
305)   6609 DC B1 6D    		         CALL    C,NEG           ;NEGATE HLH'L'B'C'	;NEGATE HLH'L'B'C'
306)   660C CD 1E 6E    		         CALL    FLO48	;
307)   660F 2F          		         CPL                     ;CHANGE RESULT SIGN	;CHANGE RESULT SIGN
308)   6610 D9          		FADD4:  EXX	;
309)   6611 EB          		         EX      DE,HL	;
310)   6612 21 00 80    		         LD      HL,8000H	;
311)   6615 B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
312)   6616 ED 42       		         SBC     HL,BC	;
313)   6618 EB          		         EX      DE,HL	;
314)   6619 D9          		         EXX	;
315)   661A CC 6E 6E    		         CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
316)   661D DC 60 6E    		         CALL    C,ADD1          ;ROUND UP	;ROUND UP
317)   6620 DC 88 6E    		         CALL    C,INCC	;
318)   6623 CB BC       		         RES     7,H	;
319)   6625 0D          		         DEC     C	;
320)   6626 0C          		         INC     C	;
321)   6627 CA B9 6E    		         JP      Z,ZERO	;
322)   662A B7          		         OR      A               ;RESULT SIGNQ	;RESULT SIGNQ
323)   662B F0          		         RET     P               ;POSITIVE	;POSITIVE
324)   662C CB FC       		         SET     7,H             ;NEGATIVE	;NEGATIVE
325)   662E C9          		         RET	;
330)   662F CD 41 6E    		IDIV:  CALL    FLOAT2	;
331)   6632 05          		FDIV:  DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
332)   6633 04          		         INC     B	;
333)   6634 3E 12       		         LD      A,DIVBY0	;
334)   6636 CA AD 64    		         JP      Z,ERROR         ;"Division by zero"	;"Division by zero"
335)   6639 0D          		         DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
336)   663A 0C          		         INC     C	;
337)   663B C8          		         RET     Z	;
338)   663C 7C          		         LD      A,H	;
339)   663D AA          		         XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
340)   663E 08          		         EX      AF,AF'          ;SAVE SIGN	;SAVE SIGN
341)   663F CB FA       		         SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
342)   6641 CB FC       		         SET     7,H	;
343)   6643 C5          		         PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
344)   6644 42          		         LD      B,D             ;LOAD REGISTERS	;LOAD REGISTERS
345)   6645 4B          		         LD      C,E	;
346)   6646 11 00 00    		         LD      DE,0	;
347)   6649 D9          		         EXX	;
348)   664A 42          		         LD      B,D	;
349)   664B 4B          		         LD      C,E	;
350)   664C 11 00 00    		         LD      DE,0	;
351)   664F 3E E0       		         LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
352)   6651 CD C9 6F    		         CALL    DIVA            ;DIVIDE	;DIVIDE
353)   6654 D9          		         EXX	;
354)   6655 CB 7A       		         BIT     7,D	;
355)   6657 D9          		         EXX	;
356)   6658 CC E4 6F    		         CALL    Z,DIVB          ;NORMALISE & INC A	;NORMALISE & INC A
357)   665B EB          		         EX      DE,HL	;
358)   665C D9          		         EXX	;
359)   665D CB 38       		         SRL     B               ;DIVISOR/2	;DIVISOR/2
360)   665F CB 19       		         RR      C	;
361)   6661 B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
362)   6662 ED 42       		         SBC     HL,BC           ;REMAINDER-DIVISOR/2	;REMAINDER-DIVISOR/2
363)   6664 3F          		         CCF	;
364)   6665 EB          		         EX      DE,HL           ;RESULT IN HLH'L'	;RESULT IN HLH'L'
365)   6666 CC 6E 6E    		         CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
366)   6669 DC 60 6E    		         CALL    C,ADD1          ;ROUND UP	;ROUND UP
367)   666C C1          		         POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
368)   666D DC 88 6E    		         CALL    C,INCC	;
369)   6670 1F          		         RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
370)   6671 79          		         LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
371)   6672 98          		         SBC     A,B	;
372)   6673 3F          		         CCF	;
373)   6674 C3 FE 66    		         JP      CHKOVF	;
377)   6677 7C          		IMUL:  LD      A,H	;
378)   6678 AA          		         XOR     D	;
379)   6679 08          		         EX      AF,AF'          ;SAVE RESULT SIGN	;SAVE RESULT SIGN
380)   667A CB 7C       		         BIT     7,H	;
381)   667C C4 9D 6D    		         CALL    NZ,NEGATE	;
382)   667F CD 74 6E    		         CALL    SWAP	;
383)   6682 CB 7C       		         BIT     7,H	;
384)   6684 C4 9D 6D    		         CALL    NZ,NEGATE	;
385)   6687 44          		         LD      B,H	;
386)   6688 4D          		         LD      C,L	;
387)   6689 21 00 00    		         LD      HL,0	;
388)   668C D9          		         EXX	;
389)   668D 44          		         LD      B,H	;
390)   668E 4D          		         LD      C,L	;
391)   668F 21 00 00    		         LD      HL,0	;
392)   6692 3E DF       		         LD      A,-33	;
393)   6694 CD F7 6F    		         CALL    MULA            ;MULTIPLY	;MULTIPLY
394)   6697 D9          		         EXX	;
395)   6698 0E BF       		         LD      C,191           ;PRESET EXPONENT	;PRESET EXPONENT
396)   669A CD 99 6E    		         CALL    TEST            ;TEST RANGE	;TEST RANGE
397)   669D 20 0D       		         JR      NZ,IMUL1        ;TOO BIG	;TOO BIG
398)   669F CB 7A       		         BIT     7,D	;
399)   66A1 20 09       		         JR      NZ,IMUL1	;
400)   66A3 CD 74 6E    		         CALL    SWAP	;
401)   66A6 4A          		         LD      C,D             ;INTEGER MARKER	;INTEGER MARKER
402)   66A7 08          		         EX      AF,AF'	;
403)   66A8 F0          		         RET     P	;
404)   66A9 C3 9D 6D    		         JP      NEGATE	;
406)   66AC 0D          		IMUL1:  DEC     C	;
407)   66AD D9          		         EXX	;
408)   66AE CB 23       		         SLA     E	;
409)   66B0 CB 12       		         RL      D	;
410)   66B2 D9          		         EXX	;
411)   66B3 CB 13       		         RL      E	;
412)   66B5 CB 12       		         RL      D	;
413)   66B7 D9          		         EXX	;
414)   66B8 ED 6A       		         ADC     HL,HL	;
415)   66BA D9          		         EXX	;
416)   66BB ED 6A       		         ADC     HL,HL	;
417)   66BD F2 AC 66    		         JP      P,IMUL1         ;NORMALISE	;NORMALISE
418)   66C0 08          		         EX      AF,AF'	;
419)   66C1 F8          		         RET     M	;
420)   66C2 CB BC       		         RES     7,H             ;POSITIVE	;POSITIVE
421)   66C4 C9          		         RET	;
425)   66C5 05          		FMUL:  DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
426)   66C6 04          		         INC     B	;
427)   66C7 CA B9 6E    		         JP      Z,ZERO	;
428)   66CA 0D          		         DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
429)   66CB 0C          		         INC     C	;
430)   66CC C8          		         RET     Z	;
431)   66CD 7C          		         LD      A,H	;
432)   66CE AA          		         XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
433)   66CF 08          		         EX      AF,AF'	;
434)   66D0 CB FA       		         SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
435)   66D2 CB FC       		         SET     7,H	;
436)   66D4 C5          		         PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
437)   66D5 44          		         LD      B,H             ;LOAD REGISTERS	;LOAD REGISTERS
438)   66D6 4D          		         LD      C,L	;
439)   66D7 21 00 00    		         LD      HL,0	;
440)   66DA D9          		         EXX	;
441)   66DB 44          		         LD      B,H	;
442)   66DC 4D          		         LD      C,L	;
443)   66DD 21 00 00    		         LD      HL,0	;
444)   66E0 3E E0       		         LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
445)   66E2 CD F7 6F    		         CALL    MULA            ;MULTIPLY	;MULTIPLY
446)   66E5 DC 0B 70    		         CALL    C,MULB          ;NORMALISE & INC A	;NORMALISE & INC A
447)   66E8 D9          		         EXX	;
448)   66E9 E5          		         PUSH    HL	;
449)   66EA 21 00 80    		         LD      HL,8000H	;
450)   66ED B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
451)   66EE ED 52       		         SBC     HL,DE	;
452)   66F0 E1          		         POP     HL	;
453)   66F1 CC 6E 6E    		         CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
454)   66F4 DC 60 6E    		         CALL    C,ADD1          ;ROUND UP	;ROUND UP
455)   66F7 C1          		         POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
456)   66F8 DC 88 6E    		         CALL    C,INCC	;
457)   66FB 1F          		         RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
458)   66FC 79          		         LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
459)   66FD 88          		         ADC     A,B	;
460)   66FE 38 05       		CHKOVF:  JR      C,CHKO1	;
461)   6700 F2 B9 6E    		         JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
462)   6703 18 03       		         JR      CHKO2	;
463)   6705 FA 8A 6E    		CHKO1:  JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
464)   6708 C6 80       		CHKO2:  ADD     A,80H	;
465)   670A 4F          		         LD      C,A	;
466)   670B CA B9 6E    		         JP      Z,ZERO	;
467)   670E 08          		         EX      AF,AF'          ;RESTORE SIGN BIT	;RESTORE SIGN BIT
468)   670F CB BC       		         RES     7,H	;
469)   6711 F0          		         RET     P	;
470)   6712 CB FC       		         SET     7,H	;
471)   6714 C9          		         RET	;
475)   6715 CD 74 6E    		IPOW:  CALL    SWAP	;
476)   6718 CB 7C       		         BIT     7,H	;
477)   671A F5          		         PUSH    AF              ;SAVE SIGN	;SAVE SIGN
478)   671B C4 9D 6D    		         CALL    NZ,NEGATE	;
479)   671E 48          		IPOW0:  LD      C,B	;
480)   671F 06 20       		         LD      B,32            ;LOOP COUNTER	;LOOP COUNTER
481)   6721 CD 13 6F    		IPOW1:  CALL    X2	;
482)   6724 38 08       		         JR      C,IPOW2	;
483)   6726 10 F9       		         DJNZ    IPOW1	;
484)   6728 F1          		         POP     AF	;
485)   6729 D9          		         EXX	;
486)   672A 2C          		         INC     L               ;RESULT=1	;RESULT=1
487)   672B D9          		         EXX	;
488)   672C 4C          		         LD      C,H	;
489)   672D C9          		         RET	;
491)   672E F1          		IPOW2:  POP     AF	;
492)   672F C5          		         PUSH    BC	;
493)   6730 EB          		         EX      DE,HL	;
494)   6731 E5          		         PUSH    HL	;
495)   6732 D9          		         EXX	;
496)   6733 EB          		         EX      DE,HL	;
497)   6734 E5          		         PUSH    HL	;
498)   6735 D9          		         EXX	;
499)   6736 DD 21 00 00 		         LD      IX,0	;
500)   673A DD 39       		         ADD     IX,SP	;
501)   673C 28 42       		         JR      Z,IPOW4	;
502)   673E C5          		         PUSH    BC	;
503)   673F D9          		         EXX	;
504)   6740 D5          		         PUSH    DE	;
505)   6741 D9          		         EXX	;
506)   6742 D5          		         PUSH    DE	;
507)   6743 CD 4A 6E    		         CALL    SFLOAT	;
508)   6746 CD 15 6A    		         CALL    RECIP	;
509)   6749 DD 71 04    		         LD      (IX+4),C	;
510)   674C D9          		         EXX	;
511)   674D DD 75 00    		         LD      (IX+0),L	;
512)   6750 DD 74 01    		         LD      (IX+1),H	;
513)   6753 D9          		         EXX	;
514)   6754 DD 75 02    		         LD      (IX+2),L	;
515)   6757 DD 74 03    		         LD      (IX+3),H	;
516)   675A 18 1D       		         JR      IPOW5	;
518)   675C C5          		IPOW3:  PUSH    BC	;
519)   675D D9          		         EXX	;
520)   675E CB 23       		         SLA     E	;
521)   6760 CB 12       		         RL      D	;
522)   6762 D5          		         PUSH    DE	;
523)   6763 D9          		         EXX	;
524)   6764 CB 13       		         RL      E	;
525)   6766 CB 12       		         RL      D	;
526)   6768 D5          		         PUSH    DE	;
527)   6769 3E 0A       		         LD      A,'*' AND 0FH	;
528)   676B F5          		         PUSH    AF	;
529)   676C CD 25 6F    		         CALL    COPY	;
530)   676F CD B3 64    		         CALL    OP              ;SQUARE	;SQUARE
531)   6772 F1          		         POP     AF	;
532)   6773 CD B9 6C    		         CALL    DLOAD5	;
533)   6776 DC B3 64    		         CALL    C,OP            ;MULTIPLY BY X	;MULTIPLY BY X
534)   6779 D1          		IPOW5:  POP     DE	;
535)   677A D9          		         EXX	;
536)   677B D1          		         POP     DE	;
537)   677C D9          		         EXX	;
538)   677D 79          		         LD      A,C	;
539)   677E C1          		         POP     BC	;
540)   677F 4F          		         LD      C,A	;
541)   6780 10 DA       		IPOW4:  DJNZ    IPOW3	;
542)   6782 F1          		         POP     AF	;
543)   6783 F1          		         POP     AF	;
544)   6784 F1          		         POP     AF	;
545)   6785 C9          		         RET	;
547)   6786 F1          		FPOW0:  POP     AF	;
548)   6787 F1          		         POP     AF	;
549)   6788 F1          		         POP     AF	;
550)   6789 18 93       		         JR      IPOW0	;
554)   678B CB 7A       		FPOW:  BIT     7,D	;
555)   678D F5          		         PUSH    AF	;
556)   678E CD 74 6E    		         CALL    SWAP	;
557)   6791 CD 33 6F    		         CALL    PUSH5	;
558)   6794 0D          		         DEC     C	;
559)   6795 0C          		         INC     C	;
560)   6796 28 EE       		         JR      Z,FPOW0	;
561)   6798 3E 9E       		         LD      A,158	;
562)   679A B9          		         CP      C	;
563)   679B 38 08       		         JR      C,FPOW1	;
564)   679D 3C          		         INC     A	;
565)   679E CD 75 6D    		         CALL    FIX	;
566)   67A1 08          		         EX      AF,AF'	;
567)   67A2 F2 86 67    		         JP      P,FPOW0	;
568)   67A5 CD 74 6E    		FPOW1:  CALL    SWAP	;
569)   67A8 CD 2C 6A    		         CALL    LN0	;
570)   67AB CD 3C 6F    		         CALL    POP5	;
571)   67AE F1          		         POP     AF	;
572)   67AF CD C5 66    		         CALL    FMUL	;
573)   67B2 C3 A1 69    		         JP      EXP0	;
578)   67B5 CD C3 6E    		FLT:  CALL    FCP	;
579)   67B8 18 03       		         JR      ILT1	;
580)   67BA CD B6 6E    		ILT:  CALL    ICP	;
581)   67BD D0          		ILT1:  RET     NC	;
582)   67BE 18 38       		         JR      TRUE	;
584)   67C0 CD C3 6E    		FGT:  CALL    FCP	;
585)   67C3 18 03       		         JR      IGT1	;
586)   67C5 CD B6 6E    		IGT:  CALL    ICP	;
587)   67C8 C8          		IGT1:  RET     Z	;
588)   67C9 D8          		         RET     C	;
589)   67CA 18 2C       		         JR      TRUE	;
591)   67CC CD C3 6E    		FGE:  CALL    FCP	;
592)   67CF 18 03       		         JR      IGE1	;
593)   67D1 CD B6 6E    		IGE:  CALL    ICP	;
594)   67D4 D8          		IGE1:  RET     C	;
595)   67D5 18 21       		         JR      TRUE	;
597)   67D7 CD C3 6E    		FLE:  CALL    FCP	;
598)   67DA 18 03       		         JR      ILE1	;
599)   67DC CD B6 6E    		ILE:  CALL    ICP	;
600)   67DF 28 17       		ILE1:  JR      Z,TRUE	;
601)   67E1 D0          		         RET     NC	;
602)   67E2 18 14       		         JR      TRUE	;
604)   67E4 CD C3 6E    		FNE:  CALL    FCP	;
605)   67E7 18 03       		         JR      INE1	;
606)   67E9 CD B6 6E    		INE:  CALL    ICP	;
607)   67EC C8          		INE1:  RET     Z	;
608)   67ED 18 09       		         JR      TRUE	;
610)   67EF CD C3 6E    		FEQ:  CALL    FCP	;
611)   67F2 18 03       		         JR      IEQ1	;
612)   67F4 CD B6 6E    		IEQ:  CALL    ICP	;
613)   67F7 C0          		IEQ1:  RET     NZ	;
614)   67F8 21 FF FF    		TRUE:  LD      HL,-1	;
615)   67FB D9          		         EXX	;
616)   67FC 21 FF FF    		         LD      HL,-1	;
617)   67FF D9          		         EXX	;
618)   6800 AF          		         XOR     A	;
619)   6801 4F          		         LD      C,A	;
620)   6802 C9          		         RET	;
631)   6803 CB 7C       		ABS:  BIT     7,H	;
632)   6805 C8          		         RET     Z               ;POSITIVE/ZERO	;POSITIVE/ZERO
633)   6806 0D          		         DEC     C	;
634)   6807 0C          		         INC     C	;
635)   6808 CA 9D 6D    		         JP      Z,NEGATE        ;INTEGER	;INTEGER
636)   680B CB BC       		         RES     7,H	;
637)   680D C9          		         RET	;
642)   680E CD 8E 6D    		NOTK:  CALL    SFIX	;
643)   6811 7C          		         LD      A,H	;
644)   6812 2F          		         CPL	;
645)   6813 67          		         LD      H,A	;
646)   6814 7D          		         LD      A,L	;
647)   6815 2F          		         CPL	;
648)   6816 6F          		         LD      L,A	;
649)   6817 D9          		         EXX	;
650)   6818 7C          		         LD      A,H	;
651)   6819 2F          		         CPL	;
652)   681A 67          		         LD      H,A	;
653)   681B 7D          		         LD      A,L	;
654)   681C 2F          		         CPL	;
655)   681D 6F          		         LD      L,A	;
656)   681E D9          		         EXX	;
657)   681F AF          		         XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
658)   6820 C9          		         RET	;
663)   6821 21 0F 49    		PI:  LD      HL,490FH	;
664)   6824 D9          		         EXX	;
665)   6825 21 A2 DA    		         LD      HL,0DAA2H	;
666)   6828 D9          		         EXX	;
667)   6829 0E 81       		         LD      C,81H	;
668)   682B AF          		         XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
669)   682C C9          		         RET	;
674)   682D CD 3D 68    		DEG:  CALL    FPI180	;
675)   6830 CD C5 66    		         CALL    FMUL	;
676)   6833 AF          		         XOR     A	;
677)   6834 C9          		         RET	;
682)   6835 CD 3D 68    		RAD:  CALL    FPI180	;
683)   6838 CD 32 66    		         CALL    FDIV	;
684)   683B AF          		         XOR     A	;
685)   683C C9          		         RET	;
689)   683D CD 4A 6E    		FPI180:  CALL    SFLOAT	;
690)   6840 11 2E 65    		         LD      DE,652EH	;
691)   6843 D9          		         EXX	;
692)   6844 11 D3 E0    		         LD      DE,0E0D3H	;
693)   6847 D9          		         EXX	;
694)   6848 06 85       		         LD      B,85H	;
695)   684A C9          		         RET	;
700)   684B CD 99 6E    		SGN:  CALL    TEST	;
701)   684E B1          		         OR      C	;
702)   684F C8          		         RET     Z               ;ZERO	;ZERO
703)   6850 CB 7C       		         BIT     7,H	;
704)   6852 C2 F8 67    		         JP      NZ,TRUE         ;-1	;-1
705)   6855 CD B9 6E    		         CALL    ZERO	;
706)   6858 C3 60 6E    		         JP      ADD1            ;1	;1
712)   685B CD 84 70    		VAL:  CALL    SIGNQ	;
713)   685E F5          		         PUSH    AF	;
714)   685F CD CB 6C    		         CALL    CON	;
715)   6862 F1          		         POP     AF	;
716)   6863 FE 2D       		         CP      '-'	;
717)   6865 3E 00       		         LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
718)   6867 C0          		         RET     NZ	;
719)   6868 0D          		         DEC     C	;
720)   6869 0C          		         INC     C	;
721)   686A CA 9D 6D    		         JP      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
722)   686D 7C          		         LD      A,H	;
723)   686E EE 80       		         XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
724)   6870 67          		         LD      H,A	;
725)   6871 AF          		         XOR     A	;
726)   6872 C9          		         RET	;
731)   6873 0D          		INT:  DEC     C	;
732)   6874 0C          		         INC     C	;
733)   6875 C8          		         RET     Z               ;ZERO/INTEGER	;ZERO/INTEGER
734)   6876 3E 9F       		         LD      A,159	;
735)   6878 44          		         LD      B,H             ;B7=SIGN BIT	;B7=SIGN BIT
736)   6879 CD 75 6D    		         CALL    FIX	;
737)   687C 08          		         EX      AF,AF'	;
738)   687D A0          		         AND     B	;
739)   687E FC 60 6E    		         CALL    M,ADD1          ;NEGATIVE NON-INTEGER	;NEGATIVE NON-INTEGER
740)   6881 78          		         LD      A,B	;
741)   6882 B7          		         OR      A	;
742)   6883 FC 9D 6D    		         CALL    M,NEGATE	;
743)   6886 AF          		         XOR     A	;
744)   6887 4F          		         LD      C,A	;
745)   6888 C9          		         RET	;
750)   6889 CD 4A 6E    		SQR:  CALL    SFLOAT	;
751)   688C CB 7C       		SQR0:  BIT     7,H	;
752)   688E 3E 15       		         LD      A,NGROOT	;
753)   6890 C2 AD 64    		         JP      NZ,ERROR        ;"-ve root"	;"-ve root"
754)   6893 0D          		         DEC     C	;
755)   6894 0C          		         INC     C	;
756)   6895 C8          		         RET     Z               ;ZERO	;ZERO
757)   6896 CB FC       		         SET     7,H             ;IMPLIED 1	;IMPLIED 1
758)   6898 CB 41       		         BIT     0,C	;
759)   689A CC 7C 6E    		         CALL    Z,DIV2          ;MAKE EXPONENT ODD	;MAKE EXPONENT ODD
760)   689D 79          		         LD      A,C	;
761)   689E D6 80       		         SUB     80H	;
762)   68A0 CB 2F       		         SRA     A               ;HALVE EXPONENT	;HALVE EXPONENT
763)   68A2 C6 80       		         ADD     A,80H	;
764)   68A4 4F          		         LD      C,A	;
765)   68A5 C5          		         PUSH    BC              ;SAVE EXPONENT	;SAVE EXPONENT
766)   68A6 EB          		         EX      DE,HL	;
767)   68A7 21 00 00    		         LD      HL,0	;
768)   68AA 44          		         LD      B,H	;
769)   68AB 4D          		         LD      C,L	;
770)   68AC D9          		         EXX	;
771)   68AD EB          		         EX      DE,HL	;
772)   68AE 21 00 00    		         LD      HL,0	;
773)   68B1 44          		         LD      B,H	;
774)   68B2 4D          		         LD      C,L	;
775)   68B3 3E E1       		         LD      A,-31	;
776)   68B5 CD 2A 70    		         CALL    SQRA            ;ROOT	;ROOT
777)   68B8 D9          		         EXX	;
778)   68B9 CB 78       		         BIT     7,B	;
779)   68BB D9          		         EXX	;
780)   68BC CC 2A 70    		         CALL    Z,SQRA          ;NORMALISE & INC A	;NORMALISE & INC A
781)   68BF CD 63 70    		         CALL    SQRB	;
782)   68C2 B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
783)   68C3 CD E4 6F    		         CALL    DIVB	;
784)   68C6 CB 1B       		         RR      E               ;LSB TO CARRY	;LSB TO CARRY
785)   68C8 60          		         LD      H,B	;
786)   68C9 69          		         LD      L,C	;
787)   68CA D9          		         EXX	;
788)   68CB 60          		         LD      H,B	;
789)   68CC 69          		         LD      L,C	;
790)   68CD DC 60 6E    		         CALL    C,ADD1          ;ROUND UP	;ROUND UP
791)   68D0 C1          		         POP     BC              ;RESTORE EXPONENT	;RESTORE EXPONENT
792)   68D1 DC 88 6E    		         CALL    C,INCC	;
793)   68D4 1F          		         RRA	;
794)   68D5 9F          		         SBC     A,A	;
795)   68D6 81          		         ADD     A,C	;
796)   68D7 4F          		         LD      C,A	;
797)   68D8 CB BC       		         RES     7,H             ;POSITIVE	;POSITIVE
798)   68DA AF          		         XOR     A	;
799)   68DB C9          		         RET	;
804)   68DC CD 4A 6E    		TAN:  CALL    SFLOAT	;
805)   68DF CD 33 6F    		         CALL    PUSH5	;
806)   68E2 CD FC 68    		         CALL    COS0	;
807)   68E5 CD 3C 6F    		         CALL    POP5	;
808)   68E8 CD 33 6F    		         CALL    PUSH5	;
809)   68EB CD 74 6E    		         CALL    SWAP	;
810)   68EE CD 07 69    		         CALL    SIN0	;
811)   68F1 CD 3C 6F    		         CALL    POP5	;
812)   68F4 CD 32 66    		         CALL    FDIV	;
813)   68F7 AF          		         XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
814)   68F8 C9          		         RET	;
819)   68F9 CD 4A 6E    		COS:  CALL    SFLOAT	;
820)   68FC CD BF 6D    		COS0:  CALL    SCALE	;
821)   68FF 1C          		         INC     E	;
822)   6900 1C          		         INC     E	;
823)   6901 7B          		         LD      A,E	;
824)   6902 18 0E       		         JR      SIN1	;
829)   6904 CD 4A 6E    		SIN:  CALL    SFLOAT	;
830)   6907 E5          		SIN0:  PUSH    HL              ;H7=SIGN	;H7=SIGN
831)   6908 CD BF 6D    		         CALL    SCALE	;
832)   690B F1          		         POP     AF	;
833)   690C 07          		         RLCA	;
834)   690D 07          		         RLCA	;
835)   690E 07          		         RLCA	;
836)   690F E6 04       		         AND     4	;
837)   6911 AB          		         XOR     E	;
838)   6912 F5          		SIN1:  PUSH    AF              ;OCTANT	;OCTANT
839)   6913 CB BC       		         RES     7,H	;
840)   6915 1F          		         RRA	;
841)   6916 CD 93 69    		         CALL    PIBY4	;
842)   6919 DC CA 65    		         CALL    C,RSUB          ;X=(PI/4)-X	;X=(PI/4)-X
843)   691C F1          		         POP     AF	;
844)   691D F5          		         PUSH    AF	;
845)   691E E6 03       		         AND     3	;
846)   6920 E2 51 69    		         JP      PO,SIN2         ;USE COSINE APPROX.	;USE COSINE APPROX.
847)   6923 CD 33 6F    		         CALL    PUSH5           ;SAVE X	;SAVE X
848)   6926 CD 2D 6F    		         CALL    SQUARE          ;PUSH X*X	;PUSH X*X
849)   6929 CD 66 6F    		         CALL    POLY	;
850)   692C B7 A8       		         DEFW    0A8B7H          ;a(8)	;a(8)
851)   692E 11 36       		         DEFW    3611H	;
852)   6930 6D          		         DEFB    6DH	;
853)   6931 26 DE       		         DEFW    0DE26H          ;a(6)	;a(6)
854)   6933 05 D0       		         DEFW    0D005H	;
855)   6935 73          		         DEFB    73H	;
856)   6936 C0 80       		         DEFW    80C0H           ;a(4)	;a(4)
857)   6938 88 08       		         DEFW    888H	;
858)   693A 79          		         DEFB    79H	;
859)   693B 9D AA       		         DEFW    0AA9DH          ;a(2)	;a(2)
860)   693D AA AA       		         DEFW    0AAAAH	;
861)   693F 7D          		         DEFB    7DH	;
862)   6940 00 00       		         DEFW    0               ;a(0)	;a(0)
863)   6942 00 00       		         DEFW    0	;
864)   6944 80          		         DEFB    80H	;
865)   6945 CD 3C 6F    		         CALL    POP5	;
866)   6948 CD 3C 6F    		         CALL    POP5	;
867)   694B CD C5 66    		         CALL    FMUL	;
868)   694E C3 73 69    		         JP      SIN3	;
870)   6951 CD 2D 6F    		SIN2:  CALL    SQUARE          ;PUSH X*X	;PUSH X*X
871)   6954 CD 66 6F    		         CALL    POLY	;
872)   6957 71 D5       		         DEFW    0D571H          ;b(8)	;b(8)
873)   6959 78 4C       		         DEFW    4C78H	;
874)   695B 70          		         DEFB    70H	;
875)   695C AF 94       		         DEFW    94AFH           ;b(6)	;b(6)
876)   695E 03 B6       		         DEFW    0B603H	;
877)   6960 76          		         DEFB    76H	;
878)   6961 C8 9C       		         DEFW    9CC8H           ;b(4)	;b(4)
879)   6963 AA 2A       		         DEFW    2AAAH	;
880)   6965 7B          		         DEFB    7BH	;
881)   6966 DD FF       		         DEFW    0FFDDH          ;b(2)	;b(2)
882)   6968 FF FF       		         DEFW    0FFFFH	;
883)   696A 7E          		         DEFB    7EH	;
884)   696B 00 00       		         DEFW    0               ;b(0)	;b(0)
885)   696D 00 00       		         DEFW    0	;
886)   696F 80          		         DEFB    80H	;
887)   6970 CD 3C 6F    		         CALL    POP5	;
888)   6973 F1          		SIN3:  POP     AF	;
889)   6974 E6 04       		         AND     4	;
890)   6976 C8          		         RET     Z	;
891)   6977 0D          		         DEC     C	;
892)   6978 0C          		         INC     C	;
893)   6979 C8          		         RET     Z               ;ZERO	;ZERO
894)   697A CB FC       		         SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
895)   697C C9          		         RET	;
899)   697D 21 00 00    		FONE:  LD      HL,0	;
900)   6980 D9          		         EXX	;
901)   6981 21 00 00    		         LD      HL,0	;
902)   6984 D9          		         EXX	;
903)   6985 0E 80       		         LD      C,80H	;
904)   6987 C9          		         RET	;
906)   6988 11 00 00    		DONE:  LD      DE,0	;
907)   698B D9          		         EXX	;
908)   698C 11 00 00    		         LD      DE,0	;
909)   698F D9          		         EXX	;
910)   6990 06 80       		         LD      B,80H	;
911)   6992 C9          		         RET	;
913)   6993 11 0F 49    		PIBY4:  LD      DE,490FH	;
914)   6996 D9          		         EXX	;
915)   6997 11 A2 DA    		         LD      DE,0DAA2H	;
916)   699A D9          		         EXX	;
917)   699B 06 7F       		         LD      B,7FH	;
918)   699D C9          		         RET	;
923)   699E CD 4A 6E    		EXP:  CALL    SFLOAT	;
924)   69A1 CD 1E 6A    		EXP0:  CALL    LN2             ;LN(2)	;LN(2)
925)   69A4 D9          		         EXX	;
926)   69A5 1D          		         DEC     E	;
927)   69A6 01 CF D1    		         LD      BC,0D1CFH       ;0.6931471805599453	;0.6931471805599453
928)   69A9 D9          		         EXX	;
929)   69AA E5          		         PUSH    HL              ;H7=SIGN	;H7=SIGN
930)   69AB CD CF 6D    		         CALL    MOD48           ;"MODULUS"	;"MODULUS"
931)   69AE F1          		         POP     AF	;
932)   69AF CB 7B       		         BIT     7,E	;
933)   69B1 28 09       		         JR      Z,EXP1	;
934)   69B3 17          		         RLA	;
935)   69B4 DA B9 6E    		         JP      C,ZERO	;
936)   69B7 3E 18       		         LD      A,EXPRNG	;
937)   69B9 C3 AD 64    		         JP      ERROR           ;"Exp range"	;"Exp range"
939)   69BC E6 80       		EXP1:  AND     80H	;
940)   69BE B3          		         OR      E	;
941)   69BF F5          		         PUSH    AF              ;INTEGER PART	;INTEGER PART
942)   69C0 CB BC       		         RES     7,H	;
943)   69C2 CD 33 6F    		         CALL    PUSH5           ;PUSH X*LN(2)	;PUSH X*LN(2)
944)   69C5 CD 66 6F    		         CALL    POLY	;
945)   69C8 72 40       		         DEFW    4072H           ;a(7)	;a(7)
946)   69CA 2E 94       		         DEFW    942EH	;
947)   69CC 73          		         DEFB    73H	;
948)   69CD 65 6F       		         DEFW    6F65H           ;a(6)	;a(6)
949)   69CF 4F 2E       		         DEFW    2E4FH	;
950)   69D1 76          		         DEFB    76H	;
951)   69D2 37 6D       		         DEFW    6D37H           ;a(5)	;a(5)
952)   69D4 02 88       		         DEFW    8802H	;
953)   69D6 79          		         DEFB    79H	;
954)   69D7 12 E5       		         DEFW    0E512H          ;a(4)	;a(4)
955)   69D9 A0 2A       		         DEFW    2AA0H	;
956)   69DB 7B          		         DEFB    7BH	;
957)   69DC 14 4F       		         DEFW    4F14H           ;a(3)	;a(3)
958)   69DE AA AA       		         DEFW    0AAAAH	;
959)   69E0 7D          		         DEFB    7DH	;
960)   69E1 56 FD       		         DEFW    0FD56H          ;a(2)	;a(2)
961)   69E3 FF 7F       		         DEFW    7FFFH	;
962)   69E5 7E          		         DEFB    7EH	;
963)   69E6 FE FF       		         DEFW    0FFFEH          ;a(1)	;a(1)
964)   69E8 FF FF       		         DEFW    0FFFFH	;
965)   69EA 7F          		         DEFB    7FH	;
966)   69EB 00 00       		         DEFW    0               ;a(0)	;a(0)
967)   69ED 00 00       		         DEFW    0	;
968)   69EF 80          		         DEFB    80H	;
969)   69F0 CD 3C 6F    		         CALL    POP5	;
970)   69F3 F1          		         POP     AF	;
971)   69F4 F5          		         PUSH    AF	;
972)   69F5 F4 15 6A    		         CALL    P,RECIP         ;X=1/X	;X=1/X
973)   69F8 F1          		         POP     AF	;
974)   69F9 F2 00 6A    		         JP      P,EXP4	;
975)   69FC E6 7F       		         AND     7FH	;
976)   69FE ED 44       		         NEG	;
977)   6A00 C6 80       		EXP4:  ADD     A,80H	;
978)   6A02 81          		         ADD     A,C	;
979)   6A03 38 05       		         JR      C,EXP2	;
980)   6A05 F2 B9 6E    		         JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
981)   6A08 18 03       		         JR      EXP3	;
982)   6A0A FA 8A 6E    		EXP2:  JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
983)   6A0D C6 80       		EXP3:  ADD     A,80H	;
984)   6A0F CA B9 6E    		         JP      Z,ZERO	;
985)   6A12 4F          		         LD      C,A	;
986)   6A13 AF          		         XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
987)   6A14 C9          		         RET	;
989)   6A15 CD 88 69    		RECIP:  CALL    DONE	;
990)   6A18 CD 74 6E    		RDIV:  CALL    SWAP	;
991)   6A1B C3 32 66    		         JP      FDIV            ;RECIPROCAL	;RECIPROCAL
993)   6A1E 11 72 31    		LN2:  LD      DE,3172H        ;LN(2)	;LN(2)
994)   6A21 D9          		         EXX	;
995)   6A22 11 F8 17    		         LD      DE,17F8H	;
996)   6A25 D9          		         EXX	;
997)   6A26 06 7F       		         LD      B,7FH	;
998)   6A28 C9          		         RET	;
1003)   6A29 CD 4A 6E    		LN:  CALL    SFLOAT	;
1004)   6A2C 3E 16       		LN0:  LD      A,LOGRNG	;
1005)   6A2E CB 7C       		         BIT     7,H	;
1006)   6A30 C2 AD 64    		         JP      NZ,ERROR        ;"Log range"	;"Log range"
1007)   6A33 0C          		         INC     C	;
1008)   6A34 0D          		         DEC     C	;
1009)   6A35 CA AD 64    		         JP      Z,ERROR	;
1010)   6A38 11 04 35    		         LD      DE,3504H        ;SQR(2)	;SQR(2)
1011)   6A3B D9          		         EXX	;
1012)   6A3C 11 33 F3    		         LD      DE,0F333H       ;1.41421356237	;1.41421356237
1013)   6A3F D9          		         EXX	;
1014)   6A40 CD CB 6E    		         CALL    ICP0            ;MANTISSA>SQR(2)?	;MANTISSA>SQR(2)?
1015)   6A43 79          		         LD      A,C             ;EXPONENT	;EXPONENT
1016)   6A44 0E 80       		         LD      C,80H           ;1 <= X < 2	;1 <= X < 2
1017)   6A46 38 02       		         JR      C,LN4	;
1018)   6A48 0D          		         DEC     C	;
1019)   6A49 3C          		         INC     A	;
1020)   6A4A F5          		LN4:  PUSH    AF              ;SAVE EXPONENT	;SAVE EXPONENT
1021)   6A4B CD 48 6F    		         CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1022)   6A4E CD 33 6F    		         CALL    PUSH5	;
1023)   6A51 CD 2D 6F    		         CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1024)   6A54 CD 66 6F    		         CALL    POLY	;
1025)   6A57 48 CC       		         DEFW    0CC48H          ;a(9)	;a(9)
1026)   6A59 FB 74       		         DEFW    74FBH	;
1027)   6A5B 7D          		         DEFB    7DH	;
1028)   6A5C AF AE       		         DEFW    0AEAFH          ;a(7)	;a(7)
1029)   6A5E FF 11       		         DEFW    11FFH	;
1030)   6A60 7E          		         DEFB    7EH	;
1031)   6A61 8C D9       		         DEFW    0D98CH          ;a(5)	;a(5)
1032)   6A63 CD 4C       		         DEFW    4CCDH	;
1033)   6A65 7E          		         DEFB    7EH	;
1034)   6A66 E3 A9       		         DEFW    0A9E3H          ;a(3)	;a(3)
1035)   6A68 AA 2A       		         DEFW    2AAAH	;
1036)   6A6A 7F          		         DEFB    7FH	;
1037)   6A6B 00 00       		         DEFW    0               ;a(1)	;a(1)
1038)   6A6D 00 00       		         DEFW    0	;
1039)   6A6F 81          		         DEFB    81H	;
1040)   6A70 CD 3C 6F    		         CALL    POP5	;
1041)   6A73 CD 3C 6F    		         CALL    POP5	;
1042)   6A76 CD C5 66    		         CALL    FMUL	;
1043)   6A79 F1          		         POP     AF              ;EXPONENT	;EXPONENT
1044)   6A7A CD 33 6F    		         CALL    PUSH5	;
1045)   6A7D 08          		         EX      AF,AF'	;
1046)   6A7E CD B9 6E    		         CALL    ZERO	;
1047)   6A81 08          		         EX      AF,AF'	;
1048)   6A82 D6 80       		         SUB     80H	;
1049)   6A84 28 1B       		         JR      Z,LN3	;
1050)   6A86 30 02       		         JR      NC,LN1	;
1051)   6A88 2F          		         CPL	;
1052)   6A89 3C          		         INC     A	;
1053)   6A8A 67          		LN1:  LD      H,A	;
1054)   6A8B 0E 87       		         LD      C,87H	;
1055)   6A8D F5          		         PUSH    AF	;
1056)   6A8E CD 30 6E    		         CALL    FLOAT	;
1057)   6A91 CB BC       		         RES     7,H	;
1058)   6A93 CD 1E 6A    		         CALL    LN2	;
1059)   6A96 CD C5 66    		         CALL    FMUL	;
1060)   6A99 F1          		         POP     AF	;
1061)   6A9A 30 05       		         JR      NC,LN3	;
1062)   6A9C FA A1 6A    		         JP      M,LN3	;
1063)   6A9F CB FC       		         SET     7,H	;
1064)   6AA1 CD 3C 6F    		LN3:  CALL    POP5	;
1065)   6AA4 CD DA 65    		         CALL    FADD	;
1066)   6AA7 AF          		         XOR     A	;
1067)   6AA8 C9          		         RET	;
1072)   6AA9 CD 29 6A    		LOG:  CALL    LN	;
1073)   6AAC 11 5B 5E    		         LD      DE,5E5BH        ;LOG(e)	;LOG(e)
1074)   6AAF D9          		         EXX	;
1075)   6AB0 11 A9 D8    		         LD      DE,0D8A9H	;
1076)   6AB3 D9          		         EXX	;
1077)   6AB4 06 7E       		         LD      B,7EH	;
1078)   6AB6 CD C5 66    		         CALL    FMUL	;
1079)   6AB9 AF          		         XOR     A	;
1080)   6ABA C9          		         RET	;
1085)   6ABB CD 4A 6E    		ASN:  CALL    SFLOAT	;
1086)   6ABE CD 33 6F    		         CALL    PUSH5	;
1087)   6AC1 CD 25 6F    		         CALL    COPY	;
1088)   6AC4 CD C5 66    		         CALL    FMUL	;
1089)   6AC7 CD 88 69    		         CALL    DONE	;
1090)   6ACA CD CA 65    		         CALL    RSUB	;
1091)   6ACD CD 8C 68    		         CALL    SQR0	;
1092)   6AD0 CD 3C 6F    		         CALL    POP5	;
1093)   6AD3 0C          		         INC     C	;
1094)   6AD4 0D          		         DEC     C	;
1095)   6AD5 3E 02       		         LD      A,2	;
1096)   6AD7 D5          		         PUSH    DE	;
1097)   6AD8 28 70       		         JR      Z,ACS1	;
1098)   6ADA D1          		         POP     DE	;
1099)   6ADB CD 18 6A    		         CALL    RDIV	;
1100)   6ADE 18 03       		         JR      ATN0	;
1105)   6AE0 CD 4A 6E    		ATN:  CALL    SFLOAT	;
1106)   6AE3 E5          		ATN0:  PUSH    HL              ;SAVE SIGN	;SAVE SIGN
1107)   6AE4 CB BC       		         RES     7,H	;
1108)   6AE6 11 13 54    		         LD      DE,5413H        ;TAN(PI/8)=SQR(2)-1	;TAN(PI/8)=SQR(2)-1
1109)   6AE9 D9          		         EXX	;
1110)   6AEA 11 D0 CC    		         LD      DE,0CCD0H	;
1111)   6AED D9          		         EXX	;
1112)   6AEE 06 7E       		         LD      B,7EH	;
1113)   6AF0 CD C8 6E    		         CALL    FCP0            ;COMPARE	;COMPARE
1114)   6AF3 06 00       		         LD      B,0	;
1115)   6AF5 38 1C       		         JR      C,ATN2	;
1116)   6AF7 11 82 1A    		         LD      DE,1A82H        ;TAN(3*PI/8)=SQR(2)+1	;TAN(3*PI/8)=SQR(2)+1
1117)   6AFA D9          		         EXX	;
1118)   6AFB 11 9A 79    		         LD      DE,799AH	;
1119)   6AFE D9          		         EXX	;
1120)   6AFF 06 81       		         LD      B,81H	;
1121)   6B01 CD C8 6E    		         CALL    FCP0            ;COMPARE	;COMPARE
1122)   6B04 38 08       		         JR      C,ATN1	;
1123)   6B06 CD 15 6A    		         CALL    RECIP           ;X=1/X	;X=1/X
1124)   6B09 06 02       		         LD      B,2	;
1125)   6B0B C3 13 6B    		         JP      ATN2	;
1126)   6B0E CD 48 6F    		ATN1:  CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1127)   6B11 06 01       		         LD      B,1	;
1128)   6B13 C5          		ATN2:  PUSH    BC              ;SAVE FLAG	;SAVE FLAG
1129)   6B14 CD 33 6F    		         CALL    PUSH5	;
1130)   6B17 CD 2D 6F    		         CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1131)   6B1A CD 66 6F    		         CALL    POLY	;
1132)   6B1D 35 F3       		         DEFW    0F335H          ;a(13)	;a(13)
1133)   6B1F D8 37       		         DEFW    37D8H	;
1134)   6B21 7B          		         DEFB    7BH	;
1135)   6B22 91 6B       		         DEFW    6B91H           ;a(11)	;a(11)
1136)   6B24 B9 AA       		         DEFW    0AAB9H	;
1137)   6B26 7C          		         DEFB    7CH	;
1138)   6B27 DE 41       		         DEFW    41DEH           ;a(9)	;a(9)
1139)   6B29 97 61       		         DEFW    6197H	;
1140)   6B2B 7C          		         DEFB    7CH	;
1141)   6B2C 7B 9D       		         DEFW    9D7BH           ;a(7)	;a(7)
1142)   6B2E 37 92       		         DEFW    9237H	;
1143)   6B30 7D          		         DEFB    7DH	;
1144)   6B31 5A 2A       		         DEFW    2A5AH           ;a(5)	;a(5)
1145)   6B33 CC 4C       		         DEFW    4CCCH	;
1146)   6B35 7D          		         DEFB    7DH	;
1147)   6B36 5C A9       		         DEFW    0A95CH          ;a(3)	;a(3)
1148)   6B38 AA AA       		         DEFW    0AAAAH	;
1149)   6B3A 7E          		         DEFB    7EH	;
1150)   6B3B 00 00       		         DEFW    0               ;a(1)	;a(1)
1151)   6B3D 00 00       		         DEFW    0	;
1152)   6B3F 80          		         DEFB    80H	;
1153)   6B40 CD 3C 6F    		         CALL    POP5	;
1154)   6B43 CD 3C 6F    		         CALL    POP5	;
1155)   6B46 CD C5 66    		         CALL    FMUL	;
1156)   6B49 F1          		         POP     AF	;
1157)   6B4A CD 93 69    		ACS1:  CALL    PIBY4           ;PI/4	;PI/4
1158)   6B4D 1F          		         RRA	;
1159)   6B4E F5          		         PUSH    AF	;
1160)   6B4F DC DA 65    		         CALL    C,FADD	;
1161)   6B52 F1          		         POP     AF	;
1162)   6B53 04          		         INC     B	;
1163)   6B54 1F          		         RRA	;
1164)   6B55 DC CA 65    		         CALL    C,RSUB	;
1165)   6B58 F1          		         POP     AF	;
1166)   6B59 B7          		         OR      A	;
1167)   6B5A F0          		         RET     P	;
1168)   6B5B CB FC       		         SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
1169)   6B5D AF          		         XOR     A	;
1170)   6B5E C9          		         RET	;
1175)   6B5F CD BB 6A    		ACS:  CALL    ASN	;
1176)   6B62 3E 02       		         LD      A,2	;
1177)   6B64 F5          		         PUSH    AF	;
1178)   6B65 18 E3       		         JR      ACS1	;
1188)   6B67 CD 4A 6E    		STR:  CALL    SFLOAT	;
1189)   6B6A 06 00       		         LD      B,0             ;DEFAULT PT. POSITION	;DEFAULT PT. POSITION
1190)   6B6C CB 7C       		         BIT     7,H             ;NEGATIVE?	;NEGATIVE?
1191)   6B6E 28 06       		         JR      Z,STR10	;
1192)   6B70 CB BC       		         RES     7,H	;
1193)   6B72 3E 2D       		         LD      A,'-'	;
1194)   6B74 12          		         LD      (DE),A          ;STORE SIGN	;STORE SIGN
1195)   6B75 13          		         INC     DE	;
1196)   6B76 AF          		STR10:  XOR     A               ;CLEAR A	;CLEAR A
1197)   6B77 B9          		         CP      C	;
1198)   6B78 28 47       		         JR      Z,STR2          ;ZERO	;ZERO
1199)   6B7A D5          		         PUSH    DE              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
1200)   6B7B 78          		         LD      A,B	;
1201)   6B7C F5          		STR11:  PUSH    AF              ;SAVE DECIMAL COUNTER	;SAVE DECIMAL COUNTER
1202)   6B7D 79          		         LD      A,C             ;BINARY EXPONENT	;BINARY EXPONENT
1203)   6B7E FE A1       		         CP      161	;
1204)   6B80 30 1A       		         JR      NC,STR14	;
1205)   6B82 FE 9B       		         CP      155	;
1206)   6B84 30 25       		         JR      NC,STR15	;
1207)   6B86 2F          		         CPL	;
1208)   6B87 FE E1       		         CP      225	;
1209)   6B89 38 02       		         JR      C,STR13	;
1210)   6B8B 3E F8       		         LD      A,-8	;
1211)   6B8D C6 1C       		STR13:  ADD     A,28	;
1212)   6B8F CD 8D 6F    		         CALL    POWR10	;
1213)   6B92 F5          		         PUSH    AF	;
1214)   6B93 CD C5 66    		         CALL    FMUL	;
1215)   6B96 F1          		         POP     AF	;
1216)   6B97 47          		         LD      B,A	;
1217)   6B98 F1          		         POP     AF	;
1218)   6B99 90          		         SUB     B	;
1219)   6B9A 18 E0       		         JR      STR11	;
1220)   6B9C D6 20       		STR14:  SUB     32	;
1221)   6B9E CD 8D 6F    		         CALL    POWR10	;
1222)   6BA1 F5          		         PUSH    AF	;
1223)   6BA2 CD 32 66    		         CALL    FDIV	;
1224)   6BA5 F1          		         POP     AF	;
1225)   6BA6 47          		         LD      B,A	;
1226)   6BA7 F1          		         POP     AF	;
1227)   6BA8 80          		         ADD     A,B	;
1228)   6BA9 18 D1       		         JR      STR11	;
1229)   6BAB 3E 09       		STR15:  LD      A,9	;
1230)   6BAD CD 8D 6F    		         CALL    POWR10          ;10^9	;10^9
1231)   6BB0 CD C8 6E    		         CALL    FCP0	;
1232)   6BB3 79          		         LD      A,C	;
1233)   6BB4 C1          		         POP     BC	;
1234)   6BB5 4F          		         LD      C,A	;
1235)   6BB6 CB FC       		         SET     7,H             ;IMPLIED 1	;IMPLIED 1
1236)   6BB8 DC EA 6E    		         CALL    C,X10B          ;X10, DEC B	;X10, DEC B
1237)   6BBB D1          		         POP     DE              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
1238)   6BBC CB B9       		         RES     7,C	;
1239)   6BBE 3E 00       		         LD      A,0	;
1240)   6BC0 17          		         RLA                     ;PUT CARRY IN LSB	;PUT CARRY IN LSB
1248)   6BC1 0C          		STR2:  INC     C	;
1249)   6BC2 08          		         EX      AF,AF'          ;SAVE A	;SAVE A
1250)   6BC3 78          		         LD      A,B	;
1251)   6BC4 DD CB 02 4E 		         BIT     1,(IX+2)	;
1252)   6BC8 20 08       		         JR      NZ,STR20	;
1253)   6BCA AF          		         XOR     A	;
1254)   6BCB DD BE 01    		         CP      (IX+1)	;
1255)   6BCE 28 0A       		         JR      Z,STR21	;
1256)   6BD0 3E F6       		         LD      A,-10	;
1257)   6BD2 DD 86 01    		STR20:  ADD     A,(IX+1)        ;SIG. FIG. COUNT	;SIG. FIG. COUNT
1258)   6BD5 B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
1259)   6BD6 FA DA 6B    		         JP      M,STR21	;
1260)   6BD9 AF          		         XOR     A	;
1261)   6BDA F5          		STR21:  PUSH    AF	;
1262)   6BDB 08          		         EX      AF,AF'          ;RESTORE A	;RESTORE A
1263)   6BDC CD 13 6F    		STR22:  CALL    X2              ;RL AHLH'L'	;RL AHLH'L'
1264)   6BDF 8F          		         ADC     A,A	;
1265)   6BE0 FE 0A       		         CP      10	;
1266)   6BE2 38 05       		         JR      C,STR23	;
1267)   6BE4 D6 0A       		         SUB     10	;
1268)   6BE6 D9          		         EXX	;
1269)   6BE7 2C          		         INC     L               ;SET RESULT BIT	;SET RESULT BIT
1270)   6BE8 D9          		         EXX	;
1271)   6BE9 0D          		STR23:  DEC     C	;
1272)   6BEA 20 F0       		         JR      NZ,STR22        ;32 TIMES	;32 TIMES
1273)   6BEC 4F          		         LD      C,A             ;REMAINDER	;REMAINDER
1274)   6BED 7C          		         LD      A,H	;
1275)   6BEE E6 3F       		         AND     3FH             ;CLEAR OUT JUNK	;CLEAR OUT JUNK
1276)   6BF0 67          		         LD      H,A	;
1277)   6BF1 F1          		         POP     AF	;
1278)   6BF2 F2 FF 6B    		         JP      P,STR24	;
1279)   6BF5 3C          		         INC     A	;
1280)   6BF6 20 1C       		         JR      NZ,STR26	;
1281)   6BF8 3E 04       		         LD      A,4	;
1282)   6BFA B9          		         CP      C               ;ROUND UP?	;ROUND UP?
1283)   6BFB 3E 00       		         LD      A,0	;
1284)   6BFD 18 15       		         JR      STR26	;
1285)   6BFF F5          		STR24:  PUSH    AF	;
1286)   6C00 79          		         LD      A,C	;
1287)   6C01 CE 30       		         ADC     A,'0'           ;ADD CARRY	;ADD CARRY
1288)   6C03 FE 30       		         CP      '0'	;
1289)   6C05 28 05       		         JR      Z,STR25         ;SUPPRESS ZERO	;SUPPRESS ZERO
1290)   6C07 FE 3A       		         CP      '9'+1	;
1291)   6C09 3F          		         CCF	;
1292)   6C0A 30 08       		         JR      NC,STR26	;
1293)   6C0C E3          		STR25:  EX      (SP),HL	;
1294)   6C0D CB 75       		         BIT     6,L             ;ZERO FLAG	;ZERO FLAG
1295)   6C0F E3          		         EX      (SP),HL	;
1296)   6C10 20 05       		         JR      NZ,STR27	;
1297)   6C12 3E 30       		         LD      A,'0'	;
1298)   6C14 3C          		STR26:  INC     A               ;SET +VE	;SET +VE
1299)   6C15 3D          		         DEC     A	;
1300)   6C16 F5          		         PUSH    AF              ;PUT ON STACK + CARRY	;PUT ON STACK + CARRY
1301)   6C17 04          		STR27:  INC     B	;
1302)   6C18 CD 99 6E    		         CALL    TEST            ;IS HLH'L' ZERO?	;IS HLH'L' ZERO?
1303)   6C1B 0E 20       		         LD      C,32	;
1304)   6C1D 3E 00       		         LD      A,0	;
1305)   6C1F 20 BB       		         JR      NZ,STR22	;
1306)   6C21 F1          		         POP     AF	;
1307)   6C22 F5          		         PUSH    AF	;
1308)   6C23 3E 00       		         LD      A,0	;
1309)   6C25 38 B5       		         JR      C,STR22	;
1317)   6C27 EB          		STR3:  EX      DE,HL           ;STRING POINTER	;STRING POINTER
1318)   6C28 0E FF       		         LD      C,-1            ;FLAG "E"	;FLAG "E"
1319)   6C2A 16 01       		         LD      D,1	;
1320)   6C2C DD 5E 01    		         LD      E,(IX+1)        ;f2	;f2
1321)   6C2F DD CB 02 46 		         BIT     0,(IX+2)	;
1322)   6C33 20 32       		         JR      NZ,STR34        ;E MODE	;E MODE
1323)   6C35 DD CB 02 4E 		         BIT     1,(IX+2)	;
1324)   6C39 28 11       		         JR      Z,STR31	;
1325)   6C3B 78          		         LD      A,B             ;F MODE	;F MODE
1326)   6C3C B7          		         OR      A	;
1327)   6C3D 28 04       		         JR      Z,STR30	;
1328)   6C3F FA 43 6C    		         JP      M,STR30	;
1329)   6C42 50          		         LD      D,B	;
1330)   6C43 7A          		STR30:  LD      A,D	;
1331)   6C44 DD 86 01    		         ADD     A,(IX+1)	;
1332)   6C47 5F          		         LD      E,A	;
1333)   6C48 FE 0B       		         CP      11	;
1334)   6C4A 38 17       		         JR      C,STR32	;
1335)   6C4C 78          		STR31:  LD      A,B             ;G MODE	;G MODE
1336)   6C4D 11 01 01    		         LD      DE,101H	;
1337)   6C50 B7          		         OR      A	;
1338)   6C51 FA 67 6C    		         JP      M,STR34	;
1339)   6C54 28 0D       		         JR      Z,STR32	;
1340)   6C56 DD 7E 01    		         LD      A,(IX+1)	;
1341)   6C59 B7          		         OR      A	;
1342)   6C5A 20 02       		         JR      NZ,STR3A	;
1343)   6C5C 3E 0A       		         LD      A,10	;
1344)   6C5E B8          		STR3A:  CP      B	;
1345)   6C5F 38 06       		         JR      C,STR34	;
1346)   6C61 50          		         LD      D,B	;
1347)   6C62 58          		         LD      E,B	;
1348)   6C63 78          		STR32:  LD      A,B	;
1349)   6C64 C6 81       		         ADD     A,129	;
1350)   6C66 4F          		         LD      C,A	;
1351)   6C67 CB FA       		STR34:  SET     7,D	;
1352)   6C69 1D          		         DEC     E	;
1353)   6C6A 7A          		STR35:  LD      A,D	;
1354)   6C6B B9          		         CP      C	;
1355)   6C6C 30 0C       		         JR      NC,STR33	;
1356)   6C6E F1          		STR36:  POP     AF	;
1357)   6C6F 28 03       		         JR      Z,STR37	;
1358)   6C71 F2 7C 6C    		         JP      P,STR38	;
1359)   6C74 F5          		STR37:  PUSH    AF	;
1360)   6C75 1C          		         INC     E	;
1361)   6C76 1D          		         DEC     E	;
1362)   6C77 FA 8B 6C    		         JP      M,STR4	;
1363)   6C7A 3E 30       		STR33:  LD      A,'0'	;
1364)   6C7C 15          		STR38:  DEC     D	;
1365)   6C7D E2 83 6C    		         JP      PO,STR39	;
1366)   6C80 36 2E       		         LD      (HL),'.'	;
1367)   6C82 23          		         INC     HL	;
1368)   6C83 77          		STR39:  LD      (HL),A	;
1369)   6C84 23          		         INC     HL	;
1370)   6C85 1D          		         DEC     E	;
1371)   6C86 F2 6A 6C    		         JP      P,STR35	;
1372)   6C89 18 E3       		         JR      STR36	;
1374)   6C8B F1          		STR4:  POP     AF	;
1375)   6C8C 0C          		STR40:  INC     C	;
1376)   6C8D 4D          		         LD      C,L	;
1377)   6C8E 20 27       		         JR      NZ,STR44	;
1378)   6C90 36 45       		         LD      (HL),'E'        ;EXPONENT	;EXPONENT
1379)   6C92 23          		         INC     HL	;
1380)   6C93 78          		         LD      A,B	;
1381)   6C94 3D          		         DEC     A	;
1382)   6C95 F2 9D 6C    		         JP      P,STR41	;
1383)   6C98 36 2D       		         LD      (HL),'-'	;
1384)   6C9A 23          		         INC     HL	;
1385)   6C9B ED 44       		         NEG	;
1386)   6C9D 36 30       		STR41:  LD      (HL),'0'	;
1387)   6C9F 28 15       		         JR      Z,STR47	;
1388)   6CA1 FE 0A       		         CP      10	;
1389)   6CA3 47          		         LD      B,A	;
1390)   6CA4 3E 3A       		         LD      A,':'	;
1391)   6CA6 38 03       		         JR      C,STR42	;
1392)   6CA8 23          		         INC     HL	;
1393)   6CA9 36 30       		         LD      (HL),'0'	;
1394)   6CAB 34          		STR42:  INC     (HL)	;
1395)   6CAC BE          		         CP      (HL)	;
1396)   6CAD 20 05       		         JR      NZ,STR43	;
1397)   6CAF 36 30       		         LD      (HL),'0'	;
1398)   6CB1 2B          		         DEC     HL	;
1399)   6CB2 34          		         INC     (HL)	;
1400)   6CB3 23          		         INC     HL	;
1401)   6CB4 10 F5       		STR43:  DJNZ    STR42	;
1402)   6CB6 23          		STR47:  INC     HL	;
1403)   6CB7 EB          		STR44:  EX      DE,HL	;
1404)   6CB8 C9          		        RET	;
1408)   6CB9 DD 46 04    		DLOAD5:  LD      B,(IX+4)	;
1409)   6CBC D9          		         EXX	;
1410)   6CBD DD 5E 00    		         LD      E,(IX+0)	;
1411)   6CC0 DD 56 01    		         LD      D,(IX+1)	;
1412)   6CC3 D9          		         EXX	;
1413)   6CC4 DD 5E 02    		         LD      E,(IX+2)	;
1414)   6CC7 DD 56 03    		         LD      D,(IX+3)	;
1415)   6CCA C9          		         RET	;
1423)   6CCB CD B9 6E    		CON:  CALL    ZERO            ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1424)   6CCE 0E 00       		         LD      C,0             ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1425)   6CD0 CD 50 6D    		         CALL    NUMBER          ;GET INTEGER PART	;GET INTEGER PART
1426)   6CD3 FE 2E       		         CP      '.'	;
1427)   6CD5 06 00       		         LD      B,0             ;DECL. PLACE COUNTER	;DECL. PLACE COUNTER
1428)   6CD7 CC 4E 6D    		         CALL    Z,NUMBIX        ;GET FRACTION PART	;GET FRACTION PART
1429)   6CDA FE 45       		         CP      'E'	;
1430)   6CDC 3E 00       		         LD      A,0             ;INITIALISE EXPONENT	;INITIALISE EXPONENT
1431)   6CDE CC 1F 6D    		         CALL    Z,GETEXP        ;GET EXPONENT	;GET EXPONENT
1432)   6CE1 CB 7C       		         BIT     7,H	;
1433)   6CE3 20 08       		         JR      NZ,CON0         ;INTEGER OVERFLOW	;INTEGER OVERFLOW
1434)   6CE5 B7          		         OR      A	;
1435)   6CE6 20 05       		         JR      NZ,CON0         ;EXPONENT NON-ZERO	;EXPONENT NON-ZERO
1436)   6CE8 B8          		         CP      B	;
1437)   6CE9 20 02       		         JR      NZ,CON0         ;DECIMAL POINT	;DECIMAL POINT
1438)   6CEB B9          		         CP      C	;
1439)   6CEC C8          		         RET     Z               ;INTEGER	;INTEGER
1440)   6CED 90          		CON0:  SUB     B	;
1441)   6CEE 81          		         ADD     A,C	;
1442)   6CEF 0E 9F       		         LD      C,159	;
1443)   6CF1 CD 30 6E    		         CALL    FLOAT	;
1444)   6CF4 CB BC       		         RES     7,H             ;DITCH IMPLIED 1	;DITCH IMPLIED 1
1445)   6CF6 B7          		         OR      A	;
1446)   6CF7 C8          		         RET     Z               ;DONE	;DONE
1447)   6CF8 FA 03 6D    		         JP      M,CON2          ;NEGATIVE EXPONENT	;NEGATIVE EXPONENT
1448)   6CFB CD 8D 6F    		         CALL    POWR10	;
1449)   6CFE CD C5 66    		         CALL    FMUL            ;SCALE	;SCALE
1450)   6D01 AF          		         XOR     A	;
1451)   6D02 C9          		         RET	;
1452)   6D03 FE DA       		CON2:  CP      -38	;
1453)   6D05 38 0A       		         JR      C,CON3          ;CAN'T SCALE IN ONE GO	;CAN'T SCALE IN ONE GO
1454)   6D07 ED 44       		         NEG	;
1455)   6D09 CD 8D 6F    		         CALL    POWR10	;
1456)   6D0C CD 32 66    		         CALL    FDIV            ;SCALE	;SCALE
1457)   6D0F AF          		         XOR     A	;
1458)   6D10 C9          		         RET	;
1459)   6D11 F5          		CON3:  PUSH    AF	;
1460)   6D12 3E 26       		         LD      A,38	;
1461)   6D14 CD 8D 6F    		         CALL    POWR10	;
1462)   6D17 CD 32 66    		         CALL    FDIV	;
1463)   6D1A F1          		         POP     AF	;
1464)   6D1B C6 26       		         ADD     A,38	;
1465)   6D1D 18 E4       		         JR      CON2	;
1475)   6D1F C5          		GETEXP:  PUSH    BC              ;SAVE REGISTERS	;SAVE REGISTERS
1476)   6D20 47          		         LD      B,A             ;INITIAL VALUE	;INITIAL VALUE
1477)   6D21 0E 02       		         LD      C,2             ;2 DIGITS MAX	;2 DIGITS MAX
1478)   6D23 DD 23       		         INC     IX              ;BUMP PAST 'E'	;BUMP PAST 'E'
1479)   6D25 CD 84 70    		         CALL    SIGNQ	;
1480)   6D28 08          		         EX      AF,AF'          ;SAVE EXPONENT SIGN	;SAVE EXPONENT SIGN
1481)   6D29 CD 7A 70    		GETEX1:  CALL    DIGITQ	;
1482)   6D2C 38 17       		         JR      C,GETEX2	;
1483)   6D2E 78          		         LD      A,B             ;B=B*10	;B=B*10
1484)   6D2F 87          		         ADD     A,A	;
1485)   6D30 87          		         ADD     A,A	;
1486)   6D31 80          		         ADD     A,B	;
1487)   6D32 87          		         ADD     A,A	;
1488)   6D33 47          		         LD      B,A	;
1489)   6D34 DD 7E 00    		         LD      A,(IX)          ;GET BACK DIGIT	;GET BACK DIGIT
1490)   6D37 DD 23       		         INC     IX	;
1491)   6D39 E6 0F       		         AND     0FH             ;MASK UNWANTED BITS	;MASK UNWANTED BITS
1492)   6D3B 80          		         ADD     A,B             ;ADD IN DIGIT	;ADD IN DIGIT
1493)   6D3C 47          		         LD      B,A	;
1494)   6D3D 0D          		         DEC     C	;
1495)   6D3E F2 29 6D    		         JP      P,GETEX1	;
1496)   6D41 06 64       		         LD      B,100           ;FORCE OVERFLOW	;FORCE OVERFLOW
1497)   6D43 18 E4       		         JR      GETEX1	;
1498)   6D45 08          		GETEX2:  EX      AF,AF'          ;RESTORE SIGN	;RESTORE SIGN
1499)   6D46 FE 2D       		         CP      '-'	;
1500)   6D48 78          		         LD      A,B	;
1501)   6D49 C1          		         POP     BC              ;RESTORE	;RESTORE
1502)   6D4A C0          		         RET     NZ	;
1503)   6D4B ED 44       		         NEG                     ;NEGATE EXPONENT	;NEGATE EXPONENT
1504)   6D4D C9          		         RET	;
1517)   6D4E DD 23       		NUMBIX:  INC     IX	;
1518)   6D50 CD 7A 70    		NUMBER:  CALL    DIGITQ	;
1519)   6D53 D8          		         RET     C	;
1520)   6D54 04          		         INC     B               ;INCREMENT DIGIT COUNT	;INCREMENT DIGIT COUNT
1521)   6D55 DD 23       		         INC     IX	;
1522)   6D57 CD 04 6F    		         CALL    X10             ;*10 & COPY OLD VALUE	;*10 & COPY OLD VALUE
1523)   6D5A 38 13       		         JR      C,NUMB1         ;OVERFLOW	;OVERFLOW
1524)   6D5C 0D          		         DEC     C               ;SEE IF TRUNCATED	;SEE IF TRUNCATED
1525)   6D5D 0C          		         INC     C	;
1526)   6D5E 20 0F       		         JR      NZ,NUMB1        ;IMPORTANT!	;IMPORTANT!
1527)   6D60 E6 0F       		         AND     0FH	;
1528)   6D62 D9          		         EXX	;
1529)   6D63 06 00       		         LD      B,0	;
1530)   6D65 4F          		         LD      C,A	;
1531)   6D66 09          		         ADD     HL,BC           ;ADD IN DIGIT	;ADD IN DIGIT
1532)   6D67 D9          		         EXX	;
1533)   6D68 30 E6       		         JR      NC,NUMBER	;
1534)   6D6A 23          		         INC     HL              ;CARRY	;CARRY
1535)   6D6B 7C          		         LD      A,H	;
1536)   6D6C B5          		         OR      L	;
1537)   6D6D 20 E1       		         JR      NZ,NUMBER	;
1538)   6D6F 0C          		NUMB1:  INC     C               ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1539)   6D70 CD 77 6E    		         CALL    SWAP1           ;RESTORE PREVIOUS VALUE	;RESTORE PREVIOUS VALUE
1540)   6D73 18 DB       		         JR      NUMBER	;
1550)   6D75 08          		FIX:  EX      AF,AF'	;
1551)   6D76 AF          		         XOR     A	;
1552)   6D77 08          		         EX      AF,AF'	;
1553)   6D78 CB FC       		         SET     7,H             ;IMPLIED 1	;IMPLIED 1
1554)   6D7A CD 7C 6E    		FIX1:  CALL    DIV2	;
1555)   6D7D B9          		         CP      C	;
1556)   6D7E C8          		         RET     Z	;
1557)   6D7F D2 7A 6D    		         JP      NC,FIX1	;
1558)   6D82 C3 8A 6E    		         JP      OFLOW	;
1568)   6D85 CD 74 6E    		FIX2:  CALL    SWAP	;
1569)   6D88 CD 8E 6D    		         CALL    SFIX	;
1570)   6D8B CD 74 6E    		         CALL    SWAP	;
1571)   6D8E 0D          		SFIX:  DEC     C	;
1572)   6D8F 0C          		         INC     C	;
1573)   6D90 C8          		         RET     Z               ;INTEGER/ZERO	;INTEGER/ZERO
1574)   6D91 CB 7C       		         BIT     7,H             ;SIGN	;SIGN
1575)   6D93 F5          		         PUSH    AF	;
1576)   6D94 3E 9F       		         LD      A,159	;
1577)   6D96 CD 75 6D    		         CALL    FIX	;
1578)   6D99 F1          		         POP     AF	;
1579)   6D9A 0E 00       		         LD      C,0	;
1580)   6D9C C8          		         RET     Z	;
1581)   6D9D B7          		NEGATE:  OR      A               ;CLEAR CARRY	;CLEAR CARRY
1582)   6D9E D9          		         EXX	;
1583)   6D9F D5          		NEG0:  PUSH    DE	;
1584)   6DA0 EB          		         EX      DE,HL	;
1585)   6DA1 21 00 00    		         LD      HL,0	;
1586)   6DA4 ED 52       		         SBC     HL,DE	;
1587)   6DA6 D1          		         POP     DE	;
1588)   6DA7 D9          		         EXX	;
1589)   6DA8 D5          		         PUSH    DE	;
1590)   6DA9 EB          		         EX      DE,HL	;
1591)   6DAA 21 00 00    		         LD      HL,0	;
1592)   6DAD ED 52       		         SBC     HL,DE	;
1593)   6DAF D1          		         POP     DE	;
1594)   6DB0 C9          		         RET	;
1600)   6DB1 D9          		NEG:  EXX	;
1601)   6DB2 2F          		         CPL	;
1602)   6DB3 E5          		         PUSH    HL	;
1603)   6DB4 B7          		         OR      A               ;CLEAR CARRY	;CLEAR CARRY
1604)   6DB5 21 00 00    		         LD      HL,0	;
1605)   6DB8 ED 42       		         SBC     HL,BC	;
1606)   6DBA 44          		         LD      B,H	;
1607)   6DBB 4D          		         LD      C,L	;
1608)   6DBC E1          		         POP     HL	;
1609)   6DBD 18 E0       		         JR      NEG0	;
1622)   6DBF 3E 96       		SCALE:  LD      A,150	;
1623)   6DC1 B9          		         CP      C	;
1624)   6DC2 3E 17       		         LD      A,ACLOST	;
1625)   6DC4 DA AD 64    		         JP      C,ERROR         ;"Accuracy lost"	;"Accuracy lost"
1626)   6DC7 CD 93 69    		         CALL    PIBY4	;
1627)   6DCA D9          		         EXX	;
1628)   6DCB 01 69 21    		         LD      BC,2169H        ;3.141592653589793238	;3.141592653589793238
1629)   6DCE D9          		         EXX	;
1630)   6DCF CB FA       		MOD48:  SET     7,D             ;IMPLIED 1	;IMPLIED 1
1631)   6DD1 CB FC       		         SET     7,H	;
1632)   6DD3 79          		         LD      A,C	;
1633)   6DD4 0E 00       		         LD      C,0             ;INIT QUOTIENT	;INIT QUOTIENT
1634)   6DD6 DD 21 00 00 		         LD      IX,0	;
1635)   6DDA DD E5       		         PUSH    IX              ;PUT ZERO ON STACK	;PUT ZERO ON STACK
1636)   6DDC B8          		         CP      B	;
1637)   6DDD 38 3A       		         JR      C,MOD485        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1638)   6DDF D9          		MOD481:  EXX                     ;CARRY=0 HERE	;CARRY=0 HERE
1639)   6DE0 E3          		         EX      (SP),HL	;
1640)   6DE1 ED 42       		         SBC     HL,BC	;
1641)   6DE3 E3          		         EX      (SP),HL	;
1642)   6DE4 ED 52       		         SBC     HL,DE	;
1643)   6DE6 D9          		         EXX	;
1644)   6DE7 ED 52       		         SBC     HL,DE	;
1645)   6DE9 30 09       		         JR      NC,MOD482       ;DIVIDEND>=DIVISOR	;DIVIDEND>=DIVISOR
1646)   6DEB D9          		         EXX	;
1647)   6DEC E3          		         EX      (SP),HL	;
1648)   6DED 09          		         ADD     HL,BC	;
1649)   6DEE E3          		         EX      (SP),HL	;
1650)   6DEF ED 5A       		         ADC     HL,DE	;
1651)   6DF1 D9          		         EXX	;
1652)   6DF2 ED 5A       		         ADC     HL,DE	;
1653)   6DF4 3F          		MOD482:  CCF	;
1654)   6DF5 CB 11       		         RL      C               ;QUOTIENT	;QUOTIENT
1655)   6DF7 30 02       		         JR      NC,MOD483	;
1656)   6DF9 CB F9       		         SET     7,C             ;STICKY BIT	;STICKY BIT
1657)   6DFB 3D          		MOD483:  DEC     A	;
1658)   6DFC B8          		         CP      B	;
1659)   6DFD 38 19       		         JR      C,MOD484        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1660)   6DFF E3          		         EX      (SP),HL	;
1661)   6E00 29          		         ADD     HL,HL           ;DIVIDEND * 2	;DIVIDEND * 2
1662)   6E01 E3          		         EX      (SP),HL	;
1663)   6E02 D9          		         EXX	;
1664)   6E03 ED 6A       		         ADC     HL,HL	;
1665)   6E05 D9          		         EXX	;
1666)   6E06 ED 6A       		         ADC     HL,HL	;
1667)   6E08 30 D5       		         JR      NC,MOD481       ;AGAIN	;AGAIN
1668)   6E0A B7          		         OR      A	;
1669)   6E0B D9          		         EXX	;
1670)   6E0C E3          		         EX      (SP),HL	;
1671)   6E0D ED 42       		         SBC     HL,BC           ;OVERFLOW, SO SUBTRACT	;OVERFLOW, SO SUBTRACT
1672)   6E0F E3          		         EX      (SP),HL	;
1673)   6E10 ED 52       		         SBC     HL,DE	;
1674)   6E12 D9          		         EXX	;
1675)   6E13 ED 52       		         SBC     HL,DE	;
1676)   6E15 B7          		         OR      A	;
1677)   6E16 18 DC       		         JR      MOD482	;
1679)   6E18 3C          		MOD484:  INC     A	;
1680)   6E19 59          		MOD485:  LD      E,C             ;QUOTIENT	;QUOTIENT
1681)   6E1A 4F          		         LD      C,A             ;REMAINDER EXPONENT	;REMAINDER EXPONENT
1682)   6E1B D9          		         EXX	;
1683)   6E1C C1          		         POP     BC	;
1684)   6E1D D9          		         EXX	;
1685)   6E1E CB 7C       		FLO48:  BIT     7,H	;
1686)   6E20 C0          		         RET     NZ	;
1687)   6E21 D9          		         EXX	;
1688)   6E22 CB 21       		         SLA     C	;
1689)   6E24 CB 10       		         RL      B	;
1690)   6E26 ED 6A       		         ADC     HL,HL	;
1691)   6E28 D9          		         EXX	;
1692)   6E29 ED 6A       		         ADC     HL,HL	;
1693)   6E2B 0D          		         DEC     C	;
1694)   6E2C C2 1E 6E    		         JP      NZ,FLO48	;
1695)   6E2F C9          		         RET	;
1701)   6E30 CB 7C       		FLOAT:  BIT     7,H	;
1702)   6E32 C0          		         RET     NZ	;
1703)   6E33 D9          		         EXX                     ;SAME AS "X2"	;SAME AS "X2"
1704)   6E34 29          		         ADD     HL,HL           ;TIME-CRITICAL	;TIME-CRITICAL
1705)   6E35 D9          		         EXX                     ;REGION	;REGION
1706)   6E36 ED 6A       		         ADC     HL,HL           ;(BENCHMARKS)	;(BENCHMARKS)
1707)   6E38 0D          		         DEC     C	;
1708)   6E39 C2 30 6E    		         JP      NZ,FLOAT	;
1709)   6E3C C9          		         RET	;
1716)   6E3D 08          		FLOATA:  EX      AF,AF'	;
1717)   6E3E C6 2A       		         ADD     A,(RTABLE-DTABLE)/2	;
1718)   6E40 08          		         EX      AF,AF'	;
1719)   6E41 CD 74 6E    		FLOAT2:  CALL    SWAP	;
1720)   6E44 CD 4A 6E    		         CALL    SFLOAT	;
1721)   6E47 CD 74 6E    		         CALL    SWAP	;
1722)   6E4A 0D          		SFLOAT:  DEC     C	;
1723)   6E4B 0C          		         INC     C	;
1724)   6E4C C0          		         RET     NZ              ;ALREADY FLOATING-POINT	;ALREADY FLOATING-POINT
1725)   6E4D CD 99 6E    		         CALL    TEST	;
1726)   6E50 C8          		         RET     Z               ;ZERO	;ZERO
1727)   6E51 7C          		         LD      A,H	;
1728)   6E52 B7          		         OR      A	;
1729)   6E53 FC 9D 6D    		         CALL    M,NEGATE	;
1730)   6E56 0E 9F       		         LD      C,159	;
1731)   6E58 CD 30 6E    		         CALL    FLOAT	;
1732)   6E5B B7          		         OR      A	;
1733)   6E5C F8          		         RET     M               ;NEGATIVE	;NEGATIVE
1734)   6E5D CB BC       		         RES     7,H	;
1735)   6E5F C9          		         RET	;
1741)   6E60 D9          		ADD1:  EXX	;
1742)   6E61 01 01 00    		         LD      BC,1	;
1743)   6E64 09          		         ADD     HL,BC	;
1744)   6E65 D9          		         EXX	;
1745)   6E66 D0          		         RET     NC	;
1746)   6E67 C5          		         PUSH    BC	;
1747)   6E68 01 01 00    		         LD      BC,1	;
1748)   6E6B 09          		         ADD     HL,BC	;
1749)   6E6C C1          		         POP     BC	;
1750)   6E6D C9          		         RET	;
1757)   6E6E B7          		ODD:  OR      A               ;CLEAR CARRY	;CLEAR CARRY
1758)   6E6F D9          		         EXX	;
1759)   6E70 CB C5       		         SET     0,L             ;MAKE ODD	;MAKE ODD
1760)   6E72 D9          		         EXX	;
1761)   6E73 C9          		         RET	;
1769)   6E74 79          		SWAP:  LD      A,C	;
1770)   6E75 48          		         LD      C,B	;
1771)   6E76 47          		         LD      B,A	;
1772)   6E77 EB          		SWAP1:  EX      DE,HL	;
1773)   6E78 D9          		         EXX	;
1774)   6E79 EB          		         EX      DE,HL	;
1775)   6E7A D9          		         EXX	;
1776)   6E7B C9          		         RET	;
1782)   6E7C CD 1A 6F    		DIV2:  CALL    D2	;
1783)   6E7F D9          		         EXX	;
1784)   6E80 CB 18       		         RR      B	;
1785)   6E82 CB 19       		         RR      C	;
1786)   6E84 08          		         EX      AF,AF'	;
1787)   6E85 B0          		         OR      B	;
1788)   6E86 08          		         EX      AF,AF'	;
1789)   6E87 D9          		         EXX	;
1790)   6E88 0C          		INCC:  INC     C	;
1791)   6E89 C0          		         RET     NZ	;
1792)   6E8A 3E 14       		OFLOW:  LD      A,TOOBIG	;
1793)   6E8C C3 AD 64    		         JP      ERROR           ;"Too big"	;"Too big"
1798)   6E8F CD 99 6E    		FTEST:  CALL    TEST	;
1799)   6E92 C8          		         RET     Z	;
1800)   6E93 7C          		         LD      A,H	;
1801)   6E94 E6 80       		         AND     10000000B	;
1802)   6E96 F6 40       		         OR      01000000B	;
1803)   6E98 C9          		         RET	;
1809)   6E99 7C          		TEST:  LD      A,H	;
1810)   6E9A B5          		         OR      L	;
1811)   6E9B D9          		         EXX	;
1812)   6E9C B4          		         OR      H	;
1813)   6E9D B5          		         OR      L	;
1814)   6E9E D9          		         EXX	;
1815)   6E9F C9          		         RET	;
1820)   6EA0 78          		FCOMP:  LD      A,B	;
1821)   6EA1 B1          		         OR      C               ;Both integer?	;Both integer?
1822)   6EA2 20 0A       		         JR      NZ,FCOMP1	;
1823)   6EA4 CD B6 6E    		         CALL    ICP	;
1824)   6EA7 3E 00       		FCOMP0:  LD      A,0	;
1825)   6EA9 C8          		         RET     Z               ;Equal	;Equal
1826)   6EAA 3E 80       		         LD      A,80H	;
1827)   6EAC 1F          		         RRA	;
1828)   6EAD C9          		         RET	;
1830)   6EAE CD 41 6E    		FCOMP1:  CALL    FLOAT2          ;Float both	;Float both
1831)   6EB1 CD C3 6E    		         CALL    FCP	;
1832)   6EB4 18 F1       		         JR      FCOMP0	;
1842)   6EB6 CD E2 6E    		ICP:  CALL    ICP1	;
1843)   6EB9 3E 00       		ZERO:  LD      A,0	;
1844)   6EBB D9          		         EXX	;
1845)   6EBC 67          		         LD      H,A	;
1846)   6EBD 6F          		         LD      L,A	;
1847)   6EBE D9          		         EXX	;
1848)   6EBF 67          		         LD      H,A	;
1849)   6EC0 6F          		         LD      L,A	;
1850)   6EC1 4F          		         LD      C,A	;
1851)   6EC2 C9          		         RET	;
1853)   6EC3 CD D5 6E    		FCP:  CALL    FCP1	;
1854)   6EC6 18 F1       		         JR      ZERO            ;PRESET FALSE	;PRESET FALSE
1856)   6EC8 79          		FCP0:  LD      A,C	;
1857)   6EC9 B8          		         CP      B               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
1858)   6ECA C0          		         RET     NZ	;
1859)   6ECB ED 52       		ICP0:  SBC     HL,DE           ;COMP MANTISSA MSB	;COMP MANTISSA MSB
1860)   6ECD 19          		         ADD     HL,DE	;
1861)   6ECE C0          		         RET     NZ	;
1862)   6ECF D9          		         EXX	;
1863)   6ED0 ED 52       		         SBC     HL,DE           ;COMP MANTISSA LSB	;COMP MANTISSA LSB
1864)   6ED2 19          		         ADD     HL,DE	;
1865)   6ED3 D9          		         EXX	;
1866)   6ED4 C9          		         RET	;
1868)   6ED5 7C          		FCP1:  LD      A,H	;
1869)   6ED6 AA          		         XOR     D	;
1870)   6ED7 7C          		         LD      A,H	;
1871)   6ED8 17          		         RLA	;
1872)   6ED9 F8          		         RET     M	;
1873)   6EDA 30 EC       		         JR      NC,FCP0	;
1874)   6EDC CD C8 6E    		         CALL    FCP0	;
1875)   6EDF C8          		         RET     Z               ;** V0.1 BUG FIX	;** V0.1 BUG FIX
1876)   6EE0 3F          		         CCF	;
1877)   6EE1 C9          		         RET	;
1879)   6EE2 7C          		ICP1:  LD      A,H	;
1880)   6EE3 AA          		         XOR     D	;
1881)   6EE4 F2 CB 6E    		         JP      P,ICP0	;
1882)   6EE7 7C          		         LD      A,H	;
1883)   6EE8 17          		         RLA	;
1884)   6EE9 C9          		         RET	;
1890)   6EEA 05          		X10B:  DEC     B	;
1891)   6EEB 0C          		         INC     C	;
1892)   6EEC CD 26 6F    		X5:  CALL    COPY0	;
1893)   6EEF CD 19 6F    		         CALL    D2C	;
1894)   6EF2 CD 19 6F    		         CALL    D2C	;
1895)   6EF5 08          		         EX      AF,AF'          ;SAVE CARRY	;SAVE CARRY
1896)   6EF6 D9          		ADD:  EXX	;
1897)   6EF7 19          		         ADD     HL,DE	;
1898)   6EF8 D9          		         EXX	;
1899)   6EF9 ED 5A       		         ADC     HL,DE	;
1900)   6EFB C9          		         RET	;
1906)   6EFC D9          		SUB:  EXX	;
1907)   6EFD B7          		         OR      A	;
1908)   6EFE ED 52       		         SBC     HL,DE	;
1909)   6F00 D9          		         EXX	;
1910)   6F01 ED 52       		         SBC     HL,DE	;
1911)   6F03 C9          		         RET	;
1924)   6F04 CD 26 6F    		X10:  CALL    COPY0           ;DED'E'=HLH'L'	;DED'E'=HLH'L'
1925)   6F07 CD 13 6F    		         CALL    X2	;
1926)   6F0A D8          		         RET     C               ;TOO BIG	;TOO BIG
1927)   6F0B CD 13 6F    		         CALL    X2	;
1928)   6F0E D8          		         RET     C	;
1929)   6F0F CD F6 6E    		         CALL    ADD	;
1930)   6F12 D8          		         RET     C	;
1931)   6F13 D9          		X2:  EXX	;
1932)   6F14 29          		         ADD     HL,HL	;
1933)   6F15 D9          		         EXX	;
1934)   6F16 ED 6A       		         ADC     HL,HL	;
1935)   6F18 C9          		         RET	;
1941)   6F19 0C          		D2C:  INC     C	;
1942)   6F1A CB 3C       		D2:  SRL     H	;
1943)   6F1C CB 1D       		         RR      L	;
1944)   6F1E D9          		         EXX	;
1945)   6F1F CB 1C       		         RR      H	;
1946)   6F21 CB 1D       		         RR      L	;
1947)   6F23 D9          		         EXX	;
1948)   6F24 C9          		         RET	;
1953)   6F25 41          		COPY:  LD      B,C	;
1954)   6F26 54          		COPY0:  LD      D,H	;
1955)   6F27 5D          		         LD      E,L	;
1956)   6F28 D9          		         EXX	;
1957)   6F29 54          		         LD      D,H	;
1958)   6F2A 5D          		         LD      E,L	;
1959)   6F2B D9          		         EXX	;
1960)   6F2C C9          		         RET	;
1966)   6F2D CD 25 6F    		SQUARE:  CALL    COPY	;
1967)   6F30 CD C5 66    		         CALL    FMUL	;
1968)   6F33 DD E1       		PUSH5:  POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1969)   6F35 C5          		         PUSH    BC	;
1970)   6F36 E5          		         PUSH    HL	;
1971)   6F37 D9          		         EXX	;
1972)   6F38 E5          		         PUSH    HL	;
1973)   6F39 D9          		         EXX	;
1974)   6F3A DD E9       		         JP      (IX)            ;"RETURN"	;"RETURN"
1979)   6F3C DD E1       		POP5:  POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1980)   6F3E D9          		         EXX	;
1981)   6F3F D1          		         POP     DE	;
1982)   6F40 D9          		         EXX	;
1983)   6F41 D1          		         POP     DE	;
1984)   6F42 79          		         LD      A,C	;
1985)   6F43 C1          		         POP     BC	;
1986)   6F44 41          		         LD      B,C	;
1987)   6F45 4F          		         LD      C,A	;
1988)   6F46 DD E9       		         JP      (IX)            ;"RETURN"	;"RETURN"
1995)   6F48 CD 33 6F    		RATIO:  CALL    PUSH5           ;SAVE X	;SAVE X
1996)   6F4B CD 88 69    		         CALL    DONE	;
1997)   6F4E CD DA 65    		         CALL    FADD	;
1998)   6F51 CD 3C 6F    		         CALL    POP5            ;RESTORE X	;RESTORE X
1999)   6F54 CD 33 6F    		         CALL    PUSH5           ;SAVE X+1	;SAVE X+1
2000)   6F57 CD 74 6E    		         CALL    SWAP	;
2001)   6F5A CD 88 69    		         CALL    DONE	;
2002)   6F5D CD C4 65    		         CALL    FSUB	;
2003)   6F60 CD 3C 6F    		         CALL    POP5            ;RESTORE X+1	;RESTORE X+1
2004)   6F63 C3 32 66    		         JP      FDIV	;
2015)   6F66 DD 21 02 00 		POLY:  LD      IX,2	;
2016)   6F6A DD 39       		         ADD     IX,SP	;
2017)   6F6C DD E3       		         EX      (SP),IX	;
2018)   6F6E CD B9 6C    		         CALL    DLOAD5          ;FIRST COEFFICIENT	;FIRST COEFFICIENT
2019)   6F71 CD C5 66    		POLY1:  CALL    FMUL	;
2020)   6F74 11 05 00    		         LD      DE,5	;
2021)   6F77 DD 19       		         ADD     IX,DE	;
2022)   6F79 CD B9 6C    		         CALL    DLOAD5          ;NEXT COEFFICIENT	;NEXT COEFFICIENT
2023)   6F7C DD E3       		         EX      (SP),IX	;
2024)   6F7E 04          		         INC     B	;
2025)   6F7F 05          		         DEC     B               ;TEST	;TEST
2026)   6F80 FA DA 65    		         JP      M,FADD	;
2027)   6F83 CD DA 65    		         CALL    FADD	;
2028)   6F86 CD B9 6C    		         CALL    DLOAD5          ;X	;X
2029)   6F89 DD E3       		         EX      (SP),IX	;
2030)   6F8B 18 E4       		         JR      POLY1	;
2039)   6F8D 3C          		POWR10:  INC     A	;
2040)   6F8E 08          		         EX      AF,AF'	;
2041)   6F8F E5          		         PUSH    HL	;
2042)   6F90 D9          		         EXX	;
2043)   6F91 E5          		         PUSH    HL	;
2044)   6F92 D9          		         EXX	;
2045)   6F93 CD 88 69    		         CALL    DONE	;
2046)   6F96 CD 74 6E    		         CALL    SWAP	;
2047)   6F99 AF          		         XOR     A	;
2048)   6F9A 08          		POWR11:  EX      AF,AF'	;
2049)   6F9B 3D          		         DEC     A	;
2050)   6F9C 28 20       		         JR      Z,POWR14        ;EXIT TYPE 1	;EXIT TYPE 1
2051)   6F9E F2 A5 6F    		         JP      P,POWR13	;
2052)   6FA1 B9          		         CP      C	;
2053)   6FA2 38 1A       		         JR      C,POWR14        ;EXIT TYPE 2	;EXIT TYPE 2
2054)   6FA4 3C          		         INC     A	;
2055)   6FA5 08          		POWR13:  EX      AF,AF'	;
2056)   6FA6 3C          		         INC     A	;
2057)   6FA7 CB FC       		         SET     7,H	;
2058)   6FA9 CD EC 6E    		         CALL    X5	;
2059)   6FAC 30 05       		         JR      NC,POWR12	;
2060)   6FAE 08          		         EX      AF,AF'	;
2061)   6FAF CD 19 6F    		         CALL    D2C	;
2062)   6FB2 08          		         EX      AF,AF'	;
2063)   6FB3 08          		POWR12:  EX      AF,AF'	;
2064)   6FB4 DC 60 6E    		         CALL    C,ADD1          ;ROUND UP	;ROUND UP
2065)   6FB7 0C          		         INC     C	;
2066)   6FB8 FA 9A 6F    		         JP      M,POWR11	;
2067)   6FBB C3 8A 6E    		         JP      OFLOW	;
2068)   6FBE CD 74 6E    		POWR14:  CALL    SWAP	;
2069)   6FC1 CB BA       		         RES     7,D	;
2070)   6FC3 D9          		         EXX	;
2071)   6FC4 E1          		         POP     HL	;
2072)   6FC5 D9          		         EXX	;
2073)   6FC6 E1          		         POP     HL	;
2074)   6FC7 08          		         EX      AF,AF'	;
2075)   6FC8 C9          		         RET	;
2083)   6FC9 B7          		DIVA:  OR      A               ;CLEAR CARRY	;CLEAR CARRY
2084)   6FCA ED 42       		DIV0:  SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2085)   6FCC D9          		         EXX	;
2086)   6FCD ED 42       		         SBC     HL,BC	;
2087)   6FCF D9          		         EXX	;
2088)   6FD0 30 05       		         JR      NC,DIV1	;
2089)   6FD2 09          		         ADD     HL,BC           ;DIVIDEND+DIVISOR	;DIVIDEND+DIVISOR
2090)   6FD3 D9          		         EXX	;
2091)   6FD4 ED 4A       		         ADC     HL,BC	;
2092)   6FD6 D9          		         EXX	;
2093)   6FD7 3F          		DIV1:  CCF	;
2094)   6FD8 CB 13       		DIVC:  RL      E               ;SHIFT RESULT INTO DE	;SHIFT RESULT INTO DE
2095)   6FDA CB 12       		         RL      D	;
2096)   6FDC D9          		         EXX	;
2097)   6FDD CB 13       		         RL      E	;
2098)   6FDF CB 12       		         RL      D	;
2099)   6FE1 D9          		         EXX	;
2100)   6FE2 3C          		         INC     A	;
2101)   6FE3 F0          		         RET     P	;
2102)   6FE4 ED 6A       		DIVB:  ADC     HL,HL           ;DIVIDEND*2	;DIVIDEND*2
2103)   6FE6 D9          		         EXX	;
2104)   6FE7 ED 6A       		         ADC     HL,HL	;
2105)   6FE9 D9          		         EXX	;
2106)   6FEA 30 DE       		         JR      NC,DIV0	;
2107)   6FEC B7          		         OR      A	;
2108)   6FED ED 42       		         SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2109)   6FEF D9          		         EXX	;
2110)   6FF0 ED 42       		         SBC     HL,BC	;
2111)   6FF2 D9          		         EXX	;
2112)   6FF3 37          		         SCF	;
2113)   6FF4 C3 D8 6F    		         JP      DIVC	;
2121)   6FF7 B7          		MULA:  OR      A               ;CLEAR CARRY	;CLEAR CARRY
2122)   6FF8 D9          		MUL0:  EXX	;
2123)   6FF9 CB 1A       		         RR      D               ;MULTIPLIER/2	;MULTIPLIER/2
2124)   6FFB CB 1B       		         RR      E	;
2125)   6FFD D9          		         EXX	;
2126)   6FFE CB 1A       		         RR      D	;
2127)   7000 CB 1B       		         RR      E	;
2128)   7002 30 05       		         JR      NC,MUL1	;
2129)   7004 09          		         ADD     HL,BC           ;ADD IN MULTIPLICAND	;ADD IN MULTIPLICAND
2130)   7005 D9          		         EXX	;
2131)   7006 ED 4A       		         ADC     HL,BC	;
2132)   7008 D9          		         EXX	;
2133)   7009 3C          		MUL1:  INC     A	;
2134)   700A F0          		         RET     P	;
2135)   700B D9          		MULB:  EXX	;
2136)   700C CB 1C       		         RR      H               ;PRODUCT/2	;PRODUCT/2
2137)   700E CB 1D       		         RR      L	;
2138)   7010 D9          		         EXX	;
2139)   7011 CB 1C       		         RR      H	;
2140)   7013 CB 1D       		         RR      L	;
2141)   7015 C3 F8 6F    		         JP      MUL0	;
2149)   7018 ED 42       		SQR1: SBC     HL,BC	;
2150)   701A D9          		         EXX	;
2151)   701B ED 42       		         SBC     HL,BC	;
2152)   701D D9          		         EXX	;
2153)   701E 0C          		         INC     C	;
2154)   701F 30 07       		         JR      NC,SQR2	;
2155)   7021 0D          		         DEC     C	;
2156)   7022 09          		         ADD     HL,BC	;
2157)   7023 D9          		         EXX	;
2158)   7024 ED 4A       		         ADC     HL,BC	;
2159)   7026 D9          		         EXX	;
2160)   7027 0D          		         DEC     C	;
2161)   7028 3C          		SQR2:  INC     A	;
2162)   7029 F0          		         RET     P	;
2163)   702A CB 21       		SQRA:  SLA     C	;
2164)   702C CB 10       		         RL      B	;
2165)   702E D9          		         EXX	;
2166)   702F CB 11       		         RL      C	;
2167)   7031 CB 10       		         RL      B	;
2168)   7033 D9          		         EXX	;
2169)   7034 0C          		         INC     C	;
2170)   7035 CB 23       		         SLA     E	;
2171)   7037 CB 12       		         RL      D	;
2172)   7039 D9          		         EXX	;
2173)   703A CB 13       		         RL      E	;
2174)   703C CB 12       		         RL      D	;
2175)   703E D9          		         EXX	;
2176)   703F ED 6A       		         ADC     HL,HL	;
2177)   7041 D9          		         EXX	;
2178)   7042 ED 6A       		         ADC     HL,HL	;
2179)   7044 D9          		         EXX	;
2180)   7045 CB 23       		         SLA     E	;
2181)   7047 CB 12       		         RL      D	;
2182)   7049 D9          		         EXX	;
2183)   704A CB 13       		         RL      E	;
2184)   704C CB 12       		         RL      D	;
2185)   704E D9          		         EXX	;
2186)   704F ED 6A       		         ADC     HL,HL	;
2187)   7051 D9          		         EXX	;
2188)   7052 ED 6A       		         ADC     HL,HL	;
2189)   7054 D9          		         EXX	;
2190)   7055 D2 18 70    		         JP      NC,SQR1	;
2191)   7058 B7          		SQR3:  OR      A	;
2192)   7059 ED 42       		         SBC     HL,BC	;
2193)   705B D9          		         EXX	;
2194)   705C ED 42       		         SBC     HL,BC	;
2195)   705E D9          		         EXX	;
2196)   705F 0C          		         INC     C	;
2197)   7060 C3 28 70    		         JP      SQR2	;
2199)   7063 29          		SQRB:  ADD     HL,HL	;
2200)   7064 D9          		         EXX	;
2201)   7065 ED 6A       		         ADC     HL,HL	;
2202)   7067 D9          		         EXX	;
2203)   7068 38 EE       		         JR      C,SQR3	;
2204)   706A 3C          		         INC     A	;
2205)   706B 0C          		         INC     C	;
2206)   706C ED 42       		         SBC     HL,BC	;
2207)   706E D9          		         EXX	;
2208)   706F ED 42       		         SBC     HL,BC	;
2209)   7071 D9          		         EXX	;
2210)   7072 D0          		         RET     NC	;
2211)   7073 09          		         ADD     HL,BC	;
2212)   7074 D9          		         EXX	;
2213)   7075 ED 4A       		         ADC     HL,BC	;
2214)   7077 D9          		         EXX	;
2215)   7078 0D          		         DEC     C	;
2216)   7079 C9          		         RET	;
2218)   707A DD 7E 00    		DIGITQ:  LD      A,(IX)	;
2219)   707D FE 3A       		         CP      '9'+1	;
2220)   707F 3F          		         CCF	;
2221)   7080 D8          		         RET     C	;
2222)   7081 FE 30       		         CP      '0'	;
2223)   7083 C9          		         RET	;
2225)   7084 DD 7E 00    		SIGNQ:  LD      A,(IX)	;
2226)   7087 DD 23       		         INC     IX	;
2227)   7089 FE 20       		         CP      ' '	;
2228)   708B 28 F7       		         JR      Z,SIGNQ	;
2229)   708D FE 2B       		         CP      '+'	;
2230)   708F C8          		         RET     Z	;
2231)   7090 FE 2D       		         CP      '-'	;
2232)   7092 C8          		         RET     Z	;
2233)   7093 DD 2B       		         DEC     IX	;
2234)   7095 C9          		         RET	;
 12)   7096 	            		@CLRSCN EQU MYOS_CLRSCN	;
 13)   7096 	            		@PUTIME EQU MYOS_PUTIME	;
 14)   7096 	            		@GETIME EQU MYOS_GETIME	;
 15)   7096 	            		@PUTCSR EQU MYOS_PUTCSR	;
 16)   7096 	            		@GETCSR EQU MYOS_GETCSR	;
 17)   7096 	            		@OSRDCH EQU MYOS_OSRDCH	;
 18)   7096 	            		@PROMPT EQU MYOS_PROMPT	;
 19)   7096 	            		@OSWRCH EQU MYOS_OSWRCH	;
 20)   7096 	            		@OSKEY EQU MYOS_OSKEY 	;
 21)   7096 	            		@OSINIT EQU MYOS_OSINIT	;
 22)   7096 	            		@OSLINE EQU MYOS_OSLINE	;
 23)   7096 	            		@OSCLI EQU MYOS_OSCLI 	;
 24)   7096 	            		@OSBPUT EQU MYOS_OSBPUT	;
 25)   7096 	            		@OSBGET EQU MYOS_OSBGET	;
 26)   7096 	            		@OSSTAT EQU MYOS_OSSTAT	;
 27)   7096 	            		@OSSHUT EQU MYOS_OSSHUT	;
 28)   7096 	            		@OSOPEN EQU MYOS_OSOPEN	;
 29)   7096 	            		@OSCALL EQU MYOS_OSCALL	;
 30)   7096 	            		@OSSAVE EQU MYOS_OSSAVE	;
 31)   7096 	            		@OSLOAD EQU MYOS_OSLOAD	;
 32)   7096 	            		@GETPTR EQU MYOS_GETPTR	;
 33)   7096 	            		@PUTPTR EQU MYOS_PUTPTR	;
 34)   7096 	            		@GETEXT EQU MYOS_GETEXT	;
 35)   7096 	            		@RESET EQU MYOS_RESET 	;
 36)   7096 	            		@TRAP  EQU MYOS_TRAP  	;
 37)   7096 	            		@LTRAP EQU MYOS_LTRAP 	;
 38)   7096 	            		@CLG   EQU MYOS_CLG   	;
 39)   7096 	            		@COLOUR EQU MYOS_COLOUR	;
 40)   7096 	            		@DRAW  EQU MYOS_DRAW  	;
 41)   7096 	            		@ENVEL EQU MYOS_ENVEL 	;
 42)   7096 	            		@GCOL  EQU MYOS_GCOL  	;
 43)   7096 	            		@MODE  EQU MYOS_MODE  	;
 44)   7096 	            		@MOVE  EQU MYOS_MOVE  	;
 45)   7096 	            		@PLOT  EQU MYOS_PLOT  	;
 46)   7096 	            		@SOUND EQU MYOS_SOUND 	;
 47)   7096 	            		@ADVAL EQU MYOS_ADVAL 	;
 48)   7096 	            		@POINT EQU MYOS_POINT 	;
 49)   7096 	            		@GETIMS EQU MYOS_GETIMS	;
 50)   7096 	            		@PUTIMS EQU MYOS_PUTIMS	;
407)   7096 C3 04 01    		@MYOS_CLRSCN: JP IOS_CLRSCR       ; CLRSCN: clears the screen.	; CLRSCN: clears the screen.
410)   7099 7D          		 LD A, L	;
411)   709A 32 BD FE    		 LD (TIMECTR), A	;
412)   709D 7C          		 LD A, H	;
413)   709E 32 BE FE    		 LD (TIMECTR + 1), A	;
414)   70A1 7B          		 LD A, E	;
415)   70A2 32 BF FE    		 LD (TIMECTR + 2), A	;
416)   70A5 7A          		 LD A, D	;
417)   70A6 32 C0 FE    		 LD (TIMECTR + 3), A	;
418)   70A9 C9          		 RET	;
422)   70AA 3A BD FE    		 LD A, (TIMECTR)	;
423)   70AD 6F          		 LD L, A	;
424)   70AE 3A BE FE    		 LD A, (TIMECTR + 1)	;
425)   70B1 67          		 LD H, A	;
426)   70B2 3A BF FE    		 LD A, (TIMECTR + 2)	;
427)   70B5 5F          		 LD E, A	;
428)   70B6 3A C0 FE    		 LD A, (TIMECTR + 3)	;
429)   70B9 57          		 LD D, A	;
430)   70BA C9          		 RET	;
432)   70BB 63          		 LD H, E	;
433)   70BC E5          		 PUSH HL	;
434)   70BD CD 07 01    		 CALL IOS_RMVCURS	;
435)   70C0 E1          		 POP HL	;
436)   70C1 7C          		 LD A, H	;
437)   70C2 32 0D FE    		 LD (CURSORX), A	;
438)   70C5 32 0F FF    		 LD (VGATX_X),A	;
439)   70C8 7D          		 LD A, L	;
440)   70C9 32 0E FE    		 LD (CURSORY), A	;
441)   70CC 32 10 FF    		 LD (VGATX_Y),A	;
442)   70CF CD 0A 01    		 CALL IOS_PRNCURS	;
443)   70D2 C9          		 RET	;
445)   70D3 16 00       		 LD D, 0	;
446)   70D5 3A 0D FE    		 LD A, (CURSORX)	;
448)   70D8 5F          		 LD E, A	;
449)   70D9 26 00       		 LD H, 0	;
452)   70DB CD 0D 01    		 CALL IOS_CALCLINE      ;GETS CURSORY WITH SCROLL	;GETS CURSORY WITH SCROLL
453)   70DE 6F          		 LD L, A	;
454)   70DF C9          		 RET	;
455)   70E0 06 50       		KEYGET: LD B, 80       ;SCREEN WIDTH IN CHARS	;SCREEN WIDTH IN CHARS
457)   70E2 E5          		 PUSH HL	;
458)   70E3 ED 62       		 SBC HL, HL        ;HL=0	;HL=0
459)   70E5 CD D7 72    		 CALL MYOS_OSKEY	;
460)   70E8 E1          		 POP HL	;
461)   70E9 D8          		 RET C	;
462)   70EA 18 F6       		 JR MYOS_OSRDCH	;
463)   70EC C9          		 RET	;
464)   70ED F5          		@MYOS_OSWRCH: PUSH AF       ; OSWRCH: write a character to the screen	; OSWRCH: write a character to the screen
465)   70EE D5          		 PUSH DE	;
466)   70EF E5          		 PUSH HL	;
467)   70F0 DD E5       		 PUSH IX	;
468)   70F2 D9          		 EXX	;
469)   70F3 C5          		 PUSH BC	;
470)   70F4 D5          		 PUSH DE	;
471)   70F5 E5          		 PUSH HL	;
472)   70F6 D9          		 EXX	;
473)   70F7 5F          		 LD E, A	;
474)   70F8 CD F6 72    		 CALL ESCTEST	;
477)   70FB 7B          		 LD A, E	;
478)   70FC FE 20       		 CP 32	;
479)   70FE 38 0D       		 JR C, CTRCODE	;
480)   7100 FE 7F       		 CP 127         ;BACKSPACE	;BACKSPACE
481)   7102 C2 86 72    		 JP NZ, PRINTIT	;
482)   7105 3E 08       		 LD A, 8        ;DO A BACKSPACE	;DO A BACKSPACE
483)   7107 CD 10 01    		 CALL IOS_PRINTCHAR	;
484)   710A C3 89 72    		 JP OSWREXIT	;
485)   710D FE 04       		CTRCODE: CP 4       ;WRITE TEXT AT TEXT POS	;WRITE TEXT AT TEXT POS
486)   710F 20 06       		 JR NZ, CC1	;
487)   7111 32 16 FE    		 LD (VDUMODE), A	;
488)   7114 C3 89 72    		 JP OSWREXIT	;
489)   7117 FE 05       		CC1: CP 5        ;WRITE TEXT AT GRAPH POS	;WRITE TEXT AT GRAPH POS
490)   7119 20 06       		 JR NZ, CC2	;
491)   711B 32 16 FE    		 LD (VDUMODE), A	;
492)   711E C3 89 72    		 JP OSWREXIT	;
493)   7121 FE 06       		CC2: CP 6        ;ENABLE OUTPUT TO SCREEN	;ENABLE OUTPUT TO SCREEN
494)   7123 20 03       		 JR NZ, CC3	;
495)   7125 C3 89 72    		 JP OSWREXIT	;
496)   7128 FE 07       		CC3: CP 7        ;BEEP	;BEEP
497)   712A 20 03       		 JR NZ, CC4	;
498)   712C C3 89 72    		 JP OSWREXIT	;
499)   712F FE 08       		CC4: CP 8        ;MOVE TEXT CURSOR BACK A CHAR	;MOVE TEXT CURSOR BACK A CHAR
500)   7131 20 03       		 JR NZ, CC5	;
501)   7133 C3 86 72    		 JP PRINTIT	;
508)   7136 FE 09       		CC5: CP 9        ;MOVE TEXT CURSOR FORWARD A CHAR	;MOVE TEXT CURSOR FORWARD A CHAR
509)   7138 20 0F       		 JR NZ, CC6	;
510)   713A 3A 0D FE    		 LD A, (CURSORX)	;
511)   713D 3C          		 INC A	;
512)   713E FE 50       		 CP 80	;
513)   7140 D2 89 72    		 JP NC, OSWREXIT	;
514)   7143 32 0D FE    		 LD (CURSORX), A	;
515)   7146 C3 89 72    		 JP OSWREXIT	;
516)   7149 FE 0A       		CC6: CP 10        ;MOVE TEXT DOWN LF	;MOVE TEXT DOWN LF
517)   714B CA 86 72    		 JP Z, PRINTIT	;
518)   714E FE 0B       		CC7: CP 11        ;MOVE TEXT UP	;MOVE TEXT UP
519)   7150 20 0F       		 JR NZ, CC8	;
520)   7152 3A 0E FE    		 LD A, (CURSORY)	;
521)   7155 3D          		 DEC A	;
522)   7156 FE FF       		 CP 0XFF	;
523)   7158 CA 89 72    		 JP Z, OSWREXIT	;
524)   715B 32 0E FE    		 LD (CURSORY), A	;
525)   715E C3 89 72    		 JP OSWREXIT	;
526)   7161 FE 0C       		CC8: CP 12        ; CLS	; CLS
527)   7163 20 06       		 JR NZ, CC9	;
528)   7165 CD 04 01    		 CALL IOS_CLRSCR	;
529)   7168 C3 89 72    		 JP OSWREXIT	;
530)   716B FE 0D       		CC9: CP 13        ;GOTO START OF LINE CR	;GOTO START OF LINE CR
531)   716D CA 86 72    		 JP Z, PRINTIT	;
532)   7170 FE 0E       		CC10: CP 14        ;ENABLE THE AUTOPAGING MODE	;ENABLE THE AUTOPAGING MODE
533)   7172 20 03       		 JR NZ, CC11	;
534)   7174 C3 89 72    		 JP OSWREXIT	;
535)   7177 FE 0F       		CC11: CP 15        ;DISABLE THE AUTOPAGING MODE	;DISABLE THE AUTOPAGING MODE
536)   7179 20 03       		 JR NZ, CC12	;
537)   717B C3 89 72    		 JP OSWREXIT	;
538)   717E FE 10       		CC12: CP 16        ;CLG	;CLG
539)   7180 20 06       		 JR NZ, CC13	;
540)   7182 CD 45 74    		 CALL MYOS_CLG	;
541)   7185 C3 89 72    		 JP OSWREXIT	;
542)   7188 FE 11       		CC13: CP 17        ; SAME AS COLOUR	; SAME AS COLOUR
543)   718A 20 09       		 JR NZ, CC14	;
545)   718C FD 23       		 INC IY        ;SKIP ','	;SKIP ','
546)   718E CD 94 5E    		 CALL EXPRI	;
547)   7191 D9          		 EXX        ;l has the param  color	;l has the param  color
548)   7192 C3 89 72    		 JP OSWREXIT	;
549)   7195 FE 12       		CC14: CP 18        ;SAME AS GCOL	;SAME AS GCOL
550)   7197 20 0F       		 JR NZ, CC15	;
551)   7199 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
552)   719B CD 94 5E    		 CALL EXPRI	;
553)   719E D9          		 EXX        ;l has the param  mode	;l has the param  mode
554)   719F FD 23       		 INC IY        ;SKIP ','	;SKIP ','
555)   71A1 CD 94 5E    		 CALL EXPRI	;
556)   71A4 D9          		 EXX        ;l has the param  color	;l has the param  color
558)   71A5 C3 89 72    		 JP OSWREXIT	;
559)   71A8 FE 13       		CC15: CP 19        ;SELECT A COLOR PALLETTE???	;SELECT A COLOR PALLETTE???
560)   71AA 20 0F       		 JR NZ, CC16	;
562)   71AC 06 05       		 LD B, 5	;
563)   71AE C5          		CC15AGN: PUSH BC	;
564)   71AF FD 23       		 INC IY        ;SKIP ','	;SKIP ','
565)   71B1 CD 94 5E    		 CALL EXPRI	;
566)   71B4 D9          		 EXX        ;l has the param	;l has the param
567)   71B5 C1          		 POP BC	;
568)   71B6 10 F6       		 DJNZ CC15AGN	;
569)   71B8 C3 89 72    		 JP OSWREXIT	;
570)   71BB FE 14       		CC16: CP 20        ;RESTORE THE DEFAULT LOGICAL COLORS	;RESTORE THE DEFAULT LOGICAL COLORS
571)   71BD 20 03       		 JR NZ, CC17	;
573)   71BF C3 89 72    		 JP OSWREXIT	;
574)   71C2 FE 15       		CC17: CP 21        ;NO OUTPUT TO SCREEN	;NO OUTPUT TO SCREEN
575)   71C4 20 03       		 JR NZ, CC18	;
577)   71C6 C3 89 72    		 JP OSWREXIT	;
578)   71C9 FE 16       		CC18: CP 22        ;LIKE MODE	;LIKE MODE
579)   71CB 20 09       		 JR NZ, CC19	;
580)   71CD FD 23       		 INC IY        ;SKIP ','	;SKIP ','
581)   71CF CD 94 5E    		 CALL EXPRI	;
582)   71D2 D9          		 EXX        ;l has the param	;l has the param
583)   71D3 C3 89 72    		 JP OSWREXIT	;
584)   71D6 FE 17       		CC19: CP 23        ;Program characters and control the cursor.???	;Program characters and control the cursor.???
585)   71D8 20 27       		 JR NZ, CC20	;
586)   71DA 06 09       		 LD B, 9        ;9 PARAMS CHAR_NO +8 ROWS OF A CHAR	;9 PARAMS CHAR_NO +8 ROWS OF A CHAR
587)   71DC FD 7E 00    		 LD A, (IY)	;
588)   71DF FD 23       		 INC IY        ;SKIP ',' OR ';'	;SKIP ',' OR ';'
589)   71E1 FE 3B       		 CP ';'        ;'	;'
590)   71E3 20 01       		 JR NZ, CC19AGN	;
591)   71E5 05          		 DEC B        ; IF ; THE DELIMETER THEN 2 BYTES AT START	; IF ; THE DELIMETER THEN 2 BYTES AT START
592)   71E6 C5          		CC19AGN: PUSH BC	;
593)   71E7 CD 94 5E    		 CALL EXPRI	;
594)   71EA D9          		 EXX        ;l has the param	;l has the param
595)   71EB FD 7E 00    		 LD A, (IY)	;
596)   71EE FE 2C       		 CP ', '	;
597)   71F0 28 07       		 JR Z, CC19NXT0	;
598)   71F2 FE 3B       		 CP ';'        ;'	;'
599)   71F4 20 05       		 JR NZ, CC19NXT	;
600)   71F6 C1          		 POP BC	;
601)   71F7 05          		 DEC B	;
602)   71F8 C5          		 PUSH BC	;
603)   71F9 FD 23       		CC19NXT0: INC IY       ;SKIP ','	;SKIP ','
604)   71FB C1          		CC19NXT: POP BC	;
605)   71FC 10 E8       		 DJNZ CC19AGN	;
606)   71FE C3 89 72    		 JP OSWREXIT	;
607)   7201 FE 18       		CC20: CP 24        ;Define a graphics window	;Define a graphics window
608)   7203 20 11       		 JR NZ, CC21	;
609)   7205 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
610)   7207 06 04       		 LD B, 4        ;4 PARAMS TWO CORNERS OF A RECT	;4 PARAMS TWO CORNERS OF A RECT
611)   7209 C5          		CC20AGN: PUSH BC	;
612)   720A CD 94 5E    		 CALL EXPRI	;
613)   720D D9          		 EXX        ;HL has the param	;HL has the param
614)   720E FD 23       		 INC IY        ;SKIP ';'	;SKIP ';'
615)   7210 C1          		 POP BC	;
616)   7211 10 F6       		 DJNZ CC20AGN	;
617)   7213 C3 89 72    		 JP OSWREXIT	;
618)   7216 FE 19       		CC21: CP 25        ;Identical to PLOT.	;Identical to PLOT.
619)   7218 20 17       		 JR NZ, CC22	;
620)   721A FD 23       		 INC IY        ;SKIP ','	;SKIP ','
621)   721C CD 94 5E    		 CALL EXPRI	;
622)   721F D9          		 EXX        ;L has the param PLOTMODE	;L has the param PLOTMODE
623)   7220 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
624)   7222 CD 94 5E    		 CALL EXPRI	;
625)   7225 D9          		 EXX        ;HL has the param X	;HL has the param X
626)   7226 FD 23       		 INC IY        ;SKIP ';'	;SKIP ';'
627)   7228 CD 94 5E    		 CALL EXPRI	;
628)   722B D9          		 EXX        ;HL has the param Y	;HL has the param Y
629)   722C FD 23       		 INC IY        ;SKIP ';'	;SKIP ';'
632)   722E C3 89 72    		 JP OSWREXIT	;
633)   7231 FE 1A       		CC22: CP 26        ;Restore the default text and graphics windows.	;Restore the default text and graphics windows.
634)   7233 20 02       		 JR NZ, CC23	;
635)   7235 18 52       		 JR OSWREXIT	;
636)   7237 FE 1B       		CC23: CP 27        ;Send the next character to the screen.	;Send the next character to the screen.
637)   7239 20 07       		 JR NZ, CC24	;
638)   723B CD 94 5E    		 CALL EXPRI	;
639)   723E D9          		 EXX        ;	;
640)   723F 7D          		 LD A, L	;
641)   7240 18 44       		 JR PRINTIT	;
642)   7242 FE 1C       		CC24: CP 28        ;Define a text window.	;Define a text window.
643)   7244 20 0E       		 JR NZ, CC25	;
644)   7246 06 04       		 LD B, 4        ;4 PARAMS UPPERLEFT AND LOWERRIGHT	;4 PARAMS UPPERLEFT AND LOWERRIGHT
645)   7248 C5          		CC24AGN: PUSH BC	;
646)   7249 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
647)   724B CD 94 5E    		 CALL EXPRI	;
648)   724E D9          		 EXX        ;l has the param	;l has the param
649)   724F C1          		 POP BC	;
650)   7250 10 F6       		 DJNZ CC24AGN	;
651)   7252 18 35       		 JR OSWREXIT	;
652)   7254 FE 1D       		CC25: CP 29        ;Set the graphics origin.	;Set the graphics origin.
653)   7256 20 10       		 JR NZ, CC26	;
654)   7258 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
655)   725A CD 94 5E    		 CALL EXPRI	;
656)   725D D9          		 EXX        ;HL has the param X	;HL has the param X
657)   725E FD 23       		 INC IY        ;SKIP ';'	;SKIP ';'
658)   7260 CD 94 5E    		 CALL EXPRI	;
659)   7263 D9          		 EXX        ;HL has the param Y	;HL has the param Y
660)   7264 FD 23       		 INC IY        ;SKIP ';'	;SKIP ';'
662)   7266 18 21       		 JR OSWREXIT	;
663)   7268 FE 1E       		CC26: CP 30        ;Home the text cursor to the top left of the screen.	;Home the text cursor to the top left of the screen.
664)   726A 20 08       		 JR NZ, CC27	;
665)   726C 21 00 00    		 LD HL, 0	;
666)   726F 22 0D FE    		 LD (CURSORX), HL	;
667)   7272 18 15       		 JR OSWREXIT	;
668)   7274 FE 1F       		CC27: CP 31        ;Move the text cursor - identical to TAB(x,y).	;Move the text cursor - identical to TAB(x,y).
669)   7276 20 11       		 JR NZ, OSWREXIT	;
670)   7278 FD 23       		 INC IY        ;SKIP ','	;SKIP ','
671)   727A CD 94 5E    		 CALL EXPRI	;
672)   727D D9          		 EXX        ;l has the param X	;l has the param X
673)   727E FD 23       		 INC IY        ;SKIP ','	;SKIP ','
674)   7280 CD 94 5E    		 CALL EXPRI	;
675)   7283 D9          		 EXX        ;l has the param Y	;l has the param Y
677)   7284 18 03       		 JR OSWREXIT	;
680)   7286 CD 94 72    		PRINTIT: CALL EDPUT	;
681)   7289 D9          		OSWREXIT: EXX	;
682)   728A E1          		 POP HL	;
683)   728B D1          		 POP DE	;
684)   728C C1          		 POP BC	;
685)   728D D9          		 EXX	;
686)   728E DD E1       		 POP IX	;
687)   7290 E1          		 POP HL	;
688)   7291 D1          		 POP DE	;
689)   7292 F1          		 POP AF	;
690)   7293 C9          		 RET	;
695)   7294 3A 00 FE    		EDPUT: LD A, (FLAGS)	;
696)   7297 CB 5F       		 BIT 3, A	;
697)   7299 28 10       		 JR Z, WRCH	;
698)   729B 7B          		 LD A, E	;
699)   729C FE 20       		 CP ' '	;
700)   729E D8          		 RET C	;
701)   729F 2A 12 FE    		 LD HL, (EDPTR)	;
702)   72A2 73          		 LD (HL), E	;
703)   72A3 2C          		 INC L	;
704)   72A4 C8          		 RET Z	;
705)   72A5 22 12 FE    		 LD (EDPTR), HL	;
706)   72A8 C9          		 RET	;
709)   72A9 1E 3E       		 LD E, '>'	;
710)   72AB 7B          		WRCH: LD A, E	;
711)   72AC F5          		 PUSH AF	;
712)   72AD C5          		 PUSH BC	;
713)   72AE D5          		 PUSH DE	;
714)   72AF E5          		 PUSH HL	;
715)   72B0 DD E5       		 PUSH IX	;
716)   72B2 FD E5       		 PUSH IY	;
717)   72B4 F5          		 PUSH AF	;
718)   72B5 C5          		 PUSH BC	;
719)   72B6 D5          		 PUSH DE	;
720)   72B7 E5          		 PUSH HL	;
721)   72B8 CD 07 01    		 CALL IOS_RMVCURS	;
722)   72BB E1          		 POP HL	;
723)   72BC D1          		 POP DE	;
724)   72BD C1          		 POP BC	;
725)   72BE F1          		 POP AF	;
728)   72BF CD 10 01    		 CALL IOS_PRINTCHAR	;
729)   72C2 CD 0A 01    		 CALL IOS_PRNCURS	;
731)   72C5 FD E1       		 POP IY	;
732)   72C7 DD E1       		 POP IX	;
733)   72C9 E1          		 POP HL	;
734)   72CA D1          		 POP DE	;
735)   72CB C1          		 POP BC	;
736)   72CC F1          		 POP AF	;
737)   72CD C9          		 RET	;
739)   72CE 3A 00 FE    		TOGGLE: LD A, (FLAGS)	;
740)   72D1 EE 04       		 XOR 00000100B	;
741)   72D3 32 00 FE    		 LD (FLAGS), A	;
742)   72D6 C9          		 RET	;
751)   72D7 E5          		@MYOS_OSKEY: PUSH HL	;
752)   72D8 21 15 FE    		 LD HL, INKEY	;
753)   72DB 7E          		 LD A, (HL)	;
754)   72DC 36 00       		 LD (HL), 0	;
755)   72DE E1          		 POP HL	;
756)   72DF B7          		 OR A	;
757)   72E0 37          		 SCF	;
758)   72E1 C0          		 RET NZ	;
760)   72E2 CD C2 74    		 CALL GETKEYNW	;
762)   72E5 D0          		 RET NC	;
763)   72E6 FE 1B       		 CP ESC	;
764)   72E8 37          		 SCF	;
765)   72E9 C0          		 RET NZ	;
766)   72EA E5          		ESCSET: PUSH HL	;
767)   72EB 21 00 FE    		 LD HL, FLAGS	;
768)   72EE CB 76       		 BIT 6, (HL)        ; ESC DISABLED?	; ESC DISABLED?
769)   72F0 20 02       		 JR NZ, ESCDIS	;
770)   72F2 CB FE       		 SET 7, (HL)        ; SET ESCAPE FLAG	; SET ESCAPE FLAG
771)   72F4 E1          		ESCDIS: POP HL	;
772)   72F5 C9          		 RET	;
773)   72F6 D5          		ESCTEST: PUSH DE	;
774)   72F7 E5          		 PUSH HL	;
775)   72F8 C5          		 PUSH BC	;
776)   72F9 CD 16 01    		 CALL IOS_GETCHARNW	;
777)   72FC C1          		 POP BC	;
778)   72FD E1          		 POP HL	;
779)   72FE D1          		 POP DE	;
781)   72FF B7          		 OR A	;
782)   7300 C8          		 RET Z	;
783)   7301 FE 1B       		 CP 0x1B        ; ESC	; ESC
784)   7303 28 E5       		 JR Z, ESCSET	;
785)   7305 32 15 FE    		 LD (INKEY), A	;
786)   7308 C9          		 RET	;
788)   7309 CD F6 72    		@MYOS_TRAP: CALL ESCTEST	;
789)   730C 3A 00 FE    		@MYOS_LTRAP: LD A, (FLAGS)	;
790)   730F B7          		 OR A	;
791)   7310 F0          		 RET P	;
792)   7311 21 00 FE    		ABORT: LD HL, FLAGS	;
793)   7314 CB BE       		 RES 7, (HL)	;
794)   7316 C3 C2 4D    		 JP ESCAPE	;
803)   7319 F3          		 DI	;
804)   731A 21 F6 FD    		 LD HL, RANDOM        ; SET RANDOM SEED TO NON 0	; SET RANDOM SEED TO NON 0
805)   731D 3E 06       		 LD A, 0x06	;
806)   731F 77          		 LD (HL), A	;
807)   7320 3E BB       		 LD A, 0xBB	;
808)   7322 77          		 LD (HL), A	;
809)   7323 21 00 00    		 LD HL, 0	;
810)   7326 22 0D FE    		 LD (CURSORX), HL       ; CURSOR X 7 Y ZEROED	; CURSOR X 7 Y ZEROED
811)   7329 11 FF FF    		 LD DE, COL_WHITE       ; SET FCOLOR AND BCOLOR DEFAULT VALUES	; SET FCOLOR AND BCOLOR DEFAULT VALUES
812)   732C 21 01 FE    		 LD HL, FCOLOR	;
813)   732F 73          		 LD (HL), E	;
814)   7330 23          		 INC HL	;
815)   7331 72          		 LD (HL), D	;
816)   7332 23          		 INC HL	;
817)   7333 11 00 00    		 LD DE, COL_BLACK	;
818)   7336 73          		 LD (HL), E	;
819)   7337 23          		 INC HL	;
820)   7338 72          		 LD (HL), D	;
821)   7339 01 04 00    		 LD BC, 4        ; COPY SAME COLORS TO GRAPHICS	; COPY SAME COLORS TO GRAPHICS
822)   733C 11 05 FE    		 LD DE, FGRCOL	;
823)   733F 21 01 FE    		 LD HL, FCOLOR	;
824)   7342 ED B0       		 LDIR	;
825)   7344 11 17 FE    		 LD DE, FCOLPAL	;
826)   7347 CD 58 73    		 CALL COPYPAL	;
827)   734A 11 37 FE    		 LD DE, BCOLPAL	;
828)   734D CD 58 73    		 CALL COPYPAL	;
829)   7350 21 B4 73    		 LD HL, EXTCMDRET	;
830)   7353 22 3F FF    		 LD (COMDGET),HL       ;SET RETURN ADDRESS FOR OS COMMANDS	;SET RETURN ADDRESS FOR OS COMMANDS
831)   7356 18 16       		 JR OSFINSH       ;	;
832)   7358 21 7B 73    		COPYPAL: LD HL, COL_PALET	;
833)   735B 01 20 00    		 LD BC, 16 * 2        ;SHOULD ADD 8 MORE COLORS	;SHOULD ADD 8 MORE COLORS
834)   735E ED B0       		 LDIR	;
835)   7360 AF          		 XOR A	;
836)   7361 32 0F FE    		 LD (SCRLN), A	;
837)   7364 21 00 00    		 LD HL, 0	;
838)   7367 22 BD FE    		 LD (TIMECTR), HL	;
839)   736A 22 BF FE    		 LD (TIMECTR + 2), HL	;
840)   736D C9          		 RET	;
842)   736E CD 04 01    		OSFINSH: CALL IOS_CLRSCR	;
843)   7371 AF          		 XOR A	;
844)   7372 11 FF F9    		 LD DE, STACKP - 0x100      ;DE = HIMEM	;DE = HIMEM
845)   7375 5F          		 LD E, A        ;PAGE BOUNDARY	;PAGE BOUNDARY
846)   7376 21 00 80    		 LD HL, RAMADBBC       ;@USER	;@USER
847)   7379 FB          		 EI	;
848)   737A C9          		 RET	;
849)   737B 00 00       		COL_PALET: DW COL_BLACK	;
850)   737D 00 F8       		 DW COL_RED	;
851)   737F C0 07       		 DW COL_GREEN	;
852)   7381 C0 FF       		 DW COL_YELLOW	;
853)   7383 3F 00       		 DW COL_BLUE	;
854)   7385 3F F8       		 DW COL_MAGENTA	;
855)   7387 FF 07       		 DW COL_CYAN	;
856)   7389 FF FF       		 DW COL_WHITE	;
857)   738B 00 00       		 DW COL_BLACK       ;TODO PICK 8 MORE COLORS	;TODO PICK 8 MORE COLORS
858)   738D 00 F8       		 DW COL_RED	;
859)   738F C0 07       		 DW COL_GREEN	;
860)   7391 C0 FF       		 DW COL_YELLOW	;
861)   7393 3F 00       		 DW COL_BLUE	;
862)   7395 3F F8       		 DW COL_MAGENTA	;
863)   7397 FF 07       		 DW COL_CYAN	;
864)   7399 FF FF       		 DW COL_WHITE	;
869)   739B 11 17 FF    		@MYOS_OSCLI: LD DE, COMDBUF	;
871)   739E 7E          		MOAGN: LD A,(HL)	;
872)   739F FE 0D       		 CP 13	;
873)   73A1 28 09       		 JR Z, MOEXC1	;
874)   73A3 FE 00       		 CP 0	;
875)   73A5 28 05       		 JR Z, MOEXC1	;
876)   73A7 12          		 LD (DE),A	;
877)   73A8 23          		 INC HL	;
878)   73A9 13          		 INC DE	;
879)   73AA 18 F2       		 JR MOAGN	;
880)   73AC 22 BA FE    		MOEXC1: LD (PRGEX),HL       ;SAVE HL	;SAVE HL
881)   73AF 3E 0D       		 LD A,13    	;
882)   73B1 C3 3D 01    		 JP IOS_DOCMD	;
885)   73B4 2A BA FE    		@EXTCMDRET: LD HL,(PRGEX)      ;RESTORE HL	;RESTORE HL
886)   73B7 E5          		 PUSH HL	;
887)   73B8 FD E1       		 POP IY         ;IY AT POSITION	;IY AT POSITION
888)   73BA 36 0D       		 LD (HL),CR	;
889)   73BC AF          		 XOR A	;
890)   73BD 23          		 INC HL	;
891)   73BE 77          		 LD (HL),A	;
892)   73BF C9          		 RET	;
898)   73C0 FE FF       		@MYOS_OSOPEN: CP 255	;
899)   73C2 28 06       		 JR Z, OPW	;
900)   73C4 FE 01       		 CP 1	;
901)   73C6 28 06       		 JR Z, OPRW	;
903)   73C8 18 06       		 JR DOOP	;
904)   73CA 3E 01       		OPW: LD A, 1	;
905)   73CC 18 02       		 JR DOOP	;
906)   73CE 3E 02       		OPRW: LD A, 2	;
907)   73D0 F5          		DOOP: PUSH AF        ;SAVE A	;SAVE A
908)   73D1 AF          		 XOR A         ;CLEAR CARRY FLAG	;CLEAR CARRY FLAG
909)   73D2 12          		 LD (DE), A        ;MAKE FILENAME ZERO TERMINATED REPLACE #13 WITH 0	;MAKE FILENAME ZERO TERMINATED REPLACE #13 WITH 0
910)   73D3 EB          		 EX DE, HL	;
911)   73D4 ED 52       		 SBC HL, DE	;
912)   73D6 23          		 INC HL         ;+1 FOR ZERO	;+1 FOR ZERO
913)   73D7 E5          		 PUSH HL	;
914)   73D8 C1          		 POP BC	;
915)   73D9 EB          		 EX DE, HL	;
916)   73DA 11 CF FE    		 LD DE, STRGBUFF	;
917)   73DD ED B0       		 LDIR         ;COPY FILENAME TO STRGBUFF	;COPY FILENAME TO STRGBUFF
918)   73DF F1          		 POP AF         ;RESTORE A	;RESTORE A
919)   73E0 CD 1F 01    		 CALL IOS_OPNFILE	;
920)   73E3 DA 2B 74    		 JP C, DRV_ERROR	;
921)   73E6 C9          		 RET	;
925)   73E7 21 CF FE    		@MYOS_OSBPUT: LD HL, STRGBUFF	;
926)   73EA 77          		 LD (HL), A        ;VALUE	;VALUE
927)   73EB 7B          		 LD A, E        ;FID	;FID
928)   73EC EB          		 EX DE, HL	;
929)   73ED 01 01 00    		 LD BC, 1        ;NO OF BYTES TO WRITE	;NO OF BYTES TO WRITE
930)   73F0 CD 28 01    		 CALL IOS_BLKWRITE	;
931)   73F3 DA 2B 74    		 JP C, DRV_ERROR	;
932)   73F6 C9          		 RET	;
936)   73F7 7B          		@MYOS_OSBGET: LD A, E       ;FID	;FID
937)   73F8 11 CF FE    		 LD DE, STRGBUFF       ;SET BUFFER	;SET BUFFER
938)   73FB 01 01 00    		 LD BC, 1        ;NO OF BYTES TO READ	;NO OF BYTES TO READ
939)   73FE CD 2B 01    		 CALL IOS_BLKREAD	;
940)   7401 DA 2B 74    		 JP C, DRV_ERROR	;
941)   7404 78          		 LD A, B	;
942)   7405 81          		 ADD C	;
943)   7406 FE 01       		 CP 1	;
944)   7408 28 03       		 JR Z, GETISOK	;
945)   740A 3E FF       		 LD A, 255	;
946)   740C C9          		 RET	;
947)   740D 3A CF FE    		GETISOK: LD A, (STRGBUFF)	;
948)   7410 C9          		 RET	;
953)   7411 7B          		@MYOS_GETPTR: LD A, E	;
954)   7412 CD 2E 01    		 CALL IOS_GETPOS	;
955)   7415 C9          		 RET	;
960)   7416 CD 31 01    		@MYOS_PUTPTR: CALL IOS_SETPOS	;
961)   7419 C9          		 RET	;
966)   741A 7B          		@MYOS_GETEXT: LD A, E	;
967)   741B CD 34 01    		 CALL IOS_GETSIZE	;
968)   741E C9          		 RET	;
973)   741F 7B          		@MYOS_OSSHUT: LD A, E	;
974)   7420 CD 25 01    		 CALL IOS_CLSFILE	;
975)   7423 C9          		 RET	;
978)   7424 7B          		@MYOS_OSSTAT: LD A, E	;
979)   7425 CD 37 01    		 CALL IOS_GETEOF	;
980)   7428 FE FF       		 CP 255         ;TEST IF -1	;TEST IF -1
981)   742A C9          		 RET	;
983)   742B CD F0 46    		DRV_ERROR: CALL EXTERR	;
984)   742E 53 54 4F 52 		 DEFM  "STORAGE ERROR"	;
984)   7432 41 47 45 20 		 DEFM  "STORAGE ERROR"	;
984)   7436 45 52 52 4F 		 DEFM  "STORAGE ERROR"	;
984)   743A 52          		 DEFM  "STORAGE ERROR"	;
985)   743B 00          		 DEFB    0	;
991)   743C C9          		@MYOS_OSCALL: RET	;
994)   743D C9          		@MYOS_RESET: RET	;
996)   743E CD 94 5E    		@MYOS_MODE: CALL EXPRI       ;GET PARAM	;GET PARAM
997)   7441 D9          		 EXX         ;HL HAS THE PARAM	;HL HAS THE PARAM
998)   7442 C3 E8 4C    		 JP XEQ	;
1000)   7445 CD 1F 78    		@MYOS_CLG: CALL GRPH_SAVECOLORS	;
1001)   7448 CD 70 01    		 CALL IOS_CLRGRAPH	;
1002)   744B CD 36 78    		 CALL GRPH_RESTORECOLORS	;
1003)   744E C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1006)   7451 DD E5       		@MYOS_GCOL: PUSH IX	;
1007)   7453 3E 01       		 LD A, 1	;
1008)   7455 CD F7 75    		 CALL BAS_COLOUR	;
1009)   7458 DD E1       		 POP IX	;
1010)   745A C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1012)   745D DD E5       		@MYOS_COLOUR: PUSH IX	;
1013)   745F AF          		 XOR A	;
1014)   7460 CD F7 75    		 CALL BAS_COLOUR	;
1015)   7463 DD E1       		 POP IX	;
1016)   7465 C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1018)   7468 DD E5       		@MYOS_DRAW: PUSH IX	;
1019)   746A CD D8 76    		 CALL BAS_DRAW	;
1020)   746D DD E1       		 POP IX	;
1021)   746F C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1023)   7472 DD E5       		@MYOS_MOVE: PUSH IX	;
1024)   7474 CD 04 77    		 CALL BAS_MOVE	;
1025)   7477 DD E1       		 POP IX	;
1026)   7479 C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1028)   747C DD E5       		@MYOS_PLOT: PUSH IX	;
1029)   747E CD 7A 77    		 CALL BAS_PLOT	;
1030)   7481 DD E1       		 POP IX	;
1031)   7483 C3 E8 4C    		 JP XEQ         ;RETURN TO BASIC	;RETURN TO BASIC
1033)   7486 DD E5       		@MYOS_POINT: PUSH IX	;
1034)   7488 CD 10 77    		 CALL BAS_POINT       ;RETURNS A VALUE TO BASIC	;RETURNS A VALUE TO BASIC
1035)   748B DD E1       		 POP IX	;
1036)   748D C9          		 RET	;
1045)   748E CD 94 76    		@MYOS_PUTIMS: CALL GETBASICPARAMS     ;	;
1046)   7491 C3 E8 4C    		 JP XEQ	;
1049)   7494 CD 43 01    		RTC_GET: CALL IOS_DSGETNOW	;
1051)   7497 21 A5 74    		 LD HL, TSTSTR	;
1052)   749A 11 00 80    		 LD DE, $8000	;
1053)   749D 01 14 00    		 LD BC, 20	;
1054)   74A0 C5          		 PUSH BC	;
1055)   74A1 ED B0       		 LDIR	;
1056)   74A3 C1          		 POP BC	;
1057)   74A4 C9          		 RET	;
1059)   74A5 31 37 2F 30 		 TSTSTR DEFM "17/03/2021 17:52:03"	;
1059)   74A9 33 2F 32 30 		 TSTSTR DEFM "17/03/2021 17:52:03"	;
1059)   74AD 32 31 20 31 		 TSTSTR DEFM "17/03/2021 17:52:03"	;
1059)   74B1 37 3A 35 32 		 TSTSTR DEFM "17/03/2021 17:52:03"	;
1059)   74B5 3A 30 33    		 TSTSTR DEFM "17/03/2021 17:52:03"	;
1060)   74B8 00 0D       		 DEFB 0,0x0D	;
1062)   74BA C3 94 74    		@MYOS_GETIMS: JP RTC_GET	;
1068)   74BD CD 13 01    		GETKEY: CALL IOS_GETCHAR	;
1069)   74C0 37          		 SCF	;
1070)   74C1 C9          		 RET	;
1076)   74C2 CD 16 01    		 CALL IOS_GETCHARNW	;
1077)   74C5 3F          		 CCF	;
1078)   74C6 FE 00       		 CP 0	;
1079)   74C8 C8          		 RET Z	;
1080)   74C9 37          		 SCF	;
1081)   74CA C9          		 RET	;
1091)   74CB 3A 00 FE    		@MYOS_OSLINE: LD A, (FLAGS)	;
1092)   74CE CB 5F       		 BIT 3, A        ;EDIT MODE?	;EDIT MODE?
1093)   74D0 28 09       		 JR Z, OSLIN1	;
1094)   74D2 CB 9F       		 RES 3, A	;
1095)   74D4 32 00 FE    		 LD (FLAGS), A	;
1096)   74D7 2A 12 FE    		 LD HL, (EDPTR)	;
1097)   74DA BD          		 CP L	;
1098)   74DB 3E 0D       		OSLIN1: LD A, CR	;
1099)   74DD 77          		 LD (HL), A	;
1100)   74DE C4 ED 70    		 CALL NZ, MYOS_OSWRCH	;
1101)   74E1 3E 65       		 LD A, 'e'       ;PROMPT	;PROMPT
1102)   74E3 C4 ED 70    		 CALL NZ, MYOS_OSWRCH	;
1103)   74E6 2E 00       		 LD L, 0	;
1104)   74E8 4D          		 LD C, L        ;REPEAT FLAG	;REPEAT FLAG
1105)   74E9 28 20       		 JR Z, OSWAIT        ;SUPPRESS UNWANTED SPACE	;SUPPRESS UNWANTED SPACE
1106)   74EB 06 00       		UPDATE: LD B, 0	;
1107)   74ED 7E          		UPD1: LD A, (HL)	;
1108)   74EE 04          		 INC B	;
1109)   74EF 23          		 INC HL	;
1110)   74F0 FE 0D       		 CP CR	;
1111)   74F2 F5          		 PUSH AF	;
1112)   74F3 E5          		 PUSH HL	;
1113)   74F4 5F          		 LD E, A	;
1114)   74F5 C4 AB 72    		 CALL NZ, WRCH        ;FAST WRCH	;FAST WRCH
1115)   74F8 E1          		 POP HL	;
1116)   74F9 F1          		 POP AF	;
1117)   74FA 20 F1       		 JR NZ, UPD1	;
1118)   74FC 3E 20       		 LD A, ' '	;
1119)   74FE CD ED 70    		 CALL MYOS_OSWRCH	;
1120)   7501 1E 08       		 LD E, BS	;
1121)   7503 E5          		UPD2: PUSH HL	;
1122)   7504 CD AB 72    		 CALL WRCH        ;FAST WRCH	;FAST WRCH
1123)   7507 E1          		 POP HL	;
1124)   7508 2B          		 DEC HL	;
1125)   7509 10 F8       		 DJNZ UPD2	;
1126)   750B 79          		OSWAIT: LD A, C	;
1127)   750C 05          		 DEC B	;
1128)   750D 28 01       		 JR Z, LIMIT	;
1129)   750F B7          		 OR A         ;REPEAT COMMAND?	;REPEAT COMMAND?
1130)   7510 CC E0 70    		LIMIT: CALL Z, KEYGET        ;READ KEYBOARD	;READ KEYBOARD
1131)   7513 4F          		 LD C, A        ;SAVE FOR REPEAT	;SAVE FOR REPEAT
1132)   7514 11 0B 75    		 LD DE, OSWAIT        ;RETURN ADDRESS	;RETURN ADDRESS
1133)   7517 D5          		 PUSH DE	;
1134)   7518 3A 00 FE    		 LD A, (FLAGS)	;
1135)   751B B7          		 OR A         ;TEST FOR ESCAPE	;TEST FOR ESCAPE
1136)   751C 79          		 LD A, C	;
1137)   751D FA 5F 75    		 JP M, OSEXIT	;
1138)   7520 FE 0B       		 CP 11         ;CURSOR UP     (IX-11)	;CURSOR UP     (IX-11)
1139)   7522 CA A3 75    		 JP Z, LEFT	;
1140)   7525 FE 0A       		 CP 10         ;CURSOR DOWN   (IX-10)	;CURSOR DOWN   (IX-10)
1141)   7527 CA D6 75    		 JP Z, RIGHT	;
1142)   752A 06 00       		 LD B, 0	;
1143)   752C FE 05       		 CP 5         ;CLEAR LEFT    (IX-5)	;CLEAR LEFT    (IX-5)
1144)   752E 28 72       		 JR Z, BACK	;
1145)   7530 FE 09       		 CP 9         ;START OF LINE (IX-9)	;START OF LINE (IX-9)
1146)   7532 28 6F       		 JR Z, LEFT	;
1147)   7534 FE 07       		 CP 7         ;CLEAR RIGHT   (IX-7)	;CLEAR RIGHT   (IX-7)
1148)   7536 28 76       		 JR Z, DELETE	;
1149)   7538 FE 08       		 CP 8         ;END OF LINE   (IX-8)	;END OF LINE   (IX-8)
1150)   753A CA D6 75    		 JP Z, RIGHT	;
1151)   753D 0E 00       		 LD C, 0        ;INHIBIT REPEAT	;INHIBIT REPEAT
1152)   753F FE 10       		 CP 'P' AND 1FH	;
1153)   7541 CA CE 72    		 JP Z, TOGGLE	;
1154)   7544 FE 06       		 CP 6         ;DELETE LEFT   (IX-6)	;DELETE LEFT   (IX-6)
1155)   7546 28 5A       		 JR Z, BACK	;
1156)   7548 FE 04       		 CP 4         ;CURSOR LEFT   (IX-4)	;CURSOR LEFT   (IX-4)
1157)   754A 28 57       		 JR Z, LEFT	;
1158)   754C FE 02       		 CP 2         ;DELETE RIGHT  (IX-2)	;DELETE RIGHT  (IX-2)
1159)   754E 28 5E       		 JR Z, DELETE	;
1160)   7550 FE 01       		 CP 1         ;INSERT SPACE  (IX-1)	;INSERT SPACE  (IX-1)
1161)   7552 28 6E       		 JR Z, INSERT	;
1162)   7554 FE 03       		 CP 3         ;CURSOR RIGHT  (IX-3)	;CURSOR RIGHT  (IX-3)
1163)   7556 28 7E       		 JR Z, RIGHT	;
1164)   7558 FE 20       		 CP ' '         ;PRINTING CHARACTER	;PRINTING CHARACTER
1165)   755A 30 7F       		 JR NC, SAVECH	;
1166)   755C FE 0D       		 CP CR         ;ENTER LINE	;ENTER LINE
1167)   755E C0          		 RET NZ	;
1168)   755F 7E          		OSEXIT: LD A, (HL)	;
1169)   7560 CD ED 70    		 CALL MYOS_OSWRCH       ;WRITE REST OF LINE	;WRITE REST OF LINE
1170)   7563 23          		 INC HL	;
1171)   7564 D6 0D       		 SUB CR	;
1172)   7566 20 F7       		 JR NZ, OSEXIT	;
1173)   7568 D1          		 POP DE         ;DITCH RETURN ADDRESS	;DITCH RETURN ADDRESS
1174)   7569 B9          		 CP C	;
1175)   756A C2 11 73    		 JP NZ, ABORT        ;ESCAPE	;ESCAPE
1176)   756D 3E 0A       		 LD A, LF	;
1177)   756F CD ED 70    		 CALL MYOS_OSWRCH	;
1178)   7572 ED 5B F4 FD 		 LD DE, (ERRLIN)	;
1179)   7576 AF          		 XOR A	;
1180)   7577 6F          		 LD L, A	;
1181)   7578 22 12 FE    		 LD (EDPTR), HL	;
1182)   757B BA          		 CP D	;
1183)   757C C0          		 RET NZ	;
1184)   757D BB          		 CP E	;
1185)   757E C0          		 RET NZ	;
1186)   757F 11 EF 75    		 LD DE, EDITST	;
1187)   7582 06 04       		 LD B, 4	;
1188)   7584 1A          		CMPARE: LD A, (DE)	;
1189)   7585 BE          		 CP (HL)	;
1190)   7586 3E 00       		 LD A, 0	;
1191)   7588 C0          		 RET NZ	;
1192)   7589 23          		 INC HL	;
1193)   758A 13          		 INC DE	;
1194)   758B 7E          		 LD A, (HL)	;
1195)   758C FE 2E       		 CP '.'	;
1196)   758E 28 02       		 JR Z, ABBR	;
1197)   7590 10 F2       		 DJNZ CMPARE	;
1198)   7592 AF          		ABBR: XOR A	;
1199)   7593 47          		 LD B, A	;
1200)   7594 4D          		 LD C, L	;
1201)   7595 6F          		 LD L, A	;
1202)   7596 11 F3 75    		 LD DE, LISTST	;
1203)   7599 EB          		 EX DE, HL	;
1204)   759A ED B0       		 LDIR	;
1205)   759C 21 00 FE    		 LD HL, FLAGS	;
1206)   759F CB DE       		 SET 3, (HL)	;
1207)   75A1 C9          		 RET	;
1209)   75A2 37          		BACK: SCF         ;DELETE LEFT	;DELETE LEFT
1210)   75A3 2C          		LEFT: INC L         ;CURSOR LEFT	;CURSOR LEFT
1211)   75A4 2D          		 DEC L	;
1212)   75A5 28 45       		 JR Z, STOP	;
1213)   75A7 3E 08       		 LD A, BS	;
1214)   75A9 CD ED 70    		 CALL MYOS_OSWRCH	;
1215)   75AC 2D          		 DEC L	;
1216)   75AD D0          		 RET NC	;
1217)   75AE 7E          		DELETE: LD A, (HL)        ;DELETE RIGHT	;DELETE RIGHT
1218)   75AF FE 0D       		 CP CR	;
1219)   75B1 28 39       		 JR Z, STOP	;
1220)   75B3 54          		 LD D, H	;
1221)   75B4 5D          		 LD E, L	;
1222)   75B5 13          		DEL1: INC DE	;
1223)   75B6 1A          		 LD A, (DE)	;
1224)   75B7 1B          		 DEC DE	;
1225)   75B8 12          		 LD (DE), A	;
1226)   75B9 13          		 INC DE	;
1227)   75BA FE 0D       		 CP CR	;
1228)   75BC 20 F7       		 JR NZ, DEL1	;
1229)   75BE D1          		DEL2: POP DE         ;DITCH	;DITCH
1230)   75BF C3 EB 74    		 JP UPDATE	;
1232)   75C2 3E 0D       		INSERT: LD A, CR        ;INSERT SPACE	;INSERT SPACE
1233)   75C4 BE          		 CP (HL)	;
1234)   75C5 C8          		 RET Z	;
1235)   75C6 54          		 LD D, H	;
1236)   75C7 1E FE       		 LD E, 254	;
1237)   75C9 13          		INS1: INC DE	;
1238)   75CA 12          		 LD (DE), A	;
1239)   75CB 1B          		 DEC DE	;
1240)   75CC 7B          		 LD A, E	;
1241)   75CD BD          		 CP L	;
1242)   75CE 1B          		 DEC DE	;
1243)   75CF 1A          		 LD A, (DE)	;
1244)   75D0 20 F7       		 JR NZ, INS1	;
1245)   75D2 36 20       		 LD (HL), ' '	;
1246)   75D4 18 E8       		 JR DEL2	;
1248)   75D6 7E          		RIGHT: LD A, (HL)        ;CURSOR RIGHT	;CURSOR RIGHT
1249)   75D7 FE 0D       		 CP CR	;
1250)   75D9 28 11       		 JR Z, STOP	;
1251)   75DB 56          		SAVECH: LD D, (HL)        ;PRINTING CHARACTER	;PRINTING CHARACTER
1252)   75DC 77          		 LD (HL), A	;
1253)   75DD 2C          		 INC L	;
1254)   75DE 28 09       		 JR Z, WONTGO        ;LINE TOO LONG	;LINE TOO LONG
1255)   75E0 CD ED 70    		 CALL MYOS_OSWRCH	;
1256)   75E3 3E 0D       		 LD A, CR	;
1257)   75E5 BA          		 CP D	;
1258)   75E6 C0          		 RET NZ	;
1259)   75E7 77          		 LD (HL), A	;
1260)   75E8 C9          		 RET	;
1262)   75E9 2D          		WONTGO: DEC L	;
1263)   75EA 36 0D       		 LD (HL), CR	;
1266)   75EC 0E 00       		STOP: LD C, 0        ;STOP REPEAT	;STOP REPEAT
1267)   75EE C9          		 RET	;
1270)   75EF 45 44 49 54 		EDITST: DEFM  "EDIT"	;
1271)   75F3 4C 49 53 54 		LISTST: DEFM  "LIST"	;
385)   75F7 FE 01       		 CP 1         ;IS IT FOR GRAPHICS?	;IS IT FOR GRAPHICS?
386)   75F9 28 0E       		 JR Z, GRCOLS	;
387)   75FB 21 03 FE    		 LD HL, BCOLOR	;
388)   75FE 22 69 FE    		 LD (GR_PARAM4), HL	;
389)   7601 21 01 FE    		 LD HL, FCOLOR	;
390)   7604 22 67 FE    		 LD (GR_PARAM3), HL	;
391)   7607 18 0C       		 JR BS_DOCOL	;
392)   7609 21 07 FE    		GRCOLS: LD HL, BGRCOL	;
393)   760C 22 69 FE    		 LD (GR_PARAM4), HL	;
394)   760F 21 05 FE    		 LD HL, FGRCOL	;
395)   7612 22 67 FE    		 LD (GR_PARAM3), HL	;
396)   7615 CD 94 5E    		BS_DOCOL: CALL EXPRI       ;GET 1ST PARAM	;GET 1ST PARAM
397)   7618 D9          		 EXX	;
398)   7619 FD 7E 00    		 LD A, (IY)	;
399)   761C FE 0D       		 CP 0x0D        ;FINISHED COMD LINE	;FINISHED COMD LINE
400)   761E 28 32       		 JR Z, COLSEL	;
401)   7620 FE 3A       		 CP ':'	;
402)   7622 28 2E       		 JR Z, COLSEL	;
403)   7624 FE 2C       		 CP ', '        ;CHECK FOR ','	;CHECK FOR ','
404)   7626 C2 39 7A    		 JP NZ, GRPHERR	;
406)   7629 E5          		 PUSH HL        ;SAVE 1ST PARAM	;SAVE 1ST PARAM
407)   762A FD 23       		 INC IY         ;NEXT PARAM	;NEXT PARAM
408)   762C CD 94 5E    		 CALL EXPRI        ;GET 2ND PARAM	;GET 2ND PARAM
409)   762F D9          		 EXX	;
410)   7630 D1          		 POP DE         ;RESTORE 1ST PARAM ON DE HL HAS THE 2ND	;RESTORE 1ST PARAM ON DE HL HAS THE 2ND
411)   7631 7B          		 LD A, E	;
412)   7632 D6 80       		 SUB 128	;
413)   7634 38 07       		 JR C, COLFC	;
414)   7636 5F          		 LD E, A	;
415)   7637 DD 21 37 FE 		 LD IX, BCOLPAL	;
416)   763B 18 04       		 JR DOPALCOL	;
417)   763D DD 21 17 FE 		COLFC: LD IX, FCOLPAL	;
419)   7641 7B          		 LD A, E	;
420)   7642 FE 0F       		 CP 15         ;MAX 16 COLORS	;MAX 16 COLORS
421)   7644 D2 39 7A    		 JP NC, GRPHERR	;
422)   7647 DD 19       		 ADD IX, DE	;
423)   7649 DD 19       		 ADD IX, DE        ;2*DE CAUSE ITS A 2 BYTE ARRAY	;2*DE CAUSE ITS A 2 BYTE ARRAY
424)   764B DD 75 00    		 LD (IX), L        ;SAVE THE NEW COLOR	;SAVE THE NEW COLOR
425)   764E DD 74 01    		 LD (IX + 1), H	;
426)   7651 C9          		 RET	;
429)   7652 E5          		 PUSH HL	;
430)   7653 D1          		 POP DE	;
431)   7654 7B          		 LD A, E	;
432)   7655 D6 80       		 SUB 128        ;CHECK MSB	;CHECK MSB
433)   7657 38 15       		 JR C, CFC	;
434)   7659 5F          		 LD E, A	;
435)   765A DD 21 69 FE 		 LD IX, GR_PARAM4	;
437)   765E 7B          		 LD A,E	;
438)   765F 32 0E FF    		 LD (VGABCOL),A	;
440)   7662 DD 6E 00    		 LD L, (IX)	;
441)   7665 DD 66 01    		 LD H, (IX + 1)	;
442)   7668 DD 21 37 FE 		 LD IX, BCOLPAL        ;BACKCOLOR	;BACKCOLOR
443)   766C 18 12       		 JR SFC	;
444)   766E DD 21 67 FE 		CFC: LD IX, GR_PARAM3	;
446)   7672 7B          		 LD A,E	;
447)   7673 32 0D FF    		 LD (VGAFCOL),A	;
449)   7676 DD 6E 00    		 LD L, (IX)	;
450)   7679 DD 66 01    		 LD H, (IX + 1)	;
451)   767C DD 21 17 FE 		 LD IX, FCOLPAL        ;FRONTCOLOR	;FRONTCOLOR
452)   7680 7B          		SFC: LD A, E	;
453)   7681 FE 10       		 CP 16         ;MAX 16 COLORS	;MAX 16 COLORS
454)   7683 D2 39 7A    		 JP NC, GRPHERR	;
455)   7686 DD 19       		 ADD IX, DE	;
456)   7688 DD 19       		 ADD IX, DE	;
457)   768A DD 56 00    		 LD D, (IX)	;
458)   768D DD 5E 01    		 LD E, (IX + 1)	;
459)   7690 72          		 LD (HL), D        ;SAVE AGAIN	;SAVE AGAIN
460)   7691 23          		 INC HL	;
461)   7692 73          		 LD (HL), E	;
462)   7693 C9          		 RET	;
468)   7694 AF          		 XOR A	;
469)   7695 21 63 FE    		 LD HL, GR_PARAM1	;
471)   7698 F5          		 PUSH AF	;
472)   7699 E5          		 PUSH HL	;
473)   769A CD 94 5E    		 CALL EXPRI        ;GET 1ST PARAM	;GET 1ST PARAM
474)   769D D9          		 EXX         ;HL HAS THE PARAM	;HL HAS THE PARAM
475)   769E D1          		 POP DE         ;GET PARAM ADDRESS	;GET PARAM ADDRESS
476)   769F EB          		 EX DE, HL	;
477)   76A0 73          		 LD (HL), E	;
478)   76A1 23          		 INC HL	;
479)   76A2 72          		 LD (HL), D	;
480)   76A3 23          		 INC HL         ;PARAM SAVED	;PARAM SAVED
481)   76A4 F1          		 POP AF	;
482)   76A5 3C          		 INC A	;
483)   76A6 FE 04       		 CP 4	;
484)   76A8 C8          		 RET Z	;
485)   76A9 F5          		 PUSH AF	;
486)   76AA FD 7E 00    		 LD A, (IY)	;
487)   76AD FE 0D       		 CP 0x0D        ;FINISHED COMD LINE	;FINISHED COMD LINE
488)   76AF 28 0D       		 JR Z, NOMORE	;
489)   76B1 FE 3A       		 CP ':'         ;FINISHED COMD LINE	;FINISHED COMD LINE
490)   76B3 28 09       		 JR Z, NOMORE	;
491)   76B5 FE 2C       		 CP ', '        ;CHECK FOR ','	;CHECK FOR ','
492)   76B7 20 05       		 JR NZ, NOMORE	;
493)   76B9 FD 23       		 INC IY         ;NEXT PARAM	;NEXT PARAM
494)   76BB F1          		 POP AF	;
495)   76BC 18 DA       		 JR GBP_NXT	;
496)   76BE F1          		NOMORE: POP AF	;
497)   76BF C9          		 RET	;
502)   76C0 01 08 00    		 LD BC, 8        ;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD	;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD
503)   76C3 11 57 FE    		 LD DE, GR_LASTX3	;
504)   76C6 21 5B FE    		 LD HL, GR_LASTX2	;
505)   76C9 ED B0       		 LDIR	;
506)   76CB 2A 63 FE    		 LD HL, (GR_PARAM1)	;
507)   76CE 22 5F FE    		 LD (GR_LASTX), HL       ;SAVE TO LAST	;SAVE TO LAST
508)   76D1 2A 65 FE    		 LD HL, (GR_PARAM2)	;
509)   76D4 22 61 FE    		 LD (GR_LASTY), HL       ;SAVE TO LAST	;SAVE TO LAST
510)   76D7 C9          		 RET	;
514)   76D8 CD 94 76    		 CALL GETBASICPARAMS	;
515)   76DB FE 02       		 CP 2	;
516)   76DD C2 39 7A    		 JP NZ, GRPHERR	;
517)   76E0 CD 1F 78    		BAS_DODRAW: CALL GRPH_SAVECOLORS	;
518)   76E3 FD E5       		 PUSH IY	;
521)   76E5 2A 5F FE    		 LD HL, (GR_LASTX)	;
522)   76E8 E5          		 PUSH HL	;
523)   76E9 2A 61 FE    		 LD HL, (GR_LASTY)	;
524)   76EC E5          		 PUSH HL	;
525)   76ED CD C0 76    		 CALL GRPH_SAVELASTPOS	;
526)   76F0 2A 63 FE    		 LD HL, (GR_PARAM1)	;
527)   76F3 E5          		 PUSH HL	;
528)   76F4 2A 65 FE    		 LD HL, (GR_PARAM2)	;
529)   76F7 E5          		 PUSH HL	;
530)   76F8 CD 73 01    		 CALL IOS_GRDRAWLNE	;
531)   76FB CD 42 78    		 CALL GRPH_PLOTPXL      ;PLOT LAST PIXEL	;PLOT LAST PIXEL
533)   76FE FD E1       		 POP IY	;
534)   7700 CD 36 78    		 CALL GRPH_RESTORECOLORS	;
535)   7703 C9          		 RET         ;RETURN TO BASIC	;RETURN TO BASIC
539)   7704 CD 94 76    		@BAS_MOVE: CALL GETBASICPARAMS	;
540)   7707 FE 02       		 CP 2	;
541)   7709 C2 39 7A    		 JP NZ, GRPHERR	;
543)   770C CD C0 76    		 CALL GRPH_SAVELASTPOS	;
544)   770F C9          		 RET	;
550)   7710 CD 94 76    		@BAS_POINT: CALL GETBASICPARAMS	;
551)   7713 FE 02       		 CP 2	;
552)   7715 C2 39 7A    		 JP NZ, GRPHERR	;
555)   7718 2A 63 FE    		 LD HL, (GR_PARAM1)	;
556)   771B E5          		 PUSH HL	;
557)   771C 2A 65 FE    		 LD HL, (GR_PARAM2)	;
558)   771F E5          		 PUSH HL	;
559)   7720 CD 76 01    		 CALL IOS_GRREADPXL	;
563)   7723 FD 7E 00    		 LD A, (IY)	;
564)   7726 FE 29       		 CP ')'	;
565)   7728 C2 39 7A    		 JP NZ, GRPHERR	;
566)   772B FD 23       		 INC IY	;
569)   772D 01 00 00    		 LD BC, 0	;
570)   7730 F3          		 DI	;
571)   7731 E5          		 PUSH HL	;
572)   7732 D9          		 EXX	;
573)   7733 E1          		 POP HL	;
574)   7734 D9          		 EXX	;
575)   7735 21 00 00    		 LD HL, 0	;
576)   7738 FB          		 EI	;
577)   7739 C9          		 RET	;
583)   773A FE 00       		GRPH_GETGROUP: CP 0	;
585)   773C 21 99 79    		 LD HL, PLOT00	;
586)   773F C8          		 RET Z	;
587)   7740 FE 08       		 CP 64.SHR.3	;
588)   7742 21 A9 79    		 LD HL, PLOT64	;
589)   7745 C8          		 RET Z	;
590)   7746 FE 0A       		 CP 80.SHR.3	;
591)   7748 21 B9 79    		 LD HL, PLOT80	;
592)   774B C8          		 RET Z	;
593)   774C FE 0C       		 CP 96.SHR.3	;
594)   774E 21 C9 79    		 LD HL, PLOT96	;
595)   7751 C8          		 RET Z	;
596)   7752 FE 10       		 CP 128.SHR.3	;
597)   7754 21 D9 79    		 LD HL, PLOT128	;
598)   7757 C8          		 RET Z	;
599)   7758 FE 12       		 CP 144.SHR.3	;
600)   775A 21 E9 79    		 LD HL, PLOT144	;
601)   775D C8          		 RET Z	;
602)   775E FE 13       		 CP 152.SHR.3	;
603)   7760 21 F9 79    		 LD HL, PLOT152	;
604)   7763 C8          		 RET Z	;
605)   7764 FE 14       		 CP 160.SHR.3	;
606)   7766 21 09 7A    		 LD HL, PLOT160	;
607)   7769 C8          		 RET Z	;
608)   776A FE 18       		 CP 192.SHR.3	;
609)   776C 21 19 7A    		 LD HL, PLOT192	;
610)   776F C8          		 RET Z	;
611)   7770 FE 19       		 CP 200.SHR.3	;
612)   7772 21 29 7A    		 LD HL, PLOT200	;
613)   7775 C8          		 RET Z	;
614)   7776 21 00 00    		 LD HL, 0	;
615)   7779 C9          		 RET	;
618)   777A CD 94 76    		@BAS_PLOT: CALL GETBASICPARAMS	;
619)   777D FE 03       		 CP 3	;
620)   777F C2 39 7A    		 JP NZ, GRPHERR	;
621)   7782 3A 63 FE    		 LD A, (GR_PARAM1)	;
623)   7785 01 04 00    		 LD BC, 4	;
624)   7788 21 65 FE    		 LD HL, GR_PARAM2	;
625)   778B 11 63 FE    		 LD DE, GR_PARAM1	;
626)   778E ED B0       		 LDIR	;
627)   7790 47          		 LD B, A        ;COMMAND GROUP 5 BITS	;COMMAND GROUP 5 BITS
628)   7791 CB 38       		 SRL B	;
629)   7793 CB 38       		 SRL B	;
630)   7795 CB 38       		 SRL B	;
631)   7797 E6 07       		 AND 7	;
632)   7799 4F          		 LD C, A        ;SPECIFIC COMMAND IN GROUP	;SPECIFIC COMMAND IN GROUP
633)   779A 78          		 LD A, B	;
634)   779B CD 3A 77    		 CALL GRPH_GETGROUP	;
635)   779E 7C          		 LD A, H	;
636)   779F FE 00       		 CP 0	;
637)   77A1 C8          		 RET Z        ;RET IF HL=0 GROUP NOT IMPLEMENTED	;RET IF HL=0 GROUP NOT IMPLEMENTED
638)   77A2 06 00       		 LD B, 0	;
639)   77A4 CB 21       		 SLA C         ;C=C*2 2BYTE ADDRESSES	;C=C*2 2BYTE ADDRESSES
640)   77A6 09          		 ADD HL, BC        ;C IS 0-7 SPECIFIC COMMD	;C IS 0-7 SPECIFIC COMMD
641)   77A7 5E          		 LD E, (HL)	;
642)   77A8 23          		 INC HL	;
643)   77A9 56          		 LD D, (HL)	;
644)   77AA EB          		 EX DE, HL	;
645)   77AB E9          		 JP (HL)	;
647)   77AC AF          		GRPH_NOTIMPL: XOR A	;
648)   77AD CD F0 46    		 CALL EXTERR	;
649)   77B0 4E 4F 54 20 		 DEFM 'NOT IMPLEMENTED'	;
649)   77B4 49 4D 50 4C 		 DEFM 'NOT IMPLEMENTED'	;
649)   77B8 45 4D 45 4E 		 DEFM 'NOT IMPLEMENTED'	;
649)   77BC 54 45 44    		 DEFM 'NOT IMPLEMENTED'	;
650)   77BF 00          		 DEFB    0	;
655)   77C0 2A 63 FE    		GRPH_CALCREL: LD HL, (GR_PARAM1)	;
656)   77C3 ED 5B 5F FE 		 LD DE, (GR_LASTX)	;
657)   77C7 19          		 ADD HL, DE	;
658)   77C8 22 63 FE    		 LD (GR_PARAM1), HL	;
659)   77CB 2A 65 FE    		 LD HL, (GR_PARAM2)	;
660)   77CE ED 5B 61 FE 		 LD DE, (GR_LASTY)	;
661)   77D2 19          		 ADD HL, DE	;
662)   77D3 22 65 FE    		 LD (GR_PARAM2), HL	;
663)   77D6 C9          		 RET	;
666)   77D7 CD C0 77    		 CALL GRPH_CALCREL	;
667)   77DA CD C0 76    		 CALL GRPH_SAVELASTPOS	;
668)   77DD C9          		 RET	;
671)   77DE CD C0 77    		 CALL GRPH_CALCREL	;
672)   77E1 CD E0 76    		 CALL BAS_DODRAW	;
673)   77E4 C9          		 RET	;
676)   77E5 2A 01 FE    		 LD HL, (FCOLOR)	;
677)   77E8 E5          		 PUSH HL	;
678)   77E9 2A 03 FE    		 LD HL, (BCOLOR)	;
679)   77EC 22 01 FE    		 LD (FCOLOR), HL	;
680)   77EF E1          		 POP HL	;
681)   77F0 22 03 FE    		 LD (BCOLOR), HL	;
683)   77F3 3A 0D FF    		 LD A,(VGAFCOL)	;
684)   77F6 67          		 LD H,A	;
685)   77F7 3A 0E FF    		 LD A,(VGABCOL)	;
686)   77FA 32 0D FF    		 LD (VGAFCOL),A	;
687)   77FD 7C          		 LD A,H	;
688)   77FE 32 0E FF    		 LD (VGABCOL),A	;
689)   7801 C9          		 RET	;
692)   7802 2A 05 FE    		 LD HL, (FGRCOL)	;
693)   7805 E5          		 PUSH HL	;
694)   7806 2A 07 FE    		 LD HL, (BGRCOL)	;
695)   7809 22 05 FE    		 LD (FGRCOL), HL	;
696)   780C E1          		 POP HL	;
697)   780D 22 07 FE    		 LD (BGRCOL), HL	;
699)   7810 3A 0D FF    		 LD A,(VGAFCOL)	;
700)   7813 67          		 LD H,A	;
701)   7814 3A 0E FF    		 LD A,(VGABCOL)	;
702)   7817 32 0D FF    		 LD (VGAFCOL),A	;
703)   781A 7C          		 LD A,H	;
704)   781B 32 0E FF    		 LD (VGABCOL),A	;
705)   781E C9          		 RET	;
709)   781F 01 04 00    		 LD BC, 4       ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
710)   7822 21 01 FE    		 LD HL, FCOLOR	;
711)   7825 11 09 FE    		 LD DE, FCOLTM	;
712)   7828 ED B0       		 LDIR	;
713)   782A 01 04 00    		 LD BC, 4       ;2 FGRCOL + 2 BGRCOL	;2 FGRCOL + 2 BGRCOL
714)   782D 21 05 FE    		 LD HL, FGRCOL	;
715)   7830 11 01 FE    		 LD DE, FCOLOR	;
716)   7833 ED B0       		 LDIR	;
717)   7835 C9          		 RET	;
721)   7836 01 04 00    		 LD BC, 4       ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
722)   7839 21 09 FE    		 LD HL, FCOLTM	;
723)   783C 11 01 FE    		 LD DE, FCOLOR	;
724)   783F ED B0       		 LDIR	;
725)   7841 C9          		 RET	;
729)   7842 2A 5F FE    		GRPH_PLOTPXL:  LD HL, (GR_LASTX)	;
730)   7845 ED 5B 61 FE 		 LD DE, (GR_LASTY)	;
731)   7849 CD 7F 01    		 CALL IOS_GRPLTPXL	;
732)   784C C9          		 RET	;
734)   784D CD 02 78    		GRPH_PLOTPXLBC: CALL GRPH_SWAPGRCOLS	;
735)   7850 CD 42 78    		 CALL GRPH_PLOTPXL	;
736)   7853 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
737)   7856 C9          		 RET	;
740)   7857 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
741)   785A CD C0 77    		 CALL GRPH_CALCREL	;
742)   785D CD E0 76    		 CALL BAS_DODRAW	;
743)   7860 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
744)   7863 C9          		 RET	;
747)   7864 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
748)   7867 CD E0 76    		 CALL BAS_DODRAW	;
749)   786A CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
750)   786D C9          		 RET	;
752)   786E CD E0 76    		GRPH_TRIANGLE: CALL BAS_DODRAW      ;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT	;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT
753)   7871 2A 57 FE    		 LD HL, (GR_LASTX3)	;
754)   7874 22 63 FE    		 LD (GR_PARAM1), HL	;
755)   7877 2A 59 FE    		 LD HL, (GR_LASTY3)	;
756)   787A 22 65 FE    		 LD (GR_PARAM2), HL	;
757)   787D CD E0 76    		 CALL BAS_DODRAW       ;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT	;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT
758)   7880 2A 57 FE    		 LD HL, (GR_LASTX3)	;
759)   7883 22 63 FE    		 LD (GR_PARAM1), HL	;
760)   7886 2A 59 FE    		 LD HL, (GR_LASTY3)	;
761)   7889 22 65 FE    		 LD (GR_PARAM2), HL	;
762)   788C CD E0 76    		 CALL BAS_DODRAW       ;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT	;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT
763)   788F 01 04 00    		 LD BC, 4	;
764)   7892 21 57 FE    		 LD HL, GR_LASTX3	;
765)   7895 11 5F FE    		 LD DE, GR_LASTX	;
766)   7898 ED B0       		 LDIR         ;SET LASTX,LASTY	;SET LASTX,LASTY
767)   789A C9          		 RET	;
769)   789B CD 02 78    		GRPH_TRIANGLEBC: CALL GRPH_SWAPGRCOLS	;
770)   789E CD 6E 78    		 CALL GRPH_TRIANGLE	;
771)   78A1 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
772)   78A4 C9          		 RET	;
775)   78A5 21 63 FE    		GRPH_RECT: LD HL, GR_PARAM1	;
776)   78A8 11 67 FE    		 LD DE, GR_PARAM3	;
777)   78AB 01 04 00    		 LD BC, 4	;
778)   78AE ED B0       		 LDIR         ;COPY PARAM1,2 TO 3,4	;COPY PARAM1,2 TO 3,4
779)   78B0 2A 61 FE    		 LD HL, (GR_LASTY)	;
780)   78B3 E5          		 PUSH HL        ;PT1_Y	;PT1_Y
781)   78B4 2A 5F FE    		 LD HL, (GR_LASTX)	;
782)   78B7 E5          		 PUSH HL        ;PT1_X	;PT1_X
783)   78B8 2A 61 FE    		 LD HL, (GR_LASTY)	;
784)   78BB 22 65 FE    		 LD (GR_PARAM2), HL	;
785)   78BE CD E0 76    		 CALL BAS_DODRAW       ;PT1_X,PT1_Y TO PT2_X,PT1_Y	;PT1_X,PT1_Y TO PT2_X,PT1_Y
786)   78C1 2A 69 FE    		 LD HL, (GR_PARAM4)	;
787)   78C4 22 65 FE    		 LD (GR_PARAM2), HL	;
788)   78C7 CD E0 76    		 CALL BAS_DODRAW       ;PT2_X,PT1_Y TO PT2_X,PT2_Y	;PT2_X,PT1_Y TO PT2_X,PT2_Y
789)   78CA E1          		 POP HL         ;PT1_X	;PT1_X
790)   78CB 22 63 FE    		 LD (GR_PARAM1), HL	;
791)   78CE CD E0 76    		 CALL BAS_DODRAW       ;PT2_X,PT2_Y TO PT1_X,PT2_Y	;PT2_X,PT2_Y TO PT1_X,PT2_Y
792)   78D1 E1          		 POP HL         ;PT1_Y	;PT1_Y
793)   78D2 22 65 FE    		 LD (GR_PARAM2), HL	;
794)   78D5 CD E0 76    		 CALL BAS_DODRAW       ;PT1_X,PT2_Y TO PT1_X,PT1_Y  	;PT1_X,PT2_Y TO PT1_X,PT1_Y
795)   78D8 01 04 00    		 LD BC, 4	;
796)   78DB 21 67 FE    		 LD HL, GR_PARAM3	;
797)   78DE 11 5F FE    		 LD DE, GR_LASTX	;
798)   78E1 ED B0       		 LDIR         ;SET LASTX,LASTY  	;SET LASTX,LASTY
799)   78E3 C9          		 RET	;
801)   78E4 CD 02 78    		GRPH_RECTBC: CALL GRPH_SWAPGRCOLS	;
802)   78E7 CD A5 78    		 CALL GRPH_RECT	;
803)   78EA CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
804)   78ED C9          		 RET	;
807)   78EE CD 1F 78    		GRPH_CIRCREL: CALL GRPH_SAVECOLORS	;
808)   78F1 2A 63 FE    		 LD HL, (GR_PARAM1)	;
809)   78F4 7C          		 LD A, H	;
810)   78F5 B5          		 OR L	;
811)   78F6 20 06       		 JR NZ, CIRE_DOIT	;
812)   78F8 2A 65 FE    		 LD HL, (GR_PARAM2)	;
813)   78FB 7C          		 LD A, H	;
814)   78FC B5          		 OR L	;
815)   78FD C8          		 RET Z         ; RETURN IF BOTH PARAMS ARE ZERO	; RETURN IF BOTH PARAMS ARE ZERO
816)   78FE ED 5B 5F FE 		CIRE_DOIT: LD DE, (GR_LASTX)	;
817)   7902 D5          		 PUSH DE	;
818)   7903 ED 5B 61 FE 		 LD DE, (GR_LASTY)	;
819)   7907 D5          		 PUSH DE	;
820)   7908 E5          		 PUSH HL	;
821)   7909 CD 79 01    		 CALL IOS_GRCIRCLE	;
822)   790C CD 36 78    		 CALL GRPH_RESTORECOLORS	;
823)   790F C9          		 RET	;
825)   7910 CD 02 78    		GRPH_CIRCRELBC: CALL GRPH_SWAPGRCOLS	;
826)   7913 CD EE 78    		 CALL GRPH_CIRCREL	;
827)   7916 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
828)   7919 C9          		 RET	;
834)   791A C9          		GRPH_CIRCLE: RET	;
835)   791B 2A 5F FE    		 LD HL, (GR_LASTX)	;
836)   791E ED 5B 63 FE 		 LD DE, (GR_PARAM1)	;
837)   7922 AF          		 XOR A	;
838)   7923 ED 42       		 SBC HL, BC	;
839)   7925 22 67 FE    		 LD (GR_PARAM3), HL       ;X2-X1	;X2-X1
840)   7928 2A 61 FE    		 LD HL, (GR_LASTY)	;
841)   792B ED 5B 65 FE 		 LD DE, (GR_PARAM2)	;
842)   792F AF          		 XOR A	;
843)   7930 ED 42       		 SBC HL, BC	;
844)   7932 22 69 FE    		 LD (GR_PARAM4), HL       ;Y2-Y1	;Y2-Y1
846)   7935 ED 4B 67 FE 		 LD BC, (GR_PARAM3)	;
847)   7939 C5          		 PUSH BC	;
848)   793A D1          		 POP DE	;
849)   793B CD 85 01    		 CALL IOS_MULT32        ;BCHL RESULT	;BCHL RESULT
850)   793E D9          		 EXX	;
851)   793F C5          		 PUSH BC	;
852)   7940 D1          		 POP DE	;
853)   7941 D9          		 EXX	;
854)   7942 E5          		 PUSH HL        ;DE LOW	;DE LOW
855)   7943 ED 4B 69 FE 		 LD BC, (GR_PARAM4)	;
856)   7947 C5          		 PUSH BC	;
857)   7948 D1          		 POP DE	;
858)   7949 CD 85 01    		 CALL IOS_MULT32        ;BCHL RESULT	;BCHL RESULT
859)   794C D9          		 EXX	;
860)   794D C5          		 PUSH BC	;
861)   794E E1          		 POP HL	;
862)   794F D9          		 EXX	;
863)   7950 D1          		 POP DE	;
865)   7951 CD 82 01    		 CALL IOS_ADD32	;
870)   7954 C9          		 RET	;
872)   7955 CD 02 78    		GRPH_CIRCLEBC: CALL GRPH_SWAPGRCOLS	;
873)   7958 CD 1A 79    		 CALL GRPH_CIRCLE	;
874)   795B CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
875)   795E C9          		 RET	;
879)   795F CD 02 78    		GRPH_FILL: CALL GRPH_SWAPGRCOLS	;
880)   7962 CD 1F 78    		 CALL GRPH_SAVECOLORS	;
881)   7965 2A 63 FE    		 LD HL, (GR_PARAM1)  ;REVERSED 20/4/2022	;REVERSED 20/4/2022
882)   7968 E5          		 PUSH HL	;
883)   7969 2A 65 FE    		 LD HL, (GR_PARAM2)	;
884)   796C E5          		 PUSH HL	;
885)   796D CD 7C 01    		 CALL IOS_GRFILL	;
886)   7970 CD 36 78    		 CALL GRPH_RESTORECOLORS	;
887)   7973 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
888)   7976 C9          		 RET	;
890)   7977 CD C0 76    		GRPH_DOPIXEL: CALL GRPH_SAVELASTPOS 	;
891)   797A CD 42 78    		 CALL GRPH_PLOTPXL	;
892)   797D C9          		 RET	;
893)   797E CD C0 76    		GRPH_DOPIXELBC: CALL GRPH_SAVELASTPOS 	;
894)   7981 CD 4D 78    		 CALL GRPH_PLOTPXLBC	;
895)   7984 C9          		 RET	;
897)   7985 CD C0 77    		GRPH_DOPIXELREL: CALL GRPH_CALCREL	;
898)   7988 CD C0 76    		 CALL GRPH_SAVELASTPOS  	;
899)   798B CD 42 78    		 CALL GRPH_PLOTPXL	;
900)   798E C9          		 RET	;
901)   798F CD 02 78    		GRPH_DOPIXELRELBC: CALL GRPH_SWAPGRCOLS	;
902)   7992 CD 85 79    		 CALL GRPH_DOPIXELREL	;
903)   7995 CD 02 78    		 CALL GRPH_SWAPGRCOLS	;
904)   7998 C9          		 RET	;
908)   7999 D7 77       		PLOT00: DW GRPH_MOVEREL	;
909)   799B DE 77       		 DW GRPH_LINEREL	;
910)   799D AC 77       		 DW GRPH_NOTIMPL	;
911)   799F 57 78       		 DW GRPH_LINERELBC	;
912)   79A1 C0 76       		 DW GRPH_SAVELASTPOS	;
913)   79A3 E0 76       		 DW BAS_DODRAW	;
914)   79A5 AC 77       		 DW GRPH_NOTIMPL	;
915)   79A7 64 78       		 DW GRPH_DRAWBC	;
917)   79A9 85 79       		PLOT64: DW GRPH_DOPIXELREL	;
918)   79AB 8F 79       		 DW GRPH_DOPIXELRELBC	;
919)   79AD AC 77       		 DW GRPH_NOTIMPL	;
920)   79AF AC 77       		 DW GRPH_NOTIMPL	;
921)   79B1 77 79       		 DW GRPH_DOPIXEL	;
922)   79B3 7E 79       		 DW GRPH_DOPIXELBC  	;
923)   79B5 AC 77       		 DW GRPH_NOTIMPL	;
924)   79B7 AC 77       		 DW GRPH_NOTIMPL  	;
926)   79B9 AC 77       		PLOT80: DW GRPH_NOTIMPL	;
927)   79BB 6E 78       		 DW GRPH_TRIANGLE	;
928)   79BD AC 77       		 DW GRPH_NOTIMPL	;
929)   79BF 9B 78       		 DW GRPH_TRIANGLEBC	;
930)   79C1 AC 77       		 DW GRPH_NOTIMPL	;
931)   79C3 6E 78       		 DW GRPH_TRIANGLE	;
932)   79C5 AC 77       		 DW GRPH_NOTIMPL	;
933)   79C7 9B 78       		 DW GRPH_TRIANGLEBC	;
935)   79C9 AC 77       		PLOT96: DW GRPH_NOTIMPL	;
936)   79CB A5 78       		 DW GRPH_RECT	;
937)   79CD AC 77       		 DW GRPH_NOTIMPL	;
938)   79CF E4 78       		 DW GRPH_RECTBC	;
939)   79D1 AC 77       		 DW GRPH_NOTIMPL	;
940)   79D3 A5 78       		 DW GRPH_RECT	;
941)   79D5 AC 77       		 DW GRPH_NOTIMPL	;
942)   79D7 E4 78       		 DW GRPH_RECTBC	;
944)   79D9 AC 77       		PLOT128: DW GRPH_NOTIMPL	;
945)   79DB 5F 79       		 DW GRPH_FILL	;
946)   79DD AC 77       		 DW GRPH_NOTIMPL	;
947)   79DF AC 77       		 DW GRPH_NOTIMPL	;
948)   79E1 AC 77       		 DW GRPH_NOTIMPL	;
949)   79E3 AC 77       		 DW GRPH_NOTIMPL	;
950)   79E5 AC 77       		 DW GRPH_NOTIMPL	;
951)   79E7 AC 77       		 DW GRPH_NOTIMPL	;
953)   79E9 EE 78       		PLOT144: DW GRPH_CIRCREL	;
954)   79EB EE 78       		 DW GRPH_CIRCREL	;
955)   79ED AC 77       		 DW GRPH_NOTIMPL	;
956)   79EF 10 79       		 DW GRPH_CIRCRELBC	;
957)   79F1 1A 79       		 DW GRPH_CIRCLE	;
958)   79F3 1A 79       		 DW GRPH_CIRCLE	;
959)   79F5 AC 77       		 DW GRPH_NOTIMPL	;
960)   79F7 55 79       		 DW GRPH_CIRCLEBC	;
962)   79F9 AC 77       		PLOT152: DW GRPH_NOTIMPL	;
963)   79FB AC 77       		 DW GRPH_NOTIMPL	;
964)   79FD AC 77       		 DW GRPH_NOTIMPL	;
965)   79FF AC 77       		 DW GRPH_NOTIMPL	;
966)   7A01 AC 77       		 DW GRPH_NOTIMPL	;
967)   7A03 AC 77       		 DW GRPH_NOTIMPL	;
968)   7A05 AC 77       		 DW GRPH_NOTIMPL	;
969)   7A07 AC 77       		 DW GRPH_NOTIMPL	;
971)   7A09 AC 77       		PLOT160: DW GRPH_NOTIMPL	;
972)   7A0B AC 77       		 DW GRPH_NOTIMPL	;
973)   7A0D AC 77       		 DW GRPH_NOTIMPL	;
974)   7A0F AC 77       		 DW GRPH_NOTIMPL	;
975)   7A11 AC 77       		 DW GRPH_NOTIMPL	;
976)   7A13 AC 77       		 DW GRPH_NOTIMPL	;
977)   7A15 AC 77       		 DW GRPH_NOTIMPL	;
978)   7A17 AC 77       		 DW GRPH_NOTIMPL	;
980)   7A19 AC 77       		PLOT192: DW GRPH_NOTIMPL	;
981)   7A1B AC 77       		 DW GRPH_NOTIMPL	;
982)   7A1D AC 77       		 DW GRPH_NOTIMPL	;
983)   7A1F AC 77       		 DW GRPH_NOTIMPL	;
984)   7A21 AC 77       		 DW GRPH_NOTIMPL	;
985)   7A23 AC 77       		 DW GRPH_NOTIMPL	;
986)   7A25 AC 77       		 DW GRPH_NOTIMPL	;
987)   7A27 AC 77       		 DW GRPH_NOTIMPL	;
989)   7A29 AC 77       		PLOT200: DW GRPH_NOTIMPL	;
990)   7A2B AC 77       		 DW GRPH_NOTIMPL	;
991)   7A2D AC 77       		 DW GRPH_NOTIMPL	;
992)   7A2F AC 77       		 DW GRPH_NOTIMPL	;
993)   7A31 AC 77       		 DW GRPH_NOTIMPL	;
994)   7A33 AC 77       		 DW GRPH_NOTIMPL	;
995)   7A35 AC 77       		 DW GRPH_NOTIMPL	;
996)   7A37 AC 77       		 DW GRPH_NOTIMPL	;
999)   7A39 AF          		 XOR A	;
1000)   7A3A CD F0 46    		 CALL EXTERR	;
1001)   7A3D 70 61 72 61 		 DEFM 'param error'	;
1001)   7A41 6D 20 65 72 		 DEFM 'param error'	;
1001)   7A45 72 6F 72    		 DEFM 'param error'	;
1002)   7A48 00          		 DEFB    0	;
382)   7A49 11 CF FE    		@MYOS_OSSAVE: LD DE, STRGBUFF	;
383)   7A4C 7E          		OSNXT: LD A, (HL)        ;hl = ACCS =FILENAME ENDS WITH 0X0D	;hl = ACCS =FILENAME ENDS WITH 0X0D
384)   7A4D FE 0D       		 CP 13         ;	;
385)   7A4F 20 01       		 JR NZ, OSCONT	;
386)   7A51 AF          		 XOR A	;
387)   7A52 12          		OSCONT: LD (DE), A	;
388)   7A53 23          		 INC HL	;
389)   7A54 13          		 INC DE	;
390)   7A55 FE 00       		 CP 0	;
391)   7A57 20 F3       		 JR NZ, OSNXT	;
392)   7A59 3E 04       		 LD A, 4        ;OPEN FILE FOR WRITE AND CREATE IT	;OPEN FILE FOR WRITE AND CREATE IT
393)   7A5B C5          		 PUSH BC	;
394)   7A5C CD 1F 01    		 CALL IOS_OPNFILE       ;A=4=CREATE ON RET FID HAS THE FILE ID ALSO ON A	;A=4=CREATE ON RET FID HAS THE FILE ID ALSO ON A
395)   7A5F C1          		 POP BC         ;bc = length of program	;bc = length of program
396)   7A60 38 12       		 JR C, SVERR	;
397)   7A62 ED 5B DC FD 		 LD DE, (PAGE)	;
398)   7A66 CD 28 01    		 CALL IOS_BLKWRITE      ;BLOCK WRITE	;BLOCK WRITE
399)   7A69 FE C8       		 CP FCMDOK	;
400)   7A6B 20 07       		 JR NZ, SVERR	;
401)   7A6D 3A FB FE    		 LD A, (FID)	;
402)   7A70 CD 25 01    		 CALL IOS_CLSFILE	;
403)   7A73 C9          		 RET         ;ON RET A=RESULT	;ON RET A=RESULT
404)   7A74 FE CA       		SVERR: CP FNOTFND	;
405)   7A76 CA CF 7A    		 JP Z, FLNOTF	;
406)   7A79 CD F0 46    		 CALL EXTERR	;
407)   7A7C 45 72 72 6F 		 DEFM  "Error Saving"	;
407)   7A80 72 20 53 61 		 DEFM  "Error Saving"	;
407)   7A84 76 69 6E 67 		 DEFM  "Error Saving"	;
408)   7A88 00          		 DEFB    0	;
412)   7A89 11 CF FE    		@MYOS_OSLOAD: LD DE, STRGBUFF	;
413)   7A8C 7E          		OLNXT: LD A, (HL)	;
414)   7A8D FE 0D       		 CP 13         ;	;
415)   7A8F 20 01       		 JR NZ, OLCONT	;
416)   7A91 AF          		 XOR A	;
417)   7A92 12          		OLCONT: LD (DE), a	;
418)   7A93 23          		 INC HL	;
419)   7A94 13          		 INC DE	;
420)   7A95 FE 00       		 CP 0	;
421)   7A97 20 F3       		 JR NZ, OLNXT	;
422)   7A99 CD 1F 01    		 CALL IOS_OPNFILE      ;A=0=READ ON RET FID HAS THE FILE ID ALSO ON A	;A=0=READ ON RET FID HAS THE FILE ID ALSO ON A
423)   7A9C 38 1C       		 JR C, LDERR	;
424)   7A9E 2A DC FD    		 LD HL, (PAGE)	;
425)   7AA1 EB          		 EX DE, HL	;
426)   7AA2 01 00 00    		 LD BC, 0        ;ZERO MEANS LOAD ALL	;ZERO MEANS LOAD ALL
427)   7AA5 CD 2B 01    		 CALL IOS_BLKREAD      ;ON RETURN BC HAS THE BYTES WE READ A=RESULT DE=AFTER THE LAST BYTE SAVED	;ON RETURN BC HAS THE BYTES WE READ A=RESULT DE=AFTER THE LAST BYTE SAVED
428)   7AA8 FE C8       		 CP FCMDOK	;
429)   7AAA 20 0E       		 JR NZ, LDERR	;
430)   7AAC 3A FB FE    		 LD A, (FID)	;
431)   7AAF CD 25 01    		 CALL IOS_CLSFILE	;
432)   7AB2 21 DE FD    		 LD HL, TOP       ;SAVE TOP OF BASIC	;SAVE TOP OF BASIC
433)   7AB5 73          		 LD (HL), E	;
434)   7AB6 23          		 INC HL	;
435)   7AB7 72          		 LD (HL), D	;
436)   7AB8 37          		 SCF         ;SET C = NO ERROR	;SET C = NO ERROR
437)   7AB9 C9          		 RET	;
438)   7ABA FE CA       		LDERR: CP FNOTFND	;
439)   7ABC 28 11       		 JR Z, FLNOTF	;
440)   7ABE CD F0 46    		 CALL EXTERR	;
441)   7AC1 45 72 72 6F 		 DEFM  "Error Loading"	;
441)   7AC5 72 20 4C 6F 		 DEFM  "Error Loading"	;
441)   7AC9 61 64 69 6E 		 DEFM  "Error Loading"	;
441)   7ACD 67          		 DEFM  "Error Loading"	;
442)   7ACE 00          		 DEFB    0	;
443)   7ACF CD F0 46    		FLNOTF: CALL EXTERR	;
444)   7AD2 57 72 6F 6E 		 DEFM  "Wrong Filename"	;
444)   7AD6 67 20 46 69 		 DEFM  "Wrong Filename"	;
444)   7ADA 6C 65 6E 61 		 DEFM  "Wrong Filename"	;
444)   7ADE 6D 65       		 DEFM  "Wrong Filename"	;
445)   7AE0 00          		 DEFB    0	;
 16)   FB00 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB04 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB08 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB0C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB10 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB14 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB18 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB1C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB20 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB24 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB28 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB2C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB30 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB34 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB38 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB3C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB40 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB44 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB48 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB4C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB50 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB54 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB58 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB5C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB60 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB64 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB68 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB6C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB70 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB74 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB78 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB7C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB80 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB84 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB88 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB8C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB90 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB94 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB98 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FB9C 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBA0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBA4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBA8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBAC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBB0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBB4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBB8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBBC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBC0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBC4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBC8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBCC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBD0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBD4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBD8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBDC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBE0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBE4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBE8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBEC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBF0 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBF4 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBF8 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   FBFC 00 00 00 00 		@ACCS:  DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 17)   FC00 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC04 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC08 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC0C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC10 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC14 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC18 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC1C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC20 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC24 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC28 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC2C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC30 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC34 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC38 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC3C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC40 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC44 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC48 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC4C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC50 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC54 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC58 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC5C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC60 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC64 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC68 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC6C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC70 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC74 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC78 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC7C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC80 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC84 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC88 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC8C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC90 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC94 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC98 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FC9C 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCA0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCA4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCA8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCAC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCB0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCB4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCB8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCBC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCC0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCC4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCC8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCCC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCD0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCD4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCD8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCDC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCE0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCE4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCE8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCEC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCF0 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCF4 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCF8 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   FCFC 00 00 00 00 		@BUFFER: DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 18)   FD00 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD04 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD08 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD0C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD10 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD14 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD18 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD1C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD20 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD24 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD28 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD2C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD30 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD34 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD38 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD3C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD40 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD44 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD48 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD4C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD50 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD54 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD58 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD5C 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD60 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD64 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   FD68 00 00 00 00 		@STAVAR: DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 21)   FD6C 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD70 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD74 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD78 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD7C 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD80 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD84 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD88 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD8C 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD90 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD94 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD98 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FD9C 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDA0 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDA4 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDA8 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDAC 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDB0 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDB4 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDB8 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDBC 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDC0 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDC4 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDC8 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDCC 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDD0 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   FDD4 00 00 00 00 		@DYNVAR:  DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 22)   FDD8 00 00       		@FNPTR:   DEFS    2               ;DYN. FUNCTION POINTER	;DYN. FUNCTION POINTER
 23)   FDDA 00 00       		@PROPTR:  DEFS    2               ;DYN. PROCEDURE POINTER	;DYN. PROCEDURE POINTER
 25)   FDDC 00 00       		@PAGE:    DEFS    2               ;START OF USER PROGRAM	;START OF USER PROGRAM
 26)   FDDE 00 00       		@TOP:     DEFS    2               ;FIRST LOCN AFTER PROG.	;FIRST LOCN AFTER PROG.
 27)   FDE0 00 00       		@LOMEM:   DEFS    2               ;START OF DYN. STORAGE	;START OF DYN. STORAGE
 28)   FDE2 00 00       		@FREE:    DEFS    2               ;FIRST FREE-SPACE BYTE	;FIRST FREE-SPACE BYTE
 29)   FDE4 00 00       		@HIMEM:   DEFS    2               ;FIRST PROTECTED BYTE	;FIRST PROTECTED BYTE
 31)   FDE6 00 00       		@LINENO:  DEFS    2               ;LINE NUMBER	;LINE NUMBER
 32)   FDE8 00 00       		@TRACEN: DEFS    2               ;TRACE FLAG	;TRACE FLAG
 33)   FDEA 00 00       		@AUTONO: DEFS    2               ;AUTO FLAG	;AUTO FLAG
 34)   FDEC 00 00       		@ERRTRP: DEFS    2               ;ERROR TRAP	;ERROR TRAP
 35)   FDEE 00 00       		@ERRTXT: DEFS    2               ;ERROR MESSAGE POINTER	;ERROR MESSAGE POINTER
 36)   FDF0 00 00       		@DATPTR: DEFS    2               ;DATA POINTER	;DATA POINTER
 37)   FDF2 00 00       		@ERL:  DEFS    2               ;ERROR LINE	;ERROR LINE
 38)   FDF4 00 00       		@ERRLIN: DEFS    2               ;"ON ERROR" LINE	;"ON ERROR" LINE
 39)   FDF6 00 00 00 00 		@RANDOM: DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 39)   FDFA 00          		@RANDOM: DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 40)   FDFB 00          		@COUNT:  DEFS    1               ;PRINT POSITION	;PRINT POSITION
 41)   FDFC 00          		@WIDTH:  DEFS    1               ;PRINT WIDTH	;PRINT WIDTH
 42)   FDFD 00          		@ERR:  DEFS    1               ;ERROR NUMBER	;ERROR NUMBER
 43)   FDFE 00          		@LISTON: DEFS    1               ;LISTO & OPT FLAG	;LISTO & OPT FLAG
 44)   FDFF 00          		@INCREM: DEFS    1               ;AUTO INCREMENT	;AUTO INCREMENT
