 53)   2000 21 00 82    		COLD:			LD      HL,STAVAR       ;COLD START	;COLD START
 54)   2003 F9          					LD      SP,HL	;
 55)   2004 36 0A       					LD      (HL),10	;
 56)   2006 2C          					INC     L	;
 57)   2007 36 09       					LD      (HL),9	;
 58)   2009 2C          					INC     L	;
 59)   200A AF          					XOR     A	;
 60)   200B 77          		PURGE:			LD      (HL),A          ;CLEAR SCRATCHPAD	;CLEAR SCRATCHPAD
 61)   200C 2C          					INC     L	;
 62)   200D 20 FC       					JR      NZ,PURGE	;
 63)   200F 3E 37       					LD      A,37H           ;V3.0	;V3.0
 64)   2011 32 FE 82    					LD      (LISTON),A	;
 65)   2014 21 4B 20    					LD      HL,NOTICE	;
 66)   2017 22 EE 82    					LD      (ERRTXT),HL	;
 67)   201A CD 1B 01    					CALL    OSINIT	;
 68)   201D ED 53 E4 82 					LD      (HIMEM),DE	;
 69)   2021 22 DC 82    					LD      (PAGE),HL	;
 70)   2024 CD C4 27    					CALL    NEWIT	;
 71)   2027 C2 B0 2C    					JP      NZ,CHAIN0       ;AUTO-RUN	;AUTO-RUN
 72)   202A CD 2B 2C    					CALL    TELL	;
 73)   202D 42 42 43 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   2031 42 41 53 49 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   2035 43 20 28 5A 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   2039 38 30 29 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   203D 56 65 72 73 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   2041 69 6F 6E 20 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 73)   2045 33 2E 30 30 					DEFM    "BBC BASIC (Z80) Version 3.00"	;
 74)   2049 0A 0D       					DEFB	0AH,0DH	;
 75)   204B 28 43 29 20 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   204F 43 6F 70 79 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   2053 72 69 67 68 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   2057 74 20 52 2E 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   205B 54 2E 52 75 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   205F 73 73 65 6C 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   2063 6C 20 31 39 		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 75)   2067 38 37       		NOTICE:			DEFM    "(C) Copyright R.T.Russell 1987"	;
 76)   2069 0A 0D 0A 0D 					DEFB	0AH,0DH,0AH,0DH	;
 77)   206D 00          					DEFB    0	;
 78)   206E F6          		@WARM:			DEFB    0F6H	;
 79)   206F 37          		@CLOOP:			SCF	;
 80)   2070 ED 7B E4 82 					LD      SP,(HIMEM)	;
 81)   2074 CD 12 01    					CALL    PROMPT          ;PROMPT USER	;PROMPT USER
 82)   2077 21 FE 82    					LD      HL,LISTON	;
 83)   207A 7E          					LD      A,(HL)	;
 84)   207B E6 0F       					AND     0FH             ;LISTO	;LISTO
 85)   207D F6 30       					OR      30H             ;OPT 3	;OPT 3
 86)   207F 77          					LD      (HL),A	;
 87)   2080 ED 62       					SBC     HL,HL           ;HL <- 0 (V3.0)	;HL <- 0 (V3.0)
 88)   2082 22 EC 82    					LD      (ERRTRP),HL	;
 89)   2085 22 F4 82    					LD      (ERRLIN),HL	;
 90)   2088 2A EA 82    					LD      HL,(AUTONO)	;
 91)   208B 22 E6 82    					LD      (LINENO),HL	;
 92)   208E 7C          					LD      A,H	;
 93)   208F B5          					OR      L	;
 94)   2090 28 17       					JR      Z,NOAUTO	;
 95)   2092 E5          					PUSH    HL	;
 96)   2093 CD 05 29    					CALL    PBCD            ;AUTO NUMBER	;AUTO NUMBER
 97)   2096 E1          					POP     HL	;
 98)   2097 ED 4B FF 82 					LD      BC,(INCREM)	;
 99)   209B 06 00       					LD      B,0	;
100)   209D 09          					ADD     HL,BC	;
101)   209E DA E6 2A    					JP      C,TOOBIG	;
102)   20A1 22 EA 82    					LD      (AUTONO),HL	;
103)   20A4 3E 20       					LD      A,' '	;
104)   20A6 CD 74 28    					CALL    OUTCHR	;
105)   20A9 21 00 80    		NOAUTO:			LD      HL,ACCS	;
106)   20AC CD 1E 01    					CALL    OSLINE          ;GET CONSOLE INPUT	;GET CONSOLE INPUT
107)   20AF AF          					XOR     A	;
108)   20B0 32 FB 82    					LD      (COUNT),A	;
109)   20B3 FD 21 00 80 					LD      IY,ACCS	;
110)   20B7 CD C1 2A    					CALL    LINNUM	;
111)   20BA CD 78 44    					CALL    NXT	;
112)   20BD 7C          					LD      A,H	;
113)   20BE B5          					OR      L	;
114)   20BF 28 03       					JR      Z,LNZERO        ;FOR AUTO (NON-MAPPED)	;FOR AUTO (NON-MAPPED)
115)   20C1 22 E6 82    					LD      (LINENO),HL	;
116)   20C4 11 00 81    		LNZERO:			LD      DE,BUFFER	;
117)   20C7 0E 01       					LD      C,1             ;LEFT MODE	;LEFT MODE
118)   20C9 CD 55 2B    					CALL    LEXAN2          ;LEXICAL ANALYSIS	;LEXICAL ANALYSIS
119)   20CC 12          					LD      (DE),A          ;TERMINATOR	;TERMINATOR
120)   20CD AF          					XOR     A	;
121)   20CE 47          					LD      B,A	;
122)   20CF 4B          					LD      C,E             ;BC=LINE LENGTH	;BC=LINE LENGTH
123)   20D0 13          					INC     DE	;
124)   20D1 12          					LD      (DE),A          ;ZERO NEXT	;ZERO NEXT
125)   20D2 2A E6 82    					LD      HL,(LINENO)	;
126)   20D5 7C          					LD      A,H	;
127)   20D6 B5          					OR      L	;
128)   20D7 FD 21 00 81 					LD      IY,BUFFER       ;FOR XEQ	;FOR XEQ
129)   20DB CA E8 2C    					JP      Z,XEQ           ;DIRECT MODE	;DIRECT MODE
130)   20DE C5          					PUSH    BC	;
131)   20DF E5          					PUSH    HL	;
132)   20E0 CD A8 27    					CALL    SETTOP          ;SET TOP	;SET TOP
133)   20E3 E1          					POP     HL	;
134)   20E4 CD AB 28    					CALL    FINDL	;
135)   20E7 CC 68 27    					CALL    Z,DEL	;
136)   20EA C1          					POP     BC	;
137)   20EB 79          					LD      A,C	;
138)   20EC B7          					OR      A	;
139)   20ED CA 6F 20    					JP      Z,CLOOP         ;DELETE LINE ONLY	;DELETE LINE ONLY
140)   20F0 C6 04       					ADD     A,4	;
141)   20F2 4F          					LD      C,A             ;LENGTH INCLUSIVE	;LENGTH INCLUSIVE
142)   20F3 D5          					PUSH    DE              ;LINE NUMBER	;LINE NUMBER
143)   20F4 C5          					PUSH    BC              ;SAVE LINE LENGTH	;SAVE LINE LENGTH
144)   20F5 EB          					EX      DE,HL	;
145)   20F6 2A DE 82    					LD      HL,(TOP)	;
146)   20F9 E5          					PUSH    HL	;
147)   20FA 09          					ADD     HL,BC	;
148)   20FB E5          					PUSH    HL	;
149)   20FC 24          					INC     H	;
150)   20FD AF          					XOR     A	;
151)   20FE ED 72       					SBC     HL,SP	;
152)   2100 E1          					POP     HL	;
153)   2101 D2 DB 26    					JP      NC,ERROR        ;"No room"	;"No room"
154)   2104 22 DE 82    					LD      (TOP),HL	;
155)   2107 E3          					EX      (SP),HL	;
156)   2108 E5          					PUSH    HL	;
157)   2109 23          					INC     HL	;
158)   210A B7          					OR      A	;
159)   210B ED 52       					SBC     HL,DE	;
160)   210D 44          					LD      B,H             ;BC=AMOUNT TO MOVE	;BC=AMOUNT TO MOVE
161)   210E 4D          					LD      C,L	;
162)   210F E1          					POP     HL	;
163)   2110 D1          					POP     DE	;
164)   2111 28 02       					JR      Z,ATEND	;
165)   2113 ED B8       					LDDR                    ;MAKE SPACE	;MAKE SPACE
166)   2115 C1          		ATEND:			POP     BC              ;LINE LENGTH	;LINE LENGTH
167)   2116 D1          					POP     DE              ;LINE NUMBER	;LINE NUMBER
168)   2117 23          					INC     HL	;
169)   2118 71          					LD      (HL),C          ;STORE LENGTH	;STORE LENGTH
170)   2119 23          					INC     HL	;
171)   211A 73          					LD      (HL),E          ;STORE LINE NUMBER	;STORE LINE NUMBER
172)   211B 23          					INC     HL	;
173)   211C 72          					LD      (HL),D	;
174)   211D 23          					INC     HL	;
175)   211E 11 00 81    					LD      DE,BUFFER	;
176)   2121 EB          					EX      DE,HL	;
177)   2122 0D          					DEC     C	;
178)   2123 0D          					DEC     C	;
179)   2124 0D          					DEC     C	;
180)   2125 ED B0       					LDIR                    ;ADD LINE	;ADD LINE
181)   2127 CD 9D 27    					CALL    CLEAN	;
182)   212A C3 6F 20    					JP      CLOOP		;
189)   212D 80          		KEYWDS:			DEFB    80H	;
190)   212E 41 4E 44    					DEFM    'AND'	;
191)   2131 94          					DEFB    94H	;
192)   2132 41 42 53    					DEFM    'ABS'	;
193)   2135 95          					DEFB    95H	;
194)   2136 41 43 53    					DEFM    'ACS'	;
195)   2139 96          					DEFB    96H	;
196)   213A 41 44 56 41 					DEFM    'ADVAL'	;
196)   213E 4C          					DEFM    'ADVAL'	;
197)   213F 97          					DEFB    97H	;
198)   2140 41 53 43    					DEFM    'ASC'	;
199)   2143 98          					DEFB    98H	;
200)   2144 41 53 4E    					DEFM    'ASN'	;
201)   2147 99          					DEFB    99H	;
202)   2148 41 54 4E    					DEFM    'ATN'	;
203)   214B C6          					DEFB    0C6H	;
204)   214C 41 55 54 4F 					DEFM    'AUTO'	;
205)   2150 9A          					DEFB    9AH	;
206)   2151 42 47 45 54 					DEFM    'BGET'	;
207)   2155 00          					DEFB    0	;
208)   2156 D5          					DEFB    0D5H	;
209)   2157 42 50 55 54 					DEFM    'BPUT'	;
210)   215B 00          					DEFB    0	;
211)   215C FB          					DEFB    0FBH	;
212)   215D 43 4F 4C 4F 					DEFM    'COLOUR'	;
212)   2161 55 52       					DEFM    'COLOUR'	;
213)   2163 FB          					DEFB    0FBH	;
214)   2164 43 4F 4C 4F 					DEFM    'COLOR'	;
214)   2168 52          					DEFM    'COLOR'	;
215)   2169 D6          					DEFB    0D6H	;
216)   216A 43 41 4C 4C 					DEFM    'CALL'	;
217)   216E D7          					DEFB    0D7H	;
218)   216F 43 48 41 49 					DEFM    'CHAIN'	;
218)   2173 4E          					DEFM    'CHAIN'	;
219)   2174 BD          					DEFB    0BDH	;
220)   2175 43 48 52 24 					DEFM    'CHR$'	;
221)   2179 D8          					DEFB    0D8H	;
222)   217A 43 4C 45 41 					DEFM    'CLEAR'	;
222)   217E 52          					DEFM    'CLEAR'	;
223)   217F 00          					DEFB    0	;
224)   2180 D9          					DEFB    0D9H	;
225)   2181 43 4C 4F 53 					DEFM    'CLOSE'	;
225)   2185 45          					DEFM    'CLOSE'	;
226)   2186 00          					DEFB    0	;
227)   2187 DA          					DEFB    0DAH	;
228)   2188 43 4C 47    					DEFM    'CLG'	;
229)   218B 00          					DEFB    0	;
230)   218C DB          					DEFB    0DBH	;
231)   218D 43 4C 53    					DEFM    'CLS'	;
232)   2190 00          					DEFB    0	;
233)   2191 9B          					DEFB    9BH	;
234)   2192 43 4F 53    					DEFM    'COS'	;
235)   2195 9C          					DEFB    9CH	;
236)   2196 43 4F 55 4E 					DEFM    'COUNT'	;
236)   219A 54          					DEFM    'COUNT'	;
237)   219B 00          					DEFB    0	;
238)   219C DC          					DEFB    0DCH	;
239)   219D 44 41 54 41 					DEFM    'DATA'	;
240)   21A1 9D          					DEFB    9DH	;
241)   21A2 44 45 47    					DEFM    'DEG'	;
242)   21A5 DD          					DEFB    0DDH	;
243)   21A6 44 45 46    					DEFM    'DEF'	;
244)   21A9 C7          					DEFB    0C7H	;
245)   21AA 44 45 4C 45 					DEFM    'DELETE'	;
245)   21AE 54 45       					DEFM    'DELETE'	;
246)   21B0 81          					DEFB    81H	;
247)   21B1 44 49 56    					DEFM    'DIV'	;
248)   21B4 DE          					DEFB    0DEH	;
249)   21B5 44 49 4D    					DEFM    'DIM'	;
250)   21B8 DF          					DEFB    0DFH	;
251)   21B9 44 52 41 57 					DEFM    'DRAW'	;
252)   21BD E1          					DEFB    0E1H	;
253)   21BE 45 4E 44 50 					DEFM    'ENDPROC'	;
253)   21C2 52 4F 43    					DEFM    'ENDPROC'	;
254)   21C5 00          					DEFB    0	;
255)   21C6 E0          					DEFB    0E0H	;
256)   21C7 45 4E 44    					DEFM    'END'	;
257)   21CA 00          					DEFB    0	;
258)   21CB E2          					DEFB    0E2H	;
259)   21CC 45 4E 56 45 					DEFM    'ENVELOPE'	;
259)   21D0 4C 4F 50 45 					DEFM    'ENVELOPE'	;
260)   21D4 8B          					DEFB    8BH	;
261)   21D5 45 4C 53 45 					DEFM    'ELSE'	;
262)   21D9 A0          					DEFB    0A0H	;
263)   21DA 45 56 41 4C 					DEFM    'EVAL'	;
264)   21DE 9E          					DEFB    9EH	;
265)   21DF 45 52 4C    					DEFM    'ERL'	;
266)   21E2 00          					DEFB    0	;
267)   21E3 85          					DEFB    85H	;
268)   21E4 45 52 52 4F 					DEFM    'ERROR'	;
268)   21E8 52          					DEFM    'ERROR'	;
269)   21E9 C5          					DEFB    0C5H	;
270)   21EA 45 4F 46    					DEFM    'EOF'	;
271)   21ED 00          					DEFB    0	;
272)   21EE 82          					DEFB    82H	;
273)   21EF 45 4F 52    					DEFM    'EOR'	;
274)   21F2 9F          					DEFB    9FH	;
275)   21F3 45 52 52    					DEFM    'ERR'	;
276)   21F6 00          					DEFB    0	;
277)   21F7 A1          					DEFB    0A1H	;
278)   21F8 45 58 50    					DEFM    'EXP'	;
279)   21FB A2          					DEFB    0A2H	;
280)   21FC 45 58 54    					DEFM    'EXT'	;
281)   21FF 00          					DEFB    0	;
282)   2200 E3          					DEFB    0E3H	;
283)   2201 46 4F 52    					DEFM    'FOR'	;
284)   2204 A3          					DEFB    0A3H	;
285)   2205 46 41 4C 53 					DEFM    'FALSE'	;
285)   2209 45          					DEFM    'FALSE'	;
286)   220A 00          					DEFB    0	;
287)   220B A4          					DEFB    0A4H	;
288)   220C 46 4E       					DEFM    'FN'	;
289)   220E E5          					DEFB    0E5H	;
290)   220F 47 4F 54 4F 					DEFM    'GOTO'	;
291)   2213 BE          					DEFB    0BEH	;
292)   2214 47 45 54 24 					DEFM    'GET$'	;
293)   2218 A5          					DEFB    0A5H	;
294)   2219 47 45 54    					DEFM    'GET'	;
295)   221C E4          					DEFB    0E4H	;
296)   221D 47 4F 53 55 					DEFM    'GOSUB'	;
296)   2221 42          					DEFM    'GOSUB'	;
297)   2222 E6          					DEFB    0E6H	;
298)   2223 47 43 4F 4C 					DEFM    'GCOL'	;
299)   2227 93          					DEFB    93H	;
300)   2228 48 49 4D 45 					DEFM    'HIMEM'	;
300)   222C 4D          					DEFM    'HIMEM'	;
301)   222D 00          					DEFB    0	;
302)   222E E8          					DEFB    0E8H	;
303)   222F 49 4E 50 55 					DEFM    'INPUT'	;
303)   2233 54          					DEFM    'INPUT'	;
304)   2234 E7          					DEFB    0E7H	;
305)   2235 49 46       					DEFM    'IF'	;
306)   2237 BF          					DEFB    0BFH	;
307)   2238 49 4E 4B 45 					DEFM    'INKEY$'	;
307)   223C 59 24       					DEFM    'INKEY$'	;
308)   223E A6          					DEFB    0A6H	;
309)   223F 49 4E 4B 45 					DEFM    'INKEY'	;
309)   2243 59          					DEFM    'INKEY'	;
310)   2244 A8          					DEFB    0A8H	;
311)   2245 49 4E 54    					DEFM    'INT'	;
312)   2248 A7          					DEFB    0A7H	;
313)   2249 49 4E 53 54 					DEFM    'INSTR('	;
313)   224D 52 28       					DEFM    'INSTR('	;
314)   224F C9          					DEFB    0C9H	;
315)   2250 4C 49 53 54 					DEFM    'LIST'	;
316)   2254 86          					DEFB    86H	;
317)   2255 4C 49 4E 45 					DEFM    'LINE'	;
318)   2259 C8          					DEFB    0C8H	;
319)   225A 4C 4F 41 44 					DEFM    'LOAD'	;
320)   225E 92          					DEFB    92H	;
321)   225F 4C 4F 4D 45 					DEFM    'LOMEM'	;
321)   2263 4D          					DEFM    'LOMEM'	;
322)   2264 00          					DEFB    0	;
323)   2265 EA          					DEFB    0EAH	;
324)   2266 4C 4F 43 41 					DEFM    'LOCAL'	;
324)   226A 4C          					DEFM    'LOCAL'	;
325)   226B C0          					DEFB    0C0H	;
326)   226C 4C 45 46 54 					DEFM    'LEFT$('	;
326)   2270 24 28       					DEFM    'LEFT$('	;
327)   2272 A9          					DEFB    0A9H	;
328)   2273 4C 45 4E    					DEFM    'LEN'	;
329)   2276 E9          					DEFB    0E9H	;
330)   2277 4C 45 54    					DEFM    'LET'	;
331)   227A AB          					DEFB    0ABH	;
332)   227B 4C 4F 47    					DEFM    'LOG'	;
333)   227E AA          					DEFB    0AAH	;
334)   227F 4C 4E       					DEFM    'LN'	;
335)   2281 C1          					DEFB    0C1H	;
336)   2282 4D 49 44 24 					DEFM    'MID$('	;
336)   2286 28          					DEFM    'MID$('	;
337)   2287 EB          					DEFB    0EBH	;
338)   2288 4D 4F 44 45 					DEFM    'MODE'	;
339)   228C 83          					DEFB    83H	;
340)   228D 4D 4F 44    					DEFM    'MOD'	;
341)   2290 EC          					DEFB    0ECH	;
342)   2291 4D 4F 56 45 					DEFM    'MOVE'	;
343)   2295 ED          					DEFB    0EDH	;
344)   2296 4E 45 58 54 					DEFM    'NEXT'	;
345)   229A CA          					DEFB    0CAH	;
346)   229B 4E 45 57    					DEFM    'NEW'	;
347)   229E 00          					DEFB    0	;
348)   229F AC          					DEFB    0ACH	;
349)   22A0 4E 4F 54    					DEFM    'NOT'	;
350)   22A3 CB          					DEFB    0CBH	;
351)   22A4 4F 4C 44    					DEFM    'OLD'	;
352)   22A7 00          					DEFB    0	;
353)   22A8 EE          					DEFB    0EEH	;
354)   22A9 4F 4E       					DEFM    'ON'	;
355)   22AB 87          					DEFB    87H	;
356)   22AC 4F 46 46    					DEFM    'OFF'	;
357)   22AF 84          					DEFB    84H	;
358)   22B0 4F 52       					DEFM    'OR'	;
359)   22B2 8E          					DEFB    8EH	;
360)   22B3 4F 50 45 4E 					DEFM    'OPENIN'	;
360)   22B7 49 4E       					DEFM    'OPENIN'	;
361)   22B9 AE          					DEFB    0AEH	;
362)   22BA 4F 50 45 4E 					DEFM    'OPENOUT'	;
362)   22BE 4F 55 54    					DEFM    'OPENOUT'	;
363)   22C1 AD          					DEFB    0ADH	;
364)   22C2 4F 50 45 4E 					DEFM    'OPENUP'	;
364)   22C6 55 50       					DEFM    'OPENUP'	;
365)   22C8 FF          					DEFB    0FFH	;
366)   22C9 4F 53 43 4C 					DEFM    'OSCLI'	;
366)   22CD 49          					DEFM    'OSCLI'	;
367)   22CE F1          					DEFB    0F1H	;
368)   22CF 50 52 49 4E 					DEFM    'PRINT'	;
368)   22D3 54          					DEFM    'PRINT'	;
369)   22D4 90          					DEFB    90H	;
370)   22D5 50 41 47 45 					DEFM    'PAGE'	;
371)   22D9 00          					DEFB    0	;
372)   22DA 8F          					DEFB    8FH	;
373)   22DB 50 54 52    					DEFM    'PTR'	;
374)   22DE 00          					DEFB    0	;
375)   22DF AF          					DEFB    0AFH	;
376)   22E0 50 49       					DEFM    'PI'	;
377)   22E2 00          					DEFB    0	;
378)   22E3 F0          					DEFB    0F0H	;
379)   22E4 50 4C 4F 54 					DEFM    'PLOT'	;
380)   22E8 B0          					DEFB    0B0H	;
381)   22E9 50 4F 49 4E 					DEFM    'POINT('	;
381)   22ED 54 28       					DEFM    'POINT('	;
382)   22EF F2          					DEFB    0F2H	;
383)   22F0 50 52 4F 43 					DEFM    'PROC'	;
384)   22F4 B1          					DEFB    0B1H	;
385)   22F5 50 4F 53    					DEFM    'POS'	;
386)   22F8 00          					DEFB    0	;
387)   22F9 CE          					DEFB    0CEH	;
388)   22FA 50 55 54    					DEFM    'PUT'	;
389)   22FD F8          					DEFB    0F8H	;
390)   22FE 52 45 54 55 					DEFM    'RETURN'	;
390)   2302 52 4E       					DEFM    'RETURN'	;
391)   2304 00          					DEFB    0	;
392)   2305 F5          					DEFB    0F5H	;
393)   2306 52 45 50 45 					DEFM    'REPEAT'	;
393)   230A 41 54       					DEFM    'REPEAT'	;
394)   230C F6          					DEFB    0F6H	;
395)   230D 52 45 50 4F 					DEFM    'REPORT'	;
395)   2311 52 54       					DEFM    'REPORT'	;
396)   2313 00          					DEFB    0	;
397)   2314 F3          					DEFB    0F3H	;
398)   2315 52 45 41 44 					DEFM    'READ'	;
399)   2319 F4          					DEFB    0F4H	;
400)   231A 52 45 4D    					DEFM    'REM'	;
401)   231D F9          					DEFB    0F9H	;
402)   231E 52 55 4E    					DEFM    'RUN'	;
403)   2321 00          					DEFB    0	;
404)   2322 B2          					DEFB    0B2H	;
405)   2323 52 41 44    					DEFM    'RAD'	;
406)   2326 F7          					DEFB    0F7H	;
407)   2327 52 45 53 54 					DEFM    'RESTORE'	;
407)   232B 4F 52 45    					DEFM    'RESTORE'	;
408)   232E C2          					DEFB    0C2H	;
409)   232F 52 49 47 48 					DEFM    'RIGHT$('	;
409)   2333 54 24 28    					DEFM    'RIGHT$('	;
410)   2336 B3          					DEFB    0B3H	;
411)   2337 52 4E 44    					DEFM    'RND'	;
412)   233A 00          					DEFB    0	;
413)   233B CC          					DEFB    0CCH	;
414)   233C 52 45 4E 55 					DEFM    'RENUMBER'	;
414)   2340 4D 42 45 52 					DEFM    'RENUMBER'	;
415)   2344 88          					DEFB    88H	;
416)   2345 53 54 45 50 					DEFM    'STEP'	;
417)   2349 CD          					DEFB    0CDH	;
418)   234A 53 41 56 45 					DEFM    'SAVE'	;
419)   234E B4          					DEFB    0B4H	;
420)   234F 53 47 4E    					DEFM    'SGN'	;
421)   2352 B5          					DEFB    0B5H	;
422)   2353 53 49 4E    					DEFM    'SIN'	;
423)   2356 B6          					DEFB    0B6H	;
424)   2357 53 51 52    					DEFM    'SQR'	;
425)   235A 89          					DEFB    89H	;
426)   235B 53 50 43    					DEFM    'SPC'	;
427)   235E C3          					DEFB    0C3H	;
428)   235F 53 54 52 24 					DEFM    'STR$'	;
429)   2363 C4          					DEFB    0C4H	;
430)   2364 53 54 52 49 					DEFM    'STRING$('	;
430)   2368 4E 47 24 28 					DEFM    'STRING$('	;
431)   236C D4          					DEFB    0D4H	;
432)   236D 53 4F 55 4E 					DEFM    'SOUND'	;
432)   2371 44          					DEFM    'SOUND'	;
433)   2372 FA          					DEFB    0FAH	;
434)   2373 53 54 4F 50 					DEFM    'STOP'	;
435)   2377 00          					DEFB    0	;
436)   2378 B7          					DEFB    0B7H	;
437)   2379 54 41 4E    					DEFM    'TAN'	;
438)   237C 8C          					DEFB    8CH	;
439)   237D 54 48 45 4E 					DEFM    'THEN'	;
440)   2381 B8          					DEFB    0B8H	;
441)   2382 54 4F       					DEFM    'TO'	;
442)   2384 8A          					DEFB    8AH	;
443)   2385 54 41 42 28 					DEFM    'TAB('	;
444)   2389 FC          					DEFB    0FCH	;
445)   238A 54 52 41 43 					DEFM    'TRACE'	;
445)   238E 45          					DEFM    'TRACE'	;
446)   238F 91          					DEFB    91H	;
447)   2390 54 49 4D 45 					DEFM    'TIME'	;
448)   2394 00          					DEFB    0	;
449)   2395 B9          					DEFB    0B9H	;
450)   2396 54 52 55 45 					DEFM    'TRUE'	;
451)   239A 00          					DEFB    0	;
452)   239B FD          					DEFB    0FDH	;
453)   239C 55 4E 54 49 					DEFM    'UNTIL'	;
453)   23A0 4C          					DEFM    'UNTIL'	;
454)   23A1 BA          					DEFB    0BAH	;
455)   23A2 55 53 52    					DEFM    'USR'	;
456)   23A5 EF          					DEFB    0EFH	;
457)   23A6 56 44 55    					DEFM    'VDU'	;
458)   23A9 BB          					DEFB    0BBH	;
459)   23AA 56 41 4C    					DEFM    'VAL'	;
460)   23AD BC          					DEFB    0BCH	;
461)   23AE 56 50 4F 53 					DEFM    'VPOS'	;
462)   23B2 00          					DEFB    0	;
463)   23B3 FE          					DEFB    0FEH	;
464)   23B4 57 49 44 54 					DEFM    'WIDTH'	;
464)   23B8 48          					DEFM    'WIDTH'	;
465)   23B9 D3          					DEFB    0D3H	;
466)   23BA 48 49 4D 45 					DEFM    'HIMEM'	;
466)   23BE 4D          					DEFM    'HIMEM'	;
467)   23BF D2          					DEFB    0D2H	;
468)   23C0 4C 4F 4D 45 					DEFM    'LOMEM'	;
468)   23C4 4D          					DEFM    'LOMEM'	;
469)   23C5 D0          					DEFB    0D0H	;
470)   23C6 50 41 47 45 					DEFM    'PAGE'	;
471)   23CA CF          					DEFB    0CFH	;
472)   23CB 50 54 52    					DEFM    'PTR'	;
473)   23CE D1          					DEFB    0D1H	;
474)   23CF 54 49 4D 45 					DEFM    'TIME'	;
475)   23D3 01          					DEFB    1	;
476)   23D4 4D 69 73 73 					DEFM    'Missing '	;
476)   23D8 69 6E 67 20 					DEFM    'Missing '	;
477)   23DC 02          					DEFB    2	;
478)   23DD 4E 6F 20 73 					DEFM    'No such '	;
478)   23E1 75 63 68 20 					DEFM    'No such '	;
479)   23E5 03          					DEFB    3	;
480)   23E6 42 61 64 20 					DEFM    'Bad '	;
481)   23EA 04          					DEFB    4	;
482)   23EB 20 72 61 6E 					DEFM    ' range'	;
482)   23EF 67 65       					DEFM    ' range'	;
483)   23F1 05          					DEFB    5	;
484)   23F2 76 61 72 69 					DEFM    'variable'	;
484)   23F6 61 62 6C 65 					DEFM    'variable'	;
485)   23FA 06          					DEFB    6	;
486)   23FB 4F 75 74 20 					DEFM    'Out of'	;
486)   23FF 6F 66       					DEFM    'Out of'	;
487)   2401 07          					DEFB    7	;
488)   2402 4E 6F 20    					DEFM    'No '	;
489)   2405 08          					DEFB    8	;
490)   2406 20 73 70 61 					DEFM    ' space'	;
490)   240A 63 65       					DEFM    ' space'	;
492)   240C FF FF       					DEFW    -1	;
496)   240E 07          		ERRWDS:			DEFB    7	;
497)   240F 72 6F 6F 6D 					DEFM    'room'	;
498)   2413 00          					DEFB    0	;
499)   2414 06          					DEFB    6	;
500)   2415 04          					DEFB    4	;
501)   2416 00          					DEFB    0	;
502)   2417 00 00       					DEFW    0	;
503)   2419 4D 69 73 74 					DEFM    'Mistake'	;
503)   241D 61 6B 65    					DEFM    'Mistake'	;
504)   2420 00          					DEFB    0	;
505)   2421 01          					DEFB    1	;
506)   2422 2C          					DEFM    ','	;
507)   2423 00          					DEFB    0	;
508)   2424 54 79 70 65 					DEFM    'Type mismatch'	;
508)   2428 20 6D 69 73 					DEFM    'Type mismatch'	;
508)   242C 6D 61 74 63 					DEFM    'Type mismatch'	;
508)   2430 68          					DEFM    'Type mismatch'	;
509)   2431 00          					DEFB    0	;
510)   2432 07          					DEFB    7	;
511)   2433 A4          					DEFB    FN	;
512)   2434 00 00       					DEFW    0	;
513)   2436 01          					DEFB    1	;
514)   2437 22          					DEFB    34		;ASCII ""	;ASCII ""
515)   2438 00          					DEFB    0	;
516)   2439 03          					DEFB    3	;
517)   243A DE          					DEFB    DIM	;
518)   243B 00          					DEFB    0	;
519)   243C DE          					DEFB    DIM	;
520)   243D 08          					DEFB    8	;
521)   243E 00          					DEFB    0	;
522)   243F 4E 6F 74 20 					DEFM    'Not '	;
523)   2443 EA          					DEFB    LOCAL	;
524)   2444 00          					DEFB    0	;
525)   2445 07          					DEFB    7	;
526)   2446 F2          					DEFB    PROC	;
527)   2447 00          					DEFB    0	;
528)   2448 41 72 72 61 					DEFM    'Array'	;
528)   244C 79          					DEFM    'Array'	;
529)   244D 00          					DEFB    0	;
530)   244E 53 75 62 73 					DEFM    'Subscript'	;
530)   2452 63 72 69 70 					DEFM    'Subscript'	;
530)   2456 74          					DEFM    'Subscript'	;
531)   2457 00          					DEFB    0	;
532)   2458 53 79 6E 74 					DEFM    'Syntax error'	;
532)   245C 61 78 20 65 					DEFM    'Syntax error'	;
532)   2460 72 72 6F 72 					DEFM    'Syntax error'	;
533)   2464 00          					DEFB    0	;
534)   2465 45 73 63 61 					DEFM    'Escape'	;
534)   2469 70 65       					DEFM    'Escape'	;
535)   246B 00          					DEFB    0	;
536)   246C 44 69 76 69 					DEFM    'Division by zero'	;
536)   2470 73 69 6F 6E 					DEFM    'Division by zero'	;
536)   2474 20 62 79 20 					DEFM    'Division by zero'	;
536)   2478 7A 65 72 6F 					DEFM    'Division by zero'	;
537)   247C 00          					DEFB    0	;
538)   247D 53 74 72 69 					DEFM    'String too long'	;
538)   2481 6E 67 20 74 					DEFM    'String too long'	;
538)   2485 6F 6F 20 6C 					DEFM    'String too long'	;
538)   2489 6F 6E 67    					DEFM    'String too long'	;
539)   248C 00          					DEFB    0	;
540)   248D 54 6F 6F 20 					DEFM    'Too big'	;
540)   2491 62 69 67    					DEFM    'Too big'	;
541)   2494 00          					DEFB    0	;
542)   2495 2D 76 65 20 					DEFM    '-ve root'	;
542)   2499 72 6F 6F 74 					DEFM    '-ve root'	;
543)   249D 00          					DEFB    0	;
544)   249E 4C 6F 67    					DEFM    'Log'	;
545)   24A1 04          					DEFB    4	;
546)   24A2 00          					DEFB    0	;
547)   24A3 41 63 63 75 					DEFM    'Accuracy lost'	;
547)   24A7 72 61 63 79 					DEFM    'Accuracy lost'	;
547)   24AB 20 6C 6F 73 					DEFM    'Accuracy lost'	;
547)   24AF 74          					DEFM    'Accuracy lost'	;
548)   24B0 00          					DEFB    0	;
549)   24B1 45 78 70    					DEFM    'Exp'	;
550)   24B4 04          					DEFB    4	;
551)   24B5 00 00       					DEFW    0	;
552)   24B7 02          					DEFB    2	;
553)   24B8 05          					DEFB    5	;
554)   24B9 00          					DEFB    0	;
555)   24BA 01          					DEFB    1	;
556)   24BB 29          					DEFM    ')'	;
557)   24BC 00          					DEFB    0	;
558)   24BD 03          					DEFB    3	;
559)   24BE 48 45 58    					DEFM    'HEX'	;
560)   24C1 00          					DEFB    0	;
561)   24C2 02          					DEFB    2	;
562)   24C3 A4          					DEFB    FN	;
563)   24C4 2F          					DEFM    '/'	;
564)   24C5 F2          					DEFB    PROC	;
565)   24C6 00          					DEFB    0	;
566)   24C7 03          					DEFB    3	;
567)   24C8 63 61 6C 6C 					DEFM    'call'	;
568)   24CC 00          					DEFB    0	;
569)   24CD 41 72 67 75 					DEFM    'Arguments'	;
569)   24D1 6D 65 6E 74 					DEFM    'Arguments'	;
569)   24D5 73          					DEFM    'Arguments'	;
570)   24D6 00          					DEFB    0	;
571)   24D7 07          					DEFB    7	;
572)   24D8 E3          					DEFB    FOR	;
573)   24D9 00          					DEFB    0	;
574)   24DA 43 61 6E 27 					DEFM    'Can't match '	;
574)   24DE 74 20 6D 61 					DEFM    'Can't match '	;
574)   24E2 74 63 68 20 					DEFM    'Can't match '	;
575)   24E6 E3          					DEFB    FOR	;
576)   24E7 00          					DEFB    0	;
577)   24E8 E3          					DEFB    FOR	;
578)   24E9 20          					DEFM    ' '	;
579)   24EA 05          					DEFB    5	;
580)   24EB 00 00       					DEFW    0	;
581)   24ED 07          					DEFB    7	;
582)   24EE B8          					DEFB    TO	;
583)   24EF 00 00       					DEFW    0	;
584)   24F1 07          					DEFB    7	;
585)   24F2 E4          					DEFB    GOSUB	;
586)   24F3 00          					DEFB    0	;
587)   24F4 EE          					DEFB    ON	;
588)   24F5 20 73 79 6E 					DEFM    ' syntax'	;
588)   24F9 74 61 78    					DEFM    ' syntax'	;
589)   24FC 00          					DEFB    0	;
590)   24FD EE          					DEFB    ON	;
591)   24FE 04          					DEFB    4	;
592)   24FF 00          					DEFB    0	;
593)   2500 02          					DEFB    2	;
594)   2501 6C 69 6E 65 					DEFM    'line'	;
595)   2505 00          					DEFB    0	;
596)   2506 06          					DEFB    6	;
597)   2507 20          					DEFM    ' '	;
598)   2508 DC          					DEFB    DATA	;
599)   2509 00          					DEFB    0	;
600)   250A 07          					DEFB    7	;
601)   250B F5          					DEFB    REPEAT	;
602)   250C 00 00       					DEFW    0	;
603)   250E 01          					DEFB    1	;
604)   250F 23          					DEFM    '#'	;
605)   2510 00          					DEFB    0	;
611)   2511 CD A8 27    		@DELETE:		CALL    SETTOP          ;SET TOP	;SET TOP
612)   2514 CD 0E 2B    					CALL    DLPAIR	;
613)   2517 7E          		DELET1:			LD      A,(HL)	;
614)   2518 B7          					OR      A	;
615)   2519 28 71       					JR      Z,WARMNC	;
616)   251B 23          					INC     HL	;
617)   251C 5E          					LD      E,(HL)	;
618)   251D 23          					INC     HL	;
619)   251E 56          					LD      D,(HL)	;
620)   251F 7A          					LD      A,D	;
621)   2520 B3          					OR      E	;
622)   2521 28 1A       					JR      Z,CLOOP1        ;LINE NUMBER ZERO	;LINE NUMBER ZERO
623)   2523 2B          					DEC     HL	;
624)   2524 2B          					DEC     HL	;
625)   2525 EB          					EX      DE,HL	;
626)   2526 37          					SCF	;
627)   2527 ED 42       					SBC     HL,BC	;
628)   2529 EB          					EX      DE,HL	;
629)   252A 30 60       					JR      NC,WARMNC	;
630)   252C C5          					PUSH    BC	;
631)   252D CD 68 27    					CALL    DEL	;
632)   2530 C1          					POP     BC	;
633)   2531 18 E4       					JR      DELET1	;
637)   2533 FD 23       		LISTO:			INC     IY              ;SKIP "O"	;SKIP "O"
638)   2535 CD 94 3E    					CALL    EXPRI	;
639)   2538 D9          					EXX	;
640)   2539 7D          					LD      A,L	;
641)   253A 32 FE 82    					LD      (LISTON),A	;
642)   253D C3 6F 20    		CLOOP1:			JP      CLOOP	;
650)   2540 FE 4F       		@LIST:			CP      'O'	;
651)   2542 28 EF       					JR      Z,LISTO	;
652)   2544 CD 0E 2B    					CALL    DLPAIR	;
653)   2547 CD 78 44    					CALL    NXT	;
654)   254A FE E7       					CP      TIF             ;IF CLAUSE ?	;IF CLAUSE ?
655)   254C 3E 00       					LD      A,0             ;INIT IF-CLAUSE LENGTH	;INIT IF-CLAUSE LENGTH
656)   254E 20 15       					JR      NZ,LISTB	;
657)   2550 FD 23       					INC     IY              ;SKIP IF	;SKIP IF
658)   2552 CD 78 44    					CALL    NXT             ;SKIP SPACES (IF ANY)	;SKIP SPACES (IF ANY)
659)   2555 EB          					EX      DE,HL	;
660)   2556 FD E5       					PUSH    IY	;
661)   2558 E1          					POP     HL              ;HL ADDRESSES IF CLAUSE	;HL ADDRESSES IF CLAUSE
662)   2559 3E 0D       					LD      A,CR	;
663)   255B C5          					PUSH    BC	;
664)   255C 01 00 01    					LD      BC,256	;
665)   255F ED B1       					CPIR                    ;LOCATE CR	;LOCATE CR
666)   2561 79          					LD      A,C	;
667)   2562 2F          					CPL                     ;A = SUBSTRING LENGTH	;A = SUBSTRING LENGTH
668)   2563 C1          					POP     BC	;
669)   2564 EB          					EX      DE,HL	;
670)   2565 5F          		LISTB:			LD      E,A             ;IF-CLAUSE LENGTH	;IF-CLAUSE LENGTH
671)   2566 78          					LD      A,B	;
672)   2567 B1          					OR      C	;
673)   2568 20 01       					JR      NZ,LISTA	;
674)   256A 0B          					DEC     BC	;
675)   256B D9          		LISTA:			EXX	;
676)   256C DD 21 FE 82 					LD      IX,LISTON	;
677)   2570 01 00 00    					LD      BC,0            ;INDENTATION COUNT	;INDENTATION COUNT
678)   2573 D9          					EXX	;
679)   2574 3E 14       					LD      A,20	;
681)   2576 C5          		LISTC:			PUSH    BC              ;SAVE HIGH LINE NUMBER	;SAVE HIGH LINE NUMBER
682)   2577 D5          					PUSH    DE              ;SAVE IF-CLAUSE LENGTH	;SAVE IF-CLAUSE LENGTH
683)   2578 E5          					PUSH    HL              ;SAVE PROGRAM POINTER	;SAVE PROGRAM POINTER
684)   2579 08          					EX      AF,AF'	;
685)   257A 7E          					LD      A,(HL)	;
686)   257B B7          					OR      A	;
687)   257C 28 0E       					JR      Z,WARMNC	;
691)   257E 7B          					LD      A,E             ;A = IF-CLAUSE LENGTH	;A = IF-CLAUSE LENGTH
692)   257F 23          					INC     HL	;
693)   2580 5E          					LD      E,(HL)	;
694)   2581 23          					INC     HL	;
695)   2582 56          					LD      D,(HL)          ;DE = LINE NUMBER	;DE = LINE NUMBER
696)   2583 2B          					DEC     HL	;
697)   2584 2B          					DEC     HL	;
698)   2585 D5          					PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
699)   2586 EB          					EX      DE,HL	;
700)   2587 37          					SCF	;
701)   2588 ED 42       					SBC     HL,BC	;
702)   258A EB          					EX      DE,HL	;
703)   258B D1          					POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
704)   258C D2 6E 20    		WARMNC:			JP      NC,WARM	;
705)   258F 4E          					LD      C,(HL)          ;C = LINE LENGTH + 4	;C = LINE LENGTH + 4
706)   2590 47          					LD      B,A             ;B = IF-CLAUSE LENGTH	;B = IF-CLAUSE LENGTH
710)   2591 7A          					LD      A,D	;
711)   2592 B3          					OR      E	;
712)   2593 CA 6F 20    					JP      Z,CLOOP	;
716)   2596 23          					INC     HL	;
717)   2597 23          					INC     HL	;
718)   2598 23          					INC     HL              ;HL ADDRESSES LINE TEXT	;HL ADDRESSES LINE TEXT
719)   2599 0D          					DEC     C	;
720)   259A 0D          					DEC     C	;
721)   259B 0D          					DEC     C	;
722)   259C 0D          					DEC     C               ;C = LINE LENGTH	;C = LINE LENGTH
723)   259D D5          					PUSH    DE              ;SAVE LINE NUMBER	;SAVE LINE NUMBER
724)   259E E5          					PUSH    HL              ;SAVE LINE ADDRESS	;SAVE LINE ADDRESS
725)   259F AF          					XOR     A               ;A <- 0	;A <- 0
726)   25A0 B8          					CP      B               ;WAS THERE AN IF-CLAUSE	;WAS THERE AN IF-CLAUSE
727)   25A1 FD E5       					PUSH    IY	;
728)   25A3 D1          					POP     DE              ;DE ADDRESSES IF-CLAUSE	;DE ADDRESSES IF-CLAUSE
729)   25A4 C4 33 42    					CALL    NZ,SEARCH       ;SEARCH FOR IF CLAUSE	;SEARCH FOR IF CLAUSE
730)   25A7 E1          					POP     HL              ;RESTORE LINE ADDRESS	;RESTORE LINE ADDRESS
731)   25A8 D1          					POP     DE              ;RESTORE LINE NUMBER	;RESTORE LINE NUMBER
732)   25A9 FD E5       					PUSH    IY	;
733)   25AB CC E4 27    					CALL    Z,LISTIT        ;LIST IF MATCH	;LIST IF MATCH
734)   25AE FD E1       					POP     IY	;
736)   25B0 08          					EX      AF,AF'	;
737)   25B1 3D          					DEC     A	;
738)   25B2 CD 4B 01    					CALL    LTRAP	;
739)   25B5 E1          					POP     HL              ;RESTORE POINTER	;RESTORE POINTER
740)   25B6 5E          					LD      E,(HL)	;
741)   25B7 16 00       					LD      D,0	;
742)   25B9 19          					ADD     HL,DE           ;ADDRESS NEXT LINE	;ADDRESS NEXT LINE
743)   25BA D1          					POP     DE              ;RESTORE IF-CLAUSE LEN	;RESTORE IF-CLAUSE LEN
744)   25BB C1          					POP     BC              ;RESTORE HI LINE NUMBER	;RESTORE HI LINE NUMBER
745)   25BC 18 B8       					JR      LISTC	;
752)   25BE CD CC 27    		@RENUM:			CALL    CLEAR           ;USES DYNAMIC AREA	;USES DYNAMIC AREA
753)   25C1 CD EB 2A    					CALL    PAIR            ;LOAD HL,BC	;LOAD HL,BC
754)   25C4 D9          					EXX	;
755)   25C5 2A DC 82    					LD      HL,(PAGE)	;
756)   25C8 ED 5B E0 82 					LD      DE,(LOMEM)	;
757)   25CC 7E          		RENUM1:			LD      A,(HL)          ;BUILD TABLE	;BUILD TABLE
758)   25CD B7          					OR      A	;
759)   25CE 28 30       					JR      Z,RENUM2	;
760)   25D0 23          					INC     HL	;
761)   25D1 4E          					LD      C,(HL)          ;OLD LINE NUMBER	;OLD LINE NUMBER
762)   25D2 23          					INC     HL	;
763)   25D3 46          					LD      B,(HL)	;
764)   25D4 78          					LD      A,B	;
765)   25D5 B1          					OR      C	;
766)   25D6 CA 6F 20    					JP      Z,CLOOP         ;LINE NUMBER ZERO	;LINE NUMBER ZERO
767)   25D9 EB          					EX      DE,HL	;
768)   25DA 71          					LD      (HL),C	;
769)   25DB 23          					INC     HL	;
770)   25DC 70          					LD      (HL),B	;
771)   25DD 23          					INC     HL	;
772)   25DE D9          					EXX	;
773)   25DF E5          					PUSH    HL	;
774)   25E0 09          					ADD     HL,BC           ;ADD INCREMENT	;ADD INCREMENT
775)   25E1 DA E6 2A    					JP      C,TOOBIG        ;"Too big"	;"Too big"
776)   25E4 D9          					EXX	;
777)   25E5 C1          					POP     BC	;
778)   25E6 71          					LD      (HL),C	;
779)   25E7 23          					INC     HL	;
780)   25E8 70          					LD      (HL),B	;
781)   25E9 23          					INC     HL	;
782)   25EA EB          					EX      DE,HL	;
783)   25EB 2B          					DEC     HL	;
784)   25EC 2B          					DEC     HL	;
785)   25ED AF          					XOR     A	;
786)   25EE 47          					LD      B,A	;
787)   25EF 4E          					LD      C,(HL)	;
788)   25F0 09          					ADD     HL,BC           ;NEXT LINE	;NEXT LINE
789)   25F1 EB          					EX      DE,HL	;
790)   25F2 E5          					PUSH    HL	;
791)   25F3 24          					INC     H	;
792)   25F4 ED 72       					SBC     HL,SP	;
793)   25F6 E1          					POP     HL	;
794)   25F7 EB          					EX      DE,HL	;
795)   25F8 38 D2       					JR      C,RENUM1        ;CONTINUE	;CONTINUE
796)   25FA CD F0 26    					CALL    EXTERR          ;"RENUMBER space'	;"RENUMBER space'
797)   25FD CC          					DEFB    REN	;
798)   25FE 08          					DEFB    8	;
799)   25FF 00          					DEFB    0	;
801)   2600 EB          		RENUM2:			EX      DE,HL	;
802)   2601 36 FF       					LD      (HL),-1	;
803)   2603 23          					INC     HL	;
804)   2604 36 FF       					LD      (HL),-1	;
805)   2606 ED 5B E0 82 					LD      DE,(LOMEM)	;
806)   260A D9          					EXX	;
807)   260B 2A DC 82    					LD      HL,(PAGE)	;
808)   260E 4E          		RENUM3:			LD      C,(HL)	;
809)   260F 79          					LD      A,C	;
810)   2610 B7          					OR      A	;
811)   2611 CA 6E 20    					JP      Z,WARM	;
812)   2614 D9          					EXX	;
813)   2615 EB          					EX      DE,HL	;
814)   2616 23          					INC     HL	;
815)   2617 23          					INC     HL	;
816)   2618 5E          					LD      E,(HL)	;
817)   2619 23          					INC     HL	;
818)   261A 56          					LD      D,(HL)	;
819)   261B 23          					INC     HL	;
820)   261C D5          					PUSH    DE	;
821)   261D EB          					EX      DE,HL	;
822)   261E 22 E6 82    					LD      (LINENO),HL	;
823)   2621 D9          					EXX	;
824)   2622 D1          					POP     DE	;
825)   2623 23          					INC     HL	;
826)   2624 73          					LD      (HL),E          ;NEW LINE NUMBER	;NEW LINE NUMBER
827)   2625 23          					INC     HL	;
828)   2626 72          					LD      (HL),D	;
829)   2627 23          					INC     HL	;
830)   2628 0D          					DEC     C	;
831)   2629 0D          					DEC     C	;
832)   262A 0D          					DEC     C	;
833)   262B 06 00       					LD      B,0	;
834)   262D 3E 8D       		RENUM7:			LD      A,LINO	;
835)   262F ED B1       					CPIR                    ;SEARCH FOR LINE NUMBER	;SEARCH FOR LINE NUMBER
836)   2631 20 DB       					JR      NZ,RENUM3	;
837)   2633 C5          					PUSH    BC	;
838)   2634 E5          					PUSH    HL	;
839)   2635 E5          					PUSH    HL	;
840)   2636 FD E1       					POP     IY	;
841)   2638 D9          					EXX	;
842)   2639 CD 26 43    					CALL    DECODE          ;DECODE LINE NUMBER	;DECODE LINE NUMBER
843)   263C D9          					EXX	;
844)   263D 44          					LD      B,H	;
845)   263E 4D          					LD      C,L	;
846)   263F 2A E0 82    					LD      HL,(LOMEM)	;
847)   2642 5E          		RENUM4:			LD      E,(HL)          ;CROSS-REFERENCE TABLE	;CROSS-REFERENCE TABLE
848)   2643 23          					INC     HL	;
849)   2644 56          					LD      D,(HL)	;
850)   2645 23          					INC     HL	;
851)   2646 EB          					EX      DE,HL	;
852)   2647 B7          					OR      A               ;CLEAR CARRY	;CLEAR CARRY
853)   2648 ED 42       					SBC     HL,BC	;
854)   264A EB          					EX      DE,HL	;
855)   264B 5E          					LD      E,(HL)          ;NEW NUMBER	;NEW NUMBER
856)   264C 23          					INC     HL	;
857)   264D 56          					LD      D,(HL)	;
858)   264E 23          					INC     HL	;
859)   264F 38 F1       					JR      C,RENUM4	;
860)   2651 EB          					EX      DE,HL	;
861)   2652 28 19       					JR      Z,RENUM5        ;FOUND	;FOUND
862)   2654 CD 2B 2C    					CALL    TELL	;
863)   2657 46 61 69 6C 					DEFM    'Failed at '	;
863)   265B 65 64 20 61 					DEFM    'Failed at '	;
863)   265F 74 20       					DEFM    'Failed at '	;
864)   2661 00          					DEFB    0	;
865)   2662 2A E6 82    					LD      HL,(LINENO)	;
866)   2665 CD 01 29    					CALL    PBCDL	;
867)   2668 CD 6D 28    					CALL    CRLF	;
868)   266B 18 06       					JR      RENUM6	;
869)   266D D1          		RENUM5:			POP     DE	;
870)   266E D5          					PUSH    DE	;
871)   266F 1B          					DEC     DE	;
872)   2670 CD F9 2B    					CALL    ENCODE          ;RE-WRITE NUMBER	;RE-WRITE NUMBER
873)   2673 E1          		RENUM6:			POP     HL	;
874)   2674 C1          					POP     BC	;
875)   2675 18 B6       					JR      RENUM7	;
882)   2677 CD EB 2A    		@AUTO:			CALL    PAIR	;
883)   267A 22 EA 82    					LD      (AUTONO),HL	;
884)   267D 79          					LD      A,C	;
885)   267E 32 FF 82    					LD      (INCREM),A	;
886)   2681 18 29       					JR      CLOOP0	;
891)   2683 CD 2B 2C    		BAD:			CALL    TELL            ;"Bad program'	;"Bad program'
892)   2686 03          					DEFB    3	;
893)   2687 70 72 6F 67 					DEFM    'program'	;
893)   268B 72 61 6D    					DEFM    'program'	;
894)   268E 0D          					DEFB    CR	;
895)   268F 0A          					DEFB    LF	;
896)   2690 00          					DEFB    0	;
897)   2691 CD C4 27    		@NEW:			CALL    NEWIT	;
898)   2694 18 16       					JR      CLOOP0	;
902)   2696 2A DC 82    		@OLD:			LD      HL,(PAGE)	;
903)   2699 E5          					PUSH    HL	;
904)   269A 23          					INC     HL	;
905)   269B 23          					INC     HL	;
906)   269C 23          					INC     HL	;
907)   269D 01 FC 00    					LD      BC,252	;
908)   26A0 3E 0D       					LD      A,CR	;
909)   26A2 ED B1       					CPIR	;
910)   26A4 20 DD       					JR      NZ,BAD	;
911)   26A6 7D          					LD      A,L	;
912)   26A7 E1          					POP     HL	;
913)   26A8 77          					LD      (HL),A	;
914)   26A9 CD 9D 27    					CALL    CLEAN	;
915)   26AC C3 6F 20    		CLOOP0:			JP      CLOOP	;
919)   26AF CD 9D 3E    		@LOAD:			CALL    EXPRS           ;GET FILENAME	;GET FILENAME
920)   26B2 3E 0D       					LD      A,CR	;
921)   26B4 12          					LD      (DE),A	;
922)   26B5 CD 83 27    					CALL    LOAD0	;
923)   26B8 CD CC 27    					CALL    CLEAR	;
924)   26BB 18 1B       					JR      WARM0	;
928)   26BD CD A8 27    		@SAVE:			CALL    SETTOP          ;SET TOP	;SET TOP
929)   26C0 CD 9D 3E    					CALL    EXPRS           ;FILENAME	;FILENAME
930)   26C3 3E 0D       					LD      A,CR	;
931)   26C5 12          					LD      (DE),A	;
932)   26C6 ED 5B DC 82 					LD      DE,(PAGE)	;
933)   26CA 2A DE 82    					LD      HL,(TOP)	;
934)   26CD B7          					OR      A	;
935)   26CE ED 52       					SBC     HL,DE	;
936)   26D0 44          					LD      B,H             ;LENGTH OF PROGRAM	;LENGTH OF PROGRAM
937)   26D1 4D          					LD      C,L	;
938)   26D2 21 00 80    					LD      HL,ACCS	;
939)   26D5 CD 36 01    					CALL    OSSAVE	;
940)   26D8 C3 6E 20    		WARM0:			JP      WARM	;
944)   26DB ED 7B E4 82 		@ERROR:			LD      SP,(HIMEM)	;
945)   26DF 21 0E 24    					LD      HL,ERRWDS	;
946)   26E2 B7          					OR      A	;
947)   26E3 28 0A       					JR      Z,ERROR1	;
948)   26E5 47          					LD      B,A             ;ERROR NUMBER	;ERROR NUMBER
949)   26E6 08          					EX      AF,AF'	;
950)   26E7 AF          					XOR     A	;
951)   26E8 BE          		ERROR0:			CP      (HL)	;
952)   26E9 23          					INC     HL	;
953)   26EA 20 FC       					JR      NZ,ERROR0	;
954)   26EC 10 FA       					DJNZ    ERROR0	;
955)   26EE 08          					EX      AF,AF'	;
956)   26EF E5          		ERROR1:			PUSH    HL	;
957)   26F0 E1          		@EXTERR:		POP     HL	;
958)   26F1 22 EE 82    					LD      (ERRTXT),HL	;
959)   26F4 ED 7B E4 82 					LD      SP,(HIMEM)	;
960)   26F8 32 FD 82    					LD      (ERR),A	;
961)   26FB CD C4 28    					CALL    SETLIN	;
962)   26FE 22 F2 82    					LD      (ERL),HL	;
963)   2701 B7          					OR      A	;
964)   2702 28 0B       					JR      Z,ERROR2	;
965)   2704 2A EC 82    					LD      HL,(ERRTRP)	;
966)   2707 7C          					LD      A,H	;
967)   2708 B5          					OR      L	;
968)   2709 E5          					PUSH    HL	;
969)   270A FD E1       					POP     IY	;
970)   270C C2 E8 2C    					JP      NZ,XEQ          ;ERROR TRAPPED	;ERROR TRAPPED
971)   270F 21 00 00    		ERROR2:			LD      HL,0	;
972)   2712 22 EA 82    					LD      (AUTONO),HL	;
973)   2715 22 E8 82    					LD      (TRACEN),HL     ;CANCEL TRACE	;CANCEL TRACE
974)   2718 CD 45 01    					CALL    RESET           ;RESET OPSYS	;RESET OPSYS
975)   271B CD 6D 28    					CALL    CRLF	;
976)   271E CD 1F 2C    					CALL    REPORT          ;MESSAGE	;MESSAGE
977)   2721 CD EE 28    					CALL    SAYLN	;
978)   2724 1E 00       					LD      E,0	;
979)   2726 DC 2D 01    					CALL    C,OSSHUT        ;CLOSE ALL FILES	;CLOSE ALL FILES
980)   2729 CD 6D 28    					CALL    CRLF	;
981)   272C C3 6F 20    					JP      CLOOP	;
994)   272F 21 2D 21    		LEX:			LD      HL,KEYWDS	;
995)   2732 FD 7E 00    		LEX0:			LD      A,(IY)	;
996)   2735 46          					LD      B,(HL)	;
997)   2736 23          					INC     HL	;
998)   2737 BE          					CP      (HL)	;
999)   2738 28 08       					JR      Z,LEX2	;
1000)   273A D8          					RET     C               ;FAIL EXIT	;FAIL EXIT
1001)   273B 23          		LEX1:			INC     HL	;
1002)   273C CB 7E       					BIT     7,(HL)	;
1003)   273E 28 FB       					JR      Z,LEX1	;
1004)   2740 18 F0       					JR      LEX0	;
1005)   2742 FD E5       		LEX2:			PUSH    IY              ;SAVE POINTER	;SAVE POINTER
1006)   2744 23          		LEX3:			INC     HL	;
1007)   2745 CB 7E       					BIT     7,(HL)	;
1008)   2747 20 1B       					JR      NZ,LEX6         ;FOUND	;FOUND
1009)   2749 FD 23       					INC     IY	;
1010)   274B FD 7E 00    					LD      A,(IY)	;
1011)   274E FE 2E       					CP      '.'	;
1012)   2750 28 12       					JR      Z,LEX6          ;FOUND (ABBREV.)	;FOUND (ABBREV.)
1013)   2752 BE          					CP      (HL)	;
1014)   2753 28 EF       					JR      Z,LEX3	;
1015)   2755 CD 32 2B    					CALL    RANGE1	;
1016)   2758 38 04       					JR      C,LEX5	;
1017)   275A FD E1       		LEX4:			POP     IY              ;RESTORE POINTER	;RESTORE POINTER
1018)   275C 18 DD       					JR      LEX1	;
1019)   275E 7E          		LEX5:			LD      A,(HL)	;
1020)   275F B7          					OR      A	;
1021)   2760 20 F8       					JR      NZ,LEX4	;
1022)   2762 FD 2B       					DEC     IY	;
1023)   2764 F1          		LEX6:			POP     AF	;
1024)   2765 AF          					XOR     A	;
1025)   2766 78          					LD      A,B	;
1026)   2767 C9          					RET	;
1032)   2768 D5          		DEL:			PUSH    DE	;
1033)   2769 E5          					PUSH    HL	;
1034)   276A E5          					PUSH    HL	;
1035)   276B 06 00       					LD      B,0	;
1036)   276D 4E          					LD      C,(HL)	;
1037)   276E 09          					ADD     HL,BC	;
1038)   276F E5          					PUSH    HL	;
1039)   2770 EB          					EX      DE,HL	;
1040)   2771 2A DE 82    					LD      HL,(TOP)	;
1041)   2774 ED 52       					SBC     HL,DE	;
1042)   2776 44          					LD      B,H	;
1043)   2777 4D          					LD      C,L	;
1044)   2778 E1          					POP     HL	;
1045)   2779 D1          					POP     DE	;
1046)   277A ED B0       					LDIR                    ;DELETE LINE	;DELETE LINE
1047)   277C ED 53 DE 82 					LD      (TOP),DE	;
1048)   2780 E1          					POP     HL	;
1049)   2781 D1          					POP     DE	;
1050)   2782 C9          					RET	;
1060)   2783 ED 5B DC 82 		@LOAD0: 		LD      DE,(PAGE)	;
1061)   2787 21 00 FF    					LD      HL,-256	;
1062)   278A 39          					ADD     HL,SP	;
1063)   278B ED 52       					SBC     HL,DE           ;FIND AVAILABLE SPACE	;FIND AVAILABLE SPACE
1064)   278D 44          					LD      B,H	;
1065)   278E 4D          					LD      C,L	;
1066)   278F 21 00 80    					LD      HL,ACCS	;
1067)   2792 CD 39 01    					CALL    OSLOAD          ;LOAD	;LOAD
1068)   2795 D4 C4 27    					CALL    NC,NEWIT	;
1069)   2798 3E 00       					LD      A,0	;
1070)   279A D2 DB 26    					JP      NC,ERROR        ;"No room"	;"No room"
1071)   279D CD A8 27    		CLEAN:			CALL    SETTOP	;
1072)   27A0 2B          					DEC     HL	;
1073)   27A1 36 FF       					LD      (HL),-1         ;WRITE &FFFF	;WRITE &FFFF
1074)   27A3 2B          					DEC     HL	;
1075)   27A4 36 FF       					LD      (HL),-1	;
1076)   27A6 18 24       					JR      CLEAR	;
1078)   27A8 2A DC 82    		SETTOP:			LD      HL,(PAGE)	;
1079)   27AB 06 00       					LD      B,0	;
1080)   27AD 3E 0D       					LD      A,CR	;
1081)   27AF 4E          		SETOP1:			LD      C,(HL)	;
1082)   27B0 0C          					INC     C	;
1083)   27B1 0D          					DEC     C	;
1084)   27B2 28 09       					JR      Z,SETOP2	;
1085)   27B4 09          					ADD     HL,BC	;
1086)   27B5 2B          					DEC     HL	;
1087)   27B6 BE          					CP      (HL)	;
1088)   27B7 23          					INC     HL	;
1089)   27B8 28 F5       					JR      Z,SETOP1	;
1090)   27BA C3 83 26    					JP      BAD	;
1091)   27BD 23          		SETOP2:			INC     HL              ;N.B. CALLED FROM NEWIT	;N.B. CALLED FROM NEWIT
1092)   27BE 23          					INC     HL	;
1093)   27BF 23          					INC     HL	;
1094)   27C0 22 DE 82    					LD      (TOP),HL	;
1095)   27C3 C9          					RET	;
1104)   27C4 2A DC 82    		NEWIT:			LD      HL,(PAGE)	;
1105)   27C7 36 00       					LD      (HL),0	;
1106)   27C9 CD BD 27    					CALL    SETOP2	;
1107)   27CC E5          		@CLEAR:			PUSH    HL	;
1108)   27CD 2A DE 82    					LD      HL,(TOP)	;
1109)   27D0 22 E0 82    					LD      (LOMEM),HL	;
1110)   27D3 22 E2 82    					LD      (FREE),HL	;
1111)   27D6 21 6C 82    					LD      HL,DYNVAR	;
1112)   27D9 C5          					PUSH    BC	;
1113)   27DA 06 70       					LD      B,2*(54+2)	;
1114)   27DC 36 00       		CLEAR1:			LD      (HL),0	;
1115)   27DE 23          					INC     HL	;
1116)   27DF 10 FB       					DJNZ    CLEAR1	;
1117)   27E1 C1          					POP     BC	;
1118)   27E2 E1          					POP     HL	;
1119)   27E3 C9          					RET	;
1127)   27E4 E5          		LISTIT:			PUSH    HL	;
1128)   27E5 EB          					EX      DE,HL	;
1129)   27E6 C5          					PUSH    BC	;
1130)   27E7 CD 05 29    					CALL    PBCD	;
1131)   27EA C1          					POP     BC	;
1132)   27EB E1          					POP     HL	;
1133)   27EC 7E          					LD      A,(HL)	;
1134)   27ED FE ED       					CP      NEXT	;
1135)   27EF CC 50 28    					CALL    Z,INDENT	;
1136)   27F2 FE FD       					CP      UNTIL	;
1137)   27F4 CC 50 28    					CALL    Z,INDENT	;
1138)   27F7 D9          					EXX	;
1139)   27F8 3E 20       					LD      A,' '	;
1140)   27FA DD CB 00 46 					BIT     0,(IX)	;
1141)   27FE C4 74 28    					CALL    NZ,OUTCHR	;
1142)   2801 78          					LD      A,B	;
1143)   2802 87          					ADD     A,A	;
1144)   2803 DD CB 00 4E 					BIT     1,(IX)	;
1145)   2807 C4 2A 37    					CALL    NZ,FILL	;
1146)   280A 79          					LD      A,C	;
1147)   280B 87          					ADD     A,A	;
1148)   280C DD CB 00 56 					BIT     2,(IX)	;
1149)   2810 C4 2A 37    					CALL    NZ,FILL	;
1150)   2813 D9          					EXX	;
1151)   2814 7E          					LD      A,(HL)	;
1152)   2815 FE E3       					CP      FOR	;
1153)   2817 CC 50 28    					CALL    Z,INDENT	;
1154)   281A FE F5       					CP      REPEAT	;
1155)   281C CC 50 28    					CALL    Z,INDENT	;
1156)   281F 1E 00       					LD      E,0	;
1157)   2821 7E          		LIST8:			LD      A,(HL)	;
1158)   2822 23          					INC     HL	;
1159)   2823 FE 0D       					CP      CR	;
1160)   2825 28 46       					JR      Z,CRLF	;
1161)   2827 FE 22       					CP      34		;ASCII ""	;ASCII ""
1162)   2829 20 01       					JR      NZ,LIST7	;
1163)   282B 1C          					INC     E	;
1164)   282C CD 44 28    		LIST7:			CALL    LOUT	;
1165)   282F 18 F0       					JR      LIST8	;
1167)   2831 E5          		PRLINO:			PUSH    HL	;
1168)   2832 FD E1       					POP     IY	;
1169)   2834 C5          					PUSH    BC	;
1170)   2835 CD 26 43    					CALL    DECODE	;
1171)   2838 C1          					POP     BC	;
1172)   2839 D9          					EXX	;
1173)   283A C5          					PUSH    BC	;
1174)   283B CD 01 29    					CALL    PBCDL	;
1175)   283E C1          					POP     BC	;
1176)   283F D9          					EXX	;
1177)   2840 FD E5       					PUSH    IY	;
1178)   2842 E1          					POP     HL	;
1179)   2843 C9          					RET	;
1181)   2844 CB 43       		LOUT:			BIT     0,E	;
1182)   2846 20 2C       					JR      NZ,OUTCHR	;
1183)   2848 FE 8D       					CP      LINO	;
1184)   284A 28 E5       					JR      Z,PRLINO	;
1185)   284C CD 8D 28    					CALL    OUT	;
1186)   284F 7E          					LD      A,(HL)	;
1187)   2850 D9          		INDENT:			EXX	;
1188)   2851 FE E3       					CP      FOR	;
1189)   2853 28 08       					JR      Z,IND1	;
1190)   2855 FE ED       					CP      NEXT	;
1191)   2857 20 05       					JR      NZ,IND2	;
1192)   2859 05          					DEC     B	;
1193)   285A F2 5E 28    					JP      P,IND2	;
1194)   285D 04          		IND1:			INC     B	;
1195)   285E FE F5       		IND2:			CP      REPEAT	;
1196)   2860 28 08       					JR      Z,IND3	;
1197)   2862 FE FD       					CP      UNTIL	;
1198)   2864 20 05       					JR      NZ,IND4	;
1199)   2866 0D          					DEC     C	;
1200)   2867 F2 6B 28    					JP      P,IND4	;
1201)   286A 0C          		IND3:			INC     C	;
1202)   286B D9          		IND4:			EXX	;
1203)   286C C9          					RET	;
1211)   286D 3E 0D       		@CRLF:			LD      A,CR	;
1212)   286F CD 74 28    					CALL    OUTCHR	;
1213)   2872 3E 0A       					LD      A,LF	;
1214)   2874 CD 15 01    		@OUTCHR:		CALL    OSWRCH	;
1215)   2877 D6 0D       					SUB     CR	;
1216)   2879 28 05       					JR      Z,CARRET	;
1217)   287B D8          					RET     C               ;NON-PRINTING	;NON-PRINTING
1218)   287C 3A FB 82    					LD      A,(COUNT)	;
1219)   287F 3C          					INC     A	;
1220)   2880 32 FB 82    		CARRET:			LD      (COUNT),A	;
1221)   2883 C8          					RET     Z	;
1222)   2884 E5          					PUSH    HL	;
1223)   2885 2A FC 82    					LD      HL,(WIDTH)	;
1224)   2888 BD          					CP      L	;
1225)   2889 E1          					POP     HL	;
1226)   288A C0          					RET     NZ	;
1227)   288B 18 E0       					JR      CRLF	;
1234)   288D FE 8A       		@OUT:			CP      138	;
1235)   288F EA 74 28    					JP      PE,OUTCHR	;
1236)   2892 C5          					PUSH    BC	;
1237)   2893 E5          					PUSH    HL	;
1238)   2894 21 2D 21    					LD      HL,KEYWDS	;
1239)   2897 01 DF 02    					LD      BC,KEYWDL	;
1240)   289A ED B1       					CPIR	;
1241)   289C 7E          		TOKEN1:			LD      A,(HL)	;
1242)   289D 23          					INC     HL	;
1243)   289E FE 8A       					CP      138	;
1244)   28A0 F5          					PUSH    AF	;
1245)   28A1 EC 74 28    					CALL    PE,OUTCHR	;
1246)   28A4 F1          					POP     AF	;
1247)   28A5 EA 9C 28    					JP      PE,TOKEN1	;
1248)   28A8 E1          					POP     HL	;
1249)   28A9 C1          					POP     BC	;
1250)   28AA C9          					RET	;
1259)   28AB EB          		@FINDL:			EX      DE,HL	;
1260)   28AC 2A DC 82    					LD      HL,(PAGE)	;
1261)   28AF AF          					XOR     A               ;A=0	;A=0
1262)   28B0 BE          					CP      (HL)	;
1263)   28B1 3C          					INC     A	;
1264)   28B2 D0          					RET     NC	;
1265)   28B3 AF          					XOR     A               ;CLEAR CARRY	;CLEAR CARRY
1266)   28B4 47          					LD      B,A	;
1267)   28B5 4E          		FINDL1:			LD      C,(HL)	;
1268)   28B6 E5          					PUSH    HL	;
1269)   28B7 23          					INC     HL	;
1270)   28B8 7E          					LD      A,(HL)	;
1271)   28B9 23          					INC     HL	;
1272)   28BA 66          					LD      H,(HL)	;
1273)   28BB 6F          					LD      L,A	;
1274)   28BC ED 52       					SBC     HL,DE	;
1275)   28BE E1          					POP     HL	;
1276)   28BF D0          					RET     NC              ;FOUND OR PAST	;FOUND OR PAST
1277)   28C0 09          					ADD     HL,BC	;
1278)   28C1 C3 B5 28    					JP      FINDL1	;
1286)   28C4 06 00       		@SETLIN:		LD      B,0	;
1287)   28C6 ED 5B F4 82 					LD      DE,(ERRLIN)	;
1288)   28CA 2A DC 82    					LD      HL,(PAGE)	;
1289)   28CD B7          					OR      A	;
1290)   28CE ED 52       					SBC     HL,DE	;
1291)   28D0 19          					ADD     HL,DE	;
1292)   28D1 30 16       					JR      NC,SET3	;
1293)   28D3 4E          		SET1:			LD      C,(HL)	;
1294)   28D4 0C          					INC     C	;
1295)   28D5 0D          					DEC     C	;
1296)   28D6 28 11       					JR      Z,SET3	;
1297)   28D8 09          					ADD     HL,BC	;
1298)   28D9 ED 52       					SBC     HL,DE	;
1299)   28DB 19          					ADD     HL,DE	;
1300)   28DC 38 F5       					JR      C,SET1	;
1301)   28DE ED 42       					SBC     HL,BC	;
1302)   28E0 23          					INC     HL	;
1303)   28E1 5E          					LD      E,(HL)          ;LINE NUMBER	;LINE NUMBER
1304)   28E2 23          					INC     HL	;
1305)   28E3 56          					LD      D,(HL)	;
1306)   28E4 EB          					EX      DE,HL	;
1307)   28E5 22 E6 82    		SET2:			LD      (LINENO),HL	;
1308)   28E8 C9          					RET	;
1309)   28E9 21 00 00    		SET3:			LD      HL,0	;
1310)   28EC 18 F7       					JR      SET2	;
1317)   28EE 2A E6 82    		@SAYLN:			LD      HL,(LINENO)	;
1318)   28F1 7C          					LD      A,H	;
1319)   28F2 B5          					OR      L	;
1320)   28F3 C8          					RET     Z	;
1321)   28F4 CD 2B 2C    					CALL    TELL	;
1322)   28F7 20 61 74 20 					DEFM    ' at line '	;
1322)   28FB 6C 69 6E 65 					DEFM    ' at line '	;
1322)   28FF 20          					DEFM    ' at line '	;
1323)   2900 00          					DEFB    0	;
1324)   2901 0E 00       		@PBCDL:			LD      C,0	;
1325)   2903 18 02       					JR      PBCD0	;
1332)   2905 0E 20       		PBCD:			LD      C,' '	;
1333)   2907 06 05       		PBCD0:			LD      B,5	;
1334)   2909 11 10 27    					LD      DE,10000	;
1335)   290C AF          		PBCD1:			XOR     A	;
1336)   290D ED 52       		PBCD2:			SBC     HL,DE	;
1337)   290F 3C          					INC     A	;
1338)   2910 30 FB       					JR      NC,PBCD2	;
1339)   2912 19          					ADD     HL,DE	;
1340)   2913 3D          					DEC     A	;
1341)   2914 28 04       					JR      Z,PBCD3	;
1342)   2916 CB E1       					SET     4,C	;
1343)   2918 CB E9       					SET     5,C	;
1344)   291A B1          		PBCD3:			OR      C	;
1345)   291B C4 74 28    					CALL    NZ,OUTCHR	;
1346)   291E 78          					LD      A,B	;
1347)   291F FE 05       					CP      5	;
1348)   2921 28 06       					JR      Z,PBCD4	;
1349)   2923 29          					ADD     HL,HL	;
1350)   2924 54          					LD      D,H	;
1351)   2925 5D          					LD      E,L	;
1352)   2926 29          					ADD     HL,HL	;
1353)   2927 29          					ADD     HL,HL	;
1354)   2928 19          					ADD     HL,DE	;
1355)   2929 11 E8 03    		PBCD4:			LD      DE,1000	;
1356)   292C 10 DE       					DJNZ    PBCD1	;
1357)   292E 37          					SCF	;
1358)   292F C9          					RET	;
1365)   2930 CD 7D 2A    		@PUTVAR:		CALL    CREATE	;
1366)   2933 FD 7E 00    					LD      A,(IY)	;
1367)   2936 FE 28       					CP      '('	;
1368)   2938 20 68       					JR      NZ,GETVZ        ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1369)   293A 3E 0E       		ARRAY:			LD      A,14            ;'Array'	;'Array'
1370)   293C C3 DB 26    		ERROR3:			JP      ERROR	;
1383)   293F FD 7E 00    		@GETVAR:		LD      A,(IY)	;
1384)   2942 FE 24       					CP      '$'	;
1385)   2944 28 62       					JR      Z,GETV4	;
1386)   2946 FE 21       					CP      '!'	;
1387)   2948 28 62       					JR      Z,GETV5	;
1388)   294A FE 3F       					CP      '?'	;
1389)   294C 28 62       					JR      Z,GETV6	;
1390)   294E CD F5 29    					CALL    LOCATE	;
1391)   2951 C0          					RET     NZ	;
1392)   2952 FD 7E 00    					LD      A,(IY)	;
1393)   2955 FE 28       					CP      '('             ;ARRAY?	;ARRAY?
1394)   2957 20 41       					JR      NZ,GETVX        ;EXIT	;EXIT
1395)   2959 D5          					PUSH    DE              ;SAVE TYPE	;SAVE TYPE
1396)   295A 7E          					LD      A,(HL)          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
1397)   295B B7          					OR      A	;
1398)   295C 28 DC       					JR      Z,ARRAY	;
1399)   295E 23          					INC     HL	;
1400)   295F 11 00 00    					LD      DE,0            ;ACCUMULATOR	;ACCUMULATOR
1401)   2962 F5          					PUSH    AF	;
1402)   2963 FD 23       					INC     IY              ;SKIP (	;SKIP (
1403)   2965 18 04       					JR      GETV3	;
1404)   2967 F5          		GETV2:			PUSH    AF	;
1405)   2968 CD 30 44    					CALL    COMMA	;
1406)   296B E5          		GETV3:			PUSH    HL	;
1407)   296C D5          					PUSH    DE	;
1408)   296D CD 94 3E    					CALL    EXPRI           ;SUBSCRIPT	;SUBSCRIPT
1409)   2970 D9          					EXX	;
1410)   2971 D1          					POP     DE	;
1411)   2972 E3          					EX      (SP),HL	;
1412)   2973 4E          					LD      C,(HL)	;
1413)   2974 23          					INC     HL	;
1414)   2975 46          					LD      B,(HL)	;
1415)   2976 23          					INC     HL	;
1416)   2977 E3          					EX      (SP),HL	;
1417)   2978 EB          					EX      DE,HL	;
1418)   2979 D5          					PUSH    DE	;
1419)   297A CD A3 37    					CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
1420)   297D D1          					POP     DE	;
1421)   297E 19          					ADD     HL,DE	;
1422)   297F EB          					EX      DE,HL	;
1423)   2980 B7          					OR      A	;
1424)   2981 ED 42       					SBC     HL,BC	;
1425)   2983 3E 0F       					LD      A,15	;
1426)   2985 30 B5       					JR      NC,ERROR3       ;"Subscript"	;"Subscript"
1427)   2987 E1          					POP     HL	;
1428)   2988 F1          					POP     AF	;
1429)   2989 3D          					DEC     A               ;DIMENSION COUNTER	;DIMENSION COUNTER
1430)   298A 20 DB       					JR      NZ,GETV2	;
1431)   298C CD 3C 44    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
1432)   298F F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1433)   2990 E5          					PUSH    HL	;
1434)   2991 CD 96 37    					CALL    X4OR5           ;DE=DE*n	;DE=DE*n
1435)   2994 E1          					POP     HL	;
1436)   2995 19          					ADD     HL,DE	;
1437)   2996 57          					LD      D,A             ;TYPE	;TYPE
1438)   2997 FD 7E 00    					LD      A,(IY)	;
1439)   299A FE 3F       		GETVX:			CP      '?'	;
1440)   299C 28 1D       					JR      Z,GETV9	;
1441)   299E FE 21       					CP      '!'	;
1442)   29A0 28 15       					JR      Z,GETV8	;
1443)   29A2 E5          		GETVZ:			PUSH    HL              ;SET EXIT CONDITIONS	;SET EXIT CONDITIONS
1444)   29A3 DD E1       					POP     IX	;
1445)   29A5 7A          					LD      A,D	;
1446)   29A6 BF          					CP      A	;
1447)   29A7 C9          					RET	;
1451)   29A8 3E 80       		GETV4:			LD      A,128           ;STATIC STRING	;STATIC STRING
1452)   29AA 18 05       					JR      GETV7	;
1453)   29AC 3E 04       		GETV5:			LD      A,4             ;UNARY 32-BIT INDIRN.	;UNARY 32-BIT INDIRN.
1454)   29AE 18 01       					JR      GETV7	;
1455)   29B0 AF          		GETV6:			XOR     A               ;UNARY 8-BIT INDIRECTION	;UNARY 8-BIT INDIRECTION
1456)   29B1 21 00 00    		GETV7:			LD      HL,0	;
1457)   29B4 F5          					PUSH    AF	;
1458)   29B5 18 15       					JR      GETV0	;
1460)   29B7 06 04       		GETV8:			LD      B,4             ;32-BIT BINARY INDIRN.	;32-BIT BINARY INDIRN.
1461)   29B9 18 02       					JR      GETVA	;
1462)   29BB 06 00       		GETV9:			LD      B,0             ;8-BIT BINARY INDIRN.	;8-BIT BINARY INDIRN.
1463)   29BD E5          		GETVA:			PUSH    HL	;
1464)   29BE DD E1       					POP     IX	;
1465)   29C0 7A          					LD      A,D             ;TYPE	;TYPE
1466)   29C1 FE 81       					CP      129	;
1467)   29C3 C8          					RET     Z               ;STRING!	;STRING!
1468)   29C4 C5          					PUSH    BC	;
1469)   29C5 CD 4D 3F    					CALL    LOADN           ;LEFT OPERAND	;LEFT OPERAND
1470)   29C8 CD 3B 41    					CALL    SFIX	;
1471)   29CB D9          					EXX	;
1472)   29CC E5          		GETV0:			PUSH    HL	;
1473)   29CD FD 23       					INC     IY	;
1474)   29CF CD AB 3E    					CALL    ITEMI	;
1475)   29D2 D9          					EXX	;
1476)   29D3 D1          					POP     DE	;
1477)   29D4 F1          					POP     AF	;
1478)   29D5 19          					ADD     HL,DE	;
1479)   29D6 E5          					PUSH    HL	;
1480)   29D7 DD E1       					POP     IX	;
1481)   29D9 BF          					CP      A	;
1482)   29DA C9          					RET	;
1492)   29DB FD 7E 01    		@GETDEF:		LD      A,(IY+1)	;
1493)   29DE CD 32 2B    					CALL    RANGE1	;
1494)   29E1 D8          					RET     C	;
1495)   29E2 FD 7E 00    					LD      A,(IY)	;
1496)   29E5 21 D8 82    					LD      HL,FNPTR	;
1497)   29E8 FE A4       					CP      FN	;
1498)   29EA 28 43       					JR      Z,LOC2	;
1499)   29EC 21 DA 82    					LD      HL,PROPTR	;
1500)   29EF FE F2       					CP      PROC	;
1501)   29F1 28 3C       					JR      Z,LOC2	;
1502)   29F3 37          					SCF	;
1503)   29F4 C9          					RET	;
1519)   29F5 D6 40       		LOCATE:			SUB     '@'	;
1520)   29F7 D8          					RET     C	;
1521)   29F8 26 00       					LD      H,0	;
1522)   29FA FE 1B       					CP      'Z'-'@'+1	;
1523)   29FC 30 1D       					JR      NC,LOC0         ;NOT STATIC	;NOT STATIC
1524)   29FE 87          					ADD     A,A	;
1525)   29FF 6F          					LD      L,A	;
1526)   2A00 FD 7E 01    					LD      A,(IY+1)        ;2nd CHARACTER	;2nd CHARACTER
1527)   2A03 FE 25       					CP      '%'	;
1528)   2A05 20 20       					JR      NZ,LOC1         ;NOT STATIC	;NOT STATIC
1529)   2A07 FD 7E 02    					LD      A,(IY+2)	;
1530)   2A0A FE 28       					CP      '('	;
1531)   2A0C 28 19       					JR      Z,LOC1          ;NOT STATIC	;NOT STATIC
1532)   2A0E 29          					ADD     HL,HL	;
1533)   2A0F 11 00 82    					LD      DE,STAVAR       ;STATIC VARIABLES	;STATIC VARIABLES
1534)   2A12 19          					ADD     HL,DE	;
1535)   2A13 FD 23       					INC     IY	;
1536)   2A15 FD 23       					INC     IY	;
1537)   2A17 16 04       					LD      D,4             ;INTEGER TYPE	;INTEGER TYPE
1538)   2A19 AF          					XOR     A	;
1539)   2A1A C9          					RET	;
1541)   2A1B FE 1F       		LOC0:			CP      '_'-'@'	;
1542)   2A1D D8          					RET     C	;
1543)   2A1E FE 3B       					CP      'z'-'@'+1	;
1544)   2A20 3F          					CCF	;
1545)   2A21 3D          					DEC     A               ;SET NZ	;SET NZ
1546)   2A22 D8          					RET     C	;
1547)   2A23 D6 03       					SUB     3	;
1548)   2A25 87          					ADD     A,A	;
1549)   2A26 6F          					LD      L,A	;
1550)   2A27 11 6C 82    		LOC1:			LD      DE,DYNVAR       ;DYNAMIC VARIABLES	;DYNAMIC VARIABLES
1551)   2A2A 2D          					DEC     L	;
1552)   2A2B 2D          					DEC     L	;
1553)   2A2C 37          					SCF	;
1554)   2A2D F8          					RET     M	;
1555)   2A2E 19          					ADD     HL,DE	;
1556)   2A2F 5E          		LOC2:			LD      E,(HL)	;
1557)   2A30 23          					INC     HL	;
1558)   2A31 56          					LD      D,(HL)	;
1559)   2A32 7A          					LD      A,D	;
1560)   2A33 B3          					OR      E	;
1561)   2A34 28 45       					JR      Z,LOC6          ;UNDEFINED VARIABLE	;UNDEFINED VARIABLE
1562)   2A36 62          					LD      H,D	;
1563)   2A37 6B          					LD      L,E	;
1564)   2A38 23          					INC     HL              ;SKIP LINK	;SKIP LINK
1565)   2A39 23          					INC     HL	;
1566)   2A3A FD E5       					PUSH    IY	;
1567)   2A3C 7E          		LOC3:			LD      A,(HL)          ;COMPARE	;COMPARE
1568)   2A3D 23          					INC     HL	;
1569)   2A3E FD 23       					INC     IY	;
1570)   2A40 FD BE 00    					CP      (IY)	;
1571)   2A43 28 F7       					JR      Z,LOC3	;
1572)   2A45 B7          					OR      A               ;0=TERMINATOR	;0=TERMINATOR
1573)   2A46 28 06       					JR      Z,LOC5          ;FOUND (MAYBE)	;FOUND (MAYBE)
1574)   2A48 FD E1       		LOC4:			POP     IY	;
1575)   2A4A EB          					EX      DE,HL	;
1576)   2A4B C3 2F 2A    					JP      LOC2            ;TRY NEXT ENTRY	;TRY NEXT ENTRY
1578)   2A4E FD 2B       		LOC5:			DEC     IY	;
1579)   2A50 FD 7E 00    					LD      A,(IY)	;
1580)   2A53 FE 28       					CP      '('	;
1581)   2A55 28 13       					JR      Z,LOC5A         ;FOUND	;FOUND
1582)   2A57 FD 23       					INC     IY	;
1583)   2A59 CD 26 2B    					CALL    RANGE	;
1584)   2A5C 38 0C       					JR      C,LOC5A         ;FOUND	;FOUND
1585)   2A5E FE 28       					CP      '('	;
1586)   2A60 28 E6       					JR      Z,LOC4          ;KEEP LOOKING	;KEEP LOOKING
1587)   2A62 FD 7E FF    					LD      A,(IY-1)	;
1588)   2A65 CD 32 2B    					CALL    RANGE1	;
1589)   2A68 30 DE       					JR      NC,LOC4         ;KEEP LOOKING	;KEEP LOOKING
1590)   2A6A D1          		LOC5A:			POP     DE	;
1591)   2A6B FD 7E FF    		TYPE:			LD      A,(IY-1)	;
1592)   2A6E FE 24       					CP      '$'	;
1593)   2A70 16 81       					LD      D,129	;
1594)   2A72 C8          					RET     Z               ;STRING	;STRING
1595)   2A73 FE 25       					CP      '%'	;
1596)   2A75 16 04       					LD      D,4	;
1597)   2A77 C8          					RET     Z               ;INTEGER	;INTEGER
1598)   2A78 14          					INC     D	;
1599)   2A79 BF          					CP      A	;
1600)   2A7A C9          					RET	;
1602)   2A7B 3C          		LOC6:			INC     A               ;SET NZ	;SET NZ
1603)   2A7C C9          					RET	;
1610)   2A7D AF          		@CREATE:		XOR     A	;
1611)   2A7E ED 5B E2 82 					LD      DE,(FREE)	;
1612)   2A82 72          					LD      (HL),D	;
1613)   2A83 2B          					DEC     HL	;
1614)   2A84 73          					LD      (HL),E	;
1615)   2A85 EB          					EX      DE,HL	;
1616)   2A86 77          					LD      (HL),A	;
1617)   2A87 23          					INC     HL	;
1618)   2A88 77          					LD      (HL),A	;
1619)   2A89 23          					INC     HL	;
1620)   2A8A FD 23       		LOC7:			INC     IY	;
1621)   2A8C CD 26 2B    					CALL    RANGE           ;END OF VARIABLE?	;END OF VARIABLE?
1622)   2A8F 38 14       					JR      C,LOC8	;
1623)   2A91 77          					LD      (HL),A	;
1624)   2A92 23          					INC     HL	;
1625)   2A93 CD 32 2B    					CALL    RANGE1	;
1626)   2A96 30 F2       					JR      NC,LOC7	;
1627)   2A98 FE 28       					CP      '('	;
1628)   2A9A 28 09       					JR      Z,LOC8	;
1629)   2A9C FD 7E 01    					LD      A,(IY+1)	;
1630)   2A9F FE 28       					CP      '('	;
1631)   2AA1 28 E7       					JR      Z,LOC7	;
1632)   2AA3 FD 23       					INC     IY	;
1633)   2AA5 36 00       		LOC8:			LD      (HL),0          ;TERMINATOR	;TERMINATOR
1634)   2AA7 23          					INC     HL	;
1635)   2AA8 E5          					PUSH    HL	;
1636)   2AA9 CD 6B 2A    					CALL    TYPE	;
1637)   2AAC 3E 05       					LD      A,5	;
1638)   2AAE BA          					CP      D	;
1639)   2AAF 28 01       					JR      Z,LOC9	;
1640)   2AB1 3D          					DEC     A	;
1641)   2AB2 36 00       		LOC9:			LD      (HL),0          ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1642)   2AB4 23          					INC     HL	;
1643)   2AB5 3D          					DEC     A	;
1644)   2AB6 20 FA       					JR      NZ,LOC9	;
1645)   2AB8 22 E2 82    					LD      (FREE),HL	;
1646)   2ABB CD BF 35    					CALL    CHECK	;
1647)   2ABE E1          					POP     HL	;
1648)   2ABF AF          					XOR     A	;
1649)   2AC0 C9          					RET	;
1657)   2AC1 CD 78 44    		LINNUM:			CALL    NXT	;
1658)   2AC4 21 00 00    					LD      HL,0	;
1659)   2AC7 FD 7E 00    		LINNM1:			LD      A,(IY)	;
1660)   2ACA D6 30       					SUB     '0'	;
1661)   2ACC D8          					RET     C	;
1662)   2ACD FE 0A       					CP      10	;
1663)   2ACF D0          					RET     NC	;
1664)   2AD0 FD 23       					INC     IY	;
1665)   2AD2 54          					LD      D,H	;
1666)   2AD3 5D          					LD      E,L	;
1667)   2AD4 29          					ADD     HL,HL           ;*2	;*2
1668)   2AD5 38 0F       					JR      C,TOOBIG	;
1669)   2AD7 29          					ADD     HL,HL           ;*4	;*4
1670)   2AD8 38 0C       					JR      C,TOOBIG	;
1671)   2ADA 19          					ADD     HL,DE           ;*5	;*5
1672)   2ADB 38 09       					JR      C,TOOBIG	;
1673)   2ADD 29          					ADD     HL,HL           ;*10	;*10
1674)   2ADE 38 06       					JR      C,TOOBIG	;
1675)   2AE0 5F          					LD      E,A	;
1676)   2AE1 16 00       					LD      D,0	;
1677)   2AE3 19          					ADD     HL,DE           ;ADD IN DIGIT	;ADD IN DIGIT
1678)   2AE4 30 E1       					JR      NC,LINNM1       	;
1679)   2AE6 3E 14       		TOOBIG:			LD      A,20	;
1680)   2AE8 C3 DB 26    					JP      ERROR           ;"Too big"	;"Too big"
1688)   2AEB CD C1 2A    		PAIR:			CALL    LINNUM          ;FIRST	;FIRST
1689)   2AEE 7C          					LD      A,H	;
1690)   2AEF B5          					OR      L	;
1691)   2AF0 20 02       					JR      NZ,PAIR1	;
1692)   2AF2 2E 0A       					LD      L,10	;
1693)   2AF4 CD C2 36    		PAIR1:			CALL    TERM?	;
1694)   2AF7 FD 23       					INC     IY	;
1695)   2AF9 E5          					PUSH    HL	;
1696)   2AFA 21 0A 00    					LD      HL,10	;
1697)   2AFD C4 C1 2A    					CALL    NZ,LINNUM       ;SECOND	;SECOND
1698)   2B00 E3          					EX      (SP),HL	;
1699)   2B01 C1          					POP     BC	;
1700)   2B02 78          					LD      A,B	;
1701)   2B03 B1          					OR      C	;
1702)   2B04 C0          					RET     NZ	;
1703)   2B05 CD F0 26    					CALL    EXTERR	;
1704)   2B08 53 69 6C 6C 					DEFM    'Silly'	;
1704)   2B0C 79          					DEFM    'Silly'	;
1705)   2B0D 00          					DEFB    0	;
1713)   2B0E CD C1 2A    		DLPAIR:			CALL    LINNUM	;
1714)   2B11 E5          					PUSH    HL	;
1715)   2B12 CD C2 36    					CALL    TERM?	;
1716)   2B15 28 09       					JR      Z,DLP1	;
1717)   2B17 FE E7       					CP      TIF	;
1718)   2B19 28 05       					JR      Z,DLP1	;
1719)   2B1B FD 23       					INC     IY	;
1720)   2B1D CD C1 2A    					CALL    LINNUM	;
1721)   2B20 E3          		DLP1:			EX      (SP),HL	;
1722)   2B21 CD AB 28    					CALL    FINDL	;
1723)   2B24 C1          					POP     BC	;
1724)   2B25 C9          					RET	;
1731)   2B26 FD 7E 00    		@RANGE:			LD      A,(IY)	;
1732)   2B29 FE 24       					CP      '$'	;
1733)   2B2B C8          					RET     Z	;
1734)   2B2C FE 25       					CP      '%'	;
1735)   2B2E C8          					RET     Z	;
1736)   2B2F FE 28       					CP      '('	;
1737)   2B31 C8          					RET     Z	;
1738)   2B32 FE 30       		RANGE1:			CP      '0'	;
1739)   2B34 D8          					RET     C	;
1740)   2B35 FE 3A       					CP      '9'+1	;
1741)   2B37 3F          					CCF	;
1742)   2B38 D0          					RET     NC	;
1743)   2B39 FE 40       					CP      '@'             ;V2.4	;V2.4
1744)   2B3B C8          					RET     Z	;
1745)   2B3C FE 41       		RANGE2:			CP      'A'	;
1746)   2B3E D8          					RET     C	;
1747)   2B3F FE 5B       					CP      'Z'+1	;
1748)   2B41 3F          					CCF	;
1749)   2B42 D0          					RET     NC	;
1750)   2B43 FE 5F       					CP      '_'	;
1751)   2B45 D8          					RET     C	;
1752)   2B46 FE 7B       					CP      'z'+1	;
1753)   2B48 3F          					CCF	;
1754)   2B49 C9          					RET	;
1756)   2B4A AF          		SPACE: 			XOR     A	;
1757)   2B4B CD F0 26    					CALL    EXTERR          ;"LINE space"	;"LINE space"
1758)   2B4E 86          					DEFB    LINE	;
1759)   2B4F 08          					DEFB    8	;
1760)   2B50 00          					DEFB    0	;
1776)   2B51 12          		LEXAN1:			LD      (DE),A          ;TRANSFER TO BUFFER	;TRANSFER TO BUFFER
1777)   2B52 13          					INC     DE              ;INCREMENT POINTERS	;INCREMENT POINTERS
1778)   2B53 FD 23       					INC     IY	;
1779)   2B55 7B          		@LEXAN2:		LD      A,E             ;MAIN ENTRY	;MAIN ENTRY
1780)   2B56 FE FC       					CP      252             ;TEST LENGTH	;TEST LENGTH
1781)   2B58 30 F0       					JR      NC,SPACE        ;LINE TOO LONG	;LINE TOO LONG
1782)   2B5A FD 7E 00    					LD      A,(IY)	;
1783)   2B5D FE 0D       					CP      CR	;
1784)   2B5F C8          					RET     Z               ;END OF LINE	;END OF LINE
1785)   2B60 CD 32 2B    					CALL    RANGE1	;
1786)   2B63 30 04       					JR      NC,LEXAN3	;
1787)   2B65 CB A9       					RES     5,C             ;NOT IN VARIABLE	;NOT IN VARIABLE
1788)   2B67 CB 99       					RES     3,C             ;NOT IN HEX	;NOT IN HEX
1789)   2B69 FE 20       		LEXAN3:			CP      ' '	;
1790)   2B6B 28 E4       					JR      Z,LEXAN1        ;PASS SPACES	;PASS SPACES
1791)   2B6D FE 2C       					CP      ','	;
1792)   2B6F 28 E0       					JR      Z,LEXAN1        ;PASS COMMAS	;PASS COMMAS
1793)   2B71 FE 47       					CP      'G'	;
1794)   2B73 38 02       					JR      C,LEXAN4	;
1795)   2B75 CB 99       					RES     3,C             ;NOT IN HEX	;NOT IN HEX
1796)   2B77 FE 22       		LEXAN4:			CP      34		;ASCII ""	;ASCII ""
1797)   2B79 20 05       					JR      NZ,LEXAN5	;
1798)   2B7B CB 11       					RL      C	;
1799)   2B7D 3F          					CCF                     ;TOGGLE C7	;TOGGLE C7
1800)   2B7E CB 19       					RR      C	;
1801)   2B80 CB 61       		LEXAN5:			BIT     4,C	;
1802)   2B82 28 10       					JR      Z,LEXAN6	;
1803)   2B84 CB A1       					RES     4,C	;
1804)   2B86 C5          					PUSH    BC	;
1805)   2B87 D5          					PUSH    DE	;
1806)   2B88 CD C1 2A    					CALL    LINNUM          ;GET LINE NUMBER	;GET LINE NUMBER
1807)   2B8B D1          					POP     DE	;
1808)   2B8C C1          					POP     BC	;
1809)   2B8D 7C          					LD      A,H	;
1810)   2B8E B5          					OR      L	;
1811)   2B8F C4 F9 2B    					CALL    NZ,ENCODE       ;ENCODE LINE NUMBER	;ENCODE LINE NUMBER
1812)   2B92 18 C1       					JR      LEXAN2          ;CONTINUE	;CONTINUE
1814)   2B94 0D          		LEXAN6:			DEC     C	;
1815)   2B95 28 09       					JR      Z,LEXAN7        ;C=1 (LEFT)	;C=1 (LEFT)
1816)   2B97 0C          					INC     C	;
1817)   2B98 20 B7       					JR      NZ,LEXAN1	;
1818)   2B9A B7          					OR      A	;
1819)   2B9B F4 2F 27    					CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1820)   2B9E 18 12       					JR      LEXAN8	;
1822)   2BA0 FE 2A       		LEXAN7:			CP      '*'	;
1823)   2BA2 28 16       					JR      Z,LEXAN9	;
1824)   2BA4 B7          					OR      A	;
1825)   2BA5 F4 2F 27    					CALL    P,LEX           ;TOKENISE IF POSS.	;TOKENISE IF POSS.
1826)   2BA8 FE 8F       					CP      TOKLO	;
1827)   2BAA 38 06       					JR      C,LEXAN8	;
1828)   2BAC FE 94       					CP      TOKHI+1	;
1829)   2BAE 30 02       					JR      NC,LEXAN8	;
1830)   2BB0 C6 40       					ADD     A,OFFSET        ;LEFT VERSION	;LEFT VERSION
1831)   2BB2 FE F4       		LEXAN8:			CP      REM	;
1832)   2BB4 28 04       					JR      Z,LEXAN9	;
1833)   2BB6 FE DC       					CP      DATA	;
1834)   2BB8 20 02       					JR      NZ,LEXANA	;
1835)   2BBA CB F1       		LEXAN9:			SET     6,C             ;QUIT TOKENISING	;QUIT TOKENISING
1836)   2BBC FE A4       		LEXANA:			CP      FN	;
1837)   2BBE 28 09       					JR      Z,LEXANB	;
1838)   2BC0 FE F2       					CP      PROC	;
1839)   2BC2 28 05       					JR      Z,LEXANB	;
1840)   2BC4 CD 3C 2B    					CALL    RANGE2	;
1841)   2BC7 38 02       					JR      C,LEXANC	;
1842)   2BC9 CB E9       		LEXANB:			SET     5,C             ;IN VARIABLE/FN/PROC	;IN VARIABLE/FN/PROC
1843)   2BCB FE 26       		LEXANC:			CP      '&'	;
1844)   2BCD 20 02       					JR      NZ,LEXAND	;
1845)   2BCF CB D9       					SET     3,C             ;IN HEX	;IN HEX
1846)   2BD1 21 F0 2B    		LEXAND:			LD      HL,LIST1	;
1847)   2BD4 C5          					PUSH    BC	;
1848)   2BD5 01 06 00    					LD      BC,LIST1L	;
1849)   2BD8 ED B1       					CPIR	;
1850)   2BDA C1          					POP     BC	;
1851)   2BDB 20 02       					JR      NZ,LEXANE	;
1852)   2BDD CB E1       					SET     4,C             ;ACCEPT LINE NUMBER	;ACCEPT LINE NUMBER
1853)   2BDF 21 F4 2B    		LEXANE:			LD      HL,LIST2	;
1854)   2BE2 C5          					PUSH    BC	;
1855)   2BE3 01 05 00    					LD      BC,LIST2L	;
1856)   2BE6 ED B1       					CPIR	;
1857)   2BE8 C1          					POP     BC	;
1858)   2BE9 20 02       					JR      NZ,LEXANF	;
1859)   2BEB CB C1       					SET     0,C             ;ENTER LEFT MODE	;ENTER LEFT MODE
1860)   2BED C3 51 2B    		LEXANF:			JP      LEXAN1	;
1862)   2BF0 E5          		LIST1:			DEFB    GOTO	;
1863)   2BF1 E4          					DEFB    GOSUB	;
1864)   2BF2 F7          					DEFB    RESTOR	;
1865)   2BF3 FC          					DEFB    TRACE	;
1866)   2BF4 8C          		LIST2:			DEFB    THEN	;
1867)   2BF5 8B          					DEFB    ELSE	;
1869)   2BF6 F5          					DEFB    REPEAT	;
1870)   2BF7 85          					DEFB    TERROR	;
1871)   2BF8 3A          					DEFB    ':'	;
1879)   2BF9 CB E1       		ENCODE:			SET     4,C	;
1880)   2BFB EB          					EX      DE,HL	;
1881)   2BFC 36 8D       					LD      (HL),LINO	;
1882)   2BFE 23          					INC     HL	;
1883)   2BFF 7A          					LD      A,D	;
1884)   2C00 E6 C0       					AND     0C0H	;
1885)   2C02 0F          					RRCA	;
1886)   2C03 0F          					RRCA	;
1887)   2C04 47          					LD      B,A	;
1888)   2C05 7B          					LD      A,E	;
1889)   2C06 E6 C0       					AND     0C0H	;
1890)   2C08 B0          					OR      B	;
1891)   2C09 0F          					RRCA	;
1892)   2C0A 0F          					RRCA	;
1893)   2C0B EE 54       					XOR     01010100B	;
1894)   2C0D 77          					LD      (HL),A	;
1895)   2C0E 23          					INC     HL	;
1896)   2C0F 7B          					LD      A,E	;
1897)   2C10 E6 3F       					AND     3FH	;
1898)   2C12 F6 40       					OR      '@'	;
1899)   2C14 77          					LD      (HL),A	;
1900)   2C15 23          					INC     HL	;
1901)   2C16 7A          					LD      A,D	;
1902)   2C17 E6 3F       					AND     3FH	;
1903)   2C19 F6 40       					OR      '@'	;
1904)   2C1B 77          					LD      (HL),A	;
1905)   2C1C 23          					INC     HL	;
1906)   2C1D EB          					EX      DE,HL	;
1907)   2C1E C9          					RET	;
1914)   2C1F 2A EE 82    		@REPORT:		LD      HL,(ERRTXT)	;
1915)   2C22 7E          		TEXT:			LD      A,(HL)	;
1916)   2C23 23          					INC     HL	;
1917)   2C24 B7          					OR      A	;
1918)   2C25 C8          					RET     Z	;
1919)   2C26 CD 8D 28    					CALL    OUT	;
1920)   2C29 18 F7       					JR      TEXT	;
1926)   2C2B E3          		@TELL:			EX      (SP),HL         ;GET RETURN ADDRESS	;GET RETURN ADDRESS
1927)   2C2C CD 22 2C    					CALL    TEXT	;
1928)   2C2F E3          					EX      (SP),HL	;
1929)   2C30 C9          					RET	;
 33)   2C31 77 26       		CMDTAB:			DEFW    AUTO	;
 34)   2C33 11 25       					DEFW    DELETE	;
 35)   2C35 AF 26       					DEFW    LOAD	;
 36)   2C37 40 25       					DEFW    LIST	;
 37)   2C39 91 26       					DEFW    NEW	;
 38)   2C3B 96 26       					DEFW    OLD	;
 39)   2C3D BE 25       					DEFW    RENUM	;
 40)   2C3F BD 26       					DEFW    SAVE	;
 41)   2C41 38 35       					DEFW    PUT	;
 42)   2C43 EE 33       					DEFW    PTR	;
 43)   2C45 03 34       					DEFW    PAGEV	;
 44)   2C47 12 34       					DEFW    TIMEV	;
 45)   2C49 33 34       					DEFW    LOMEMV	;
 46)   2C4B 46 34       					DEFW    HIMEMV	;
 47)   2C4D 66 01       					DEFW    SOUND	;
 48)   2C4F BA 34       					DEFW    BPUT	;
 49)   2C51 CD 34       					DEFW    CALL	;
 50)   2C53 AA 2C       					DEFW    CHAIN	;
 51)   2C55 C8 33       					DEFW    CLR	;
 52)   2C57 B1 34       					DEFW    CLOSE	;
 53)   2C59 4E 01       					DEFW    CLG	;
 54)   2C5B A5 33       					DEFW    CLS	;
 55)   2C5D 61 2D       					DEFW    REM             ;DATA	;DATA
 56)   2C5F 61 2D       					DEFW    REM             ;DEF	;DEF
 57)   2C61 0E 2E       					DEFW    DIM	;
 58)   2C63 54 01       					DEFW    DRAW	;
 59)   2C65 10 2D       					DEFW    END	;
 60)   2C67 FD 31       					DEFW    ENDPRO	;
 61)   2C69 57 01       					DEFW    ENVEL	;
 62)   2C6B 52 30       					DEFW    FOR	;
 63)   2C6D 0D 30       					DEFW    GOSUB	;
 64)   2C6F F6 2F       					DEFW    GOTO	;
 65)   2C71 5A 01       					DEFW    GCOL	;
 66)   2C73 78 33       					DEFW    IF	;
 67)   2C75 88 32       					DEFW    INPUT	;
 68)   2C77 81 2D       					DEFW    LET	;
 69)   2C79 AF 31       					DEFW    LOCAL	;
 70)   2C7B 5D 01       					DEFW    MODE	;
 71)   2C7D 60 01       					DEFW    MOVE	;
 72)   2C7F 97 30       					DEFW    NEXT	;
 73)   2C81 90 2F       					DEFW    ON	;
 74)   2C83 90 34       					DEFW    VDU	;
 75)   2C85 63 01       					DEFW    PLOT	;
 76)   2C87 BB 2E       					DEFW    PRINT	;
 77)   2C89 20 31       					DEFW    PROC	;
 78)   2C8B 27 33       					DEFW    READ	;
 79)   2C8D 61 2D       					DEFW    REM	;
 80)   2C8F 28 30       					DEFW    REPEAT	;
 81)   2C91 C2 33       					DEFW    REPOR	;
 82)   2C93 D0 33       					DEFW    RESTOR	;
 83)   2C95 18 30       					DEFW    RETURN	;
 84)   2C97 A5 2C       					DEFW    RUN	;
 85)   2C99 AF 33       					DEFW    STOP	;
 86)   2C9B 51 01       					DEFW    COLOUR	;
 87)   2C9D 76 34       					DEFW    TRACE	;
 88)   2C9F 30 30       					DEFW    UNTIL	;
 89)   2CA1 6B 34       					DEFW    WIDTHV	;
 90)   2CA3 4D 2D       					DEFW    CLI             ;OSCLI	;OSCLI
 92)   2CA5 CD C2 36    		RUN:			CALL    TERM?	;
 93)   2CA8 28 0D       					JR      Z,RUN0	;
 94)   2CAA CD 9D 3E    		CHAIN:			CALL    EXPRS	;
 95)   2CAD 3E 0D       					LD      A,CR	;
 96)   2CAF 12          					LD      (DE),A	;
 97)   2CB0 ED 7B E4 82 		@CHAIN0:		LD      SP,(HIMEM)	;
 98)   2CB4 CD 83 27    					CALL    LOAD0	;
 99)   2CB7 ED 7B E4 82 		@RUN0:			LD      SP,(HIMEM)      ;PREPARE FOR RUN	;PREPARE FOR RUN
100)   2CBB DD 21 F6 82 					LD      IX,RANDOM	;
104)   2CBF ED 5F       					ld      a, r	;
105)   2CC1 20 1D       					jr      nz, 1F	;
106)   2CC3 3C          					inc     a	;
108)   2CC4 07          		L1:			RLCA	;
109)   2CC5 07          					RLCA	;
110)   2CC6 DD 77 03    					LD      (IX+3),A	;
111)   2CC9 9F          					SBC     A,A	;
112)   2CCA DD 77 04    					LD      (IX+4),A	;
113)   2CCD CD CC 27    					CALL    CLEAR	;
114)   2CD0 21 00 00    					LD      HL,0	;
115)   2CD3 22 EC 82    					LD      (ERRTRP),HL	;
116)   2CD6 2A DC 82    					LD      HL,(PAGE)	;
117)   2CD9 3E DC       					LD      A,DATA	;
118)   2CDB CD 80 37    					CALL    SEARCH          ;LOOK FOR "DATA"	;LOOK FOR "DATA"
119)   2CDE 22 F0 82    					LD      (DATPTR),HL     ;SET DATA POINTER	;SET DATA POINTER
120)   2CE1 FD 2A DC 82 					LD      IY,(PAGE)	;
121)   2CE5 CD 20 2D    		XEQ0:			CALL    NEWLIN	;
122)   2CE8 FD 22 F4 82 		@XEQ:			LD      (ERRLIN),IY     ;ERROR POINTER	;ERROR POINTER
123)   2CEC CD 48 01    					CALL    TRAP            ;CHECK KEYBOARD	;CHECK KEYBOARD
124)   2CEF CD 78 44    		XEQ1:			CALL    NXT	;
125)   2CF2 FD 23       					INC     IY	;
126)   2CF4 FE 3A       					CP      ':'             ;SEPARATOR	;SEPARATOR
127)   2CF6 28 F7       					JR      Z,XEQ1	;
128)   2CF8 FE 0D       					CP      CR	;
129)   2CFA 28 E9       					JR      Z,XEQ0          ;NEW PROGRAM LINE	;NEW PROGRAM LINE
130)   2CFC D6 C6       					SUB     TCMD	;
131)   2CFE 38 6F       					JR      C,LET0          ;IMPLIED "LET"	;IMPLIED "LET"
132)   2D00 87          					ADD     A,A	;
133)   2D01 4F          					LD      C,A	;
134)   2D02 06 00       					LD      B,0	;
135)   2D04 21 31 2C    					LD      HL,CMDTAB	;
136)   2D07 09          					ADD     HL,BC	;
137)   2D08 7E          					LD      A,(HL)          ;TABLE ENTRY	;TABLE ENTRY
138)   2D09 23          					INC     HL	;
139)   2D0A 66          					LD      H,(HL)	;
140)   2D0B 6F          					LD      L,A	;
141)   2D0C CD 78 44    					CALL    NXT	;
142)   2D0F E9          					JP      (HL)            ;EXECUTE STATEMENT	;EXECUTE STATEMENT
146)   2D10 CD C4 28    		END:			CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
147)   2D13 7C          					LD      A,H	;
148)   2D14 B5          					OR      L               ;DIRECT?	;DIRECT?
149)   2D15 CA 6F 20    					JP      Z,CLOOP	;
150)   2D18 1E 00       					LD      E,0	;
151)   2D1A CD 2D 01    					CALL    OSSHUT          ;CLOSE ALL FILES	;CLOSE ALL FILES
152)   2D1D C3 6E 20    					JP      WARM            ;"Ready"	;"Ready"
154)   2D20 FD 7E 00    		NEWLIN:			LD      A,(IY+0)        ;A=LINE LENGTH	;A=LINE LENGTH
155)   2D23 01 03 00    					LD      BC,3	;
156)   2D26 FD 09       					ADD     IY,BC	;
157)   2D28 B7          					OR      A	;
158)   2D29 28 E5       					JR      Z,END           ;LENGTH=0, EXIT	;LENGTH=0, EXIT
159)   2D2B 2A E8 82    					LD      HL,(TRACEN)	;
160)   2D2E 7C          					LD      A,H	;
161)   2D2F B5          					OR      L	;
162)   2D30 C8          					RET     Z	;
163)   2D31 FD 56 FF    					LD      D,(IY-1)        ;DE = LINE NUMBER	;DE = LINE NUMBER
164)   2D34 FD 5E FE    					LD      E,(IY-2)	;
165)   2D37 ED 52       					SBC     HL,DE	;
166)   2D39 D8          					RET     C	;
167)   2D3A EB          					EX      DE,HL	;
168)   2D3B 3E 5B       					LD      A,'['           ;TRACE	;TRACE
169)   2D3D CD 74 28    					CALL    OUTCHR	;
170)   2D40 CD 01 29    					CALL    PBCDL	;
171)   2D43 3E 5D       					LD      A,']'	;
172)   2D45 CD 74 28    					CALL    OUTCHR	;
173)   2D48 3E 20       					LD      A,' '	;
174)   2D4A C3 74 28    					JP      OUTCHR	;
180)   2D4D CD 9D 3E    		CLI:			CALL    EXPRS	;
181)   2D50 3E 0D       					LD      A,CR	;
182)   2D52 12          					LD      (DE),A	;
183)   2D53 21 00 80    					LD      HL,ACCS	;
184)   2D56 CD 21 01    					CALL    OSCLI	;
185)   2D59 18 8D       					JR      XEQ	;
189)   2D5B FD E5       		EXT:			PUSH    IY	;
190)   2D5D E1          					POP     HL	;
191)   2D5E CD 21 01    					CALL    OSCLI	;
192)   2D61 FD E5       		REM:			PUSH    IY	;
193)   2D63 E1          					POP     HL	;
194)   2D64 3E 0D       					LD      A,CR	;
195)   2D66 47          					LD      B,A	;
196)   2D67 ED B1       					CPIR                    ;FIND LINE END	;FIND LINE END
197)   2D69 E5          					PUSH    HL	;
198)   2D6A FD E1       					POP     IY	;
199)   2D6C C3 E5 2C    					JP      XEQ0	;
203)   2D6F FE C5       		LET0:			CP      ELSE-TCMD	;
204)   2D71 28 EE       					JR      Z,REM	;
205)   2D73 FE 64       					CP      ('*'-TCMD) AND 0xFF	;
206)   2D75 28 E4       					JR      Z,EXT	;
207)   2D77 FE 77       					CP      ('='-TCMD) AND 0xFF	;
208)   2D79 28 4C       					JR      Z,FNEND	;
209)   2D7B FE 95       					CP      ('['-TCMD) AND 0xFF	;
210)   2D7D 28 1E       					JR      Z,ASM	;
211)   2D7F FD 2B       					DEC     IY	;
212)   2D81 CD 4A 35    		LET:			CALL    ASSIGN	;
213)   2D84 CA E8 2C    					JP      Z,XEQ	;
214)   2D87 38 36       					JR      C,SYNTAX        ;"Syntax error"	;"Syntax error"
215)   2D89 F5          					PUSH    AF              ;SAVE STRING TYPE	;SAVE STRING TYPE
216)   2D8A CD D6 36    					CALL    EQUALS	;
217)   2D8D E5          					PUSH    HL	;
218)   2D8E CD 9D 3E    					CALL    EXPRS	;
219)   2D91 DD E1       					POP     IX	;
220)   2D93 F1          					POP     AF	;
221)   2D94 CD 87 35    					CALL    STACCS	;
222)   2D97 C3 E8 2C    		XEQR:			JP      XEQ	;
224)   2D9A CD 20 2D    		ASM0:			CALL    NEWLIN	;
225)   2D9D FD 22 F4 82 		ASM:			LD      (ERRLIN),IY	;
226)   2DA1 CD 48 01    					CALL    TRAP	;
227)   2DA4 CD C9 37    					CALL    ASSEM	;
228)   2DA7 38 16       					JR      C,SYNTAX	;
229)   2DA9 FE 0D       					CP      CR	;
230)   2DAB 28 ED       					JR      Z,ASM0	;
231)   2DAD 21 FE 82    					LD      HL,LISTON	;
232)   2DB0 7E          					LD      A,(HL)	;
233)   2DB1 E6 0F       					AND     0FH	;
234)   2DB3 F6 30       					OR      30H	;
235)   2DB5 77          					LD      (HL),A	;
236)   2DB6 18 DF       					JR      XEQR	;
238)   2DB8 CD 3F 29    		VAR:			CALL    GETVAR	;
239)   2DBB C8          					RET     Z	;
240)   2DBC D2 30 29    					JP      NC,PUTVAR	;
241)   2DBF 3E 10       		@SYNTAX:		LD      A,16            ;"Syntax error"	;"Syntax error"
242)   2DC1 21          					DEFB    21H	;
243)   2DC2 3E 11       		@ESCAPE:		LD      A,17            ;"Escape"	;"Escape"
244)   2DC4 C3 DB 26    		ERROR0:			JP      ERROR	;
248)   2DC7 CD 84 3D    		FNEND:			CALL    EXPR            ;FUNCTION RESULT	;FUNCTION RESULT
249)   2DCA 43          					LD      B,E	;
250)   2DCB EB          					EX      DE,HL	;
251)   2DCC D9          					EXX                     ;SAVE RESULT	;SAVE RESULT
252)   2DCD EB          					EX      DE,HL           ; IN DEB'C'D'E'	; IN DEB'C'D'E'
253)   2DCE C1          		FNEND5:			POP     BC	;
254)   2DCF 21 A2 36    					LD      HL,LOCCHK	;
255)   2DD2 B7          					OR      A	;
256)   2DD3 ED 42       					SBC     HL,BC	;
257)   2DD5 28 19       					JR      Z,FNEND0        ;LOCAL VARIABLE	;LOCAL VARIABLE
258)   2DD7 21 20 31    					LD      HL,FNCHK	;
259)   2DDA B7          					OR      A	;
260)   2DDB ED 42       					SBC     HL,BC	;
261)   2DDD 3E 07       					LD      A,7	;
262)   2DDF 20 E3       					JR      NZ,ERROR0       ;"No FN"	;"No FN"
263)   2DE1 FD E1       					POP     IY	;
264)   2DE3 FD 22 F4 82 					LD      (ERRLIN),IY     ;IN CASE OF ERROR	;IN CASE OF ERROR
265)   2DE7 EB          					EX      DE,HL	;
266)   2DE8 D9          					EXX	;
267)   2DE9 EB          					EX      DE,HL	;
268)   2DEA 11 00 80    					LD      DE,ACCS	;
269)   2DED 58          					LD      E,B	;
270)   2DEE 08          					EX      AF,AF'	;
271)   2DEF C9          					RET	;
273)   2DF0 DD E1       		FNEND0:			POP     IX	;
274)   2DF2 C1          					POP     BC	;
275)   2DF3 78          					LD      A,B	;
276)   2DF4 B7          					OR      A	;
277)   2DF5 FA 01 2E    					JP      M,FNEND1        ;STRING	;STRING
278)   2DF8 E1          					POP     HL	;
279)   2DF9 D9          					EXX	;
280)   2DFA E1          					POP     HL	;
281)   2DFB D9          					EXX	;
282)   2DFC CD 5E 35    					CALL    STORE	;
283)   2DFF 18 CD       					JR      FNEND5	;
284)   2E01 21 00 00    		FNEND1:			LD      HL,0	;
285)   2E04 39          					ADD     HL,SP	;
286)   2E05 D5          					PUSH    DE	;
287)   2E06 59          					LD      E,C	;
288)   2E07 CD 8A 35    					CALL    STORES	;
289)   2E0A D1          					POP     DE	;
290)   2E0B F9          					LD      SP,HL	;
291)   2E0C 18 C0       					JR      FNEND5	;
296)   2E0E CD 3F 29    		DIM:			CALL    GETVAR          ;VARIABLE	;VARIABLE
297)   2E11 38 7B       					JR      C,BADDIM	;
298)   2E13 CA 96 2E    					JP      Z,DIM4	;
299)   2E16 CD 7D 2A    					CALL    CREATE	;
300)   2E19 E5          					PUSH    HL	;
301)   2E1A DD E1       					POP     IX	;
302)   2E1C FD 7E 00    					LD      A,(IY)	;
303)   2E1F FE 28       					CP      '('	;
304)   2E21 7A          					LD      A,D	;
305)   2E22 20 72       					JR      NZ,DIM4	;
306)   2E24 E5          					PUSH    HL	;
307)   2E25 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
308)   2E26 11 01 00    					LD      DE,1	;
309)   2E29 42          					LD      B,D             ;DIMENSION COUNTER	;DIMENSION COUNTER
310)   2E2A FD 23       		DIM1:			INC     IY	;
311)   2E2C C5          					PUSH    BC	;
312)   2E2D D5          					PUSH    DE	;
313)   2E2E DD E5       					PUSH    IX	;
314)   2E30 CD 94 3E    					CALL    EXPRI           ;DIMENSION SIZE	;DIMENSION SIZE
315)   2E33 CB 7C       					BIT     7,H	;
316)   2E35 20 57       					JR      NZ,BADDIM	;
317)   2E37 D9          					EXX	;
318)   2E38 23          					INC     HL	;
319)   2E39 DD E1       					POP     IX	;
320)   2E3B DD 23       					INC     IX	;
321)   2E3D DD 75 00    					LD      (IX),L          ;SAVE SIZE	;SAVE SIZE
322)   2E40 DD 23       					INC     IX	;
323)   2E42 DD 74 00    					LD      (IX),H	;
324)   2E45 C1          					POP     BC	;
325)   2E46 CD A3 37    					CALL    MUL16           ;HL=HL*BC	;HL=HL*BC
326)   2E49 38 46       					JR      C,NOROOM        ;TOO LARGE	;TOO LARGE
327)   2E4B EB          					EX      DE,HL           ;DE=PRODUCT	;DE=PRODUCT
328)   2E4C C1          					POP     BC	;
329)   2E4D 04          					INC     B               ;DIMENSION COUNTER	;DIMENSION COUNTER
330)   2E4E FD 7E 00    					LD      A,(IY)	;
331)   2E51 FE 2C       					CP      ','             ;ANOTHER	;ANOTHER
332)   2E53 28 D5       					JR      Z,DIM1	;
333)   2E55 CD 3C 44    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
334)   2E58 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
335)   2E59 DD 23       					INC     IX	;
336)   2E5B DD E3       					EX      (SP),IX	;
337)   2E5D DD 70 00    					LD      (IX),B          ;NO. OF DIMENSIONS	;NO. OF DIMENSIONS
338)   2E60 CD 96 37    					CALL    X4OR5           ;DE=DE*n	;DE=DE*n
339)   2E63 E1          					POP     HL	;
340)   2E64 38 2B       					JR      C,NOROOM	;
341)   2E66 19          		DIM3:			ADD     HL,DE	;
342)   2E67 38 28       					JR      C,NOROOM	;
343)   2E69 E5          					PUSH    HL	;
344)   2E6A 24          					INC     H	;
345)   2E6B 28 24       					JR      Z,NOROOM	;
346)   2E6D ED 72       					SBC     HL,SP	;
347)   2E6F 30 20       					JR      NC,NOROOM       ;OUT OF SPACE	;OUT OF SPACE
348)   2E71 E1          					POP     HL	;
349)   2E72 22 E2 82    					LD      (FREE),HL	;
350)   2E75 7A          		DIM2:			LD      A,D	;
351)   2E76 B3          					OR      E	;
352)   2E77 28 06       					JR      Z,DIM5	;
353)   2E79 2B          					DEC     HL	;
354)   2E7A 36 00       					LD      (HL),0          ;INITIALISE ARRAY	;INITIALISE ARRAY
355)   2E7C 1B          					DEC     DE	;
356)   2E7D 18 F6       					JR      DIM2	;
357)   2E7F CD 78 44    		DIM5:			CALL    NXT	;
358)   2E82 FE 2C       					CP      ','             ;ANOTHER VARIABLE?	;ANOTHER VARIABLE?
359)   2E84 C2 E8 2C    					JP      NZ,XEQ	;
360)   2E87 FD 23       					INC     IY	;
361)   2E89 CD 78 44    					CALL    NXT	;
362)   2E8C 18 80       					JR      DIM	;
364)   2E8E 3E 0A       		BADDIM:			LD      A,10            ;"Bad DIM"	;"Bad DIM"
365)   2E90 21          					DEFB    21H	;
366)   2E91 3E 0B       		NOROOM:			LD      A,11            ;"DIM space"	;"DIM space"
367)   2E93 C3 DB 26    		ERROR1:			JP      ERROR	;
369)   2E96 B7          		DIM4:			OR      A	;
370)   2E97 28 F5       					JR      Z,BADDIM	;
371)   2E99 FA 8E 2E    					JP      M,BADDIM        	;
372)   2E9C 47          					LD      B,A	;
373)   2E9D FD 7E FF    					LD      A,(IY-1)	;
374)   2EA0 FE 29       					CP      ')'	;
375)   2EA2 78          					LD      A,B	;
376)   2EA3 28 E9       					JR      Z,BADDIM	;
377)   2EA5 2A E2 82    					LD      HL,(FREE)	;
378)   2EA8 D9          					EXX	;
379)   2EA9 21 00 00    					LD      HL,0	;
380)   2EAC 4C          					LD      C,H	;
381)   2EAD CD 5E 35    					CALL    STORE           ;RESERVED AREA	;RESERVED AREA
382)   2EB0 CD 94 3E    					CALL    EXPRI	;
383)   2EB3 D9          					EXX	;
384)   2EB4 23          					INC     HL	;
385)   2EB5 EB          					EX      DE,HL	;
386)   2EB6 2A E2 82    					LD      HL,(FREE)	;
387)   2EB9 18 AB       					JR      DIM3	;
392)   2EBB FE 23       		PRINT:			CP      '#'	;
393)   2EBD 20 6B       					JR      NZ,PRINT0	;
394)   2EBF CD C1 37    					CALL    CHNL            ;CHANNEL NO. = E	;CHANNEL NO. = E
395)   2EC2 CD 78 44    		PRNTN1:			CALL    NXT	;
396)   2EC5 FE 2C       					CP      ','	;
397)   2EC7 C2 E8 2C    					JP      NZ,XEQ	;
398)   2ECA FD 23       					INC     IY	;
399)   2ECC D5          					PUSH    DE	;
400)   2ECD CD 84 3D    					CALL    EXPR            ;ITEM TO PRINT	;ITEM TO PRINT
401)   2ED0 08          					EX      AF,AF'	;
402)   2ED1 FA F1 2E    					JP      M,PRNTN2        ;STRING	;STRING
403)   2ED4 D1          					POP     DE	;
404)   2ED5 C5          					PUSH    BC	;
405)   2ED6 D9          					EXX	;
406)   2ED7 7D          					LD      A,L	;
407)   2ED8 D9          					EXX	;
408)   2ED9 CD 24 01    					CALL    OSBPUT	;
409)   2EDC D9          					EXX	;
410)   2EDD 7C          					LD      A,H	;
411)   2EDE D9          					EXX	;
412)   2EDF CD 24 01    					CALL    OSBPUT	;
413)   2EE2 7D          					LD      A,L	;
414)   2EE3 CD 24 01    					CALL    OSBPUT	;
415)   2EE6 7C          					LD      A,H	;
416)   2EE7 CD 24 01    					CALL    OSBPUT	;
417)   2EEA C1          					POP     BC	;
418)   2EEB 79          					LD      A,C	;
419)   2EEC CD 24 01    					CALL    OSBPUT	;
420)   2EEF 18 D1       					JR      PRNTN1	;
421)   2EF1 4B          		PRNTN2:			LD      C,E	;
422)   2EF2 D1          					POP     DE	;
423)   2EF3 21 00 80    					LD      HL,ACCS	;
424)   2EF6 0C          					INC     C	;
425)   2EF7 0D          		PRNTN3:			DEC     C	;
426)   2EF8 28 09       					JR      Z,PRNTN4	;
427)   2EFA 7E          					LD      A,(HL)	;
428)   2EFB 23          					INC     HL	;
429)   2EFC C5          					PUSH    BC	;
430)   2EFD CD 24 01    					CALL    OSBPUT	;
431)   2F00 C1          					POP     BC	;
432)   2F01 18 F4       					JR      PRNTN3	;
433)   2F03 3E 0D       		PRNTN4:			LD      A,CR	;
434)   2F05 CD 24 01    					CALL    OSBPUT	;
435)   2F08 18 B8       					JR      PRNTN1	;
437)   2F0A 06 02       		PRINT6:			LD      B,2	;
438)   2F0C 18 22       					JR      PRINTC	;
439)   2F0E 01 00 01    		PRINT8:			LD      BC,100H	;
440)   2F11 18 1D       					JR      PRINTC	;
441)   2F13 21 00 82    		PRINT9:			LD      HL,STAVAR	;
442)   2F16 AF          					XOR     A	;
443)   2F17 BE          					CP      (HL)	;
444)   2F18 28 10       					JR      Z,PRINT0	;
445)   2F1A 3A FB 82    					LD      A,(COUNT)	;
446)   2F1D B7          					OR      A	;
447)   2F1E 28 0A       					JR      Z,PRINT0	;
448)   2F20 96          		PRINTA:			SUB     (HL)	;
449)   2F21 28 07       					JR      Z,PRINT0	;
450)   2F23 30 FB       					JR      NC,PRINTA	;
451)   2F25 ED 44       					NEG	;
452)   2F27 CD 2A 37    					CALL    FILL	;
453)   2F2A 3A 00 82    		PRINT0:			LD      A,(STAVAR)	;
454)   2F2D 4F          					LD      C,A             ;PRINTS	;PRINTS
455)   2F2E 06 00       					LD      B,0             ;PRINTF	;PRINTF
456)   2F30 CD C2 36    		PRINTC:			CALL    TERM?	;
457)   2F33 28 38       					JR      Z,PRINT4	;
458)   2F35 CB 80       					RES     0,B	;
459)   2F37 FD 23       					INC     IY	;
460)   2F39 FE 7E       					CP      '~'	;
461)   2F3B 28 CD       					JR      Z,PRINT6	;
462)   2F3D FE 3B       					CP      ';'	;
463)   2F3F 28 CD       					JR      Z,PRINT8	;
464)   2F41 FE 2C       					CP      ','	;
465)   2F43 28 CE       					JR      Z,PRINT9	;
466)   2F45 CD E3 36    					CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
467)   2F48 28 E6       					JR      Z,PRINTC	;
468)   2F4A FD 2B       					DEC     IY	;
469)   2F4C C5          					PUSH    BC	;
470)   2F4D CD 84 3D    					CALL    EXPR            ;VARIABLE TYPE	;VARIABLE TYPE
471)   2F50 08          					EX      AF,AF'	;
472)   2F51 FA 67 2F    					JP      M,PRINT3        ;STRING	;STRING
473)   2F54 D1          					POP     DE	;
474)   2F55 D5          					PUSH    DE	;
475)   2F56 CB 4A       					BIT     1,D	;
476)   2F58 F5          					PUSH    AF	;
477)   2F59 CC 96 43    					CALL    Z,STR           ;DECIMAL	;DECIMAL
478)   2F5C F1          					POP     AF	;
479)   2F5D C4 53 43    					CALL    NZ,HEXSTR       ;HEX	;HEX
480)   2F60 C1          					POP     BC	;
481)   2F61 C5          					PUSH    BC	;
482)   2F62 79          					LD      A,C	;
483)   2F63 93          					SUB     E	;
484)   2F64 D4 2A 37    					CALL    NC,FILL         ;RIGHT JUSTIFY	;RIGHT JUSTIFY
485)   2F67 C1          		PRINT3:			POP     BC	;
486)   2F68 CD 38 37    					CALL    PTEXT           ;PRINT	;PRINT
487)   2F6B 18 C3       					JR      PRINTC	;
488)   2F6D CB 40       		PRINT4:			BIT     0,B	;
489)   2F6F CC 6D 28    					CALL    Z,CRLF	;
490)   2F72 C3 E8 2C    					JP      XEQ	;
493)   2F75 FD 23       		ONERR:			INC     IY              ;SKIP "ERROR"	;SKIP "ERROR"
494)   2F77 21 00 00    					LD      HL,0	;
495)   2F7A 22 EC 82    					LD      (ERRTRP),HL	;
496)   2F7D CD 78 44    					CALL    NXT	;
497)   2F80 FE 87       					CP      OFF	;
498)   2F82 FD 23       					INC     IY	;
499)   2F84 CA E8 2C    					JP      Z,XEQ	;
500)   2F87 FD 2B       					DEC     IY	;
501)   2F89 FD 22 EC 82 					LD      (ERRTRP),IY	;
502)   2F8D C3 61 2D    					JP      REM	;
512)   2F90 FE 85       		ON:			CP      TERROR	;
513)   2F92 28 E1       					JR      Z,ONERR         ;"ON ERROR"	;"ON ERROR"
514)   2F94 CD 94 3E    					CALL    EXPRI	;
515)   2F97 FD 7E 00    					LD      A,(IY)	;
516)   2F9A FD 23       					INC     IY	;
517)   2F9C 1E 2C       					LD      E,','           ;SEPARATOR	;SEPARATOR
518)   2F9E FE E5       					CP      TGOTO	;
519)   2FA0 28 0B       					JR      Z,ON1	;
520)   2FA2 FE E4       					CP      TGOSUB	;
521)   2FA4 28 07       					JR      Z,ON1	;
522)   2FA6 1E F2       					LD      E,TPROC	;
523)   2FA8 BB          					CP      E	;
524)   2FA9 3E 27       					LD      A,39	;
525)   2FAB 20 41       					JR      NZ,ERROR2       ;"ON syntax"	;"ON syntax"
526)   2FAD 57          		ON1:			LD      D,A	;
527)   2FAE D9          					EXX	;
528)   2FAF E5          					PUSH    HL	;
529)   2FB0 D9          					EXX	;
530)   2FB1 C1          					POP     BC              ;ON INDEX	;ON INDEX
531)   2FB2 78          					LD      A,B	;
532)   2FB3 B4          					OR      H	;
533)   2FB4 B5          					OR      L	;
534)   2FB5 20 27       					JR      NZ,ON4          ;OUT OF RANGE	;OUT OF RANGE
535)   2FB7 B1          					OR      C	;
536)   2FB8 28 24       					JR      Z,ON4	;
537)   2FBA 0D          					DEC     C	;
538)   2FBB 28 0D       					JR      Z,ON3           ;INDEX=1	;INDEX=1
539)   2FBD CD C2 36    		ON2:			CALL    TERM?	;
540)   2FC0 28 1C       					JR      Z,ON4           ;OUT OF RANGE	;OUT OF RANGE
541)   2FC2 FD 23       					INC     IY              ;SKIP DELIMITER	;SKIP DELIMITER
542)   2FC4 BB          					CP      E	;
543)   2FC5 20 F6       					JR      NZ,ON2	;
544)   2FC7 0D          					DEC     C	;
545)   2FC8 20 F3       					JR      NZ,ON2	;
546)   2FCA 7B          		ON3:			LD      A,E	;
547)   2FCB FE F2       					CP      TPROC	;
548)   2FCD 28 22       					JR      Z,ONPROC	;
549)   2FCF D5          					PUSH    DE	;
550)   2FD0 CD AB 3E    					CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
551)   2FD3 D1          					POP     DE	;
552)   2FD4 7A          					LD      A,D	;
553)   2FD5 FE E5       					CP      TGOTO	;
554)   2FD7 28 26       					JR      Z,GOTO2	;
555)   2FD9 CD CE 36    					CALL    SPAN            ;SKIP REST OF LIST	;SKIP REST OF LIST
556)   2FDC 18 32       					JR      GOSUB1	;
558)   2FDE FD 7E 00    		ON4:			LD      A,(IY)	;
559)   2FE1 FD 23       					INC     IY	;
560)   2FE3 FE 8B       					CP      ELSE	;
561)   2FE5 CA 8A 33    					JP      Z,IF1           ;ELSE CLAUSE	;ELSE CLAUSE
562)   2FE8 FE 0D       					CP      CR	;
563)   2FEA 20 F2       					JR      NZ,ON4	;
564)   2FEC 3E 28       					LD      A,40	;
565)   2FEE C3 DB 26    		ERROR2:			JP      ERROR           ;"ON range"	;"ON range"
567)   2FF1 3E EE       		ONPROC:			LD      A,TON	;
568)   2FF3 C3 20 31    					JP      PROC	;
572)   2FF6 CD AB 3E    		GOTO:			CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
573)   2FF9 CD C2 36    		GOTO1:			CALL    TERM?	;
574)   2FFC C2 BF 2D    					JP      NZ,SYNTAX	;
575)   2FFF D9          		GOTO2:			EXX	;
576)   3000 CD AB 28    					CALL    FINDL	;
577)   3003 E5          					PUSH    HL	;
578)   3004 FD E1       					POP     IY	;
579)   3006 CA E5 2C    					JP      Z,XEQ0	;
580)   3009 3E 29       					LD      A,41	;
581)   300B 18 E1       					JR      ERROR2          ;"No such line"	;"No such line"
585)   300D CD AB 3E    		GOSUB:			CALL    ITEMI           ;LINE NUMBER	;LINE NUMBER
586)   3010 FD E5       		GOSUB1:			PUSH    IY              ;TEXT POINTER	;TEXT POINTER
587)   3012 CD BF 35    					CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
588)   3015 CD F9 2F    					CALL    GOTO1           ;SAVE MARKER	;SAVE MARKER
593)   3018 D1          		RETURN:			POP     DE              ;MARKER	;MARKER
594)   3019 21 18 30    					LD      HL,GOSCHK	;
595)   301C B7          					OR      A	;
596)   301D ED 52       					SBC     HL,DE	;
597)   301F FD E1       					POP     IY	;
598)   3021 CA E8 2C    					JP      Z,XEQ	;
599)   3024 3E 26       					LD      A,38	;
600)   3026 18 C6       					JR      ERROR2          ;"No GOSUB"	;"No GOSUB"
604)   3028 FD E5       		REPEAT:			PUSH    IY	;
605)   302A CD BF 35    					CALL    CHECK	;
606)   302D CD E8 2C    					CALL    XEQ	;
611)   3030 C1          		UNTIL:			POP     BC	;
612)   3031 C5          					PUSH    BC	;
613)   3032 21 30 30    					LD      HL,REPCHK	;
614)   3035 B7          					OR      A	;
615)   3036 ED 42       					SBC     HL,BC	;
616)   3038 3E 2B       					LD      A,43	;
617)   303A 20 B2       					JR      NZ,ERROR2       ;"No REPEAT"	;"No REPEAT"
618)   303C CD 94 3E    					CALL    EXPRI	;
619)   303F CD 1F 43    					CALL    TEST	;
620)   3042 C1          					POP     BC	;
621)   3043 D1          					POP     DE	;
622)   3044 20 05       					JR      NZ,XEQ2         ;TRUE	;TRUE
623)   3046 D5          					PUSH    DE	;
624)   3047 C5          					PUSH    BC	;
625)   3048 D5          					PUSH    DE	;
626)   3049 FD E1       					POP     IY	;
627)   304B C3 E8 2C    		XEQ2:			JP      XEQ	;
631)   304E 3E 22       		FORVAR:			LD      A,34	;
632)   3050 18 9C       					JR      ERROR2          ;"FOR variable"	;"FOR variable"
634)   3052 CD 4A 35    		FOR:			CALL    ASSIGN	;
635)   3055 20 F7       					JR      NZ,FORVAR       ;"FOR variable"	;"FOR variable"
636)   3057 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
637)   3058 FD 7E 00    					LD      A,(IY)	;
638)   305B FE B8       					CP      TO	;
639)   305D 3E 24       					LD      A,36	;
640)   305F 20 8D       					JR      NZ,ERROR2       ;"No TO"	;"No TO"
641)   3061 FD 23       					INC     IY	;
642)   3063 DD E5       					PUSH    IX	;
643)   3065 CD 8D 3E    					CALL    EXPRN           ;LIMIT	;LIMIT
644)   3068 DD E1       					POP     IX	;
645)   306A F1          					POP     AF	;
646)   306B 47          					LD      B,A             ;TYPE	;TYPE
647)   306C C5          					PUSH    BC              ;SAVE ON STACK	;SAVE ON STACK
648)   306D E5          					PUSH    HL	;
649)   306E 21 00 00    					LD      HL,0	;
650)   3071 4C          					LD      C,H	;
651)   3072 D9          					EXX	;
652)   3073 E5          					PUSH    HL	;
653)   3074 21 01 00    					LD      HL,1            ;PRESET STEP	;PRESET STEP
654)   3077 D9          					EXX	;
655)   3078 FD 7E 00    					LD      A,(IY)	;
656)   307B FE 88       					CP      STEP	;
657)   307D 20 09       					JR      NZ,FOR1	;
658)   307F FD 23       					INC     IY	;
659)   3081 DD E5       					PUSH    IX	;
660)   3083 CD 8D 3E    					CALL    EXPRN           ;STEP	;STEP
661)   3086 DD E1       					POP     IX	;
662)   3088 C5          		FOR1:			PUSH    BC	;
663)   3089 E5          					PUSH    HL	;
664)   308A D9          					EXX	;
665)   308B E5          					PUSH    HL	;
666)   308C D9          					EXX	;
667)   308D FD E5       					PUSH    IY              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
668)   308F DD E5       					PUSH    IX              ;LOOP VARIABLE	;LOOP VARIABLE
669)   3091 CD BF 35    					CALL    CHECK	;
670)   3094 CD E8 2C    					CALL    XEQ	;
675)   3097 C1          		NEXT:			POP     BC              ;MARKER	;MARKER
676)   3098 21 97 30    					LD      HL,FORCHK	;
677)   309B B7          					OR      A	;
678)   309C ED 42       					SBC     HL,BC	;
679)   309E 3E 20       					LD      A,32	;
680)   30A0 20 77       					JR      NZ,ERROR3       ;"No FOR"	;"No FOR"
681)   30A2 CD C2 36    					CALL    TERM?	;
682)   30A5 E1          					POP     HL	;
683)   30A6 E5          					PUSH    HL	;
684)   30A7 C5          					PUSH    BC	;
685)   30A8 E5          					PUSH    HL	;
686)   30A9 C4 3F 29    					CALL    NZ,GETVAR       ;VARIABLE	;VARIABLE
687)   30AC D1          					POP     DE	;
688)   30AD EB          					EX      DE,HL	;
689)   30AE B7          					OR      A	;
690)   30AF ED 52       		NEXT0:			SBC     HL,DE	;
691)   30B1 20 54       					JR      NZ,NEXT1	;
692)   30B3 D5          					PUSH    DE	;
693)   30B4 DD 21 08 00 					LD      IX,6+2	;
694)   30B8 DD 39       					ADD     IX,SP	;
695)   30BA CD C5 3F    					CALL    DLOAD5          ;STEP	;STEP
696)   30BD DD 7E 0B    					LD      A,(IX+11)       ;TYPE	;TYPE
697)   30C0 DD E1       					POP     IX	;
698)   30C2 CD 4D 3F    					CALL    LOADN           ;LOOP VARIABLE	;LOOP VARIABLE
699)   30C5 CB 7A       					BIT     7,D             ;SIGN?	;SIGN?
700)   30C7 F5          					PUSH    AF	;
701)   30C8 3E 0B       					LD      A,'+' AND 0FH	;
702)   30CA CD 9C 44    					CALL    FPP             ;ADD STEP	;ADD STEP
703)   30CD 38 4A       					JR      C,ERROR3	;
704)   30CF F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
705)   30D0 F5          					PUSH    AF	;
706)   30D1 CD 5E 35    					CALL    STORE           ;UPDATE VARIABLE	;UPDATE VARIABLE
707)   30D4 DD 21 0E 00 					LD      IX,12+2	;
708)   30D8 DD 39       					ADD     IX,SP	;
709)   30DA CD C5 3F    					CALL    DLOAD5          ;LIMIT	;LIMIT
710)   30DD F1          					POP     AF	;
711)   30DE CC 17 43    					CALL    Z,SWAP	;
712)   30E1 3E 08       					LD      A,0+('<'-4) AND 0FH	;
713)   30E3 CD 9C 44    					CALL    FPP             ;TEST AGAINST LIMIT	;TEST AGAINST LIMIT
714)   30E6 38 31       					JR      C,ERROR3	;
715)   30E8 24          					INC     H	;
716)   30E9 20 11       					JR      NZ,LOOP         ;KEEP LOOPING	;KEEP LOOPING
717)   30EB 21 12 00    					LD      HL,18	;
718)   30EE 39          					ADD     HL,SP	;
719)   30EF F9          					LD      SP,HL	;
720)   30F0 CD 78 44    					CALL    NXT	;
721)   30F3 FE 2C       					CP      ','	;
722)   30F5 C2 E8 2C    					JP      NZ,XEQ	;
723)   30F8 FD 23       					INC     IY	;
724)   30FA 18 9B       					JR      NEXT	;
726)   30FC C1          		LOOP:			POP     BC	;
727)   30FD D1          					POP     DE	;
728)   30FE FD E1       					POP     IY	;
729)   3100 FD E5       					PUSH    IY	;
730)   3102 D5          					PUSH    DE	;
731)   3103 C5          					PUSH    BC	;
732)   3104 C3 E8 2C    					JP      XEQ	;
734)   3107 21 12 00    		NEXT1:			LD      HL,18	;
735)   310A 39          					ADD     HL,SP	;
736)   310B F9          					LD      SP,HL           ;"POP" THE STACK	;"POP" THE STACK
737)   310C C1          					POP     BC	;
738)   310D 21 97 30    					LD      HL,FORCHK	;
739)   3110 ED 42       					SBC     HL,BC	;
740)   3112 E1          					POP     HL              ;VARIABLE POINTER	;VARIABLE POINTER
741)   3113 E5          					PUSH    HL	;
742)   3114 C5          					PUSH    BC	;
743)   3115 28 98       					JR      Z,NEXT0	;
744)   3117 3E 21       					LD      A,33	;
745)   3119 C3 DB 26    		ERROR3:			JP      ERROR           ;"Can't match FOR"	;"Can't match FOR"
750)   311C F5          		@FN:			PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
751)   311D CD 24 31    					CALL    PROC1	;
757)   3120 F5          		PROC:			PUSH    AF              ;MAKE SPACE ON STACK	;MAKE SPACE ON STACK
758)   3121 CD 24 31    					CALL    PROC1	;
760)   3124 CD BF 35    		PROC1::			CALL    CHECK	;
761)   3127 FD 2B       					DEC     IY	;
762)   3129 FD E5       					PUSH    IY	;
763)   312B CD DB 29    					CALL    GETDEF	;
764)   312E C1          					POP     BC	;
765)   312F 28 39       					JR      Z,PROC4	;
766)   3131 3E 1E       					LD      A,30	;
767)   3133 38 E4       					JR      C,ERROR3        ;"Bad call"	;"Bad call"
768)   3135 C5          					PUSH    BC	;
769)   3136 2A DC 82    					LD      HL,(PAGE)	;
770)   3139 3E DD       		PROC2:			LD      A,DEF	;
771)   313B CD 80 37    					CALL    SEARCH          ;LOOK FOR "DEF"	;LOOK FOR "DEF"
772)   313E 38 21       					JR      C,PROC3	;
773)   3140 E5          					PUSH    HL	;
774)   3141 FD E1       					POP     IY	;
775)   3143 FD 23       					INC     IY              ;SKIP DEF	;SKIP DEF
776)   3145 CD 78 44    					CALL    NXT	;
777)   3148 CD DB 29    					CALL    GETDEF	;
778)   314B FD E5       					PUSH    IY	;
779)   314D D1          					POP     DE	;
780)   314E 38 09       					JR      C,PROC6	;
781)   3150 C4 7D 2A    					CALL    NZ,CREATE	;
782)   3153 FD E5       					PUSH    IY	;
783)   3155 D1          					POP     DE	;
784)   3156 73          					LD      (HL),E	;
785)   3157 23          					INC     HL	;
786)   3158 72          					LD      (HL),D          ;SAVE ADDRESS	;SAVE ADDRESS
787)   3159 EB          		PROC6:			EX      DE,HL	;
788)   315A 3E 0D       					LD      A,CR	;
789)   315C 47          					LD      B,A	;
790)   315D ED B1       					CPIR                    ;SKIP TO END OF LINE	;SKIP TO END OF LINE
791)   315F 18 D8       					JR      PROC2	;
792)   3161 FD E1       		PROC3:			POP     IY              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
793)   3163 CD DB 29    					CALL    GETDEF	;
794)   3166 3E 1D       					LD      A,29	;
795)   3168 20 AF       					JR      NZ,ERROR3       ;"No such FN/PROC"	;"No such FN/PROC"
796)   316A 5E          		PROC4:			LD      E,(HL)	;
797)   316B 23          					INC     HL	;
798)   316C 56          					LD      D,(HL)          ;GET ADDRESS	;GET ADDRESS
799)   316D 21 02 00    					LD      HL,2	;
800)   3170 39          					ADD     HL,SP	;
801)   3171 CD 78 44    					CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
802)   3174 D5          					PUSH    DE              ;EXCHANGE DE,IY	;EXCHANGE DE,IY
803)   3175 FD E3       					EX      (SP),IY	;
804)   3177 D1          					POP     DE	;
805)   3178 FE 28       					CP      '('             ;ARGUMENTS?	;ARGUMENTS?
806)   317A 20 1B       					JR      NZ,PROC5	;
807)   317C CD 78 44    					CALL    NXT             ;ALLOW SPACE BEFORE (	;ALLOW SPACE BEFORE (
808)   317F FE 28       					CP      '('	;
809)   3181 C2 BF 2D    					JP      NZ,SYNTAX       ;"Syntax error"	;"Syntax error"
810)   3184 FD E5       					PUSH    IY	;
811)   3186 C1          					POP     BC              ;SAVE IY IN BC	;SAVE IY IN BC
812)   3187 D9          					EXX	;
813)   3188 CD 50 36    					CALL    SAVLOC          ;SAVE DUMMY VARIABLES	;SAVE DUMMY VARIABLES
814)   318B CD 3C 44    					CALL    BRAKET          ;CLOSING BRACKET	;CLOSING BRACKET
815)   318E D9          					EXX	;
816)   318F C5          					PUSH    BC	;
817)   3190 FD E1       					POP     IY              ;RESTORE IY	;RESTORE IY
818)   3192 E5          					PUSH    HL	;
819)   3193 CD DB 35    					CALL    ARGUE           ;TRANSFER ARGUMENTS	;TRANSFER ARGUMENTS
820)   3196 E1          					POP     HL	;
821)   3197 73          		PROC5:			LD      (HL),E          ;SAVE "RETURN ADDRESS"	;SAVE "RETURN ADDRESS"
822)   3198 23          					INC     HL	;
823)   3199 7E          					LD      A,(HL)	;
824)   319A 72          					LD      (HL),D	;
825)   319B FE EE       					CP      TON             ;WAS IT "ON PROC" ?	;WAS IT "ON PROC" ?
826)   319D C2 E8 2C    					JP      NZ,XEQ	;
827)   31A0 D5          					PUSH    DE	;
828)   31A1 FD E3       					EX      (SP),IY	;
829)   31A3 CD CE 36    					CALL    SPAN            ;SKIP REST OF ON LIST	;SKIP REST OF ON LIST
830)   31A6 FD E3       					EX      (SP),IY	;
831)   31A8 D1          					POP     DE	;
832)   31A9 72          					LD      (HL),D	;
833)   31AA 2B          					DEC     HL	;
834)   31AB 73          					LD      (HL),E	;
835)   31AC C3 E8 2C    					JP      XEQ	;
839)   31AF C1          		LOCAL:			POP     BC	;
840)   31B0 C5          					PUSH    BC	;
841)   31B1 21 20 31    					LD      HL,FNCHK	;
842)   31B4 B7          					OR      A	;
843)   31B5 ED 42       					SBC     HL,BC	;
844)   31B7 28 13       					JR      Z,LOCAL1	;
845)   31B9 21 24 31    					LD      HL,PROCHK	;
846)   31BC B7          					OR      A	;
847)   31BD ED 42       					SBC     HL,BC	;
848)   31BF 28 0B       					JR      Z,LOCAL1	;
849)   31C1 21 A2 36    					LD      HL,LOCCHK	;
850)   31C4 B7          					OR      A	;
851)   31C5 ED 42       					SBC     HL,BC	;
852)   31C7 3E 0C       					LD      A,12	;
853)   31C9 C2 DB 26    					JP      NZ,ERROR        ;"Not LOCAL"	;"Not LOCAL"
854)   31CC FD E5       		LOCAL1:			PUSH    IY	;
855)   31CE C1          					POP     BC	;
856)   31CF D9          					EXX	;
857)   31D0 FD 2B       					DEC     IY	;
858)   31D2 CD 50 36    					CALL    SAVLOC	;
859)   31D5 D9          					EXX	;
860)   31D6 C5          					PUSH    BC	;
861)   31D7 FD E1       					POP     IY	;
862)   31D9 CD 3F 29    		LOCAL2:			CALL    GETVAR	;
863)   31DC C2 BF 2D    					JP      NZ,SYNTAX	;
864)   31DF B7          					OR      A               ;TYPE	;TYPE
865)   31E0 08          					EX      AF,AF'	;
866)   31E1 CD BE 43    					CALL    ZERO	;
867)   31E4 08          					EX      AF,AF'	;
868)   31E5 F5          					PUSH    AF	;
869)   31E6 F4 5E 35    					CALL    P,STORE         ;ZERO	;ZERO
870)   31E9 F1          					POP     AF	;
871)   31EA 59          					LD      E,C	;
872)   31EB FC 8A 35    					CALL    M,STORES	;
873)   31EE CD 78 44    					CALL    NXT	;
874)   31F1 FE 2C       					CP      ','	;
875)   31F3 C2 E8 2C    					JP      NZ,XEQ	;
876)   31F6 FD 23       					INC     IY	;
877)   31F8 CD 78 44    					CALL    NXT	;
878)   31FB 18 DC       					JR      LOCAL2	;
882)   31FD C1          		ENDPRO:			POP     BC	;
883)   31FE 21 A2 36    					LD      HL,LOCCHK	;
884)   3201 B7          					OR      A	;
885)   3202 ED 42       					SBC     HL,BC	;
886)   3204 28 10       					JR      Z,UNSTK         ;LOCAL VARIABLE	;LOCAL VARIABLE
887)   3206 21 24 31    					LD      HL,PROCHK       ;PROC MARKER	;PROC MARKER
888)   3209 B7          					OR      A	;
889)   320A ED 42       					SBC     HL,BC	;
890)   320C FD E1       					POP     IY	;
891)   320E CA E8 2C    					JP      Z,XEQ	;
892)   3211 3E 0D       					LD      A,13	;
893)   3213 C3 DB 26    					JP      ERROR           ;"No PROC"	;"No PROC"
895)   3216 DD E1       		UNSTK:			POP     IX	;
896)   3218 C1          					POP     BC	;
897)   3219 78          					LD      A,B	;
898)   321A B7          					OR      A	;
899)   321B FA 27 32    					JP      M,UNSTK1        ;STRING	;STRING
900)   321E E1          					POP     HL	;
901)   321F D9          					EXX	;
902)   3220 E1          					POP     HL	;
903)   3221 D9          					EXX	;
904)   3222 CD 5E 35    					CALL    STORE	;
905)   3225 18 D6       					JR      ENDPRO	;
906)   3227 21 00 00    		UNSTK1:			LD      HL,0	;
907)   322A 39          					ADD     HL,SP	;
908)   322B 59          					LD      E,C	;
909)   322C CD 8A 35    					CALL    STORES	;
910)   322F F9          					LD      SP,HL	;
911)   3230 18 CB       					JR      ENDPRO	;
915)   3232 CD C1 37    		INPUTN:			CALL    CHNL            ;E = CHANNEL NUMBER	;E = CHANNEL NUMBER
916)   3235 CD 78 44    		INPN1:			CALL    NXT	;
917)   3238 FE 2C       					CP      ','	;
918)   323A C2 E8 2C    					JP      NZ,XEQ	;
919)   323D FD 23       					INC     IY	;
920)   323F CD 78 44    					CALL    NXT	;
921)   3242 D5          					PUSH    DE	;
922)   3243 CD B8 2D    					CALL    VAR	;
923)   3246 D1          					POP     DE	;
924)   3247 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
925)   3248 E5          					PUSH    HL              ;VARPTR	;VARPTR
926)   3249 B7          					OR      A	;
927)   324A FA 6F 32    					JP      M,INPN2         ;STRING	;STRING
928)   324D CD 27 01    					CALL    OSBGET	;
929)   3250 D9          					EXX	;
930)   3251 6F          					LD      L,A	;
931)   3252 D9          					EXX	;
932)   3253 CD 27 01    					CALL    OSBGET	;
933)   3256 D9          					EXX	;
934)   3257 67          					LD      H,A	;
935)   3258 D9          					EXX	;
936)   3259 CD 27 01    					CALL    OSBGET	;
937)   325C 6F          					LD      L,A	;
938)   325D CD 27 01    					CALL    OSBGET	;
939)   3260 67          					LD      H,A	;
940)   3261 CD 27 01    					CALL    OSBGET	;
941)   3264 4F          					LD      C,A	;
942)   3265 DD E1       					POP     IX	;
943)   3267 F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
944)   3268 D5          					PUSH    DE              ;SAVE CHANNEL	;SAVE CHANNEL
945)   3269 CD 5E 35    					CALL    STORE	;
946)   326C D1          					POP     DE	;
947)   326D 18 C6       					JR      INPN1	;
948)   326F 21 00 80    		INPN2:			LD      HL,ACCS	;
949)   3272 CD 27 01    		INPN3:			CALL    OSBGET	;
950)   3275 FE 0D       					CP      CR	;
951)   3277 28 04       					JR      Z,INPN4	;
952)   3279 77          					LD      (HL),A	;
953)   327A 2C          					INC     L	;
954)   327B 20 F5       					JR      NZ,INPN3	;
955)   327D DD E1       		INPN4:			POP     IX	;
956)   327F F1          					POP     AF	;
957)   3280 D5          					PUSH    DE	;
958)   3281 EB          					EX      DE,HL	;
959)   3282 CD 87 35    					CALL    STACCS	;
960)   3285 D1          					POP     DE	;
961)   3286 18 AD       					JR      INPN1	;
966)   3288 FE 23       		INPUT:			CP      '#'	;
967)   328A 28 A6       					JR      Z,INPUTN	;
968)   328C 0E 00       					LD      C,0             ;FLAG PROMPT	;FLAG PROMPT
969)   328E FE 86       					CP      LINE	;
970)   3290 20 04       					JR      NZ,INPUT0	;
971)   3292 FD 23       					INC     IY              ;SKIP "LINE"	;SKIP "LINE"
972)   3294 0E 80       					LD      C,80H	;
973)   3296 21 00 81    		INPUT0:			LD      HL,BUFFER	;
974)   3299 36 0D       					LD      (HL),CR         ;INITIALISE EMPTY	;INITIALISE EMPTY
975)   329B CD C2 36    		INPUT1:			CALL    TERM?	;
976)   329E CA E8 2C    					JP      Z,XEQ           ;DONE	;DONE
977)   32A1 FD 23       					INC     IY	;
978)   32A3 FE 2C       					CP      ','	;
979)   32A5 28 51       					JR      Z,INPUT3        ;SKIP COMMA	;SKIP COMMA
980)   32A7 FE 3B       					CP      ';'	;
981)   32A9 28 4D       					JR      Z,INPUT3	;
982)   32AB E5          					PUSH    HL              ;SAVE BUFFER POINTER	;SAVE BUFFER POINTER
983)   32AC FE 22       					CP      34		;ASCII ""	;ASCII ""
984)   32AE 20 0A       					JR      NZ,INPUT6	;
985)   32B0 C5          					PUSH    BC	;
986)   32B1 CD 8F 3F    					CALL    CONS	;
987)   32B4 C1          					POP     BC	;
988)   32B5 CD 38 37    					CALL    PTEXT           ;PRINT PROMPT	;PRINT PROMPT
989)   32B8 18 05       					JR      INPUT9	;
990)   32BA CD E3 36    		INPUT6:			CALL    FORMAT          ;SPC, TAB, '	;SPC, TAB, '
991)   32BD 20 05       					JR      NZ,INPUT2	;
992)   32BF E1          		INPUT9:			POP     HL	;
993)   32C0 CB C1       					SET     0,C             ;FLAG NO PROMPT	;FLAG NO PROMPT
994)   32C2 18 D2       					JR      INPUT0	;
995)   32C4 FD 2B       		INPUT2:			DEC     IY	;
996)   32C6 C5          					PUSH    BC	;
997)   32C7 CD B8 2D    					CALL    VAR	;
998)   32CA C1          					POP     BC	;
999)   32CB E1          					POP     HL	;
1000)   32CC F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1001)   32CD 7E          					LD      A,(HL)	;
1002)   32CE 23          					INC     HL	;
1003)   32CF FE 0D       					CP      CR              ;BUFFER EMPTY?	;BUFFER EMPTY?
1004)   32D1 CC FC 32    					CALL    Z,REFILL	;
1005)   32D4 CB 79       					BIT     7,C	;
1006)   32D6 F5          					PUSH    AF	;
1007)   32D7 C4 56 37    					CALL    NZ,LINES	;
1008)   32DA F1          					POP     AF	;
1009)   32DB CC 45 37    					CALL    Z,FETCHS	;
1010)   32DE F1          					POP     AF              ;RESTORE TYPE	;RESTORE TYPE
1011)   32DF C5          					PUSH    BC	;
1012)   32E0 E5          					PUSH    HL	;
1013)   32E1 B7          					OR      A	;
1014)   32E2 FA F3 32    					JP      M,INPUT4        ;STRING	;STRING
1015)   32E5 F5          					PUSH    AF	;
1016)   32E6 DD E5       					PUSH    IX	;
1017)   32E8 CD 46 41    					CALL    VAL0	;
1018)   32EB DD E1       					POP     IX	;
1019)   32ED F1          					POP     AF	;
1020)   32EE CD 5E 35    					CALL    STORE	;
1021)   32F1 18 03       					JR      INPUT5	;
1022)   32F3 CD 87 35    		INPUT4:			CALL    STACCS	;
1023)   32F6 E1          		INPUT5:			POP     HL	;
1024)   32F7 C1          					POP     BC	;
1025)   32F8 CB 81       		INPUT3:			RES     0,C	;
1026)   32FA 18 9F       					JR      INPUT1	;
1028)   32FC CB 41       		REFILL:			BIT     0,C	;
1029)   32FE 20 0A       					JR      NZ,REFIL0       ;NO PROMPT	;NO PROMPT
1030)   3300 3E 3F       					LD      A,'?'	;
1031)   3302 CD 74 28    					CALL    OUTCHR          ;PROMPT	;PROMPT
1032)   3305 3E 20       					LD      A,' '	;
1033)   3307 CD 74 28    					CALL    OUTCHR	;
1034)   330A 21 00 81    		REFIL0:			LD      HL,BUFFER	;
1035)   330D C5          					PUSH    BC	;
1036)   330E E5          					PUSH    HL	;
1037)   330F DD E5       					PUSH    IX	;
1038)   3311 CD 1E 01    					CALL    OSLINE	;
1039)   3314 DD E1       					POP     IX	;
1040)   3316 E1          					POP     HL	;
1041)   3317 C1          					POP     BC	;
1042)   3318 47          					LD      B,A             ;POS AT ENTRY	;POS AT ENTRY
1043)   3319 AF          					XOR     A	;
1044)   331A 32 FB 82    					LD      (COUNT),A	;
1045)   331D B8          					CP      B	;
1046)   331E C8          					RET     Z	;
1047)   331F 7E          		REFIL1:			LD      A,(HL)	;
1048)   3320 FE 0D       					CP      CR	;
1049)   3322 C8          					RET     Z	;
1050)   3323 23          					INC     HL	;
1051)   3324 10 F9       					DJNZ    REFIL1	;
1052)   3326 C9          					RET	;
1056)   3327 FE 23       		READ:			CP      '#'	;
1057)   3329 CA 32 32    					JP      Z,INPUTN	;
1058)   332C 2A F0 82    					LD      HL,(DATPTR)	;
1059)   332F 7E          		READ0:			LD      A,(HL)	;
1060)   3330 23          					INC     HL              ;SKIP COMMA OR "DATA"	;SKIP COMMA OR "DATA"
1061)   3331 FE 0D       					CP      CR              ;END OF DATA STMT?	;END OF DATA STMT?
1062)   3333 CC 6C 33    					CALL    Z,GETDAT	;
1063)   3336 E5          					PUSH    HL	;
1064)   3337 CD B8 2D    					CALL    VAR	;
1065)   333A E1          					POP     HL	;
1066)   333B B7          					OR      A	;
1067)   333C FA 52 33    					JP      M,READ1         ;STRING	;STRING
1068)   333F E5          					PUSH    HL	;
1069)   3340 FD E3       					EX      (SP),IY	;
1070)   3342 F5          					PUSH    AF              ;SAVE TYPE	;SAVE TYPE
1071)   3343 DD E5       					PUSH    IX	;
1072)   3345 CD 8D 3E    					CALL    EXPRN	;
1073)   3348 DD E1       					POP     IX	;
1074)   334A F1          					POP     AF	;
1075)   334B CD 5E 35    					CALL    STORE	;
1076)   334E FD E3       					EX      (SP),IY	;
1077)   3350 18 07       					JR      READ2	;
1078)   3352 CD 45 37    		READ1:			CALL    FETCHS	;
1079)   3355 E5          					PUSH    HL	;
1080)   3356 CD 87 35    					CALL    STACCS	;
1081)   3359 E1          		READ2:			POP     HL	;
1082)   335A 22 F0 82    					LD      (DATPTR),HL	;
1083)   335D CD 78 44    					CALL    NXT	;
1084)   3360 FE 2C       					CP      ','	;
1085)   3362 C2 E8 2C    					JP      NZ,XEQ	;
1086)   3365 FD 23       					INC     IY	;
1087)   3367 CD 78 44    					CALL    NXT	;
1088)   336A 18 C3       					JR      READ0	;
1090)   336C 3E DC       		GETDAT:			LD      A,DATA	;
1091)   336E CD 80 37    					CALL    SEARCH	;
1092)   3371 23          					INC     HL	;
1093)   3372 D0          					RET     NC	;
1094)   3373 3E 2A       					LD      A,42	;
1095)   3375 C3 DB 26    		ERROR4:			JP      ERROR           ;"Out of DATA"	;"Out of DATA"
1101)   3378 CD 94 3E    		IF:			CALL    EXPRI	;
1102)   337B CD 1F 43    					CALL    TEST	;
1103)   337E 28 15       					JR      Z,IFNOT         ;FALSE	;FALSE
1104)   3380 FD 7E 00    					LD      A,(IY)	;
1105)   3383 FE 8C       					CP      THEN	;
1106)   3385 C2 E8 2C    					JP      NZ,XEQ	;
1107)   3388 FD 23       					INC     IY              ;SKIP "THEN"	;SKIP "THEN"
1108)   338A CD 78 44    		IF1:			CALL    NXT	;
1109)   338D FE 8D       					CP      LINO	;
1110)   338F C2 E8 2C    					JP      NZ,XEQ          ;STATEMENT FOLLOWS	;STATEMENT FOLLOWS
1111)   3392 C3 F6 2F    					JP      GOTO            ;LINE NO. FOLLOWS	;LINE NO. FOLLOWS
1112)   3395 FD 7E 00    		IFNOT:			LD      A,(IY)	;
1113)   3398 FE 0D       					CP      CR	;
1114)   339A FD 23       					INC     IY	;
1115)   339C CA E5 2C    					JP      Z,XEQ0          ;END OF LINE	;END OF LINE
1116)   339F FE 8B       					CP      ELSE	;
1117)   33A1 20 F2       					JR      NZ,IFNOT	;
1118)   33A3 18 E5       					JR      IF1	;
1122)   33A5 CD 00 01    		CLS:			CALL    CLRSCN	;
1123)   33A8 AF          					XOR     A	;
1124)   33A9 32 FB 82    					LD      (COUNT),A	;
1125)   33AC C3 E8 2C    					JP      XEQ	;
1129)   33AF CD 2B 2C    		STOP:			CALL    TELL	;
1130)   33B2 0D          					DEFB    CR	;
1131)   33B3 0A          					DEFB    LF	;
1132)   33B4 FA          					DEFB    TSTOP	;
1133)   33B5 00          					DEFB    0	;
1134)   33B6 CD C4 28    					CALL    SETLIN          ;FIND CURRENT LINE	;FIND CURRENT LINE
1135)   33B9 CD EE 28    					CALL    SAYLN	;
1136)   33BC CD 6D 28    					CALL    CRLF	;
1137)   33BF C3 6F 20    					JP      CLOOP	;
1141)   33C2 CD 1F 2C    		REPOR:			CALL    REPORT	;
1142)   33C5 C3 E8 2C    					JP      XEQ	;
1146)   33C8 CD CC 27    		CLR:			CALL    CLEAR	;
1147)   33CB 2A DC 82    					LD      HL,(PAGE)	;
1148)   33CE 18 13       					JR      RESTR1	;
1152)   33D0 2A DC 82    		RESTOR:			LD      HL,(PAGE)	;
1153)   33D3 CD C2 36    					CALL    TERM?	;
1154)   33D6 28 0B       					JR      Z,RESTR1	;
1155)   33D8 CD AB 3E    					CALL    ITEMI	;
1156)   33DB D9          					EXX	;
1157)   33DC CD AB 28    					CALL    FINDL           ;SEARCH FOR LINE	;SEARCH FOR LINE
1158)   33DF 3E 29       					LD      A,41	;
1159)   33E1 20 92       					JR      NZ,ERROR4       ;"No such line"	;"No such line"
1160)   33E3 3E DC       		RESTR1:			LD      A,DATA	;
1161)   33E5 CD 80 37    					CALL    SEARCH	;
1162)   33E8 22 F0 82    					LD      (DATPTR),HL	;
1163)   33EB C3 E8 2C    					JP      XEQ	;
1171)   33EE CD B7 37    		PTR:			CALL    CHANEL	;
1172)   33F1 CD D6 36    					CALL    EQUALS	;
1173)   33F4 7B          					LD      A,E	;
1174)   33F5 F5          					PUSH    AF	;
1175)   33F6 CD 94 3E    					CALL    EXPRI	;
1176)   33F9 E5          					PUSH    HL	;
1177)   33FA D9          					EXX	;
1178)   33FB D1          					POP     DE	;
1179)   33FC F1          					POP     AF	;
1180)   33FD CD 3F 01    					CALL    PUTPTR	;
1181)   3400 C3 E8 2C    					JP      XEQ	;
1183)   3403 CD D6 36    		PAGEV:			CALL    EQUALS	;
1184)   3406 CD 94 3E    					CALL    EXPRI	;
1185)   3409 D9          					EXX	;
1186)   340A 2E 00       					LD      L,0	;
1187)   340C 22 DC 82    					LD      (PAGE),HL	;
1188)   340F C3 E8 2C    					JP      XEQ	;
1190)   3412 FE 24       		TIMEV:			CP      '$'	;
1191)   3414 28 0F       					JR      Z,TIMEVS	;
1192)   3416 CD D6 36    					CALL    EQUALS	;
1193)   3419 CD 94 3E    					CALL    EXPRI	;
1194)   341C E5          					PUSH    HL	;
1195)   341D D9          					EXX	;
1196)   341E D1          					POP     DE	;
1197)   341F CD 03 01    					CALL    PUTIME	;
1198)   3422 C3 E8 2C    					JP      XEQ	;
1200)   3425 FD 23       		TIMEVS:			INC     IY              ;SKIP '$'	;SKIP '$'
1201)   3427 CD D6 36    					CALL    EQUALS	;
1202)   342A CD 9D 3E    					CALL    EXPRS	;
1203)   342D CD 72 01    					CALL    PUTIMS	;
1204)   3430 C3 E8 2C    					JP      XEQ	;
1206)   3433 CD D6 36    		LOMEMV:			CALL    EQUALS	;
1207)   3436 CD 94 3E    					CALL    EXPRI	;
1208)   3439 CD CC 27    					CALL    CLEAR	;
1209)   343C D9          					EXX	;
1210)   343D 22 E0 82    					LD      (LOMEM),HL	;
1211)   3440 22 E2 82    					LD      (FREE),HL	;
1212)   3443 C3 E8 2C    					JP      XEQ	;
1214)   3446 CD D6 36    		HIMEMV:			CALL    EQUALS	;
1215)   3449 CD 94 3E    					CALL    EXPRI	;
1216)   344C D9          					EXX	;
1217)   344D ED 5B E2 82 					LD      DE,(FREE)	;
1218)   3451 14          					INC     D	;
1219)   3452 AF          					XOR     A	;
1220)   3453 ED 52       					SBC     HL,DE	;
1221)   3455 19          					ADD     HL,DE	;
1222)   3456 DA DB 26    					JP      C,ERROR         ;"No room"	;"No room"
1223)   3459 ED 5B E4 82 					LD      DE,(HIMEM)	;
1224)   345D 22 E4 82    					LD      (HIMEM),HL	;
1225)   3460 EB          					EX      DE,HL	;
1226)   3461 ED 72       					SBC     HL,SP	;
1227)   3463 C2 E8 2C    					JP      NZ,XEQ	;
1228)   3466 EB          					EX      DE,HL	;
1229)   3467 F9          					LD      SP,HL           ;LOAD STACK POINTER	;LOAD STACK POINTER
1230)   3468 C3 E8 2C    					JP      XEQ	;
1234)   346B CD 94 3E    		WIDTHV:			CALL    EXPRI	;
1235)   346E D9          					EXX	;
1236)   346F 7D          					LD      A,L	;
1237)   3470 32 FC 82    					LD      (WIDTH),A	;
1238)   3473 C3 E8 2C    					JP      XEQ	;
1244)   3476 FD 23       		TRACE:			INC     IY	;
1245)   3478 21 00 00    					LD      HL,0	;
1246)   347B FE EE       					CP      TON	;
1247)   347D 28 0A       					JR      Z,TRACE0	;
1248)   347F FE 87       					CP      OFF	;
1249)   3481 28 07       					JR      Z,TRACE1	;
1250)   3483 FD 2B       					DEC     IY	;
1251)   3485 CD 94 3E    					CALL    EXPRI	;
1252)   3488 D9          					EXX	;
1253)   3489 2B          		TRACE0:			DEC     HL	;
1254)   348A 22 E8 82    		TRACE1:			LD      (TRACEN),HL	;
1255)   348D C3 E8 2C    					JP      XEQ	;
1259)   3490 CD 94 3E    		VDU:			CALL    EXPRI	;
1260)   3493 D9          					EXX	;
1261)   3494 7D          					LD      A,L	;
1262)   3495 CD 15 01    					CALL    OSWRCH	;
1263)   3498 FD 7E 00    					LD      A,(IY)	;
1264)   349B FE 2C       					CP      ','	;
1265)   349D 28 08       					JR      Z,VDU2	;
1266)   349F FE 3B       					CP      ';'	;
1267)   34A1 20 06       					JR      NZ,VDU3	;
1268)   34A3 7C          					LD      A,H	;
1269)   34A4 CD 15 01    					CALL    OSWRCH	;
1270)   34A7 FD 23       		VDU2:			INC     IY	;
1271)   34A9 CD C2 36    		VDU3:			CALL    TERM?	;
1272)   34AC 20 E2       					JR      NZ,VDU	;
1273)   34AE C3 E8 2C    					JP      XEQ	;
1277)   34B1 CD B7 37    		CLOSE:			CALL    CHANEL	;
1278)   34B4 CD 2D 01    					CALL    OSSHUT	;
1279)   34B7 C3 E8 2C    					JP      XEQ	;
1283)   34BA CD B7 37    		BPUT:			CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
1284)   34BD D5          					PUSH    DE	;
1285)   34BE CD 30 44    					CALL    COMMA	;
1286)   34C1 CD 94 3E    					CALL    EXPRI           ;BYTE	;BYTE
1287)   34C4 D9          					EXX	;
1288)   34C5 7D          					LD      A,L	;
1289)   34C6 D1          					POP     DE	;
1290)   34C7 CD 24 01    					CALL    OSBPUT	;
1291)   34CA C3 E8 2C    					JP      XEQ	;
1295)   34CD CD 94 3E    		CALL:			CALL    EXPRI           ;ADDRESS	;ADDRESS
1296)   34D0 D9          					EXX	;
1297)   34D1 E5          					PUSH    HL              ;SAVE IT	;SAVE IT
1298)   34D2 06 00       					LD      B,0             ;PARAMETER COUNTER	;PARAMETER COUNTER
1299)   34D4 11 00 81    					LD      DE,BUFFER       ;VECTOR	;VECTOR
1300)   34D7 CD 78 44    		CALL1:			CALL    NXT	;
1301)   34DA FE 2C       					CP      ','	;
1302)   34DC 20 17       					JR      NZ,CALL2	;
1303)   34DE FD 23       					INC     IY	;
1304)   34E0 04          					INC     B	;
1305)   34E1 CD 78 44    					CALL    NXT	;
1306)   34E4 C5          					PUSH    BC	;
1307)   34E5 D5          					PUSH    DE	;
1308)   34E6 CD B8 2D    					CALL    VAR	;
1309)   34E9 D1          					POP     DE	;
1310)   34EA C1          					POP     BC	;
1311)   34EB 13          					INC     DE	;
1312)   34EC 12          					LD      (DE),A          ;PARAMETER TYPE	;PARAMETER TYPE
1313)   34ED 13          					INC     DE	;
1314)   34EE EB          					EX      DE,HL	;
1315)   34EF 73          					LD      (HL),E          ;PARAMETER ADDRESS	;PARAMETER ADDRESS
1316)   34F0 23          					INC     HL	;
1317)   34F1 72          					LD      (HL),D	;
1318)   34F2 EB          					EX      DE,HL	;
1319)   34F3 18 E2       					JR      CALL1	;
1320)   34F5 78          		CALL2:			LD      A,B	;
1321)   34F6 32 00 81    					LD      (BUFFER),A      ;PARAMETER COUNT	;PARAMETER COUNT
1322)   34F9 E1          					POP     HL              ;RESTORE ADDRESS	;RESTORE ADDRESS
1323)   34FA CD 04 35    					CALL    USR1	;
1324)   34FD C3 E8 2C    					JP      XEQ	;
1328)   3500 CD AB 3E    		@USR:			CALL    ITEMI	;
1329)   3503 D9          					EXX	;
1330)   3504 E5          		USR1:			PUSH    HL              ;ADDRESS ON STACK	;ADDRESS ON STACK
1331)   3505 FD E3       					EX      (SP),IY	;
1332)   3507 24          					INC     H               ;PAGE &FF?	;PAGE &FF?
1333)   3508 21 33 35    					LD      HL,USR2         ;RETURN ADDRESS	;RETURN ADDRESS
1334)   350B E5          					PUSH    HL	;
1335)   350C DD 21 00 82 					LD      IX,STAVAR	;
1336)   3510 CC 33 01    					CALL    Z,OSCALL        ;INTERCEPT PAGE &FF	;INTERCEPT PAGE &FF
1337)   3513 DD 4E 18    					LD      C,(IX+24)	;
1338)   3516 C5          					PUSH    BC	;
1339)   3517 F1          					POP     AF              ;LOAD FLAGS	;LOAD FLAGS
1340)   3518 DD 7E 04    					LD      A,(IX+4)        ;LOAD Z80 REGISTERS	;LOAD Z80 REGISTERS
1341)   351B DD 46 08    					LD      B,(IX+8)	;
1342)   351E DD 4E 0C    					LD      C,(IX+12)	;
1343)   3521 DD 56 10    					LD      D,(IX+16)	;
1344)   3524 DD 5E 14    					LD      E,(IX+20)	;
1345)   3527 DD 66 20    					LD      H,(IX+32)	;
1346)   352A DD 6E 30    					LD      L,(IX+48)	;
1347)   352D DD 21 00 81 					LD      IX,BUFFER	;
1348)   3531 FD E9       					JP      (IY)            ;OFF TO USER ROUTINE	;OFF TO USER ROUTINE
1349)   3533 FD E1       		USR2:			POP     IY	;
1350)   3535 AF          					XOR     A	;
1351)   3536 4F          					LD      C,A	;
1352)   3537 C9          					RET	;
1356)   3538 CD 94 3E    		PUT:			CALL    EXPRI           ;PORT ADDRESS	;PORT ADDRESS
1357)   353B D9          					EXX	;
1358)   353C E5          					PUSH    HL	;
1359)   353D CD 30 44    					CALL    COMMA	;
1360)   3540 CD 94 3E    					CALL    EXPRI           ;DATA	;DATA
1361)   3543 D9          					EXX	;
1362)   3544 C1          					POP     BC	;
1363)   3545 ED 69       					OUT     (C),L           ;OUTPUT TO PORT BC	;OUTPUT TO PORT BC
1364)   3547 C3 E8 2C    					JP      XEQ	;
1373)   354A CD 3F 29    		ASSIGN:			CALL    GETVAR          ;VARIABLE	;VARIABLE
1374)   354D D8          					RET     C               ;ILLEGAL VARIABLE	;ILLEGAL VARIABLE
1375)   354E C4 30 29    					CALL    NZ,PUTVAR	;
1376)   3551 B7          					OR      A	;
1377)   3552 F8          					RET     M               ;STRING VARIABLE	;STRING VARIABLE
1378)   3553 F5          					PUSH    AF              ;NUMERIC TYPE	;NUMERIC TYPE
1379)   3554 CD D6 36    					CALL    EQUALS	;
1380)   3557 E5          					PUSH    HL	;
1381)   3558 CD 8D 3E    					CALL    EXPRN	;
1382)   355B DD E1       					POP     IX	;
1383)   355D F1          					POP     AF	;
1384)   355E CB 47       		STORE:			BIT     0,A	;
1385)   3560 28 13       					JR      Z,STOREI	;
1386)   3562 BF          					CP      A               ;SET ZERO	;SET ZERO
1387)   3563 DD 71 04    		@STORE5:		LD      (IX+4),C	;
1388)   3566 D9          		@STORE4:		EXX	;
1389)   3567 DD 75 00    					LD      (IX+0),L	;
1390)   356A DD 74 01    					LD      (IX+1),H	;
1391)   356D D9          					EXX	;
1392)   356E DD 75 02    					LD      (IX+2),L	;
1393)   3571 DD 74 03    					LD      (IX+3),H	;
1394)   3574 C9          					RET	;
1395)   3575 F5          		STOREI:			PUSH    AF	;
1396)   3576 0C          					INC     C               ;SPEED - & PRESERVE F'	;SPEED - & PRESERVE F'
1397)   3577 0D          					DEC     C               ; WHEN CALLED BY FNEND0	; WHEN CALLED BY FNEND0
1398)   3578 C4 3B 41    					CALL    NZ,SFIX         ;CONVERT TO INTEGER	;CONVERT TO INTEGER
1399)   357B F1          					POP     AF	;
1400)   357C FE 04       					CP      4	;
1401)   357E 28 E6       					JR      Z,STORE4	;
1402)   3580 BF          					CP      A               ;SET ZERO	;SET ZERO
1403)   3581 D9          		STORE1:			EXX	;
1404)   3582 DD 75 00    					LD      (IX+0),L	;
1405)   3585 D9          					EXX	;
1406)   3586 C9          					RET	;
1408)   3587 21 00 80    		STACCS:			LD      HL,ACCS	;
1409)   358A 1F          		STORES:			RRA	;
1410)   358B 30 3F       					JR      NC,STORS3       ;FIXED STRING	;FIXED STRING
1411)   358D E5          					PUSH    HL	;
1412)   358E CD 59 3F    					CALL    LOAD4	;
1413)   3591 7B          					LD      A,E             ;LENGTH OF STRING	;LENGTH OF STRING
1414)   3592 D9          					EXX	;
1415)   3593 6F          					LD      L,A	;
1416)   3594 7C          					LD      A,H             ;LENGTH ALLOCATED	;LENGTH ALLOCATED
1417)   3595 D9          					EXX	;
1418)   3596 BB          					CP      E	;
1419)   3597 30 14       					JR      NC,STORS1       ;ENOUGH ROOM	;ENOUGH ROOM
1420)   3599 D9          					EXX	;
1421)   359A 65          					LD      H,L	;
1422)   359B D9          					EXX	;
1423)   359C E5          					PUSH    HL	;
1424)   359D 06 00       					LD      B,0	;
1425)   359F 4F          					LD      C,A	;
1426)   35A0 09          					ADD     HL,BC	;
1427)   35A1 ED 4B E2 82 					LD      BC,(FREE)	;
1428)   35A5 ED 42       					SBC     HL,BC           ;IS STRING LAST?	;IS STRING LAST?
1429)   35A7 E1          					POP     HL	;
1430)   35A8 37          					SCF	;
1431)   35A9 28 02       					JR      Z,STORS1	;
1432)   35AB 60          					LD      H,B	;
1433)   35AC 69          					LD      L,C	;
1434)   35AD CD 66 35    		STORS1:			CALL    STORE4          ;PRESERVES CARRY!	;PRESERVES CARRY!
1435)   35B0 06 00       					LD      B,0	;
1436)   35B2 4B          					LD      C,E	;
1437)   35B3 EB          					EX      DE,HL	;
1438)   35B4 E1          					POP     HL	;
1439)   35B5 0D          					DEC     C	;
1440)   35B6 0C          					INC     C	;
1441)   35B7 C8          					RET     Z               ;NULL STRING	;NULL STRING
1442)   35B8 ED B0       					LDIR	;
1443)   35BA D0          					RET     NC              ;STRING REPLACED	;STRING REPLACED
1444)   35BB ED 53 E2 82 					LD      (FREE),DE	;
1445)   35BF E5          		@CHECK:			PUSH    HL	;
1446)   35C0 2A E2 82    					LD      HL,(FREE)	;
1447)   35C3 24          					INC     H	;
1448)   35C4 ED 72       					SBC     HL,SP	;
1449)   35C6 E1          					POP     HL	;
1450)   35C7 D8          					RET     C	;
1451)   35C8 AF          					XOR     A	;
1452)   35C9 C3 DB 26    					JP      ERROR           ;"No room"	;"No room"
1454)   35CC 4B          		STORS3:			LD      C,E	;
1455)   35CD DD E5       					PUSH    IX	;
1456)   35CF D1          					POP     DE	;
1457)   35D0 AF          					XOR     A	;
1458)   35D1 47          					LD      B,A	;
1459)   35D2 B9          					CP      C	;
1460)   35D3 28 02       					JR      Z,STORS5	;
1461)   35D5 ED B0       					LDIR	;
1462)   35D7 3E 0D       		STORS5:			LD      A,CR	;
1463)   35D9 12          					LD      (DE),A	;
1464)   35DA C9          					RET	;
1475)   35DB 3E FF       		ARGUE:			LD      A,-1	;
1476)   35DD F5          					PUSH    AF              ;PUT MARKER ON STACK	;PUT MARKER ON STACK
1477)   35DE FD 23       		ARGUE1:			INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1478)   35E0 13          					INC     DE	;
1479)   35E1 D5          					PUSH    DE	;
1480)   35E2 CD 78 44    					CALL    NXT	;
1481)   35E5 CD 3F 29    					CALL    GETVAR	;
1482)   35E8 38 38       					JR      C,ARGERR	;
1483)   35EA C4 30 29    					CALL    NZ,PUTVAR	;
1484)   35ED D1          					POP     DE	;
1485)   35EE E5          					PUSH    HL              ;VARPTR	;VARPTR
1486)   35EF B7          					OR      A               ;TYPE	;TYPE
1487)   35F0 F5          					PUSH    AF	;
1488)   35F1 D5          					PUSH    DE	;
1489)   35F2 FD E3       					EX      (SP),IY	;
1490)   35F4 FA 09 36    					JP      M,ARGUE2        ;STRING	;STRING
1491)   35F7 CD 8D 3E    					CALL    EXPRN           ;PARAMETER VALUE	;PARAMETER VALUE
1492)   35FA FD E3       					EX      (SP),IY	;
1493)   35FC D1          					POP     DE	;
1494)   35FD F1          					POP     AF	;
1495)   35FE D9          					EXX	;
1496)   35FF E5          					PUSH    HL	;
1497)   3600 D9          					EXX	;
1498)   3601 E5          					PUSH    HL	;
1499)   3602 47          					LD      B,A	;
1500)   3603 C5          					PUSH    BC	;
1501)   3604 CD BF 35    					CALL    CHECK           ;CHECK ROOM	;CHECK ROOM
1502)   3607 18 0D       					JR      ARGUE4	;
1503)   3609 CD 9D 3E    		ARGUE2:			CALL    EXPRS	;
1504)   360C FD E3       					EX      (SP),IY	;
1505)   360E D9          					EXX	;
1506)   360F D1          					POP     DE	;
1507)   3610 D9          					EXX	;
1508)   3611 F1          					POP     AF	;
1509)   3612 CD DF 43    					CALL    PUSHS	;
1510)   3615 D9          					EXX	;
1511)   3616 CD 78 44    		ARGUE4:			CALL    NXT	;
1512)   3619 FE 2C       					CP      ','	;
1513)   361B 20 0A       					JR      NZ,ARGUE5	;
1514)   361D 1A          					LD      A,(DE)	;
1515)   361E FE 2C       					CP      ','	;
1516)   3620 28 BC       					JR      Z,ARGUE1        ;ANOTHER	;ANOTHER
1517)   3622 3E 1F       		ARGERR:			LD      A,31	;
1518)   3624 C3 DB 26    					JP      ERROR           ;"Arguments"	;"Arguments"
1519)   3627 CD 3C 44    		ARGUE5:			CALL    BRAKET	;
1520)   362A 1A          					LD      A,(DE)	;
1521)   362B FE 29       					CP      ')'	;
1522)   362D 20 F3       					JR      NZ,ARGERR	;
1523)   362F 13          					INC     DE	;
1524)   3630 D9          					EXX	;
1525)   3631 C1          		ARGUE6:			POP     BC	;
1526)   3632 78          					LD      A,B	;
1527)   3633 3C          					INC     A	;
1528)   3634 D9          					EXX	;
1529)   3635 C8          					RET     Z               ;MARKER POPPED	;MARKER POPPED
1530)   3636 D9          					EXX	;
1531)   3637 3D          					DEC     A	;
1532)   3638 FA 46 36    					JP      M,ARGUE7        ;STRING	;STRING
1533)   363B E1          					POP     HL	;
1534)   363C D9          					EXX	;
1535)   363D E1          					POP     HL	;
1536)   363E D9          					EXX	;
1537)   363F DD E1       					POP     IX	;
1538)   3641 CD 5E 35    					CALL    STORE           ;WRITE TO DUMMY	;WRITE TO DUMMY
1539)   3644 18 EB       					JR      ARGUE6	;
1540)   3646 CD FE 43    		ARGUE7:			CALL    POPS	;
1541)   3649 DD E1       					POP     IX	;
1542)   364B CD 87 35    					CALL    STACCS	;
1543)   364E 18 E1       					JR      ARGUE6	;
1552)   3650 D1          		SAVLOC:			POP     DE              ;RETURN ADDRESS	;RETURN ADDRESS
1553)   3651 FD 23       		SAVLO1:			INC     IY              ;BUMP PAST ( OR ,	;BUMP PAST ( OR ,
1554)   3653 CD 78 44    					CALL    NXT	;
1555)   3656 D5          					PUSH    DE	;
1556)   3657 D9          					EXX	;
1557)   3658 C5          					PUSH    BC	;
1558)   3659 D5          					PUSH    DE	;
1559)   365A E5          					PUSH    HL	;
1560)   365B D9          					EXX	;
1561)   365C CD B8 2D    					CALL    VAR             ;DUMMY VARIABLE	;DUMMY VARIABLE
1562)   365F D9          					EXX	;
1563)   3660 E1          					POP     HL	;
1564)   3661 D1          					POP     DE	;
1565)   3662 C1          					POP     BC	;
1566)   3663 D9          					EXX	;
1567)   3664 D1          					POP     DE	;
1568)   3665 B7          					OR      A               ;TYPE	;TYPE
1569)   3666 FA 77 36    					JP      M,SAVLO2        ;STRING	;STRING
1570)   3669 D9          					EXX	;
1571)   366A E5          					PUSH    HL              ;SAVE H'L'	;SAVE H'L'
1572)   366B D9          					EXX	;
1573)   366C 47          					LD      B,A             ;TYPE	;TYPE
1574)   366D CD 4D 3F    					CALL    LOADN	;
1575)   3670 D9          					EXX	;
1576)   3671 E3          					EX      (SP),HL	;
1577)   3672 D9          					EXX	;
1578)   3673 E5          					PUSH    HL	;
1579)   3674 C5          					PUSH    BC	;
1580)   3675 18 26       					JR      SAVLO4	;
1581)   3677 F5          		SAVLO2:			PUSH    AF              ;STRING TYPE	;STRING TYPE
1582)   3678 D5          					PUSH    DE	;
1583)   3679 D9          					EXX	;
1584)   367A E5          					PUSH    HL	;
1585)   367B D9          					EXX	;
1586)   367C CD D7 3F    					CALL    LOADS	;
1587)   367F D9          					EXX	;
1588)   3680 E1          					POP     HL	;
1589)   3681 D9          					EXX	;
1590)   3682 4B          					LD      C,E	;
1591)   3683 D1          					POP     DE	;
1592)   3684 CD BF 35    					CALL    CHECK	;
1593)   3687 F1          					POP     AF              ;LEVEL STACK	;LEVEL STACK
1594)   3688 21 00 00    					LD      HL,0	;
1595)   368B 45          					LD      B,L	;
1596)   368C ED 42       					SBC     HL,BC	;
1597)   368E 39          					ADD     HL,SP	;
1598)   368F F9          					LD      SP,HL	;
1599)   3690 47          					LD      B,A             ;TYPE	;TYPE
1600)   3691 C5          					PUSH    BC	;
1601)   3692 28 09       					JR      Z,SAVLO4	;
1602)   3694 D5          					PUSH    DE	;
1603)   3695 11 00 80    					LD      DE,ACCS	;
1604)   3698 EB          					EX      DE,HL	;
1605)   3699 45          					LD      B,L	;
1606)   369A ED B0       					LDIR                    ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1607)   369C D1          					POP     DE	;
1608)   369D DD E5       		SAVLO4:			PUSH    IX              ;VARPTR	;VARPTR
1609)   369F CD A2 36    					CALL    SAVLO5	;
1611)   36A2 CD BF 35    		SAVLO5:			CALL    CHECK	;
1612)   36A5 CD 78 44    					CALL    NXT	;
1613)   36A8 FE 2C       					CP      ','             ;MORE?	;MORE?
1614)   36AA 28 A5       					JR      Z,SAVLO1	;
1615)   36AC EB          					EX      DE,HL	;
1616)   36AD E9          					JP      (HL)            ;"RETURN"	;"RETURN"
1618)   36AE FD 7E 00    		DELIM:			LD      A,(IY)          ;ASSEMBLER DELIMITER	;ASSEMBLER DELIMITER
1619)   36B1 FE 20       					CP      ' '	;
1620)   36B3 C8          					RET     Z	;
1621)   36B4 FE 2C       					CP      ','	;
1622)   36B6 C8          					RET     Z	;
1623)   36B7 FE 29       					CP      ')'	;
1624)   36B9 C8          					RET     Z	;
1625)   36BA FE 3B       		TERM:			CP      ';'             ;ASSEMBLER TERMINATOR	;ASSEMBLER TERMINATOR
1626)   36BC C8          					RET     Z	;
1627)   36BD FE 5C       					CP      '\'	;
1628)   36BF C8          					RET     Z	;
1629)   36C0 18 06       					JR      TERM0	;
1631)   36C2 CD 78 44    		@TERM?:			CALL    NXT	;
1632)   36C5 FE 8B       					CP      ELSE	;
1633)   36C7 D0          					RET     NC	;
1634)   36C8 FE 3A       		TERM0:			CP      ':'             ;ASSEMBLER SEPARATOR	;ASSEMBLER SEPARATOR
1635)   36CA D0          					RET     NC	;
1636)   36CB FE 0D       					CP      CR	;
1637)   36CD C9          					RET	;
1639)   36CE CD C2 36    		SPAN:			CALL    TERM?	;
1640)   36D1 C8          					RET     Z	;
1641)   36D2 FD 23       					INC     IY	;
1642)   36D4 18 F8       					JR      SPAN	;
1644)   36D6 CD 78 44    		EQUALS:			CALL    NXT	;
1645)   36D9 FD 23       					INC     IY	;
1646)   36DB FE 3D       					CP      '='	;
1647)   36DD C8          					RET     Z	;
1648)   36DE 3E 04       					LD      A,4	;
1649)   36E0 C3 DB 26    					JP      ERROR           ;"Mistake"	;"Mistake"
1651)   36E3 FE 8A       		FORMAT:			CP      TAB	;
1652)   36E5 28 0C       					JR      Z,DOTAB	;
1653)   36E7 FE 89       					CP      SPC	;
1654)   36E9 28 38       					JR      Z,DOSPC	;
1655)   36EB FE 27       					CP      ''''	;
1656)   36ED C0          					RET     NZ	;
1657)   36EE CD 6D 28    					CALL    CRLF	;
1658)   36F1 AF          					XOR     A	;
1659)   36F2 C9          					RET	;
1661)   36F3 C5          		DOTAB:			PUSH    BC	;
1662)   36F4 CD 94 3E    					CALL    EXPRI	;
1663)   36F7 D9          					EXX	;
1664)   36F8 C1          					POP     BC	;
1665)   36F9 FD 7E 00    					LD      A,(IY)	;
1666)   36FC FE 2C       					CP      ','	;
1667)   36FE 28 11       					JR      Z,DOTAB1	;
1668)   3700 CD 3C 44    					CALL    BRAKET	;
1669)   3703 7D          					LD      A,L	;
1670)   3704 21 FB 82    		TABIT:			LD      HL,COUNT	;
1671)   3707 BE          					CP      (HL)	;
1672)   3708 C8          					RET     Z	;
1673)   3709 F5          					PUSH    AF	;
1674)   370A DC 6D 28    					CALL    C,CRLF	;
1675)   370D F1          					POP     AF	;
1676)   370E 96          					SUB     (HL)	;
1677)   370F 18 19       					JR      FILL	;
1678)   3711 FD 23       		DOTAB1:			INC     IY	;
1679)   3713 C5          					PUSH    BC	;
1680)   3714 E5          					PUSH    HL	;
1681)   3715 CD 94 3E    					CALL    EXPRI	;
1682)   3718 D9          					EXX	;
1683)   3719 D1          					POP     DE	;
1684)   371A C1          					POP     BC	;
1685)   371B CD 3C 44    					CALL    BRAKET	;
1686)   371E CD 09 01    					CALL    PUTCSR	;
1687)   3721 AF          					XOR     A	;
1688)   3722 C9          					RET	;
1690)   3723 C5          		DOSPC:			PUSH    BC	;
1691)   3724 CD AB 3E    					CALL    ITEMI	;
1692)   3727 D9          					EXX	;
1693)   3728 7D          					LD      A,L	;
1694)   3729 C1          					POP     BC	;
1695)   372A B7          		@FILL:			OR      A	;
1696)   372B C8          					RET     Z	;
1697)   372C C5          					PUSH    BC	;
1698)   372D 47          					LD      B,A	;
1699)   372E 3E 20       		FILL1:			LD      A,' '	;
1700)   3730 CD 74 28    					CALL    OUTCHR	;
1701)   3733 10 F9       					DJNZ    FILL1	;
1702)   3735 C1          					POP     BC	;
1703)   3736 AF          					XOR     A	;
1704)   3737 C9          					RET	;
1706)   3738 21 00 80    		PTEXT:			LD      HL,ACCS	;
1707)   373B 1C          					INC     E	;
1708)   373C 1D          		PTEXT1:			DEC     E	;
1709)   373D C8          					RET     Z	;
1710)   373E 7E          					LD      A,(HL)	;
1711)   373F 23          					INC     HL	;
1712)   3740 CD 74 28    					CALL    OUTCHR	;
1713)   3743 18 F7       					JR      PTEXT1	;
1715)   3745 F5          		FETCHS:			PUSH    AF	;
1716)   3746 C5          					PUSH    BC	;
1717)   3747 E5          					PUSH    HL	;
1718)   3748 FD E3       					EX      (SP),IY	;
1719)   374A CD 62 37    					CALL    XTRACT	;
1720)   374D CD 78 44    					CALL    NXT	;
1721)   3750 FD E3       					EX      (SP),IY	;
1722)   3752 E1          					POP     HL	;
1723)   3753 C1          					POP     BC	;
1724)   3754 F1          					POP     AF	;
1725)   3755 C9          					RET	;
1727)   3756 11 00 80    		LINES:			LD      DE,ACCS	;
1728)   3759 7E          		LINE1S:			LD      A,(HL)	;
1729)   375A 12          					LD      (DE),A	;
1730)   375B FE 0D       					CP      CR	;
1731)   375D C8          					RET     Z	;
1732)   375E 23          					INC     HL	;
1733)   375F 1C          					INC     E	;
1734)   3760 18 F7       					JR      LINE1S	;
1736)   3762 CD 78 44    		XTRACT:			CALL    NXT	;
1737)   3765 FE 22       					CP      34		;ASCII ""	;ASCII ""
1738)   3767 FD 23       					INC     IY	;
1739)   3769 CA 8F 3F    					JP      Z,CONS	;
1740)   376C FD 2B       					DEC     IY	;
1741)   376E 11 00 80    					LD      DE,ACCS	;
1742)   3771 FD 7E 00    		XTRAC1:			LD      A,(IY)	;
1743)   3774 12          					LD      (DE),A	;
1744)   3775 FE 2C       					CP      ','	;
1745)   3777 C8          					RET     Z	;
1746)   3778 FE 0D       					CP      CR	;
1747)   377A C8          					RET     Z	;
1748)   377B FD 23       					INC     IY	;
1749)   377D 1C          					INC     E	;
1750)   377E 18 F1       					JR      XTRAC1	;
1752)   3780 06 00       		SEARCH:			LD      B,0	;
1753)   3782 4E          		SRCH1:			LD      C,(HL)	;
1754)   3783 0C          					INC     C	;
1755)   3784 0D          					DEC     C	;
1756)   3785 28 0C       					JR      Z,SRCH2         ;FAIL	;FAIL
1757)   3787 23          					INC     HL	;
1758)   3788 23          					INC     HL	;
1759)   3789 23          					INC     HL	;
1760)   378A BE          					CP      (HL)	;
1761)   378B C8          					RET     Z	;
1762)   378C 0D          					DEC     C	;
1763)   378D 0D          					DEC     C	;
1764)   378E 0D          					DEC     C	;
1765)   378F 09          					ADD     HL,BC	;
1766)   3790 C3 82 37    					JP      SRCH1	;
1767)   3793 2B          		SRCH2:			DEC     HL              ;POINT TO CR	;POINT TO CR
1768)   3794 37          					SCF	;
1769)   3795 C9          					RET	;
1771)   3796 FE 05       		@X4OR5:			CP      5	;
1772)   3798 62          					LD      H,D	;
1773)   3799 6B          					LD      L,E	;
1774)   379A 29          					ADD     HL,HL	;
1775)   379B D8          					RET     C	;
1776)   379C 29          					ADD     HL,HL	;
1777)   379D D8          					RET     C	;
1778)   379E EB          					EX      DE,HL	;
1779)   379F C0          					RET     NZ	;
1780)   37A0 19          					ADD     HL,DE	;
1781)   37A1 EB          					EX      DE,HL	;
1782)   37A2 C9          					RET	;
1784)   37A3 EB          		@MUL16:			EX      DE,HL	;
1785)   37A4 21 00 00    					LD      HL,0	;
1786)   37A7 3E 10       					LD      A,16	;
1787)   37A9 29          		MUL161:			ADD     HL,HL	;
1788)   37AA D8          					RET     C               ;OVERFLOW	;OVERFLOW
1789)   37AB CB 23       					SLA     E	;
1790)   37AD CB 12       					RL      D	;
1791)   37AF 30 02       					JR      NC,MUL162	;
1792)   37B1 09          					ADD     HL,BC	;
1793)   37B2 D8          					RET     C	;
1794)   37B3 3D          		MUL162:			DEC     A	;
1795)   37B4 20 F3       					JR      NZ,MUL161	;
1796)   37B6 C9          					RET	;
1798)   37B7 CD 78 44    		@CHANEL:		CALL    NXT	;
1799)   37BA FE 23       					CP      '#'	;
1800)   37BC 3E 2D       					LD      A,45	;
1801)   37BE C2 DB 26    					JP      NZ,ERROR        ;"Missing #"	;"Missing #"
1802)   37C1 FD 23       		CHNL:			INC     IY              ;SKIP '#'	;SKIP '#'
1803)   37C3 CD AB 3E    					CALL    ITEMI	;
1804)   37C6 D9          					EXX	;
1805)   37C7 EB          					EX      DE,HL	;
1806)   37C8 C9          					RET	;
1812)   37C9 CD 3F 3B    		ASSEM:			CALL    SKIP	;
1813)   37CC FD 23       					INC     IY	;
1814)   37CE FE 3A       					CP      ':'	;
1815)   37D0 28 F7       					JR      Z,ASSEM	;
1816)   37D2 FE 5D       					CP      ']'	;
1817)   37D4 C8          					RET     Z	;
1818)   37D5 FE 0D       					CP      CR	;
1819)   37D7 C8          					RET     Z	;
1820)   37D8 FD 2B       					DEC     IY	;
1821)   37DA DD 2A 40 82 					LD      IX,(PC)         ;PROGRAM COUNTER	;PROGRAM COUNTER
1822)   37DE 21 FE 82    					LD      HL,LISTON	;
1823)   37E1 CB 76       					BIT     6,(HL)	;
1824)   37E3 28 04       					JR      Z,ASSEM0	;
1825)   37E5 DD 2A 3C 82 					LD      IX,(OC)         ;ORIGIN of CODE	;ORIGIN of CODE
1826)   37E9 DD E5       		ASSEM0:			PUSH    IX	;
1827)   37EB FD E5       					PUSH    IY	;
1828)   37ED CD 7D 38    					CALL    ASMB	;
1829)   37F0 C1          					POP     BC	;
1830)   37F1 D1          					POP     DE	;
1831)   37F2 D8          					RET     C	;
1832)   37F3 CD 3F 3B    					CALL    SKIP	;
1833)   37F6 37          					SCF	;
1834)   37F7 C0          					RET     NZ	;
1835)   37F8 FD 2B       					DEC     IY	;
1836)   37FA FD 23       		ASSEM3:			INC     IY	;
1837)   37FC FD 7E 00    					LD      A,(IY)	;
1838)   37FF CD C8 36    					CALL    TERM0	;
1839)   3802 20 F6       					JR      NZ,ASSEM3	;
1840)   3804 3A FE 82    					LD      A,(LISTON)	;
1841)   3807 DD E5       					PUSH    IX	;
1842)   3809 E1          					POP     HL	;
1843)   380A B7          					OR      A	;
1844)   380B ED 52       					SBC     HL,DE	;
1845)   380D EB          					EX      DE,HL           ;DE= NO. OF BYTES	;DE= NO. OF BYTES
1846)   380E E5          					PUSH    HL	;
1847)   380F 2A 40 82    					LD      HL,(PC)	;
1848)   3812 E5          					PUSH    HL	;
1849)   3813 19          					ADD     HL,DE	;
1850)   3814 22 40 82    					LD      (PC),HL         ;UPDATE PC	;UPDATE PC
1851)   3817 CB 77       					BIT     6,A	;
1852)   3819 28 07       					JR      Z,ASSEM5	;
1853)   381B 2A 3C 82    					LD      HL,(OC)	;
1854)   381E 19          					ADD     HL,DE	;
1855)   381F 22 3C 82    					LD      (OC),HL         ;UPDATE OC	;UPDATE OC
1856)   3822 E1          		ASSEM5:			POP     HL              ;OLD PC	;OLD PC
1857)   3823 DD E1       					POP     IX              ;CODE HERE	;CODE HERE
1858)   3825 CB 67       					BIT     4,A	;
1859)   3827 28 A0       					JR      Z,ASSEM	;
1860)   3829 7C          					LD      A,H	;
1861)   382A CD 69 38    					CALL    HEX	;
1862)   382D 7D          					LD      A,L	;
1863)   382E CD 62 38    					CALL    HEXSP	;
1864)   3831 AF          					XOR     A	;
1865)   3832 BB          					CP      E	;
1866)   3833 28 15       					JR      Z,ASSEM2	;
1867)   3835 3A FB 82    		ASSEM1:			LD      A,(COUNT)	;
1868)   3838 FE 11       					CP      17	;
1869)   383A 3E 05       					LD      A,5	;
1870)   383C D4 04 37    					CALL    NC,TABIT        ;NEXT LINE	;NEXT LINE
1871)   383F DD 7E 00    					LD      A,(IX)	;
1872)   3842 CD 62 38    					CALL    HEXSP	;
1873)   3845 DD 23       					INC     IX	;
1874)   3847 1D          					DEC     E	;
1875)   3848 20 EB       					JR      NZ,ASSEM1	;
1876)   384A 3E 12       		ASSEM2:			LD      A,18	;
1877)   384C CD 04 37    					CALL    TABIT	;
1878)   384F FD E5       					PUSH    IY	;
1879)   3851 E1          					POP     HL	;
1880)   3852 ED 42       					SBC     HL,BC	;
1881)   3854 0A          		ASSEM4:			LD      A,(BC)	;
1882)   3855 CD 8D 28    					CALL    OUT	;
1883)   3858 03          					INC     BC	;
1884)   3859 2D          					DEC     L	;
1885)   385A 20 F8       					JR      NZ,ASSEM4	;
1886)   385C CD 6D 28    					CALL    CRLF	;
1887)   385F C3 C9 37    					JP      ASSEM	;
1889)   3862 CD 69 38    		HEXSP:			CALL    HEX	;
1890)   3865 3E 20       					LD      A,' '	;
1891)   3867 18 11       					JR      OUTCH1	;
1892)   3869 F5          		HEX:			PUSH    AF	;
1893)   386A 0F          					RRCA	;
1894)   386B 0F          					RRCA	;
1895)   386C 0F          					RRCA	;
1896)   386D 0F          					RRCA	;
1897)   386E CD 72 38    					CALL    HEXOUT	;
1898)   3871 F1          					POP     AF	;
1899)   3872 E6 0F       		HEXOUT:			AND     0FH	;
1900)   3874 C6 90       					ADD     A,90H	;
1901)   3876 27          					DAA	;
1902)   3877 CE 40       					ADC     A,40H	;
1903)   3879 27          					DAA	;
1904)   387A C3 8D 28    		OUTCH1:			JP      OUT	;
1918)   387D FE 2E       		ASMB:			CP      '.'	;
1919)   387F 20 16       					JR      NZ,ASMB1	;
1920)   3881 FD 23       					INC     IY	;
1921)   3883 DD E5       					PUSH    IX	;
1922)   3885 CD B8 2D    					CALL    VAR	;
1923)   3888 F5          					PUSH    AF	;
1924)   3889 CD BE 43    					CALL    ZERO	;
1925)   388C D9          					EXX	;
1926)   388D 2A 40 82    					LD      HL,(PC)	;
1927)   3890 D9          					EXX	;
1928)   3891 F1          					POP     AF	;
1929)   3892 CD 5E 35    					CALL    STORE	;
1930)   3895 DD E1       					POP     IX	;
1931)   3897 CD 3F 3B    		ASMB1:			CALL    SKIP	;
1932)   389A C8          					RET     Z	;
1933)   389B FE D6       					CP      TCALL	;
1934)   389D 0E C4       					LD      C,0C4H	;
1935)   389F FD 23       					INC     IY	;
1936)   38A1 CA 8E 39    					JP      Z,GRPC	;
1937)   38A4 FD 2B       					DEC     IY	;
1938)   38A6 21 51 3B    					LD      HL,OPCODS	;
1939)   38A9 CD F6 3A    					CALL    FIND	;
1940)   38AC D8          					RET     C	;
1941)   38AD 48          					LD      C,B     ;ROOT OPCODE	;ROOT OPCODE
1942)   38AE 16 00       					LD      D,0     ;CLEAR IX/IY FLAG	;CLEAR IX/IY FLAG
1947)   38B0 D6 27       					SUB     39	;
1948)   38B2 30 07       					JR      NC,GROUP2	;
1949)   38B4 FE E8       					CP      15-39	;
1950)   38B6 D4 5C 3A    					CALL    NC,ED	;
1951)   38B9 18 68       					JR      BYTE0	;
1956)   38BB D6 0A       		GROUP2:			SUB     10	;
1957)   38BD 30 0F       					JR      NC,GROUP4	;
1958)   38BF FE F9       					CP      3-10	;
1959)   38C1 DC E6 3A    					CALL    C,BIT	;
1960)   38C4 D8          					RET     C	;
1961)   38C5 CD BB 3A    					CALL    REGLO	;
1962)   38C8 D8          					RET     C	;
1963)   38C9 CD 60 3A    					CALL    CB	;
1964)   38CC 18 55       					JR      BYTE0	;
1968)   38CE D6 03       		GROUP4:			SUB     3	;
1969)   38D0 30 06       					JR      NC,GROUP5	;
1970)   38D2 CD DA 3A    		G4:			CALL    PAIR	;
1971)   38D5 D8          					RET     C	;
1972)   38D6 18 4B       					JR      BYTE0	;
1977)   38D8 D6 0A       		GROUP5:			SUB     8+2	;
1978)   38DA 30 32       					JR      NC,GROUP7	;
1979)   38DC FE FD       					CP      5-8	;
1980)   38DE 06 07       					LD      B,7	;
1981)   38E0 D4 6E 3A    					CALL    NC,OPND	;
1982)   38E3 78          					LD      A,B	;
1983)   38E4 FE 07       					CP      7	;
1984)   38E6 20 10       					JR      NZ,G6HL	;
1985)   38E8 CD BB 3A    		G6:			CALL    REGLO	;
1986)   38EB 79          					LD      A,C	;
1987)   38EC 30 28       					JR      NC,BIND1	;
1988)   38EE EE 46       					XOR     46H	;
1989)   38F0 CD 62 3A    					CALL    BIND	;
1990)   38F3 CD 9E 3A    		DB:			CALL    NUMBER	;
1991)   38F6 18 78       					JR      VAL8	;
1993)   38F8 E6 3F       		G6HL:			AND     3FH	;
1994)   38FA FE 0C       					CP      12	;
1995)   38FC 37          					SCF	;
1996)   38FD C0          					RET     NZ	;
1997)   38FE 79          					LD      A,C	;
1998)   38FF FE 80       					CP      80H	;
1999)   3901 0E 09       					LD      C,9	;
2000)   3903 28 CD       					JR      Z,G4	;
2001)   3905 EE 1C       					XOR     1CH	;
2002)   3907 0F          					RRCA	;
2003)   3908 4F          					LD      C,A	;
2004)   3909 CD 5C 3A    					CALL    ED	;
2005)   390C 18 C4       					JR      G4	;
2009)   390E D6 02       		GROUP7:			SUB     2	;
2010)   3910 30 14       					JR      NC,GROUP8	;
2011)   3912 CD C1 3A    					CALL    REGHI	;
2012)   3915 79          					LD      A,C	;
2013)   3916 D2 62 3A    		BIND1:			JP      NC,BIND	;
2014)   3919 EE 64       					XOR     64H	;
2015)   391B 07          					RLCA	;
2016)   391C 07          					RLCA	;
2017)   391D 07          					RLCA	;
2018)   391E 4F          					LD      C,A	;
2019)   391F CD DE 3A    					CALL    PAIR1	;
2020)   3922 D8          					RET     C	;
2021)   3923 79          		BYTE0:			LD      A,C	;
2022)   3924 18 7F       					JR      BYTE2	;
2027)   3926 D6 02       		GROUP8:			SUB     2	;
2028)   3928 30 21       					JR      NC,GROUPA	;
2029)   392A FE FF       					CP      1-2	;
2030)   392C CC 51 3A    					CALL    Z,CORN	;
2031)   392F 08          					EX      AF,AF'	;
2032)   3930 CD C1 3A    					CALL    REGHI	;
2033)   3933 D8          					RET     C	;
2034)   3934 08          					EX      AF,AF'	;
2035)   3935 DC 51 3A    					CALL    C,CORN	;
2036)   3938 24          					INC     H	;
2037)   3939 28 E8       					JR      Z,BYTE0	;
2038)   393B 78          					LD      A,B	;
2039)   393C FE 07       					CP      7	;
2040)   393E 37          					SCF	;
2041)   393F C0          					RET     NZ	;
2042)   3940 79          					LD      A,C	;
2043)   3941 EE 03       					XOR     3	;
2044)   3943 07          					RLCA	;
2045)   3944 07          					RLCA	;
2046)   3945 07          					RLCA	;
2047)   3946 CD 8E 3A    					CALL    BYTE	;
2048)   3949 18 25       					JR      VAL8	;
2052)   394B D6 02       		GROUPA:			SUB     2	;
2053)   394D 30 24       					JR      NC,GROUPB	;
2054)   394F FE FF       					CP      1-2	;
2055)   3951 C4 C7 3A    					CALL    NZ,COND	;
2056)   3954 79          					LD      A,C	;
2057)   3955 30 02       					JR      NC,GRPA	;
2058)   3957 3E 18       					LD      A,18H	;
2059)   3959 CD 8E 3A    		GRPA:			CALL    BYTE	;
2060)   395C CD 9E 3A    					CALL    NUMBER	;
2061)   395F ED 5B 40 82 					LD      DE,(PC)	;
2062)   3963 13          					INC     DE	;
2063)   3964 37          					SCF	;
2064)   3965 ED 52       					SBC     HL,DE	;
2065)   3967 7D          					LD      A,L	;
2066)   3968 17          					RLA	;
2067)   3969 9F          					SBC     A,A	;
2068)   396A BC          					CP      H	;
2069)   396B 3E 01       		TOOFAR:			LD      A,1	;
2070)   396D C2 DB 26    					JP      NZ,ERROR        ;"Out of range"	;"Out of range"
2071)   3970 7D          		VAL8:			LD      A,L	;
2072)   3971 18 32       					JR      BYTE2	;
2076)   3973 47          		GROUPB:			LD      B,A	;
2077)   3974 20 16       					JR      NZ,GROUPC	;
2078)   3976 CD C7 3A    					CALL    COND	;
2079)   3979 79          					LD      A,C	;
2080)   397A 30 0B       					JR      NC,GRPB	;
2081)   397C 78          					LD      A,B	;
2082)   397D E6 3F       					AND     3FH	;
2083)   397F FE 06       					CP      6	;
2084)   3981 3E E9       					LD      A,0E9H	;
2085)   3983 28 20       					JR      Z,BYTE2	;
2086)   3985 3E C3       					LD      A,0C3H	;
2087)   3987 CD 8E 3A    		GRPB:			CALL    BYTE	;
2088)   398A 18 05       					JR      ADDR	;
2092)   398C 10 0C       		GROUPC:			DJNZ    GROUPD	;
2093)   398E CD A9 39    		GRPC:			CALL    GRPE	;
2094)   3991 CD 9E 3A    		ADDR:			CALL    NUMBER	;
2095)   3994 CD 70 39    		VAL16:			CALL    VAL8	;
2096)   3997 7C          					LD      A,H	;
2097)   3998 18 0B       					JR      BYTE2	;
2101)   399A 10 0B       		GROUPD:			DJNZ    GROUPE	;
2102)   399C CD 9E 3A    					CALL    NUMBER	;
2103)   399F A1          					AND     C	;
2104)   39A0 B4          					OR      H	;
2105)   39A1 20 C8       					JR      NZ,TOOFAR	;
2106)   39A3 7D          					LD      A,L	;
2107)   39A4 B1          					OR      C	;
2108)   39A5 18 78       		BYTE2:  		JR      BYTE1	;
2112)   39A7 10 0A       		GROUPE:			DJNZ    GROUPF	;
2113)   39A9 CD C7 3A    		GRPE:			CALL    COND	;
2114)   39AC 79          					LD      A,C	;
2115)   39AD 30 70       					JR      NC,BYTE1	;
2116)   39AF F6 09       					OR      9	;
2117)   39B1 18 6C       					JR      BYTE1	;
2121)   39B3 10 6C       		GROUPF:			DJNZ    MISC	;
2122)   39B5 CD F3 3A    					CALL    LDOP	;
2123)   39B8 30 5F       					JR      NC,LDA	;
2124)   39BA CD C1 3A    					CALL    REGHI	;
2125)   39BD 08          					EX      AF,AF'	;
2126)   39BE CD 3F 3B    					CALL    SKIP	;
2127)   39C1 FE 28       					CP      '('	;
2128)   39C3 28 1D       					JR      Z,LDIN	;
2129)   39C5 08          					EX      AF,AF'	;
2130)   39C6 D2 E8 38    					JP      NC,G6	;
2131)   39C9 0E 01       					LD      C,1	;
2132)   39CB CD DE 3A    					CALL    PAIR1	;
2133)   39CE D8          					RET     C	;
2134)   39CF 3E 0E       					LD      A,14	;
2135)   39D1 B8          					CP      B	;
2136)   39D2 47          					LD      B,A	;
2137)   39D3 CC DA 3A    					CALL    Z,PAIR	;
2138)   39D6 78          					LD      A,B	;
2139)   39D7 E6 3F       					AND     3FH	;
2140)   39D9 FE 0C       					CP      12	;
2141)   39DB 79          					LD      A,C	;
2142)   39DC 20 A9       					JR      NZ,GRPB	;
2143)   39DE 3E F9       					LD      A,0F9H	;
2144)   39E0 18 3D       					JR      BYTE1	;
2146)   39E2 08          		LDIN:			EX      AF,AF'	;
2147)   39E3 C5          					PUSH    BC	;
2148)   39E4 D4 BB 3A    					CALL    NC,REGLO	;
2149)   39E7 79          					LD      A,C	;
2150)   39E8 C1          					POP     BC	;
2151)   39E9 30 77       					JR      NC,BIND	;
2152)   39EB 0E 0A       					LD      C,0AH	;
2153)   39ED CD DE 3A    					CALL    PAIR1	;
2154)   39F0 CD 38 3A    					CALL    LD16	;
2155)   39F3 30 92       					JR      NC,GRPB	;
2156)   39F5 CD 9E 3A    					CALL    NUMBER	;
2157)   39F8 0E 02       					LD      C,2	;
2158)   39FA CD DA 3A    					CALL    PAIR	;
2159)   39FD CD 38 3A    					CALL    LD16	;
2160)   3A00 D8          					RET     C	;
2161)   3A01 CD 8E 3A    					CALL    BYTE	;
2162)   3A04 18 8E       					JR      VAL16	;
2166)   3A06 05          		OPT:			DEC     B	;
2167)   3A07 CA F3 38    					JP      Z,DB	;
2168)   3A0A 10 85       					DJNZ    ADDR	;
2169)   3A0C CD 9E 3A    					CALL    NUMBER	;
2170)   3A0F 21 FE 82    					LD      HL,LISTON	;
2171)   3A12 4F          					LD      C,A	;
2172)   3A13 ED 6F       					RLD	;
2173)   3A15 79          					LD      A,C	;
2174)   3A16 ED 67       					RRD	;
2175)   3A18 C9          					RET	;
2177)   3A19 FE 04       		LDA:			CP      4	;
2178)   3A1B DC 5C 3A    					CALL    C,ED	;
2179)   3A1E 78          					LD      A,B	;
2180)   3A1F 18 6D       		BYTE1:			JR      BYTE	;
2184)   3A21 10 E3       		MISC:			DJNZ    OPT	;
2185)   3A23 DD E5       					PUSH    IX	;
2186)   3A25 CD 9D 3E    					CALL    EXPRS	;
2187)   3A28 DD E1       					POP     IX	;
2188)   3A2A 21 00 80    					LD      HL,ACCS	;
2189)   3A2D AF          		DEFM1:			XOR     A	;
2190)   3A2E BB          					CP      E	;
2191)   3A2F C8          					RET     Z	;
2192)   3A30 7E          					LD      A,(HL)	;
2193)   3A31 23          					INC     HL	;
2194)   3A32 CD 8E 3A    					CALL    BYTE	;
2195)   3A35 1D          					DEC     E	;
2196)   3A36 18 F5       					JR      DEFM1	;
2200)   3A38 78          		LD16:			LD      A,B	;
2201)   3A39 38 0E       					JR      C,LD8	;
2202)   3A3B 78          					LD      A,B	;
2203)   3A3C E6 3F       					AND     3FH	;
2204)   3A3E FE 0C       					CP      12	;
2205)   3A40 79          					LD      A,C	;
2206)   3A41 C8          					RET     Z	;
2207)   3A42 CD 5C 3A    					CALL    ED	;
2208)   3A45 79          					LD      A,C	;
2209)   3A46 F6 43       					OR      43H	;
2210)   3A48 C9          					RET	;
2212)   3A49 FE 07       		LD8:			CP      7	;
2213)   3A4B 37          					SCF	;
2214)   3A4C C0          					RET     NZ	;
2215)   3A4D 79          					LD      A,C	;
2216)   3A4E F6 30       					OR      30H	;
2217)   3A50 C9          					RET	;
2219)   3A51 C5          		CORN:			PUSH    BC	;
2220)   3A52 CD 6E 3A    					CALL    OPND	;
2221)   3A55 CB 68       					BIT     5,B	;
2222)   3A57 C1          					POP     BC	;
2223)   3A58 28 44       					JR      Z,NUMBER	;
2224)   3A5A 26 FF       					LD      H,-1	;
2225)   3A5C 3E ED       		ED:			LD      A,0EDH	;
2226)   3A5E 18 2E       					JR      BYTE	;
2228)   3A60 3E CB       		CB:			LD      A,0CBH	;
2229)   3A62 FE 76       		BIND:			CP      76H	;
2230)   3A64 37          					SCF	;
2231)   3A65 C8          					RET     Z               ;REJECT LD (HL),(HL)	;REJECT LD (HL),(HL)
2232)   3A66 CD 8E 3A    					CALL    BYTE	;
2233)   3A69 14          					INC     D	;
2234)   3A6A F0          					RET     P	;
2235)   3A6B 7B          					LD      A,E	;
2236)   3A6C 18 20       					JR      BYTE	;
2238)   3A6E E5          		OPND:			PUSH    HL	;
2239)   3A6F 21 98 3C    					LD      HL,OPRNDS	;
2240)   3A72 CD F6 3A    					CALL    FIND	;
2241)   3A75 E1          					POP     HL	;
2242)   3A76 D8          					RET     C	;
2243)   3A77 CB 78       					BIT     7,B	;
2244)   3A79 C8          					RET     Z	;
2245)   3A7A CB 58       					BIT     3,B	;
2246)   3A7C E5          					PUSH    HL	;
2247)   3A7D CC 95 3A    					CALL    Z,OFFSET	;
2248)   3A80 5D          					LD      E,L	;
2249)   3A81 E1          					POP     HL	;
2250)   3A82 3E DD       					LD      A,0DDH	;
2251)   3A84 CB 70       					BIT     6,B	;
2252)   3A86 28 02       					JR      Z,OP1	;
2253)   3A88 3E FD       					LD      A,0FDH	;
2254)   3A8A B7          		OP1:			OR      A	;
2255)   3A8B 14          					INC     D	;
2256)   3A8C 57          					LD      D,A	;
2257)   3A8D F8          					RET     M	;
2258)   3A8E DD 77 00    		BYTE:			LD      (IX),A	;
2259)   3A91 DD 23       					INC     IX	;
2260)   3A93 B7          					OR      A	;
2261)   3A94 C9          					RET	;
2263)   3A95 FD 7E 00    		OFFSET:			LD      A,(IY)	;
2264)   3A98 FE 29       					CP      ')'	;
2265)   3A9A 21 00 00    					LD      HL,0	;
2266)   3A9D C8          					RET     Z	;
2267)   3A9E CD 3F 3B    		NUMBER:			CALL    SKIP	;
2268)   3AA1 C5          					PUSH    BC	;
2269)   3AA2 D5          					PUSH    DE	;
2270)   3AA3 DD E5       					PUSH    IX	;
2271)   3AA5 CD 94 3E    					CALL    EXPRI	;
2272)   3AA8 DD E1       					POP     IX	;
2273)   3AAA D9          					EXX	;
2274)   3AAB D1          					POP     DE	;
2275)   3AAC C1          					POP     BC	;
2276)   3AAD 7D          					LD      A,L	;
2277)   3AAE B7          					OR      A	;
2278)   3AAF C9          					RET	;
2280)   3AB0 CD 6E 3A    		REG:			CALL    OPND	;
2281)   3AB3 D8          					RET     C	;
2282)   3AB4 78          					LD      A,B	;
2283)   3AB5 E6 3F       					AND     3FH	;
2284)   3AB7 FE 08       					CP      8	;
2285)   3AB9 3F          					CCF	;
2286)   3ABA C9          					RET	;
2288)   3ABB CD B0 3A    		REGLO:			CALL    REG	;
2289)   3ABE D8          					RET     C	;
2290)   3ABF 18 2F       					JR      ORC	;
2292)   3AC1 CD B0 3A    		REGHI:			CALL    REG	;
2293)   3AC4 D8          					RET     C	;
2294)   3AC5 18 26       					JR      SHL3	;
2296)   3AC7 CD 6E 3A    		COND:			CALL    OPND	;
2297)   3ACA D8          					RET     C	;
2298)   3ACB 78          					LD      A,B	;
2299)   3ACC E6 1F       					AND     1FH	;
2300)   3ACE D6 10       					SUB     16	;
2301)   3AD0 30 1B       					JR      NC,SHL3	;
2302)   3AD2 FE F1       					CP      -15	;
2303)   3AD4 37          					SCF	;
2304)   3AD5 C0          					RET     NZ	;
2305)   3AD6 3E 03       					LD      A,3	;
2306)   3AD8 18 13       					JR      SHL3	;
2308)   3ADA CD 6E 3A    		PAIR:			CALL    OPND	;
2309)   3ADD D8          					RET     C	;
2310)   3ADE 78          		PAIR1:			LD      A,B	;
2311)   3ADF E6 0F       					AND     0FH	;
2312)   3AE1 D6 08       					SUB     8	;
2313)   3AE3 D8          					RET     C	;
2314)   3AE4 18 07       					JR      SHL3	;
2316)   3AE6 CD 9E 3A    		BIT:			CALL    NUMBER	;
2317)   3AE9 FE 08       					CP      8	;
2318)   3AEB 3F          					CCF	;
2319)   3AEC D8          					RET     C	;
2320)   3AED 07          		SHL3:			RLCA	;
2321)   3AEE 07          					RLCA	;
2322)   3AEF 07          					RLCA	;
2323)   3AF0 B1          		ORC:			OR      C	;
2324)   3AF1 4F          					LD      C,A	;
2325)   3AF2 C9          					RET	;
2327)   3AF3 21 DD 3C    		LDOP:			LD      HL,LDOPS	;
2328)   3AF6 CD 3F 3B    		FIND:			CALL    SKIP	;
2329)   3AF9 06 00       		EXIT:			LD      B,0	;
2330)   3AFB 37          					SCF	;
2331)   3AFC C8          					RET     Z	;
2332)   3AFD FE DD       					CP      DEF	;
2333)   3AFF 28 04       					JR      Z,FIND0	;
2334)   3B01 FE 85       					CP      TOR+1	;
2335)   3B03 3F          					CCF	;
2336)   3B04 D8          					RET     C	;
2337)   3B05 7E          		FIND0:			LD      A,(HL)	;
2338)   3B06 B7          					OR      A	;
2339)   3B07 28 F0       					JR      Z,EXIT	;
2340)   3B09 FD AE 00    					XOR     (IY)	;
2341)   3B0C E6 5F       					AND     01011111B	;
2342)   3B0E 28 09       					JR      Z,FIND2	;
2343)   3B10 CB 7E       		FIND1:			BIT     7,(HL)	;
2344)   3B12 23          					INC     HL	;
2345)   3B13 28 FB       					JR      Z,FIND1	;
2346)   3B15 23          					INC     HL	;
2347)   3B16 04          					INC     B	;
2348)   3B17 18 EC       					JR      FIND0	;
2350)   3B19 FD E5       		FIND2:			PUSH    IY	;
2351)   3B1B CB 7E       		FIND3:			BIT     7,(HL)	;
2352)   3B1D FD 23       					INC     IY	;
2353)   3B1F 23          					INC     HL	;
2354)   3B20 20 10       					JR      NZ,FIND5	;
2355)   3B22 BE          					CP      (HL)	;
2356)   3B23 CC 3E 3B    					CALL    Z,SKIP0	;
2357)   3B26 7E          					LD      A,(HL)	;
2358)   3B27 FD AE 00    					XOR     (IY)	;
2359)   3B2A E6 5F       					AND     01011111B	;
2360)   3B2C 28 ED       					JR      Z,FIND3	;
2361)   3B2E FD E1       		FIND4:			POP     IY	;
2362)   3B30 18 DE       					JR      FIND1	;
2364)   3B32 CD AE 36    		FIND5:			CALL    DELIM	;
2365)   3B35 C4 4B 3B    					CALL    NZ,SIGN	;
2366)   3B38 20 F4       					JR      NZ,FIND4	;
2367)   3B3A 78          		FIND6:			LD      A,B	;
2368)   3B3B 46          					LD      B,(HL)	;
2369)   3B3C E1          					POP     HL	;
2370)   3B3D C9          					RET	;
2372)   3B3E 23          		SKIP0:			INC     HL	;
2373)   3B3F CD AE 36    		SKIP:			CALL    DELIM	;
2374)   3B42 C0          					RET     NZ	;
2375)   3B43 CD BA 36    					CALL    TERM	;
2376)   3B46 C8          					RET     Z	;
2377)   3B47 FD 23       					INC     IY	;
2378)   3B49 18 F4       					JR      SKIP	;
2380)   3B4B FE 2B       		SIGN:			CP      '+'	;
2381)   3B4D C8          					RET     Z	;
2382)   3B4E FE 2D       					CP      '-'	;
2383)   3B50 C9          					RET	;
2386)   3B51 4E 4F       		OPCODS:			DEFM    'NO'	;
2387)   3B53 D0          					DEFB    'P'+80H	;
2388)   3B54 00          					DEFB    0	;
2389)   3B55 52 4C 43    					DEFM    'RLC'	;
2390)   3B58 C1          					DEFB    'A'+80H	;
2391)   3B59 07          					DEFB    7	;
2392)   3B5A 45 58       					DEFM    'EX'	;
2393)   3B5C 00          					DEFB    0	;
2394)   3B5D 41 46       					DEFM    'AF'	;
2395)   3B5F 00          					DEFB    0	;
2396)   3B60 41 46       					DEFM    'AF'	;
2397)   3B62 A7          					DEFB    ''''+80H	;
2398)   3B63 08          					DEFB    8	;
2399)   3B64 52 52 43    					DEFM    'RRC'	;
2400)   3B67 C1          					DEFB    'A'+80H	;
2401)   3B68 0F          					DEFB    0FH	;
2402)   3B69 52 4C       					DEFM    'RL'	;
2403)   3B6B C1          					DEFB    'A'+80H	;
2404)   3B6C 17          					DEFB    17H	;
2405)   3B6D 52 52       					DEFM    'RR'	;
2406)   3B6F C1          					DEFB    'A'+80H	;
2407)   3B70 1F          					DEFB    1FH	;
2408)   3B71 44 41       					DEFM    'DA'	;
2409)   3B73 C1          					DEFB    'A'+80H	;
2410)   3B74 27          					DEFB    27H	;
2411)   3B75 43 50       					DEFM    'CP'	;
2412)   3B77 CC          					DEFB    'L'+80H	;
2413)   3B78 2F          					DEFB    2FH	;
2414)   3B79 53 43       					DEFM    'SC'	;
2415)   3B7B C6          					DEFB    'F'+80H	;
2416)   3B7C 37          					DEFB    37H	;
2417)   3B7D 43 43       					DEFM    'CC'	;
2418)   3B7F C6          					DEFB    'F'+80H	;
2419)   3B80 3F          					DEFB    3FH	;
2420)   3B81 48 41 4C    					DEFM    'HAL'	;
2421)   3B84 D4          					DEFB    'T'+80H	;
2422)   3B85 76          					DEFB    76H	;
2423)   3B86 45 58       					DEFM    'EX'	;
2424)   3B88 D8          					DEFB    'X'+80H	;
2425)   3B89 D9          					DEFB    0D9H	;
2426)   3B8A 45 58       					DEFM    'EX'	;
2427)   3B8C 00          					DEFB    0	;
2428)   3B8D 44 45       					DEFM    'DE'	;
2429)   3B8F 00          					DEFB    0	;
2430)   3B90 48          					DEFM    'H'	;
2431)   3B91 CC          					DEFB    'L'+80H	;
2432)   3B92 EB          					DEFB    0EBH	;
2433)   3B93 44          					DEFM    'D'	;
2434)   3B94 C9          					DEFB    'I'+80H	;
2435)   3B95 F3          					DEFB    0F3H	;
2436)   3B96 45          					DEFM    'E'	;
2437)   3B97 C9          					DEFB    'I'+80H	;
2438)   3B98 FB          					DEFB    0FBH	;
2440)   3B99 4E 45       					DEFM    'NE'	;
2441)   3B9B C7          					DEFB    'G'+80H	;
2442)   3B9C 44          					DEFB    44H	;
2443)   3B9D 49 4D       					DEFM    'IM'	;
2444)   3B9F 00          					DEFB    0	;
2445)   3BA0 B0          					DEFB    '0'+80H	;
2446)   3BA1 46          					DEFB    46H	;
2447)   3BA2 52 45 54    					DEFM    'RET'	;
2448)   3BA5 CE          					DEFB    'N'+80H	;
2449)   3BA6 45          					DEFB    45H	;
2450)   3BA7 52 45 54    					DEFM    'RET'	;
2451)   3BAA C9          					DEFB    'I'+80H	;
2452)   3BAB 4D          					DEFB    4DH	;
2453)   3BAC 49 4D       					DEFM    'IM'	;
2454)   3BAE 00          					DEFB    0	;
2455)   3BAF B1          					DEFB    '1'+80H	;
2456)   3BB0 56          					DEFB    56H	;
2457)   3BB1 49 4D       					DEFM    'IM'	;
2458)   3BB3 00          					DEFB    0	;
2459)   3BB4 B2          					DEFB    '2'+80H	;
2460)   3BB5 5E          					DEFB    5EH	;
2461)   3BB6 52 52       					DEFM    'RR'	;
2462)   3BB8 C4          					DEFB    'D'+80H	;
2463)   3BB9 67          					DEFB    67H	;
2464)   3BBA 52 4C       					DEFM    'RL'	;
2465)   3BBC C4          					DEFB    'D'+80H	;
2466)   3BBD 6F          					DEFB    6FH	;
2467)   3BBE 4C 44       					DEFM    'LD'	;
2468)   3BC0 C9          					DEFB    'I'+80H	;
2469)   3BC1 A0          					DEFB    0A0H	;
2470)   3BC2 43 50       					DEFM    'CP'	;
2471)   3BC4 C9          					DEFB    'I'+80H	;
2472)   3BC5 A1          					DEFB    0A1H	;
2473)   3BC6 49 4E       					DEFM    'IN'	;
2474)   3BC8 C9          					DEFB    'I'+80H	;
2475)   3BC9 A2          					DEFB    0A2H	;
2476)   3BCA 4F 55 54    					DEFM    'OUT'	;
2477)   3BCD C9          					DEFB    'I'+80H	;
2478)   3BCE A3          					DEFB    0A3H	;
2479)   3BCF 4C 44       					DEFM    'LD'	;
2480)   3BD1 C4          					DEFB    'D'+80H	;
2481)   3BD2 A8          					DEFB    0A8H	;
2482)   3BD3 43 50       					DEFM    'CP'	;
2483)   3BD5 C4          					DEFB    'D'+80H	;
2484)   3BD6 A9          					DEFB    0A9H	;
2485)   3BD7 49 4E       					DEFM    'IN'	;
2486)   3BD9 C4          					DEFB    'D'+80H	;
2487)   3BDA AA          					DEFB    0AAH	;
2488)   3BDB 4F 55 54    					DEFM    'OUT'	;
2489)   3BDE C4          					DEFB    'D'+80H	;
2490)   3BDF AB          					DEFB    0ABH	;
2491)   3BE0 4C 44 49    					DEFM    'LDI'	;
2492)   3BE3 D2          					DEFB    'R'+80H	;
2493)   3BE4 B0          					DEFB    0B0H	;
2494)   3BE5 43 50 49    					DEFM    'CPI'	;
2495)   3BE8 D2          					DEFB    'R'+80H	;
2496)   3BE9 B1          					DEFB    0B1H	;
2497)   3BEA 49 4E 49    					DEFM    'INI'	;
2498)   3BED D2          					DEFB    'R'+80H	;
2499)   3BEE B2          					DEFB    0B2H	;
2500)   3BEF 4F 54 49    					DEFM    'OTI'	;
2501)   3BF2 D2          					DEFB    'R'+80H	;
2502)   3BF3 B3          					DEFB    0B3H	;
2503)   3BF4 4C 44 44    					DEFM    'LDD'	;
2504)   3BF7 D2          					DEFB    'R'+80H	;
2505)   3BF8 B8          					DEFB    0B8H	;
2506)   3BF9 43 50 44    					DEFM    'CPD'	;
2507)   3BFC D2          					DEFB    'R'+80H	;
2508)   3BFD B9          					DEFB    0B9H	;
2509)   3BFE 49 4E 44    					DEFM    'IND'	;
2510)   3C01 D2          					DEFB    'R'+80H	;
2511)   3C02 BA          					DEFB    0BAH	;
2512)   3C03 4F 54 44    					DEFM    'OTD'	;
2513)   3C06 D2          					DEFB    'R'+80H	;
2514)   3C07 BB          					DEFB    0BBH	;
2516)   3C08 42 49       					DEFM    'BI'	;
2517)   3C0A D4          					DEFB    'T'+80H	;
2518)   3C0B 40          					DEFB    40H	;
2519)   3C0C 52 45       					DEFM    'RE'	;
2520)   3C0E D3          					DEFB    'S'+80H	;
2521)   3C0F 80          					DEFB    80H	;
2522)   3C10 53 45       					DEFM    'SE'	;
2523)   3C12 D4          					DEFB    'T'+80H	;
2524)   3C13 C0          					DEFB    0C0H	;
2526)   3C14 52 4C       					DEFM    'RL'	;
2527)   3C16 C3          					DEFB    'C'+80H	;
2528)   3C17 00          					DEFB    0	;
2529)   3C18 52 52       					DEFM    'RR'	;
2530)   3C1A C3          					DEFB    'C'+80H	;
2531)   3C1B 08          					DEFB    8	;
2532)   3C1C 52          					DEFM    'R'	;
2533)   3C1D CC          					DEFB    'L'+80H	;
2534)   3C1E 10          					DEFB    10H	;
2535)   3C1F 52          					DEFM    'R'	;
2536)   3C20 D2          					DEFB    'R'+80H	;
2537)   3C21 18          					DEFB    18H	;
2538)   3C22 53 4C       					DEFM    'SL'	;
2539)   3C24 C1          					DEFB    'A'+80H	;
2540)   3C25 20          					DEFB    20H	;
2541)   3C26 53 52       					DEFM    'SR'	;
2542)   3C28 C1          					DEFB    'A'+80H	;
2543)   3C29 28          					DEFB    28H	;
2544)   3C2A 53 52       					DEFM    'SR'	;
2545)   3C2C CC          					DEFB    'L'+80H	;
2546)   3C2D 38          					DEFB    38H	;
2548)   3C2E 50 4F       					DEFM    'PO'	;
2549)   3C30 D0          					DEFB    'P'+80H	;
2550)   3C31 C1          					DEFB    0C1H	;
2551)   3C32 50 55 53    					DEFM    'PUS'	;
2552)   3C35 C8          					DEFB    'H'+80H	;
2553)   3C36 C5          					DEFB    0C5H	;
2554)   3C37 45 58       					DEFM    'EX'	;
2555)   3C39 00          					DEFB    0	;
2556)   3C3A 28 53       					DEFM    '(S'	;
2557)   3C3C D0          					DEFB    'P'+80H	;
2558)   3C3D E3          					DEFB    0E3H	;
2560)   3C3E 53 55       					DEFM    'SU'	;
2561)   3C40 C2          					DEFB    'B'+80H	;
2562)   3C41 90          					DEFB    90H	;
2563)   3C42 41 4E       					DEFM    'AN'	;
2564)   3C44 C4          					DEFB    'D'+80H	;
2565)   3C45 A0          					DEFB    0A0H	;
2566)   3C46 58 4F       					DEFM    'XO'	;
2567)   3C48 D2          					DEFB    'R'+80H	;
2568)   3C49 A8          					DEFB    0A8H	;
2569)   3C4A 4F          					DEFM    'O'	;
2570)   3C4B D2          					DEFB    'R'+80H	;
2571)   3C4C B0          					DEFB    0B0H	;
2572)   3C4D 43          					DEFM    'C'	;
2573)   3C4E D0          					DEFB    'P'+80H	;
2574)   3C4F B8          					DEFB    0B8H	;
2575)   3C50 80          					DEFB    TAND	;
2576)   3C51 A0          					DEFB    0A0H	;
2577)   3C52 84          					DEFB    TOR	;
2578)   3C53 B0          					DEFB    0B0H	;
2580)   3C54 41 44       					DEFM    'AD'	;
2581)   3C56 C4          					DEFB    'D'+80H	;
2582)   3C57 80          					DEFB    80H	;
2583)   3C58 41 44       					DEFM    'AD'	;
2584)   3C5A C3          					DEFB    'C'+80H	;
2585)   3C5B 88          					DEFB    88H	;
2586)   3C5C 53 42       					DEFM    'SB'	;
2587)   3C5E C3          					DEFB    'C'+80H	;
2588)   3C5F 98          					DEFB    98H	;
2590)   3C60 49 4E       					DEFM    'IN'	;
2591)   3C62 C3          					DEFB    'C'+80H	;
2592)   3C63 04          					DEFB    4	;
2593)   3C64 44 45       					DEFM    'DE'	;
2594)   3C66 C3          					DEFB    'C'+80H	;
2595)   3C67 05          					DEFB    5	;
2597)   3C68 49          					DEFM    'I'	;
2598)   3C69 CE          					DEFB    'N'+80H	;
2599)   3C6A 40          					DEFB    40H	;
2600)   3C6B 4F 55       					DEFM    'OU'	;
2601)   3C6D D4          					DEFB    'T'+80H	;
2602)   3C6E 41          					DEFB    41H	;
2604)   3C6F 4A          					DEFM    'J'	;
2605)   3C70 D2          					DEFB    'R'+80H	;
2606)   3C71 20          					DEFB    20H	;
2607)   3C72 44 4A 4E    					DEFM    'DJN'	;
2608)   3C75 DA          					DEFB    'Z'+80H	;
2609)   3C76 10          					DEFB    10H	;
2611)   3C77 4A          					DEFM    'J'	;
2612)   3C78 D0          					DEFB    'P'+80H	;
2613)   3C79 C2          					DEFB    0C2H	;
2615)   3C7A 43 41 4C    					DEFM    'CAL'	;
2616)   3C7D CC          					DEFB    'L'+80H	;
2617)   3C7E C4          					DEFB    0C4H	;
2619)   3C7F 52 53       					DEFM    'RS'	;
2620)   3C81 D4          					DEFB    'T'+80H	;
2621)   3C82 C7          					DEFB    0C7H	;
2623)   3C83 52 45       					DEFM    'RE'	;
2624)   3C85 D4          					DEFB    'T'+80H	;
2625)   3C86 C0          					DEFB    0C0H	;
2627)   3C87 4C          					DEFM    'L'	;
2628)   3C88 C4          					DEFB    'D'+80H	;
2629)   3C89 40          					DEFB    40H	;
2631)   3C8A 5D          					DEFB    DEF AND 7FH	;
2632)   3C8B CD          					DEFB    'M'+80H	;
2633)   3C8C 00          					DEFB    0	;
2635)   3C8D 5D          					DEFB    DEF AND 7FH	;
2636)   3C8E C2          					DEFB    'B'+80H	;
2637)   3C8F 00          					DEFB    0	;
2639)   3C90 4F 50       					DEFM    'OP'	;
2640)   3C92 D4          					DEFB    'T'+80H	;
2641)   3C93 00          					DEFB    0	;
2643)   3C94 5D          					DEFB    DEF AND 7FH	;
2644)   3C95 D7          					DEFB    'W'+80H	;
2645)   3C96 00          					DEFB    0	;
2647)   3C97 00          					DEFB    0	;
2649)   3C98 C2          		OPRNDS:			DEFB    'B'+80H	;
2650)   3C99 00          					DEFB    0	;
2651)   3C9A C3          					DEFB    'C'+80H	;
2652)   3C9B 01          					DEFB    1	;
2653)   3C9C C4          					DEFB    'D'+80H	;
2654)   3C9D 02          					DEFB    2	;
2655)   3C9E C5          					DEFB    'E'+80H	;
2656)   3C9F 03          					DEFB    3	;
2657)   3CA0 C8          					DEFB    'H'+80H	;
2658)   3CA1 04          					DEFB    4	;
2659)   3CA2 CC          					DEFB    'L'+80H	;
2660)   3CA3 05          					DEFB    5	;
2661)   3CA4 28 48       					DEFM    '(H'	;
2662)   3CA6 CC          					DEFB    'L'+80H	;
2663)   3CA7 06          					DEFB    6	;
2664)   3CA8 C1          					DEFB    'A'+80H	;
2665)   3CA9 07          					DEFB    7	;
2666)   3CAA 28 49       					DEFM    '(I'	;
2667)   3CAC D8          					DEFB    'X'+80H	;
2668)   3CAD 86          					DEFB    86H	;
2669)   3CAE 28 49       					DEFM    '(I'	;
2670)   3CB0 D9          					DEFB    'Y'+80H	;
2671)   3CB1 C6          					DEFB    0C6H	;
2673)   3CB2 42          					DEFM    'B'	;
2674)   3CB3 C3          					DEFB    'C'+80H	;
2675)   3CB4 08          					DEFB    8	;
2676)   3CB5 44          					DEFM    'D'	;
2677)   3CB6 C5          					DEFB    'E'+80H	;
2678)   3CB7 0A          					DEFB    10	;
2679)   3CB8 48          					DEFM    'H'	;
2680)   3CB9 CC          					DEFB    'L'+80H	;
2681)   3CBA 0C          					DEFB    12	;
2682)   3CBB 49          					DEFM    'I'	;
2683)   3CBC D8          					DEFB    'X'+80H	;
2684)   3CBD 8C          					DEFB    8CH	;
2685)   3CBE 49          					DEFM    'I'	;
2686)   3CBF D9          					DEFB    'Y'+80H	;
2687)   3CC0 CC          					DEFB    0CCH	;
2688)   3CC1 41          					DEFM    'A'	;
2689)   3CC2 C6          					DEFB    'F'+80H	;
2690)   3CC3 0E          					DEFB    14	;
2691)   3CC4 53          					DEFM    'S'	;
2692)   3CC5 D0          					DEFB    'P'+80H	;
2693)   3CC6 0E          					DEFB    14	;
2695)   3CC7 4E          					DEFM    'N'	;
2696)   3CC8 DA          					DEFB    'Z'+80H	;
2697)   3CC9 10          					DEFB    16	;
2698)   3CCA DA          					DEFB    'Z'+80H	;
2699)   3CCB 11          					DEFB    17	;
2700)   3CCC 4E          					DEFM    'N'	;
2701)   3CCD C3          					DEFB    'C'+80H	;
2702)   3CCE 12          					DEFB    18	;
2703)   3CCF 50          					DEFM    'P'	;
2704)   3CD0 CF          					DEFB    'O'+80H	;
2705)   3CD1 14          					DEFB    20	;
2706)   3CD2 50          					DEFM    'P'	;
2707)   3CD3 C5          					DEFB    'E'+80H	;
2708)   3CD4 15          					DEFB    21	;
2709)   3CD5 D0          					DEFB    'P'+80H	;
2710)   3CD6 16          					DEFB    22	;
2711)   3CD7 CD          					DEFB    'M'+80H	;
2712)   3CD8 17          					DEFB    23	;
2714)   3CD9 28          					DEFM    '('	;
2715)   3CDA C3          					DEFB    'C'+80H	;
2716)   3CDB 20          					DEFB    20H	;
2718)   3CDC 00          					DEFB    0	;
2720)   3CDD 49          		LDOPS:			DEFM    'I'	;
2721)   3CDE 00          					DEFB    0	;
2722)   3CDF C1          					DEFB    'A'+80H	;
2723)   3CE0 47          					DEFB    47H	;
2724)   3CE1 52          					DEFM    'R'	;
2725)   3CE2 00          					DEFB    0	;
2726)   3CE3 C1          					DEFB    'A'+80H	;
2727)   3CE4 4F          					DEFB    4FH	;
2728)   3CE5 41          					DEFM    'A'	;
2729)   3CE6 00          					DEFB    0	;
2730)   3CE7 C9          					DEFB    'I'+80H	;
2731)   3CE8 57          					DEFB    57H	;
2732)   3CE9 41          					DEFM    'A'	;
2733)   3CEA 00          					DEFB    0	;
2734)   3CEB D2          					DEFB    'R'+80H	;
2735)   3CEC 5F          					DEFB    5FH	;
2736)   3CED 28 42 43    					DEFM    '(BC'	;
2737)   3CF0 00          					DEFB    0	;
2738)   3CF1 C1          					DEFB    'A'+80H	;
2739)   3CF2 02          					DEFB    2	;
2740)   3CF3 28 44 45    					DEFM    '(DE'	;
2741)   3CF6 00          					DEFB    0	;
2742)   3CF7 C1          					DEFB    'A'+80H	;
2743)   3CF8 12          					DEFB    12H	;
2744)   3CF9 41          					DEFM    'A'	;
2745)   3CFA 00          					DEFB    0	;
2746)   3CFB 28 42       					DEFM    '(B'	;
2747)   3CFD C3          					DEFB    'C'+80H	;
2748)   3CFE 0A          					DEFB    0AH	;
2749)   3CFF 41          					DEFM    'A'	;
2750)   3D00 00          					DEFB    0	;
2751)   3D01 28 44       					DEFM    '(D'	;
2752)   3D03 C5          					DEFB    'E'+80H	;
2753)   3D04 1A          					DEFB    1AH	;
2755)   3D05 00          					DEFB    0	;
 29)   3D06 26 43       		FUNTBL:			DEFW    DECODE          ;Line number	;Line number
 30)   3D08 7F 40       					DEFW    OPENIN          ;OPENIN	;OPENIN
 31)   3D0A 9C 40       					DEFW    PTR             ;PTR	;PTR
 32)   3D0C 51 40       					DEFW    PAGEV           ;PAGE	;PAGE
 33)   3D0E A4 40       					DEFW    TIMEV           ;TIME	;TIME
 34)   3D10 47 40       					DEFW    LOMEMV          ;LOMEM	;LOMEM
 35)   3D12 4C 40       					DEFW    HIMEMV          ;HIMEM	;HIMEM
 36)   3D14 F0 40       					DEFW    ABS             ;ABS	;ABS
 37)   3D16 2C 41       					DEFW    ACS             ;ACS	;ACS
 38)   3D18 69 01       					DEFW    ADVAL           ;ADVAL	;ADVAL
 39)   3D1A 34 40       					DEFW    ASC             ;ASC	;ASC
 40)   3D1C 24 41       					DEFW    ASN             ;ASN	;ASN
 41)   3D1E 28 41       					DEFW    ATN             ;ATN	;ATN
 42)   3D20 10 40       					DEFW    BGET            ;BGET	;BGET
 43)   3D22 10 41       					DEFW    COS             ;COS	;COS
 44)   3D24 6F 40       					DEFW    COUNTV          ;COUNT	;COUNT
 45)   3D26 F8 40       					DEFW    DEG             ;DEG	;DEG
 46)   3D28 65 40       					DEFW    ERLV            ;ERL	;ERL
 47)   3D2A 6A 40       					DEFW    ERRV            ;ERR	;ERR
 48)   3D2C 50 41       					DEFW    EVAL            ;EVAL	;EVAL
 49)   3D2E 18 41       					DEFW    EXP             ;EXP	;EXP
 50)   3D30 94 40       					DEFW    EXT             ;EXT	;EXT
 51)   3D32 BE 43       					DEFW    ZERO            ;FALSE	;FALSE
 52)   3D34 1C 31       					DEFW    FN              ;FN	;FN
 53)   3D36 1E 40       					DEFW    GET             ;GET	;GET
 54)   3D38 19 40       					DEFW    INKEY           ;INKEY	;INKEY
 55)   3D3A E9 41       					DEFW    INSTR           ;INSTR(	;INSTR(
 56)   3D3C 04 41       					DEFW    INT             ;INT	;INT
 57)   3D3E 41 40       					DEFW    LEN             ;LEN	;LEN
 58)   3D40 1C 41       					DEFW    LN              ;LN	;LN
 59)   3D42 20 41       					DEFW    LOG             ;LOG	;LOG
 60)   3D44 F4 40       					DEFW    NOTK            ;NOT	;NOT
 61)   3D46 7C 40       					DEFW    OPENUP          ;OPENUP	;OPENUP
 62)   3D48 7A 40       					DEFW    OPENOT          ;OPENOUT	;OPENOUT
 63)   3D4A EC 40       					DEFW    PI              ;PI	;PI
 64)   3D4C 6C 01       					DEFW    POINT           ;POINT(	;POINT(
 65)   3D4E F9 3F       					DEFW    POS             ;POS	;POS
 66)   3D50 FC 40       					DEFW    RAD             ;RAD	;RAD
 67)   3D52 7D 41       					DEFW    RND             ;RND	;RND
 68)   3D54 00 41       					DEFW    SGN             ;SGN	;SGN
 69)   3D56 14 41       					DEFW    SIN             ;SIN	;SIN
 70)   3D58 08 41       					DEFW    SQR             ;SQR	;SQR
 71)   3D5A 0C 41       					DEFW    TAN             ;TAN	;TAN
 72)   3D5C 56 40       					DEFW    TOPV            ;TO(P)	;TO(P)
 73)   3D5E E1 40       					DEFW    TRUE            ;TRUE	;TRUE
 74)   3D60 00 35       					DEFW    USR             ;USR	;USR
 75)   3D62 43 41       					DEFW    VAL             ;VAL	;VAL
 76)   3D64 FF 3F       					DEFW    VPOS            ;VPOS	;VPOS
 77)   3D66 67 42       					DEFW    CHRS            ;CHRS	;CHRS
 78)   3D68 6E 42       					DEFW    GETS            ;GETS	;GETS
 79)   3D6A 74 42       					DEFW    INKEYS          ;INKEYS	;INKEYS
 80)   3D6C B5 42       					DEFW    LEFTS           ;LEFTS(	;LEFTS(
 81)   3D6E 84 42       					DEFW    MIDS            ;MIDS(	;MIDS(
 82)   3D70 D0 42       					DEFW    RIGHTS          ;RIGHTS(	;RIGHTS(
 83)   3D72 7E 43       					DEFW    STRS            ;STR$	;STR$
 84)   3D74 E4 42       					DEFW    STRING          ;STRINGS(	;STRINGS(
 85)   3D76 04 40       					DEFW    EOF             ;EOF	;EOF
 95)   3D78 CF 40       		SOPTBL:			DEFW    SLE             ;<= (STRING)	;<= (STRING)
 96)   3D7A D7 40       					DEFW    SNE             ;<>	;<>
 97)   3D7C C9 40       					DEFW    SGE             ;>=	;>=
 98)   3D7E BC 40       					DEFW    SLT             ;<	;<
 99)   3D80 DD 40       					DEFW    SEQ             ;=	;=
100)   3D82 C2 40       					DEFW    SGT             ;>	;>
119)   3D84 CD 99 3D    		@EXPR:			CALL    EXPR1           ;GET FIRST OPERAND	;GET FIRST OPERAND
120)   3D87 FE 82       		EXPR0A:			CP      EORK            ;CHECK OPERATOR	;CHECK OPERATOR
121)   3D89 28 03       					JR      Z,EXPR0B	;
122)   3D8B FE 84       					CP      ORK	;
123)   3D8D C0          					RET     NZ	;
124)   3D8E CD 49 44    		EXPR0B:			CALL    SAVE            ;SAVE FIRST OPERAND	;SAVE FIRST OPERAND
125)   3D91 CD 99 3D    					CALL    EXPR1           ;GET SECOND OPERAND	;GET SECOND OPERAND
126)   3D94 CD 57 44    					CALL    DOIT            ;DO OPERATION	;DO OPERATION
127)   3D97 18 EE       					JR      EXPR0A          ;CONTINUE	;CONTINUE
129)   3D99 CD AA 3D    		EXPR1:			CALL    EXPR2	;
130)   3D9C FE 80       		EXPR1A:			CP      ANDK	;
131)   3D9E C0          					RET     NZ	;
132)   3D9F CD 49 44    					CALL    SAVE	;
133)   3DA2 CD AA 3D    					CALL    EXPR2	;
134)   3DA5 CD 57 44    					CALL    DOIT	;
135)   3DA8 18 F2       					JR      EXPR1A	;
137)   3DAA CD 09 3E    		EXPR2:			CALL    EXPR3	;
138)   3DAD CD 24 44    					CALL    RELOP?	;
139)   3DB0 C0          					RET     NZ	;
140)   3DB1 47          					LD      B,A	;
141)   3DB2 FD 23       					INC     IY              ;BUMP OVER OPERATOR	;BUMP OVER OPERATOR
142)   3DB4 CD 78 44    					CALL    NXT	;
143)   3DB7 CD 24 44    					CALL    RELOP?          ;COMPOUND OPERATOR?	;COMPOUND OPERATOR?
144)   3DBA 20 08       					JR      NZ,EXPR2B	;
145)   3DBC FD 23       					INC     IY	;
146)   3DBE B8          					CP      B	;
147)   3DBF CA BF 2D    					JP      Z,SYNTAX        ;ILLEGAL COMBINATION	;ILLEGAL COMBINATION
148)   3DC2 80          					ADD     A,B	;
149)   3DC3 47          					LD      B,A	;
150)   3DC4 78          		EXPR2B:			LD      A,B	;
151)   3DC5 08          					EX      AF,AF'	;
152)   3DC6 FA DC 3D    					JP      M,EXPR2S	;
153)   3DC9 08          					EX      AF,AF'	;
154)   3DCA D6 04       					SUB     4	;
155)   3DCC FE 3A       					CP      '>'-4	;
156)   3DCE 20 02       					JR      NZ,EXPR2C	;
157)   3DD0 C6 02       					ADD     A,2	;
158)   3DD2 CD 4B 44    		EXPR2C:			CALL    SAVE1	;
159)   3DD5 CD 09 3E    					CALL    EXPR3	;
160)   3DD8 CD 57 44    					CALL    DOIT            ;Must NOT be "JP DOIT"	;Must NOT be "JP DOIT"
161)   3DDB C9          					RET	;
163)   3DDC 08          		EXPR2S:			EX      AF,AF'	;
164)   3DDD 3D          					DEC     A	;
165)   3DDE E6 07       					AND     7	;
166)   3DE0 CD DF 43    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
167)   3DE3 F5          					PUSH    AF              ;SAVE OPERATOR	;SAVE OPERATOR
168)   3DE4 CD 09 3E    					CALL    EXPR3           ;SECOND STRING	;SECOND STRING
169)   3DE7 08          					EX      AF,AF'	;
170)   3DE8 F2 B9 3E    					JP      P,TYPE	;
171)   3DEB F1          					POP     AF	;
172)   3DEC 4B          					LD      C,E             ;LENGTH OF STRING #2	;LENGTH OF STRING #2
173)   3DED D1          					POP     DE	;
174)   3DEE 21 00 00    					LD      HL,0	;
175)   3DF1 39          					ADD     HL,SP	;
176)   3DF2 43          					LD      B,E             ;LENGTH OF STRING #1	;LENGTH OF STRING #1
177)   3DF3 D5          					PUSH    DE	;
178)   3DF4 11 00 80    					LD      DE,ACCS	;
179)   3DF7 EB          					EX      DE,HL	;
180)   3DF8 CD 83 44    					CALL    DISPT2	;
181)   3DFB D1          					POP     DE	;
182)   3DFC EB          					EX      DE,HL	;
183)   3DFD 26 00       					LD      H,0	;
184)   3DFF 39          					ADD     HL,SP	;
185)   3E00 F9          					LD      SP,HL	;
186)   3E01 EB          					EX      DE,HL	;
187)   3E02 AF          					XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
188)   3E03 4F          					LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
189)   3E04 08          					EX      AF,AF'	;
190)   3E05 FD 7E 00    					LD      A,(IY)	;
191)   3E08 C9          					RET	;
193)   3E09 CD 58 3E    		EXPR3:			CALL    EXPR4	;
194)   3E0C FE 2D       		EXPR3A:			CP      '-'	;
195)   3E0E 28 08       					JR      Z,EXPR3B	;
196)   3E10 FE 2B       					CP      '+'	;
197)   3E12 C0          					RET     NZ	;
198)   3E13 08          					EX      AF,AF'	;
199)   3E14 FA 23 3E    					JP      M,EXPR3S	;
200)   3E17 08          					EX      AF,AF'	;
201)   3E18 CD 49 44    		EXPR3B:			CALL    SAVE	;
202)   3E1B CD 58 3E    					CALL    EXPR4	;
203)   3E1E CD 57 44    					CALL    DOIT	;
204)   3E21 18 E9       					JR      EXPR3A	;
206)   3E23 08          		EXPR3S:			EX      AF,AF'	;
207)   3E24 FD 23       					INC     IY              ;BUMP PAST '+'	;BUMP PAST '+'
208)   3E26 CD DF 43    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
209)   3E29 CD 58 3E    					CALL    EXPR4           ;SECOND STRING	;SECOND STRING
210)   3E2C 08          					EX      AF,AF'	;
211)   3E2D F2 B9 3E    					JP      P,TYPE	;
212)   3E30 4B          					LD      C,E             ;C=LENGTH	;C=LENGTH
213)   3E31 D1          					POP     DE	;
214)   3E32 D5          					PUSH    DE	;
215)   3E33 21 00 80    					LD      HL,ACCS	;
216)   3E36 54          					LD      D,H	;
217)   3E37 79          					LD      A,C	;
218)   3E38 B7          					OR      A	;
219)   3E39 28 0F       					JR      Z,EXP3S3	;
220)   3E3B 45          					LD      B,L	;
221)   3E3C 6F          					LD      L,A             ;SOURCE	;SOURCE
222)   3E3D 83          					ADD     A,E	;
223)   3E3E 5F          					LD      E,A             ;DESTINATION	;DESTINATION
224)   3E3F 3E 13       					LD      A,19	;
225)   3E41 DA DB 26    					JP      C,ERROR         ;"String too long"	;"String too long"
226)   3E44 D5          					PUSH    DE	;
227)   3E45 1D          					DEC     E	;
228)   3E46 2D          					DEC     L	;
229)   3E47 ED B8       					LDDR                    ;COPY	;COPY
230)   3E49 D1          					POP     DE	;
231)   3E4A D9          		EXP3S3:			EXX	;
232)   3E4B C1          					POP     BC	;
233)   3E4C CD FE 43    					CALL    POPS            ;RESTORE FROM STACK	;RESTORE FROM STACK
234)   3E4F D9          					EXX	;
235)   3E50 F6 80       					OR      80H             ;FLAG STRING	;FLAG STRING
236)   3E52 08          					EX      AF,AF'	;
237)   3E53 FD 7E 00    					LD      A,(IY)	;
238)   3E56 18 B4       					JR      EXPR3A	;
240)   3E58 CD 75 3E    		EXPR4:			CALL    EXPR5	;
241)   3E5B FE 2A       		EXPR4A:			CP      '*'	;
242)   3E5D 28 0B       					JR      Z,EXPR4B	;
243)   3E5F FE 2F       					CP      '/'	;
244)   3E61 28 07       					JR      Z,EXPR4B	;
245)   3E63 FE 83       					CP      MODK	;
246)   3E65 28 03       					JR      Z,EXPR4B	;
247)   3E67 FE 81       					CP      DIVK	;
248)   3E69 C0          					RET     NZ	;
249)   3E6A CD 49 44    		EXPR4B:			CALL    SAVE	;
250)   3E6D CD 75 3E    					CALL    EXPR5	;
251)   3E70 CD 57 44    					CALL    DOIT	;
252)   3E73 18 E6       					JR      EXPR4A	;
254)   3E75 CD 10 3F    		EXPR5:			CALL    ITEM	;
255)   3E78 B7          					OR      A               ;TEST TYPE	;TEST TYPE
256)   3E79 08          					EX      AF,AF'          ;SAVE TYPE	;SAVE TYPE
257)   3E7A CD 78 44    		EXPR5A:			CALL    NXT	;
258)   3E7D FE 5E       					CP      '^'	;
259)   3E7F C0          					RET     NZ	;
260)   3E80 CD 49 44    					CALL    SAVE	;
261)   3E83 CD 10 3F    					CALL    ITEM	;
262)   3E86 B7          					OR      A	;
263)   3E87 08          					EX      AF,AF'	;
264)   3E88 CD 57 44    					CALL    DOIT	;
265)   3E8B 18 ED       					JR      EXPR5A	;
267)   3E8D CD 84 3D    		@EXPRN:			CALL    EXPR	;
268)   3E90 08          					EX      AF,AF'	;
269)   3E91 F0          					RET     P	;
270)   3E92 18 25       					JR      TYPE	;
272)   3E94 CD 84 3D    		@EXPRI:			CALL    EXPR	;
273)   3E97 08          					EX      AF,AF'	;
274)   3E98 F2 3B 41    					JP      P,SFIX	;
275)   3E9B 18 1C       					JR      TYPE	;
277)   3E9D CD 84 3D    		@EXPRS:			CALL    EXPR	;
278)   3EA0 08          					EX      AF,AF'	;
279)   3EA1 F8          					RET     M	;
280)   3EA2 18 15       					JR      TYPE	;
283)   3EA4 CD 10 3F    		ITEMN:			CALL    ITEM	;
284)   3EA7 B7          					OR      A	;
285)   3EA8 F0          					RET     P	;
286)   3EA9 18 0E       					JR      TYPE	;
288)   3EAB CD 10 3F    		@ITEMI:			CALL    ITEM	;
289)   3EAE B7          					OR      A	;
290)   3EAF F2 3B 41    					JP      P,SFIX	;
291)   3EB2 18 05       					JR      TYPE	;
293)   3EB4 CD 10 3F    		ITEMS:			CALL    ITEM	;
294)   3EB7 B7          					OR      A	;
295)   3EB8 F8          					RET     M	;
296)   3EB9 3E 06       		TYPE:			LD      A,6	;
297)   3EBB C3 DB 26    					JP      ERROR           ;"Type mismatch"	;"Type mismatch"
299)   3EBE CD 84 3D    		ITEM1:			CALL    EXPR            ;BRACKETED EXPR	;BRACKETED EXPR
300)   3EC1 CD 3C 44    					CALL    BRAKET	;
301)   3EC4 08          					EX      AF,AF'	;
302)   3EC5 C9          					RET	;
309)   3EC6 CD BE 43    		HEX:			CALL    ZERO	;
310)   3EC9 CD 11 44    					CALL    HEXDIG	;
311)   3ECC 38 18       					JR      C,BADHEX	;
312)   3ECE FD 23       		HEX1:			INC     IY	;
313)   3ED0 E6 0F       					AND     0FH	;
314)   3ED2 06 04       					LD      B,4	;
315)   3ED4 D9          		HEX2:			EXX	;
316)   3ED5 29          					ADD     HL,HL	;
317)   3ED6 D9          					EXX	;
318)   3ED7 ED 6A       					ADC     HL,HL	;
319)   3ED9 10 F9       					DJNZ    HEX2	;
320)   3EDB D9          					EXX	;
321)   3EDC B5          					OR      L	;
322)   3EDD 6F          					LD      L,A	;
323)   3EDE D9          					EXX	;
324)   3EDF CD 11 44    					CALL    HEXDIG	;
325)   3EE2 30 EA       					JR      NC,HEX1	;
326)   3EE4 AF          					XOR     A	;
327)   3EE5 C9          					RET	;
329)   3EE6 3E 1C       		BADHEX:			LD      A,28	;
330)   3EE8 C3 DB 26    					JP      ERROR           ;"Bad HEX"	;"Bad HEX"
337)   3EEB CD A4 3E    		MINUS:			CALL    ITEMN	;
338)   3EEE 0D          		MINUS0:			DEC     C	;
339)   3EEF 0C          					INC     C	;
340)   3EF0 28 06       					JR      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
341)   3EF2 7C          					LD      A,H	;
342)   3EF3 EE 80       					XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
343)   3EF5 67          					LD      H,A	;
344)   3EF6 AF          					XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
345)   3EF7 C9          					RET	;
347)   3EF8 D9          		NEGATE:			EXX	;
348)   3EF9 7C          					LD      A,H	;
349)   3EFA 2F          					CPL	;
350)   3EFB 67          					LD      H,A	;
351)   3EFC 7D          					LD      A,L	;
352)   3EFD 2F          					CPL	;
353)   3EFE 6F          					LD      L,A	;
354)   3EFF D9          					EXX	;
355)   3F00 7C          					LD      A,H	;
356)   3F01 2F          					CPL	;
357)   3F02 67          					LD      H,A	;
358)   3F03 7D          					LD      A,L	;
359)   3F04 2F          					CPL	;
360)   3F05 6F          					LD      L,A	;
361)   3F06 D9          		ADD1:			EXX	;
362)   3F07 23          					INC     HL	;
363)   3F08 7C          					LD      A,H	;
364)   3F09 B5          					OR      L	;
365)   3F0A D9          					EXX	;
366)   3F0B 3E 00       					LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
367)   3F0D C0          					RET     NZ	;
368)   3F0E 23          					INC     HL	;
369)   3F0F C9          					RET	;
378)   3F10 CD BF 35    		ITEM:			CALL    CHECK	;
379)   3F13 CD 78 44    					CALL    NXT	;
380)   3F16 FD 23       					INC     IY	;
381)   3F18 FE 26       					CP      '&'	;
382)   3F1A 28 AA       					JR      Z,HEX           ;HEX CONSTANT	;HEX CONSTANT
383)   3F1C FE 2D       					CP      '-'	;
384)   3F1E 28 CB       					JR      Z,MINUS         ;UNARY MINUS	;UNARY MINUS
385)   3F20 FE 2B       					CP      '+'	;
386)   3F22 28 80       					JR      Z,ITEMN         ;UNARY PLUS	;UNARY PLUS
387)   3F24 FE 28       					CP      '('	;
388)   3F26 28 96       					JR      Z,ITEM1         ;EXPRESSION	;EXPRESSION
389)   3F28 FE 22       					CP      34		;ASCII ""	;ASCII ""
390)   3F2A 28 63       					JR      Z,CONS          ;STRING CONSTANT	;STRING CONSTANT
391)   3F2C FE C6       					CP      TCMD	;
392)   3F2E D2 BF 2D    					JP      NC,SYNTAX       ;SYNTAX ERROR	;SYNTAX ERROR
393)   3F31 FE 8D       					CP      FUNTOK	;
394)   3F33 D2 89 44    					JP      NC,DISPAT       ;FUNCTION	;FUNCTION
395)   3F36 FD 2B       					DEC     IY	;
396)   3F38 FE 3A       					CP      ':'	;
397)   3F3A 30 08       					JR      NC,ITEM2        ;VARIABLE?	;VARIABLE?
398)   3F3C FE 30       					CP      '0'	;
399)   3F3E 30 74       					JR      NC,CON          ;NUMERIC CONSTANT	;NUMERIC CONSTANT
400)   3F40 FE 2E       					CP      '.'	;
401)   3F42 28 70       					JR      Z,CON           ;NUMERIC CONSTANT	;NUMERIC CONSTANT
402)   3F44 CD 3F 29    		ITEM2:			CALL    GETVAR          ;VARIABLE	;VARIABLE
403)   3F47 20 2B       					JR      NZ,NOSUCH	;
404)   3F49 B7          					OR      A	;
405)   3F4A FA D7 3F    					JP      M,LOADS         ;STRING VARIABLE	;STRING VARIABLE
406)   3F4D B7          		@LOADN:			OR      A	;
407)   3F4E 28 18       					JR      Z,LOAD1         ;BYTE VARIABLE	;BYTE VARIABLE
408)   3F50 0E 00       					LD      C,0	;
409)   3F52 CB 47       					BIT     0,A	;
410)   3F54 28 03       					JR      Z,LOAD4         ;INTEGER VARIABLE	;INTEGER VARIABLE
411)   3F56 DD 4E 04    		LOAD5:			LD      C,(IX+4)	;
412)   3F59 D9          		@LOAD4:			EXX	;
413)   3F5A DD 6E 00    					LD      L,(IX+0)	;
414)   3F5D DD 66 01    					LD      H,(IX+1)	;
415)   3F60 D9          					EXX	;
416)   3F61 DD 6E 02    					LD      L,(IX+2)	;
417)   3F64 DD 66 03    					LD      H,(IX+3)	;
418)   3F67 C9          					RET	;
420)   3F68 21 00 00    		LOAD1:			LD      HL,0	;
421)   3F6B D9          					EXX	;
422)   3F6C 26 00       					LD      H,0	;
423)   3F6E DD 6E 00    					LD      L,(IX+0)	;
424)   3F71 D9          					EXX	;
425)   3F72 4C          					LD      C,H	;
426)   3F73 C9          					RET	;
428)   3F74 DA BF 2D    		NOSUCH:			JP      C,SYNTAX	;
429)   3F77 3A FE 82    					LD      A,(LISTON)	;
430)   3F7A CB 6F       					BIT     5,A	;
431)   3F7C 3E 1A       					LD      A,26	;
432)   3F7E 20 23       					JR      NZ,ERROR0       ;"No such variable"	;"No such variable"
433)   3F80 FD 23       		NOS1:			INC     IY	;
434)   3F82 CD 26 2B    					CALL    RANGE	;
435)   3F85 30 F9       					JR      NC,NOS1	;
436)   3F87 DD 21 40 82 					LD      IX,PC	;
437)   3F8B AF          					XOR     A	;
438)   3F8C 4F          					LD      C,A	;
439)   3F8D 18 CA       					JR      LOAD4	;
448)   3F8F 11 00 80    		@CONS:			LD      DE,ACCS	;
449)   3F92 FD 7E 00    		CONS3:			LD      A,(IY)	;
450)   3F95 FD 23       					INC     IY	;
451)   3F97 FE 22       					CP      34		;ASCII ""	;ASCII ""
452)   3F99 28 0B       					JR      Z,CONS2	;
453)   3F9B 12          		CONS1:			LD      (DE),A	;
454)   3F9C 1C          					INC     E	;
455)   3F9D FE 0D       					CP      CR	;
456)   3F9F 20 F1       					JR      NZ,CONS3	;
457)   3FA1 3E 09       					LD      A,9	;
458)   3FA3 C3 DB 26    		ERROR0:			JP      ERROR           ;"Missing """	;"Missing """
460)   3FA6 FD 7E 00    		CONS2:			LD      A,(IY)	;
461)   3FA9 FE 34       					CP      0x34		;ASCII "	;ASCII "
462)   3FAB FD 23       					INC     IY	;
463)   3FAD 28 EC       					JR      Z,CONS1	;
464)   3FAF FD 2B       					DEC     IY	;
465)   3FB1 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
466)   3FB3 C9          					RET	;
474)   3FB4 FD E5       		CON:			PUSH    IY	;
475)   3FB6 DD E1       					POP     IX	;
476)   3FB8 3E 24       					LD      A,36	;
477)   3FBA CD 9C 44    					CALL    FPP	;
478)   3FBD 38 E4       					JR      C,ERROR0	;
479)   3FBF DD E5       					PUSH    IX	;
480)   3FC1 FD E1       					POP     IY	;
481)   3FC3 AF          					XOR     A	;
482)   3FC4 C9          					RET	;
484)   3FC5 DD 46 04    		@DLOAD5:		LD      B,(IX+4)	;
485)   3FC8 D9          					EXX	;
486)   3FC9 DD 5E 00    					LD      E,(IX+0)	;
487)   3FCC DD 56 01    					LD      D,(IX+1)	;
488)   3FCF D9          					EXX	;
489)   3FD0 DD 5E 02    					LD      E,(IX+2)	;
490)   3FD3 DD 56 03    					LD      D,(IX+3)	;
491)   3FD6 C9          					RET	;
493)   3FD7 11 00 80    		@LOADS:			LD      DE,ACCS	;
494)   3FDA 1F          					RRA	;
495)   3FDB 30 10       					JR      NC,LOADS2       ;FIXED STRING	;FIXED STRING
496)   3FDD CD 59 3F    					CALL    LOAD4	;
497)   3FE0 D9          					EXX	;
498)   3FE1 7D          					LD      A,L	;
499)   3FE2 D9          					EXX	;
500)   3FE3 B7          					OR      A	;
501)   3FE4 4F          					LD      C,A	;
502)   3FE5 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
503)   3FE7 C8          					RET     Z	;
504)   3FE8 06 00       					LD      B,0	;
505)   3FEA ED B0       					LDIR	;
506)   3FEC C9          					RET	;
507)   3FED 7E          		LOADS2:			LD      A,(HL)	;
508)   3FEE 12          					LD      (DE),A	;
509)   3FEF 23          					INC     HL	;
510)   3FF0 FE 0D       					CP      CR	;
511)   3FF2 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
512)   3FF4 C8          					RET     Z	;
513)   3FF5 1C          					INC     E	;
514)   3FF6 20 F5       					JR      NZ,LOADS2	;
515)   3FF8 C9          					RET                     ;RETURN NULL STRING	;RETURN NULL STRING
545)   3FF9 CD 0C 01    		POS:			CALL    GETCSR	;
546)   3FFC EB          					EX      DE,HL	;
547)   3FFD 18 75       					JR      COUNT1	;
548)   3FFF CD 0C 01    		VPOS:			CALL    GETCSR	;
549)   4002 18 70       					JR      COUNT1	;
550)   4004 CD B7 37    		EOF:			CALL    CHANEL	;
551)   4007 CD 2A 01    					CALL    OSSTAT	;
552)   400A CA E1 40    					JP      Z,TRUE	;
553)   400D C3 BE 43    					JP      ZERO	;
554)   4010 CD B7 37    		BGET:			CALL    CHANEL          ;CHANNEL NUMBER	;CHANNEL NUMBER
555)   4013 CD 27 01    					CALL    OSBGET	;
556)   4016 6F          					LD      L,A	;
557)   4017 18 59       					JR      COUNT0	;
558)   4019 CD 74 42    		INKEY:			CALL    INKEYS	;
559)   401C 18 19       					JR      ASC0	;
560)   401E CD 78 44    		GET:			CALL    NXT	;
561)   4021 FE 28       					CP      '('	;
562)   4023 20 0A       					JR      NZ,GET0	;
563)   4025 CD AB 3E    					CALL    ITEMI           ;PORT ADDRESS	;PORT ADDRESS
564)   4028 D9          					EXX	;
565)   4029 44          					LD      B,H	;
566)   402A 4D          					LD      C,L	;
567)   402B ED 68       					IN      L,(C)           ;INPUT FROM PORT BC	;INPUT FROM PORT BC
568)   402D 18 43       					JR      COUNT0	;
569)   402F CD 6E 42    		GET0:			CALL    GETS	;
570)   4032 18 08       					JR      ASC1	;
571)   4034 CD B4 3E    		ASC:			CALL    ITEMS	;
572)   4037 AF          		ASC0:			XOR     A	;
573)   4038 BB          					CP      E	;
574)   4039 CA E1 40    					JP      Z,TRUE          ;NULL STRING	;NULL STRING
575)   403C 2A 00 80    		ASC1:			LD      HL,(ACCS)	;
576)   403F 18 31       					JR      COUNT0	;
577)   4041 CD B4 3E    		LEN:			CALL    ITEMS	;
578)   4044 EB          					EX      DE,HL	;
579)   4045 18 2B       					JR      COUNT0	;
580)   4047 2A E0 82    		LOMEMV:			LD      HL,(LOMEM)	;
581)   404A 18 28       					JR      COUNT1	;
582)   404C 2A E4 82    		HIMEMV:			LD      HL,(HIMEM)	;
583)   404F 18 23       					JR      COUNT1	;
584)   4051 2A DC 82    		PAGEV:			LD      HL,(PAGE)	;
585)   4054 18 1E       					JR      COUNT1	;
586)   4056 FD 7E 00    		TOPV:			LD      A,(IY)	;
587)   4059 FD 23       					INC     IY              ;SKIP "P"	;SKIP "P"
588)   405B FE 50       					CP      'P'	;
589)   405D C2 BF 2D    					JP      NZ,SYNTAX       ;"Syntax Error"	;"Syntax Error"
590)   4060 2A DE 82    					LD      HL,(TOP)	;
591)   4063 18 0F       					JR      COUNT1	;
592)   4065 2A F2 82    		ERLV:			LD      HL,(ERL)	;
593)   4068 18 0A       					JR      COUNT1	;
594)   406A 2A FD 82    		ERRV:			LD      HL,(ERR)	;
595)   406D 18 03       					JR      COUNT0	;
596)   406F 2A FB 82    		COUNTV:			LD      HL,(COUNT)	;
597)   4072 26 00       		COUNT0:			LD      H,0	;
598)   4074 D9          		COUNT1:			EXX	;
599)   4075 AF          					XOR     A	;
600)   4076 4F          					LD      C,A             ;INTEGER MARKER	;INTEGER MARKER
601)   4077 67          					LD      H,A	;
602)   4078 6F          					LD      L,A	;
603)   4079 C9          					RET	;
610)   407A AF          		OPENOT:			XOR     A	;
611)   407B 21          					DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
612)   407C 3E 02       		OPENUP:			LD      A,2	;
613)   407E 21          					DEFB    21H             ;SKIP NEXT 2 BYTES	;SKIP NEXT 2 BYTES
614)   407F 3E 01       		OPENIN:			LD      A,1	;
615)   4081 F5          					PUSH    AF              ;SAVE OPEN TYPE	;SAVE OPEN TYPE
616)   4082 CD B4 3E    					CALL    ITEMS           ;FILENAME	;FILENAME
617)   4085 3E 0D       					LD      A,CR	;
618)   4087 12          					LD      (DE),A	;
619)   4088 F1          					POP     AF              ;RESTORE OPEN TYPE	;RESTORE OPEN TYPE
620)   4089 C6 FF       					ADD     A,-1            ;AFFECT FLAGS	;AFFECT FLAGS
621)   408B 21 00 80    					LD      HL,ACCS	;
622)   408E CD 30 01    					CALL    OSOPEN	;
623)   4091 6F          					LD      L,A	;
624)   4092 18 DE       					JR      COUNT0	;
630)   4094 CD B7 37    		EXT:			CALL    CHANEL	;
631)   4097 CD 42 01    					CALL    GETEXT	;
632)   409A 18 12       					JR      TIME0	;
634)   409C CD B7 37    		PTR:			CALL    CHANEL	;
635)   409F CD 3C 01    					CALL    GETPTR	;
636)   40A2 18 0A       					JR      TIME0	;
641)   40A4 FD 7E 00    		TIMEV:			LD      A,(IY)	;
642)   40A7 FE 24       					CP      '$'	;
643)   40A9 28 09       					JR      Z,TIMEVS	;
644)   40AB CD 06 01    					CALL    GETIME	;
645)   40AE D5          		TIME0:			PUSH    DE	;
646)   40AF D9          					EXX	;
647)   40B0 E1          					POP     HL	;
648)   40B1 AF          					XOR     A	;
649)   40B2 4F          					LD      C,A	;
650)   40B3 C9          					RET	;
655)   40B4 FD 23       		TIMEVS:			INC     IY              ;SKIP $	;SKIP $
656)   40B6 CD 6F 01    					CALL    GETIMS	;
657)   40B9 3E 80       					LD      A,80H           ;MARK STRING	;MARK STRING
658)   40BB C9          					RET	;
662)   40BC CD BB 43    		SLT:			CALL    SCP	;
663)   40BF D0          					RET     NC	;
664)   40C0 18 1F       					JR      TRUE	;
666)   40C2 CD BB 43    		SGT:			CALL    SCP	;
667)   40C5 C8          					RET     Z	;
668)   40C6 D8          					RET     C	;
669)   40C7 18 18       					JR      TRUE	;
671)   40C9 CD BB 43    		SGE:			CALL    SCP	;
672)   40CC D8          					RET     C	;
673)   40CD 18 12       					JR      TRUE	;
675)   40CF CD BB 43    		SLE:			CALL    SCP	;
676)   40D2 28 0D       					JR      Z,TRUE	;
677)   40D4 D0          					RET     NC	;
678)   40D5 18 0A       					JR      TRUE	;
680)   40D7 CD BB 43    		SNE:			CALL    SCP	;
681)   40DA C8          					RET     Z	;
682)   40DB 18 04       					JR      TRUE	;
684)   40DD CD BB 43    		SEQ:			CALL    SCP	;
685)   40E0 C0          					RET     NZ	;
686)   40E1 3E FF       		TRUE:			LD      A,-1	;
687)   40E3 D9          					EXX	;
688)   40E4 67          					LD      H,A	;
689)   40E5 6F          					LD      L,A	;
690)   40E6 D9          					EXX	;
691)   40E7 67          					LD      H,A	;
692)   40E8 6F          					LD      L,A	;
693)   40E9 3C          					INC     A	;
694)   40EA 4F          					LD      C,A	;
695)   40EB C9          					RET	;
700)   40EC 3E 23       		PI:			LD      A,35	;
701)   40EE 18 43       					JR      FPP1	;
706)   40F0 3E 10       		ABS:			LD      A,16	;
707)   40F2 18 3A       					JR      FPPN	;
712)   40F4 3E 1A       		NOTK:			LD      A,26	;
713)   40F6 18 36       					JR      FPPN	;
718)   40F8 3E 15       		DEG:			LD      A,21	;
719)   40FA 18 32       					JR      FPPN	;
724)   40FC 3E 1B       		RAD:			LD      A,27	;
725)   40FE 18 2E       					JR      FPPN	;
730)   4100 3E 1C       		SGN:			LD      A,28	;
731)   4102 18 2A       					JR      FPPN	;
736)   4104 3E 17       		INT:			LD      A,23	;
737)   4106 18 26       					JR      FPPN	;
742)   4108 3E 1E       		SQR:			LD      A,30	;
743)   410A 18 22       					JR      FPPN	;
748)   410C 3E 1F       		TAN:			LD      A,31	;
749)   410E 18 1E       					JR      FPPN	;
754)   4110 3E 14       		COS:			LD      A,20	;
755)   4112 18 1A       					JR      FPPN	;
760)   4114 3E 1D       		SIN:			LD      A,29	;
761)   4116 18 16       					JR      FPPN	;
766)   4118 3E 16       		EXP:			LD      A,22	;
767)   411A 18 12       					JR      FPPN	;
772)   411C 3E 18       		LN:			LD      A,24	;
773)   411E 18 0E       					JR      FPPN	;
778)   4120 3E 19       		LOG:			LD      A,25	;
779)   4122 18 0A       					JR      FPPN	;
784)   4124 3E 12       		ASN:			LD      A,18	;
785)   4126 18 06       					JR      FPPN	;
790)   4128 3E 13       		ATN:			LD      A,19	;
791)   412A 18 02       					JR      FPPN	;
796)   412C 3E 11       		ACS:			LD      A,17	;
797)   412E F5          		FPPN:			PUSH    AF	;
798)   412F CD A4 3E    					CALL    ITEMN	;
799)   4132 F1          					POP     AF	;
800)   4133 CD 9C 44    		FPP1:			CALL    FPP	;
801)   4136 DA DB 26    					JP      C,ERROR	;
802)   4139 AF          					XOR     A	;
803)   413A C9          					RET	;
807)   413B 3E 26       		@SFIX:			LD      A,38	;
808)   413D 18 F4       					JR      FPP1	;
812)   413F 3E 27       		SFLOAT:			LD      A,39	;
813)   4141 18 F0       					JR      FPP1	;
818)   4143 CD B4 3E    		VAL:			CALL    ITEMS	;
819)   4146 AF          		@VAL0:			XOR     A	;
820)   4147 12          					LD      (DE),A	;
821)   4148 DD 21 00 80 					LD      IX,ACCS	;
822)   414C 3E 24       					LD      A,36	;
823)   414E 18 E3       					JR      FPP1	;
828)   4150 CD B4 3E    		EVAL:			CALL    ITEMS	;
829)   4153 3E 0D       					LD      A,CR	;
830)   4155 12          					LD      (DE),A	;
831)   4156 FD E5       					PUSH    IY	;
832)   4158 11 00 80    					LD      DE,ACCS	;
833)   415B FD 21 00 80 					LD      IY,ACCS	;
834)   415F 0E 00       					LD      C,0	;
835)   4161 CD 55 2B    					CALL    LEXAN2          ;TOKENISE	;TOKENISE
836)   4164 12          					LD      (DE),A	;
837)   4165 13          					INC     DE	;
838)   4166 AF          					XOR     A	;
839)   4167 CD DF 43    					CALL    PUSHS           ;PUT ON STACK	;PUT ON STACK
840)   416A FD 21 02 00 					LD      IY,2	;
841)   416E FD 39       					ADD     IY,SP	;
842)   4170 CD 84 3D    					CALL    EXPR	;
843)   4173 FD E1       					POP     IY	;
844)   4175 FD 39       					ADD     IY,SP	;
845)   4177 FD F9       					LD      SP,IY           ;ADJUST STACK POINTER	;ADJUST STACK POINTER
846)   4179 FD E1       					POP     IY	;
847)   417B 08          					EX      AF,AF'	;
848)   417C C9          					RET	;
857)   417D DD 21 F6 82 		RND:			LD      IX,RANDOM	;
858)   4181 CD 78 44    					CALL    NXT	;
859)   4184 FE 28       					CP      '('	;
860)   4186 28 1C       					JR      Z,RND5          ;ARGUMENT FOLLOWS	;ARGUMENT FOLLOWS
861)   4188 CD 56 3F    					CALL    LOAD5	;
862)   418B CB 19       		RND1:			RR      C	;
863)   418D 06 20       					LD      B,32	;
864)   418F D9          		RND2:			EXX                     ;CALCULATE NEXT	;CALCULATE NEXT
865)   4190 ED 6A       					ADC     HL,HL	;
866)   4192 D9          					EXX	;
867)   4193 ED 6A       					ADC     HL,HL	;
868)   4195 CB 5D       					BIT     3,L	;
869)   4197 28 01       					JR      Z,RND3	;
870)   4199 3F          					CCF	;
871)   419A 10 F3       		RND3:			DJNZ    RND2	;
872)   419C CB 11       		RND4:			RL      C               ;SAVE CARRY	;SAVE CARRY
873)   419E CD 63 35    					CALL    STORE5          ;STORE NEW NUMBER	;STORE NEW NUMBER
874)   41A1 AF          					XOR     A	;
875)   41A2 4F          					LD      C,A	;
876)   41A3 C9          					RET	;
877)   41A4 CD AB 3E    		RND5:			CALL    ITEMI	;
878)   41A7 DD 21 F6 82 					LD      IX,RANDOM	;
879)   41AB CB 7C       					BIT     7,H             ;NEGATIVE?	;NEGATIVE?
880)   41AD 37          					SCF	;
881)   41AE 20 EC       					JR      NZ,RND4         ;SEED	;SEED
882)   41B0 CD 1F 43    					CALL    TEST	;
883)   41B3 F5          					PUSH    AF	;
884)   41B4 CD 17 43    					CALL    SWAP	;
885)   41B7 D9          					EXX	;
886)   41B8 CD 56 3F    					CALL    LOAD5	;
887)   41BB C4 8B 41    					CALL    NZ,RND1         ;NEXT IF NON-ZERO	;NEXT IF NON-ZERO
888)   41BE D9          					EXX                     ;SCRAMBLE (CARE!)	;SCRAMBLE (CARE!)
889)   41BF 0E 7F       					LD      C,7FH	;
890)   41C1 CB 7C       		RND6:			BIT     7,H             ;FLOAT	;FLOAT
891)   41C3 20 08       					JR      NZ,RND7	;
892)   41C5 D9          					EXX	;
893)   41C6 29          					ADD     HL,HL	;
894)   41C7 D9          					EXX	;
895)   41C8 ED 6A       					ADC     HL,HL	;
896)   41CA 0D          					DEC     C	;
897)   41CB 20 F4       					JR      NZ,RND6	;
898)   41CD CB BC       		RND7:			RES     7,H             ;POSITIVE 0-0.999999	;POSITIVE 0-0.999999
899)   41CF F1          					POP     AF	;
900)   41D0 C8          					RET     Z               ;ZERO ARGUMENT	;ZERO ARGUMENT
901)   41D1 D9          					EXX	;
902)   41D2 7B          					LD      A,E	;
903)   41D3 3D          					DEC     A	;
904)   41D4 B2          					OR      D	;
905)   41D5 D9          					EXX	;
906)   41D6 B3          					OR      E	;
907)   41D7 B2          					OR      D	;
908)   41D8 C8          					RET     Z               ;ARGUMENT=1	;ARGUMENT=1
909)   41D9 06 00       					LD      B,0             ;INTEGER MARKER	;INTEGER MARKER
910)   41DB 3E 0A       					LD      A,10	;
911)   41DD CD 9C 44    					CALL    FPP             ;MULTIPLY	;MULTIPLY
912)   41E0 DA DB 26    					JP      C,ERROR	;
913)   41E3 CD 3B 41    					CALL    SFIX	;
914)   41E6 C3 06 3F    					JP      ADD1	;
919)   41E9 CD 2D 44    		INSTR:			CALL    EXPRSC          ;STRING TO SEARCH	;STRING TO SEARCH
920)   41EC CD DF 43    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
921)   41EF CD 9D 3E    					CALL    EXPRS           ;SUB-STRING	;SUB-STRING
922)   41F2 C1          					POP     BC	;
923)   41F3 21 00 00    					LD      HL,0	;
924)   41F6 39          					ADD     HL,SP           ;HL ADDRESSES MAIN	;HL ADDRESSES MAIN
925)   41F7 C5          					PUSH    BC              ;C = MAIN STRING LENGTH	;C = MAIN STRING LENGTH
926)   41F8 43          					LD      B,E             ;B = SUB-STRING LENGTH	;B = SUB-STRING LENGTH
927)   41F9 CD 78 44    					CALL    NXT	;
928)   41FC FE 2C       					CP      ','	;
929)   41FE 3E 00       					LD      A,0	;
930)   4200 20 17       					JR      NZ,INSTR1	;
931)   4202 FD 23       					INC     IY              ;SKIP COMMA	;SKIP COMMA
932)   4204 C5          					PUSH    BC              ;SAVE LENGTHS	;SAVE LENGTHS
933)   4205 E5          					PUSH    HL              ;SAVE MAIN ADDRESS	;SAVE MAIN ADDRESS
934)   4206 CD DF 43    					CALL    PUSHS	;
935)   4209 CD 94 3E    					CALL    EXPRI	;
936)   420C C1          					POP     BC	;
937)   420D CD FE 43    					CALL    POPS	;
938)   4210 E1          					POP     HL              ;RESTORE MAIN ADDRESS	;RESTORE MAIN ADDRESS
939)   4211 C1          					POP     BC              ;RESTORE LENGTHS	;RESTORE LENGTHS
940)   4212 D9          					EXX	;
941)   4213 7D          					LD      A,L	;
942)   4214 D9          					EXX	;
943)   4215 B7          					OR      A	;
944)   4216 28 01       					JR      Z,INSTR1	;
945)   4218 3D          					DEC     A	;
946)   4219 11 00 80    		INSTR1:			LD      DE,ACCS         ;DE ADDRESSES SUB	;DE ADDRESSES SUB
947)   421C CD 33 42    					CALL    SEARCH	;
948)   421F D1          					POP     DE	;
949)   4220 28 03       					JR      Z,INSTR2        ;N.B. CARRY CLEARED	;N.B. CARRY CLEARED
950)   4222 ED 62       					SBC     HL,HL	;
951)   4224 39          					ADD     HL,SP	;
952)   4225 ED 72       		INSTR2:			SBC     HL,SP	;
953)   4227 EB          					EX      DE,HL	;
954)   4228 26 00       					LD      H,0	;
955)   422A 39          					ADD     HL,SP	;
956)   422B F9          					LD      SP,HL	;
957)   422C EB          					EX      DE,HL	;
958)   422D CD 3C 44    					CALL    BRAKET	;
959)   4230 C3 74 40    					JP      COUNT1	;
969)   4233 C5          		@SEARCH:		PUSH    BC	;
970)   4234 06 00       					LD      B,0	;
971)   4236 4F          					LD      C,A	;
972)   4237 09          					ADD     HL,BC           ;NEW START ADDRESS	;NEW START ADDRESS
973)   4238 C1          					POP     BC	;
974)   4239 91          					SUB     C	;
975)   423A 30 28       					JR      NC,SRCH4	;
976)   423C ED 44       					NEG	;
977)   423E 4F          					LD      C,A             ;REMAINING LENGTH	;REMAINING LENGTH
978)   423F 1A          		SRCH1:			LD      A,(DE)	;
979)   4240 C5          					PUSH    BC	;
980)   4241 06 00       					LD      B,0	;
981)   4243 ED B1       					CPIR                    ;FIND FIRST CHARACTER	;FIND FIRST CHARACTER
982)   4245 79          					LD      A,C	;
983)   4246 C1          					POP     BC	;
984)   4247 20 1B       					JR      NZ,SRCH4	;
985)   4249 4F          					LD      C,A	;
986)   424A 05          					DEC     B               ;Bug fix	;Bug fix
987)   424B B8          					CP      B               ;Bug fix	;Bug fix
988)   424C 04          					INC     B               ;Bug fix	;Bug fix
989)   424D 38 15       					JR      C,SRCH4         ;Bug fix	;Bug fix
990)   424F C5          					PUSH    BC	;
991)   4250 D5          					PUSH    DE	;
992)   4251 E5          					PUSH    HL	;
993)   4252 05          					DEC     B	;
994)   4253 28 08       					JR      Z,SRCH3         ;FOUND !	;FOUND !
995)   4255 13          		SRCH2:			INC     DE	;
996)   4256 1A          					LD      A,(DE)	;
997)   4257 BE          					CP      (HL)	;
998)   4258 20 03       					JR      NZ,SRCH3	;
999)   425A 23          					INC     HL	;
1000)   425B 10 F8       					DJNZ    SRCH2	;
1001)   425D E1          		SRCH3:			POP     HL	;
1002)   425E D1          					POP     DE	;
1003)   425F C1          					POP     BC	;
1004)   4260 20 DD       					JR      NZ,SRCH1	;
1005)   4262 AF          					XOR     A               ;Z, NC	;Z, NC
1006)   4263 C9          					RET                     ;FOUND	;FOUND
1008)   4264 F6 FF       		SRCH4:			OR      0FFH            ;NZ, NC	;NZ, NC
1009)   4266 C9          					RET                     ;NOT FOUND	;NOT FOUND
1014)   4267 CD AB 3E    		CHRS:			CALL    ITEMI	;
1015)   426A D9          					EXX	;
1016)   426B 7D          					LD      A,L	;
1017)   426C 18 03       					JR      GET1	;
1022)   426E CD 0F 01    		GETS:			CALL    OSRDCH	;
1023)   4271 37          		GET1:			SCF	;
1024)   4272 18 07       					JR      INKEY1	;
1031)   4274 CD AB 3E    		INKEYS:			CALL    ITEMI	;
1032)   4277 D9          					EXX	;
1033)   4278 CD 18 01    					CALL    OSKEY	;
1034)   427B 11 00 80    		INKEY1:			LD      DE,ACCS	;
1035)   427E 12          					LD      (DE),A	;
1036)   427F 3E 80       					LD      A,80H	;
1037)   4281 D0          					RET     NC	;
1038)   4282 1C          					INC     E	;
1039)   4283 C9          					RET	;
1044)   4284 CD 2D 44    		MIDS:			CALL    EXPRSC	;
1045)   4287 CD DF 43    					CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1046)   428A CD 94 3E    					CALL    EXPRI	;
1047)   428D C1          					POP     BC	;
1048)   428E CD FE 43    					CALL    POPS	;
1049)   4291 D9          					EXX	;
1050)   4292 7D          					LD      A,L	;
1051)   4293 D9          					EXX	;
1052)   4294 B7          					OR      A	;
1053)   4295 28 0D       					JR      Z,MIDS1	;
1054)   4297 3D          					DEC     A	;
1055)   4298 6F          					LD      L,A	;
1056)   4299 93          					SUB     E	;
1057)   429A 1E 00       					LD      E,0	;
1058)   429C 30 06       					JR      NC,MIDS1	;
1059)   429E ED 44       					NEG	;
1060)   42A0 4F          					LD      C,A	;
1061)   42A1 CD DB 42    					CALL    RIGHT1	;
1062)   42A4 CD 78 44    		MIDS1:			CALL    NXT	;
1063)   42A7 FE 2C       					CP      ','	;
1064)   42A9 FD 23       					INC     IY	;
1065)   42AB 28 0B       					JR      Z,LEFT1	;
1066)   42AD FD 2B       					DEC     IY	;
1067)   42AF CD 3C 44    					CALL    BRAKET	;
1068)   42B2 3E 80       					LD      A,80H	;
1069)   42B4 C9          					RET	;
1075)   42B5 CD 2D 44    		LEFTS:			CALL    EXPRSC	;
1076)   42B8 CD DF 43    		LEFT1:			CALL    PUSHS           ;SAVE STRING ON STACK	;SAVE STRING ON STACK
1077)   42BB CD 94 3E    					CALL    EXPRI	;
1078)   42BE C1          					POP     BC	;
1079)   42BF CD FE 43    					CALL    POPS	;
1080)   42C2 CD 3C 44    					CALL    BRAKET	;
1081)   42C5 D9          					EXX	;
1082)   42C6 7D          					LD      A,L	;
1083)   42C7 D9          					EXX	;
1084)   42C8 BB          					CP      E	;
1085)   42C9 30 02       					JR      NC,LEFT3	;
1086)   42CB 6B          					LD      L,E             ;FOR RIGHTS	;FOR RIGHTS
1087)   42CC 5F          		LEFT2:			LD      E,A	;
1088)   42CD 3E 80       		LEFT3:			LD      A,80H           ;STRING MARKER	;STRING MARKER
1089)   42CF C9          					RET	;
1094)   42D0 CD B5 42    		RIGHTS:			CALL    LEFTS	;
1095)   42D3 D0          					RET     NC	;
1096)   42D4 1C          					INC     E	;
1097)   42D5 1D          					DEC     E	;
1098)   42D6 C8          					RET     Z	;
1099)   42D7 4B          					LD      C,E	;
1100)   42D8 7D          					LD      A,L	;
1101)   42D9 93          					SUB     E	;
1102)   42DA 6F          					LD      L,A	;
1103)   42DB 06 00       		RIGHT1:			LD      B,0	;
1104)   42DD 62          					LD      H,D	;
1105)   42DE 58          					LD      E,B	;
1106)   42DF ED B0       					LDIR                    ;MOVE	;MOVE
1107)   42E1 3E 80       					LD      A,80H	;
1108)   42E3 C9          					RET	;
1113)   42E4 CD 94 3E    		STRING:			CALL    EXPRI	;
1114)   42E7 CD 30 44    					CALL    COMMA	;
1115)   42EA D9          					EXX	;
1116)   42EB 7D          					LD      A,L	;
1117)   42EC D9          					EXX	;
1118)   42ED F5          					PUSH    AF	;
1119)   42EE CD 9D 3E    					CALL    EXPRS	;
1120)   42F1 CD 3C 44    					CALL    BRAKET	;
1121)   42F4 F1          					POP     AF	;
1122)   42F5 B7          					OR      A	;
1123)   42F6 28 D4       					JR      Z,LEFT2         ;N=0	;N=0
1124)   42F8 3D          					DEC     A	;
1125)   42F9 4F          					LD      C,A	;
1126)   42FA 3E 80       					LD      A,80H           ;STRING MARKER	;STRING MARKER
1127)   42FC C8          					RET     Z	;
1128)   42FD 1C          					INC     E	;
1129)   42FE 1D          					DEC     E	;
1130)   42FF C8          					RET     Z               ;NULL STRING	;NULL STRING
1131)   4300 43          					LD      B,E	;
1132)   4301 62          					LD      H,D	;
1133)   4302 2E 00       					LD      L,0	;
1134)   4304 C5          		STRIN1:			PUSH    BC	;
1135)   4305 7E          		STRIN2:			LD      A,(HL)	;
1136)   4306 23          					INC     HL	;
1137)   4307 12          					LD      (DE),A	;
1138)   4308 1C          					INC     E	;
1139)   4309 3E 13       					LD      A,19	;
1140)   430B CA DB 26    					JP      Z,ERROR         ;"String too long"	;"String too long"
1141)   430E 10 F5       					DJNZ    STRIN2	;
1142)   4310 C1          					POP     BC	;
1143)   4311 0D          					DEC     C	;
1144)   4312 20 F0       					JR      NZ,STRIN1	;
1145)   4314 3E 80       					LD      A,80H	;
1146)   4316 C9          					RET	;
1154)   4317 79          		@SWAP:			LD      A,C	;
1155)   4318 48          					LD      C,B	;
1156)   4319 47          					LD      B,A	;
1157)   431A EB          					EX      DE,HL	;
1158)   431B D9          					EXX	;
1159)   431C EB          					EX      DE,HL	;
1160)   431D D9          					EXX	;
1161)   431E C9          					RET	;
1167)   431F 7C          		@TEST:			LD      A,H	;
1168)   4320 B5          					OR      L	;
1169)   4321 D9          					EXX	;
1170)   4322 B4          					OR      H	;
1171)   4323 B5          					OR      L	;
1172)   4324 D9          					EXX	;
1173)   4325 C9          					RET	;
1180)   4326 D9          		@DECODE:		EXX	;
1181)   4327 FD 7E 00    					LD      A,(IY)	;
1182)   432A FD 23       					INC     IY	;
1183)   432C 17          					RLA	;
1184)   432D 17          					RLA	;
1185)   432E 67          					LD      H,A	;
1186)   432F E6 C0       					AND     0C0H	;
1187)   4331 FD AE 00    					XOR     (IY)	;
1188)   4334 FD 23       					INC     IY	;
1189)   4336 6F          					LD      L,A	;
1190)   4337 7C          					LD      A,H	;
1191)   4338 17          					RLA	;
1192)   4339 17          					RLA	;
1193)   433A E6 C0       					AND     0C0H	;
1194)   433C FD AE 00    					XOR     (IY)	;
1195)   433F FD 23       					INC     IY	;
1196)   4341 67          					LD      H,A	;
1197)   4342 D9          					EXX	;
1198)   4343 AF          					XOR     A	;
1199)   4344 4F          					LD      C,A	;
1200)   4345 67          					LD      H,A	;
1201)   4346 6F          					LD      L,A	;
1202)   4347 C9          					RET	;
1209)   4348 FD 23       		HEXSTS:			INC     IY              ;SKIP TILDE	;SKIP TILDE
1210)   434A CD A4 3E    					CALL    ITEMN	;
1211)   434D CD 53 43    					CALL    HEXSTR	;
1212)   4350 3E 80       					LD      A,80H	;
1213)   4352 C9          					RET	;
1215)   4353 CD 3B 41    		@HEXSTR:		CALL    SFIX	;
1216)   4356 01 08 00    					LD      BC,8	;
1217)   4359 11 00 80    					LD      DE,ACCS	;
1218)   435C C5          		HEXST1:			PUSH    BC	;
1219)   435D 06 04       					LD      B,4	;
1220)   435F AF          					XOR     A	;
1221)   4360 D9          		HEXST2:			EXX	;
1222)   4361 29          					ADD     HL,HL	;
1223)   4362 D9          					EXX	;
1224)   4363 ED 6A       					ADC     HL,HL	;
1225)   4365 17          					RLA	;
1226)   4366 10 F8       					DJNZ    HEXST2	;
1227)   4368 C1          					POP     BC	;
1228)   4369 0D          					DEC     C	;
1229)   436A F8          					RET     M	;
1230)   436B 28 06       					JR      Z,HEXST3	;
1231)   436D B7          					OR      A	;
1232)   436E 20 03       					JR      NZ,HEXST3	;
1233)   4370 B8          					CP      B	;
1234)   4371 28 E9       					JR      Z,HEXST1	;
1235)   4373 C6 90       		HEXST3:			ADD     A,90H	;
1236)   4375 27          					DAA	;
1237)   4376 CE 40       					ADC     A,40H	;
1238)   4378 27          					DAA	;
1239)   4379 12          					LD      (DE),A	;
1240)   437A 13          					INC     DE	;
1241)   437B 47          					LD      B,A	;
1242)   437C 18 DE       					JR      HEXST1	;
1252)   437E CD 78 44    		STRS:			CALL    NXT	;
1253)   4381 FE 7E       					CP      '~'	;
1254)   4383 28 C3       					JR      Z,HEXSTS	;
1255)   4385 CD A4 3E    					CALL    ITEMN	;
1256)   4388 DD 21 00 82 					LD      IX,STAVAR	;
1257)   438C DD 7E 03    					LD      A,(IX+3)	;
1258)   438F B7          					OR      A	;
1259)   4390 DD 21 B8 43 					LD      IX,G9-1         ;G9 FORMAT	;G9 FORMAT
1260)   4394 28 04       					JR      Z,STR0	;
1261)   4396 DD 21 00 82 		@STR:			LD      IX,STAVAR	;
1262)   439A 11 00 80    		STR0:			LD      DE,ACCS	;
1263)   439D 3E 25       					LD      A,37	;
1264)   439F CD 9C 44    					CALL    FPP	;
1265)   43A2 DA DB 26    					JP      C,ERROR	;
1266)   43A5 DD CB 02 46 					BIT     0,(IX+2)	;
1267)   43A9 3E 80       		STR1:			LD      A,80H           ;STRING MARKER	;STRING MARKER
1268)   43AB C8          					RET     Z	;
1269)   43AC 79          					LD      A,C	;
1270)   43AD C6 04       					ADD     A,4	;
1271)   43AF BB          		STR2:			CP      E	;
1272)   43B0 28 F7       					JR      Z,STR1	;
1273)   43B2 EB          					EX      DE,HL		;
1274)   43B3 36 20       					LD      (HL),' '        ;TRAILING SPACE	;TRAILING SPACE
1275)   43B5 23          					INC     HL	;
1276)   43B6 EB          					EX      DE,HL	;
1277)   43B7 18 F6       					JR      STR2	;
1279)   43B9 09 00       		G9:			DEFW    9	;
1285)   43BB CD C8 43    		SCP:			CALL    SCP0	;
1286)   43BE 3E 00       		@ZERO:			LD      A,0	;
1287)   43C0 D9          					EXX	;
1288)   43C1 67          					LD      H,A	;
1289)   43C2 6F          					LD      L,A	;
1290)   43C3 D9          					EXX	;
1291)   43C4 67          					LD      H,A	;
1292)   43C5 6F          					LD      L,A	;
1293)   43C6 4F          					LD      C,A	;
1294)   43C7 C9          					RET	;
1296)   43C8 04          		SCP0:			INC     B	;
1297)   43C9 0C          					INC     C	;
1298)   43CA 05          		SCP1:			DEC     B	;
1299)   43CB 28 0A       					JR      Z,SCP2	;
1300)   43CD 0D          					DEC     C	;
1301)   43CE 28 0C       					JR      Z,SCP3	;
1302)   43D0 1A          					LD      A,(DE)	;
1303)   43D1 BE          					CP      (HL)	;
1304)   43D2 C0          					RET     NZ	;
1305)   43D3 13          					INC     DE	;
1306)   43D4 23          					INC     HL	;
1307)   43D5 18 F3       					JR      SCP1	;
1308)   43D7 B7          		SCP2:			OR      A	;
1309)   43D8 0D          						DEC     C	;
1310)   43D9 C8          					RET     Z	;
1311)   43DA 37          					SCF	;
1312)   43DB C9          					RET	;
1313)   43DC B7          		SCP3:			OR      A	;
1314)   43DD 0C          					INC     C	;
1315)   43DE C9          					RET	;
1323)   43DF CD BF 35    		@PUSHS:			CALL    CHECK	;
1324)   43E2 DD E1       					POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1325)   43E4 B7          					OR      A               ;CLEAR CARRY	;CLEAR CARRY
1326)   43E5 21 00 80    					LD      HL,ACCS	;
1327)   43E8 54          					LD      D,H	;
1328)   43E9 45          					LD      B,L             ;B=0	;B=0
1329)   43EA ED 52       					SBC     HL,DE	;
1330)   43EC 39          					ADD     HL,SP	;
1331)   43ED F9          					LD      SP,HL	;
1332)   43EE 57          					LD      D,A	;
1333)   43EF D5          					PUSH    DE	;
1334)   43F0 28 0A       					JR      Z,PUSHS1        ;ZERO LENGTH	;ZERO LENGTH
1335)   43F2 4B          					LD      C,E	;
1336)   43F3 11 00 80    					LD      DE,ACCS	;
1337)   43F6 EB          					EX      DE,HL	;
1338)   43F7 ED B0       					LDIR                    ;COPY TO STACK	;COPY TO STACK
1339)   43F9 CD BF 35    					CALL    CHECK	;
1340)   43FC DD E9       		PUSHS1:			JP      (IX)            ;"RETURN"	;"RETURN"
1348)   43FE DD E1       		@POPS:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1349)   4400 21 00 00    					LD      HL,0	;
1350)   4403 44          					LD      B,H             ;B=0	;B=0
1351)   4404 39          					ADD     HL,SP	;
1352)   4405 11 00 80    					LD      DE,ACCS	;
1353)   4408 0C          					INC     C	;
1354)   4409 0D          					DEC     C	;
1355)   440A 28 02       					JR      Z,POPS1         ;ZERO LENGTH	;ZERO LENGTH
1356)   440C ED B0       					LDIR                    ;COPY FROM STACK	;COPY FROM STACK
1357)   440E F9          		POPS1:			LD      SP,HL	;
1358)   440F DD E9       					JP      (IX)            ;"RETURN"	;"RETURN"
1360)   4411 FD 7E 00    		HEXDIG:			LD      A,(IY)	;
1361)   4414 FE 30       					CP      '0'	;
1362)   4416 D8          					RET     C	;
1363)   4417 FE 3A       					CP      '9'+1	;
1364)   4419 3F          					CCF	;
1365)   441A D0          					RET     NC	;
1366)   441B FE 41       					CP      'A'	;
1367)   441D D8          					RET     C	;
1368)   441E D6 37       					SUB     'A'-10	;
1369)   4420 FE 10       					CP      16	;
1370)   4422 3F          					CCF	;
1371)   4423 C9          					RET	;
1373)   4424 FE 3E       		RELOP?:			CP      '>'	;
1374)   4426 D0          					RET     NC	;
1375)   4427 FE 3D       					CP      '='	;
1376)   4429 D0          					RET     NC	;
1377)   442A FE 3C       					CP      '<'	;
1378)   442C C9          					RET	;
1380)   442D CD 9D 3E    		EXPRSC:			CALL    EXPRS	;
1381)   4430 CD 78 44    		@COMMA:			CALL    NXT	;
1382)   4433 FD 23       					INC     IY	;
1383)   4435 FE 2C       					CP      ','	;
1384)   4437 C8          					RET     Z	;
1385)   4438 3E 05       					LD      A,5	;
1386)   443A 18 0A       					JR      ERROR1          ;"Missing ,"	;"Missing ,"
1388)   443C CD 78 44    		@BRAKET:		CALL    NXT	;
1389)   443F FD 23       					INC     IY	;
1390)   4441 FE 29       					CP      ')'	;
1391)   4443 C8          					RET     Z	;
1392)   4444 3E 1B       					LD      A,27	;
1393)   4446 C3 DB 26    		ERROR1:			JP      ERROR           ;"Missing )"	;"Missing )"
1395)   4449 FD 23       		SAVE:			INC     IY	;
1396)   444B 08          		SAVE1:			EX      AF,AF'	;
1397)   444C FA B9 3E    					JP      M,TYPE	;
1398)   444F 08          					EX      AF,AF'	;
1399)   4450 E3          					EX      (SP),HL	;
1400)   4451 D9          					EXX	;
1401)   4452 E5          					PUSH    HL	;
1402)   4453 D9          					EXX	;
1403)   4454 F5          					PUSH    AF	;
1404)   4455 C5          					PUSH    BC	;
1405)   4456 E9          					JP      (HL)	;
1407)   4457 08          		DOIT:			EX      AF,AF'	;
1408)   4458 FA B9 3E    					JP      M,TYPE	;
1409)   445B D9          					EXX	;
1410)   445C C1          					POP     BC              ;RETURN ADDRESS	;RETURN ADDRESS
1411)   445D D9          					EXX	;
1412)   445E 79          					LD      A,C	;
1413)   445F C1          					POP     BC	;
1414)   4460 47          					LD      B,A	;
1415)   4461 F1          					POP     AF              ;OPERATOR	;OPERATOR
1416)   4462 D9          					EXX	;
1417)   4463 EB          					EX      DE,HL	;
1418)   4464 E1          					POP     HL	;
1419)   4465 D9          					EXX	;
1420)   4466 EB          					EX      DE,HL	;
1421)   4467 E1          					POP     HL	;
1422)   4468 D9          					EXX	;
1423)   4469 C5          					PUSH    BC	;
1424)   446A D9          					EXX	;
1425)   446B E6 0F       					AND     0FH	;
1426)   446D CD 9C 44    					CALL    FPP	;
1427)   4470 38 D4       					JR      C,ERROR1	;
1428)   4472 AF          					XOR     A	;
1429)   4473 08          					EX      AF,AF'          ;TYPE	;TYPE
1430)   4474 FD 7E 00    					LD      A,(IY)	;
1431)   4477 C9          					RET	;
1433)   4478 FD 7E 00    		@NXT:			LD      A,(IY)	;
1434)   447B FE 20       					CP      ' '	;
1435)   447D C0          					RET     NZ	;
1436)   447E FD 23       					INC     IY	;
1437)   4480 C3 78 44    					JP      NXT	;
1439)   4483 E5          		DISPT2:			PUSH    HL	;
1440)   4484 21 78 3D    					LD      HL,SOPTBL	;
1441)   4487 18 06       					JR      DISPT0	;
1443)   4489 E5          		DISPAT:			PUSH    HL	;
1444)   448A D6 8D       					SUB     FUNTOK	;
1445)   448C 21 06 3D    					LD      HL,FUNTBL	;
1446)   448F C5          		DISPT0:			PUSH    BC	;
1447)   4490 87          					ADD     A,A	;
1448)   4491 4F          					LD      C,A	;
1449)   4492 06 00       					LD      B,0	;
1450)   4494 09          					ADD     HL,BC	;
1451)   4495 7E          					LD      A,(HL)	;
1452)   4496 23          					INC     HL	;
1453)   4497 66          					LD      H,(HL)	;
1454)   4498 6F          					LD      L,A	;
1455)   4499 C1          					POP     BC	;
1456)   449A E3          					EX      (SP),HL	;
1457)   449B C9          					RET                     ;OFF TO ROUTINE	;OFF TO ROUTINE
 36)   449C FD E5       		@FPP:			PUSH    IY              ;Save IY	;Save IY
 37)   449E FD 21 00 00 		        		LD      IY,0	;
 38)   44A2 FD 39       		        		ADD     IY,SP           ;Save SP in IY	;Save SP in IY
 39)   44A4 CD B3 44    		        		CALL    OP              ;Perform operation	;Perform operation
 40)   44A7 BF          		        		CP      A               ;Good return (Z, NC)	;Good return (Z, NC)
 41)   44A8 FD E1       		EXIT:			POP     IY              ;Restore IY	;Restore IY
 42)   44AA C9          		        		RET                     ;Return to caller	;Return to caller
 46)   44AB 3E 01       		BAD:			LD      A,BADOP         ;"Bad operation code"	;"Bad operation code"
 47)   44AD FD F9       		ERROR:			LD      SP,IY           ;Restore SP from IY	;Restore SP from IY
 48)   44AF B7          		        		OR      A               ;Set NZ	;Set NZ
 49)   44B0 37          		        		SCF                     ;Set C	;Set C
 50)   44B1 18 F5       		        		JR      EXIT	;
 54)   44B3 FE 2A       		OP:			CP      (RTABLE-DTABLE)/2	;
 55)   44B5 30 F4       		        		JR      NC,BAD	;
 56)   44B7 FE 10       		        		CP      (FTABLE-DTABLE)/2	;
 57)   44B9 30 07       		        		JR      NC,DISPAT	;
 58)   44BB 08          		        		EX      AF,AF'	;
 59)   44BC 78          		        		LD      A,B	;
 60)   44BD B1          		        		OR      C               ;Both integer?	;Both integer?
 61)   44BE C4 3D 4E    		        		CALL    NZ,FLOATA       ;No, so float both	;No, so float both
 62)   44C1 08          		        		EX      AF,AF'	;
 63)   44C2 E5          		DISPAT:			PUSH    HL	;
 64)   44C3 21 D3 44    		        		LD      HL,DTABLE	;
 65)   44C6 C5          		        		PUSH    BC	;
 66)   44C7 87          		        		ADD     A,A             ;A = op-code * 2	;A = op-code * 2
 67)   44C8 4F          		        		LD      C,A	;
 68)   44C9 06 00       		        		LD      B,0             ;BC = op-code * 2	;BC = op-code * 2
 69)   44CB 09          		        		ADD     HL,BC	;
 70)   44CC 7E          		        		LD      A,(HL)          ;Get low byte	;Get low byte
 71)   44CD 23          		        		INC     HL	;
 72)   44CE 66          		        		LD      H,(HL)          ;Get high byte	;Get high byte
 73)   44CF 6F          		        		LD      L,A	;
 74)   44D0 C1          		        		POP     BC	;
 75)   44D1 E3          		        		EX      (SP),HL	;
 76)   44D2 C9          		        		RET                     ;Off to routine	;Off to routine
 80)   44D3 4A 45       		DTABLE:			DEFW    IAND            ;AND (INTEGER)	;AND (INTEGER)
 81)   44D5 AD 45       		        		DEFW    IBDIV           ;DIV	;DIV
 82)   44D7 5C 45       		        		DEFW    IEOR            ;EOR	;EOR
 83)   44D9 80 45       		        		DEFW    IMOD            ;MOD	;MOD
 84)   44DB 6E 45       		        		DEFW    IOR             ;OR	;OR
 85)   44DD DC 47       		        		DEFW    ILE             ;<=	;<=
 86)   44DF E9 47       		        		DEFW    INE             ;<>	;<>
 87)   44E1 D1 47       		        		DEFW    IGE             ;>=	;>=
 88)   44E3 BA 47       		        		DEFW    ILT             ;<	;<
 89)   44E5 F4 47       		        		DEFW    IEQ             ;=	;=
 90)   44E7 77 46       		        		DEFW    IMUL            ;*	;*
 91)   44E9 D0 45       		        		DEFW    IADD            ;+	;+
 92)   44EB C5 47       		        		DEFW    IGT             ;>	;>
 93)   44ED BA 45       		        		DEFW    ISUB            ;-	;-
 94)   44EF 15 47       		        		DEFW    IPOW            ;^	;^
 95)   44F1 2F 46       		        		DEFW    IDIV            ;/	;/
 97)   44F3 03 48       		FTABLE:			DEFW    ABS             ;ABS	;ABS
 98)   44F5 5F 4B       		        		DEFW    ACS             ;ACS	;ACS
 99)   44F7 BB 4A       		        		DEFW    ASN             ;ASN	;ASN
100)   44F9 E0 4A       		        		DEFW    ATN             ;ATN	;ATN
101)   44FB F9 48       		        		DEFW    COS             ;COS	;COS
102)   44FD 2D 48       		        		DEFW    DEG             ;DEG	;DEG
103)   44FF 9E 49       		        		DEFW    EXP             ;EXP	;EXP
104)   4501 73 48       		        		DEFW    INT             ;INT	;INT
105)   4503 29 4A       		        		DEFW    LN              ;LN	;LN
106)   4505 A9 4A       		        		DEFW    LOG             ;LOG	;LOG
107)   4507 0E 48       		        		DEFW    NOTK            ;NOT	;NOT
108)   4509 35 48       		        		DEFW    RAD             ;RAD	;RAD
109)   450B 4B 48       		        		DEFW    SGN             ;SGN	;SGN
110)   450D 04 49       		        		DEFW    SIN             ;SIN	;SIN
111)   450F 89 48       		        		DEFW    SQR             ;SQR	;SQR
112)   4511 DC 48       		        		DEFW    TAN             ;TAN	;TAN
114)   4513 B9 4E       				        DEFW    ZERO            ;ZERO	;ZERO
115)   4515 7D 49       		        		DEFW    FONE            ;FONE	;FONE
116)   4517 F8 47       		        		DEFW    TRUE            ;TRUE	;TRUE
117)   4519 21 48       		        		DEFW    PI              ;PI	;PI
119)   451B 5B 48       				        DEFW    VAL             ;VAL	;VAL
120)   451D 67 4B       		        		DEFW    STR             ;STR$	;STR$
122)   451F 8E 4D       		        		DEFW    SFIX            ;FIX	;FIX
123)   4521 4A 4E       		        		DEFW    SFLOAT          ;FLOAT	;FLOAT
125)   4523 8F 4E       				        DEFW    FTEST           ;TEST	;TEST
126)   4525 A0 4E       		        		DEFW    FCOMP           ;COMPARE	;COMPARE
128)   4527 47 45       		RTABLE:			DEFW    FAND            ;AND (FLOATING-POINT)	;AND (FLOATING-POINT)
129)   4529 AA 45       		        		DEFW    FBDIV           ;DIV	;DIV
130)   452B 59 45       		        		DEFW    FEOR            ;EOR	;EOR
131)   452D 7D 45       		        		DEFW    FMOD            ;MOD	;MOD
132)   452F 6B 45       		        		DEFW    FOR             ;OR	;OR
133)   4531 D7 47       		        		DEFW    FLE             ;<= 	;<=
134)   4533 E4 47       		        		DEFW    FNE             ;<>	;<>
135)   4535 CC 47       		        		DEFW    FGE             ;>=	;>=
136)   4537 B5 47       		        		DEFW    FLT             ;<	;<
137)   4539 EF 47       		        		DEFW    FEQ             ;=	;=
138)   453B C5 46       		        		DEFW    FMUL            ;*	;*
139)   453D DA 45       		        		DEFW    FADD            ;+	;+
140)   453F C0 47       		        		DEFW    FGT             ;>	;>
141)   4541 C4 45       		        		DEFW    FSUB            ;-	;-
142)   4543 8B 47       		        		DEFW    FPOW            ;^	;^
143)   4545 32 46       		        		DEFW    FDIV            ;/	;/
156)   4547 CD 85 4D    		FAND:			CALL    FIX2	;
157)   454A 7C          		IAND:			LD      A,H	;
158)   454B A2          		        		AND     D	;
159)   454C 67          		        		LD      H,A	;
160)   454D 7D          		        		LD      A,L	;
161)   454E A3          		        		AND     E	;
162)   454F 6F          		        		LD      L,A	;
163)   4550 D9          		        		EXX	;
164)   4551 7C          		        		LD      A,H	;
165)   4552 A2          		        		AND     D	;
166)   4553 67          		        		LD      H,A	;
167)   4554 7D          		        		LD      A,L	;
168)   4555 A3          		        		AND     E	;
169)   4556 6F          		        		LD      L,A	;
170)   4557 D9          		        		EXX	;
171)   4558 C9          		        		RET	;
176)   4559 CD 85 4D    		FEOR:			CALL    FIX2	;
177)   455C 7C          		IEOR:			LD      A,H	;
178)   455D AA          		        		XOR     D	;
179)   455E 67          		        		LD      H,A	;
180)   455F 7D          		        		LD      A,L	;
181)   4560 AB          		        		XOR     E	;
182)   4561 6F          		        		LD      L,A	;
183)   4562 D9          		        		EXX	;
184)   4563 7C          		        		LD      A,H	;
185)   4564 AA          		        		XOR     D	;
186)   4565 67          		        		LD      H,A	;
187)   4566 7D          		        		LD      A,L	;
188)   4567 AB          		        		XOR     E	;
189)   4568 6F          		        		LD      L,A	;
190)   4569 D9          		        		EXX	;
191)   456A C9          		        		RET	;
196)   456B CD 85 4D    		FOR:			CALL    FIX2	;
197)   456E 7C          		IOR:			LD      A,H	;
198)   456F B2          		        		OR      D	;
199)   4570 67          		        		LD      H,A	;
200)   4571 7D          		        		LD      A,L	;
201)   4572 B3          		        		OR      E	;
202)   4573 6F          		        		LD      L,A	;
203)   4574 D9          		        		EXX	;
204)   4575 7C          		        		LD      A,H	;
205)   4576 B2          		        		OR      D	;
206)   4577 67          		        		LD      H,A	;
207)   4578 7D          		        		LD      A,L	;
208)   4579 B3          		        		OR      E	;
209)   457A 6F          		        		LD      L,A	;
210)   457B D9          		        		EXX	;
211)   457C C9          		        		RET	;
216)   457D CD 85 4D    		FMOD:			CALL    FIX2	;
217)   4580 7C          		IMOD:			LD      A,H	;
218)   4581 AA          		        		XOR     D               ;DIV RESULT SIGN	;DIV RESULT SIGN
219)   4582 CB 7C       		        		BIT     7,H	;
220)   4584 08          		        		EX      AF,AF'	;
221)   4585 CB 7C       		        		BIT     7,H	;
222)   4587 C4 9D 4D    		        		CALL    NZ,NEGATE       ;MAKE ARGUMENTS +VE	;MAKE ARGUMENTS +VE
223)   458A CD 74 4E    		        		CALL    SWAP	;
224)   458D CB 7C       		        		BIT     7,H	;
225)   458F C4 9D 4D    		        		CALL    NZ,NEGATE	;
226)   4592 44          		        		LD      B,H	;
227)   4593 4D          		        		LD      C,L	;
228)   4594 21 00 00    		        		LD      HL,0	;
229)   4597 D9          		        		EXX	;
230)   4598 44          		        		LD      B,H	;
231)   4599 4D          		        		LD      C,L	;
232)   459A 21 00 00    		        		LD      HL,0	;
233)   459D 3E DF       		        		LD      A,-33	;
234)   459F CD C9 4F    		        		CALL    DIVA            ;DIVIDE	;DIVIDE
235)   45A2 D9          		        		EXX	;
236)   45A3 0E 00       		        		LD      C,0             ;INTEGER MARKER	;INTEGER MARKER
237)   45A5 08          		        		EX      AF,AF'	;
238)   45A6 C8          		        		RET     Z	;
239)   45A7 C3 9D 4D    		        		JP      NEGATE	;
243)   45AA CD 85 4D    		FBDIV:			CALL    FIX2	;
244)   45AD CD 80 45    		IBDIV:			CALL    IMOD	;
245)   45B0 B7          		        		OR      A	;
246)   45B1 CD 74 4E    		        		CALL    SWAP	;
247)   45B4 0E 00       		        		LD      C,0	;
248)   45B6 F0          		        		RET     P	;
249)   45B7 C3 9D 4D    		        		JP      NEGATE	;
254)   45BA CD FC 4E    		ISUB:			CALL    SUB	;
255)   45BD E0          		        		RET     PO	;
256)   45BE CD F6 4E    		        		CALL    ADD	;
257)   45C1 CD 41 4E    		        		CALL    FLOAT2	;
258)   45C4 7A          		FSUB:			LD      A,D	;
259)   45C5 EE 80       		        		XOR     80H             ;CHANGE SIGN THEN ADD	;CHANGE SIGN THEN ADD
260)   45C7 57          		        		LD      D,A	;
261)   45C8 18 10       		        		JR      FADD	;
265)   45CA 7C          		RSUB:			LD      A,H	;
266)   45CB EE 80       		        		XOR     80H	;
267)   45CD 67          		        		LD      H,A	;
268)   45CE 18 0A       		        		JR      FADD	;
273)   45D0 CD F6 4E    		IADD:			CALL    ADD	;
274)   45D3 E0          		        		RET     PO	;
275)   45D4 CD FC 4E    		        		CALL    SUB	;
276)   45D7 CD 41 4E    		        		CALL    FLOAT2	;
277)   45DA 05          		FADD:			DEC     B	;
278)   45DB 04          		        		INC     B	;
279)   45DC C8          		        		RET     Z               ;ARG 2 ZERO	;ARG 2 ZERO
280)   45DD 0D          		        		DEC     C	;
281)   45DE 0C          		        		INC     C	;
282)   45DF CA 74 4E    		        		JP      Z,SWAP          ;ARG 1 ZERO	;ARG 1 ZERO
283)   45E2 D9          		        		EXX	;
284)   45E3 01 00 00    		        		LD      BC,0            ;INITIALISE	;INITIALISE
285)   45E6 D9          		        		EXX	;
286)   45E7 7C          		        		LD      A,H	;
287)   45E8 AA          		        		XOR     D               ;XOR SIGNS	;XOR SIGNS
288)   45E9 F5          		        		PUSH    AF	;
289)   45EA 78          		        		LD      A,B	;
290)   45EB B9          		        		CP      C               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
291)   45EC DC 74 4E    		        		CALL    C,SWAP          ;MAKE DED'E'B LARGEST	;MAKE DED'E'B LARGEST
292)   45EF 78          		        		LD      A,B	;
293)   45F0 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
294)   45F2 C4 75 4D    		        		CALL    NZ,FIX          ;ALIGN	;ALIGN
295)   45F5 F1          		        		POP     AF	;
296)   45F6 7A          		        		LD      A,D             ;SIGN OF LARGER	;SIGN OF LARGER
297)   45F7 CB FA       		        		SET     7,D             ;IMPLIED 1	;IMPLIED 1
298)   45F9 FA 06 46    		        		JP      M,FADD3         ;SIGNS DIFFERENT	;SIGNS DIFFERENT
299)   45FC CD F6 4E    		        		CALL    ADD             ;HLH'L'=HLH'L'+DED'E'	;HLH'L'=HLH'L'+DED'E'
300)   45FF DC 7C 4E    		        		CALL    C,DIV2          ;NORMALISE	;NORMALISE
301)   4602 CB FC       		        		SET     7,H	;
302)   4604 18 0A       		        		JR      FADD4	;
304)   4606 CD FC 4E    		FADD3:			CALL    SUB             ;HLH'L'=HLH'L'-DED'E'	;HLH'L'=HLH'L'-DED'E'
305)   4609 DC B1 4D    		        		CALL    C,NEG           ;NEGATE HLH'L'B'C'	;NEGATE HLH'L'B'C'
306)   460C CD 1E 4E    		        		CALL    FLO48	;
307)   460F 2F          		        		CPL                     ;CHANGE RESULT SIGN	;CHANGE RESULT SIGN
308)   4610 D9          		FADD4:			EXX	;
309)   4611 EB          		        		EX      DE,HL	;
310)   4612 21 00 80    		        		LD      HL,8000H	;
311)   4615 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
312)   4616 ED 42       		        		SBC     HL,BC	;
313)   4618 EB          		        		EX      DE,HL	;
314)   4619 D9          		        		EXX	;
315)   461A CC 6E 4E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
316)   461D DC 60 4E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
317)   4620 DC 88 4E    		        		CALL    C,INCC	;
318)   4623 CB BC       		        		RES     7,H	;
319)   4625 0D          		        		DEC     C	;
320)   4626 0C          		        		INC     C	;
321)   4627 CA B9 4E    		        		JP      Z,ZERO	;
322)   462A B7          		        		OR      A               ;RESULT SIGNQ	;RESULT SIGNQ
323)   462B F0          		        		RET     P               ;POSITIVE	;POSITIVE
324)   462C CB FC       		        		SET     7,H             ;NEGATIVE	;NEGATIVE
325)   462E C9          		        		RET	;
330)   462F CD 41 4E    		IDIV:			CALL    FLOAT2	;
331)   4632 05          		FDIV:			DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
332)   4633 04          		        		INC     B	;
333)   4634 3E 12       		        		LD      A,DIVBY0	;
334)   4636 CA AD 44    		        		JP      Z,ERROR         ;"Division by zero"	;"Division by zero"
335)   4639 0D          		        		DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
336)   463A 0C          		        		INC     C	;
337)   463B C8          		        		RET     Z	;
338)   463C 7C          		        		LD      A,H	;
339)   463D AA          		        		XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
340)   463E 08          		        		EX      AF,AF'          ;SAVE SIGN	;SAVE SIGN
341)   463F CB FA       		        		SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
342)   4641 CB FC       		        		SET     7,H	;
343)   4643 C5          		        		PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
344)   4644 42          		        		LD      B,D             ;LOAD REGISTERS	;LOAD REGISTERS
345)   4645 4B          		        		LD      C,E	;
346)   4646 11 00 00    		        		LD      DE,0	;
347)   4649 D9          		        		EXX	;
348)   464A 42          		        		LD      B,D	;
349)   464B 4B          		        		LD      C,E	;
350)   464C 11 00 00    		        		LD      DE,0	;
351)   464F 3E E0       		        		LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
352)   4651 CD C9 4F    		        		CALL    DIVA            ;DIVIDE	;DIVIDE
353)   4654 D9          		        		EXX	;
354)   4655 CB 7A       		        		BIT     7,D	;
355)   4657 D9          		        		EXX	;
356)   4658 CC E4 4F    		        		CALL    Z,DIVB          ;NORMALISE & INC A	;NORMALISE & INC A
357)   465B EB          		        		EX      DE,HL	;
358)   465C D9          		        		EXX	;
359)   465D CB 38       		        		SRL     B               ;DIVISOR/2	;DIVISOR/2
360)   465F CB 19       		        		RR      C	;
361)   4661 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
362)   4662 ED 42       		        		SBC     HL,BC           ;REMAINDER-DIVISOR/2	;REMAINDER-DIVISOR/2
363)   4664 3F          		        		CCF	;
364)   4665 EB          		        		EX      DE,HL           ;RESULT IN HLH'L'	;RESULT IN HLH'L'
365)   4666 CC 6E 4E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
366)   4669 DC 60 4E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
367)   466C C1          		        		POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
368)   466D DC 88 4E    		        		CALL    C,INCC	;
369)   4670 1F          		        		RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
370)   4671 79          		        		LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
371)   4672 98          		        		SBC     A,B	;
372)   4673 3F          		        		CCF	;
373)   4674 C3 FE 46    		        		JP      CHKOVF	;
377)   4677 7C          		IMUL:			LD      A,H	;
378)   4678 AA          		        		XOR     D	;
379)   4679 08          		        		EX      AF,AF'          ;SAVE RESULT SIGN	;SAVE RESULT SIGN
380)   467A CB 7C       		        		BIT     7,H	;
381)   467C C4 9D 4D    		        		CALL    NZ,NEGATE	;
382)   467F CD 74 4E    		        		CALL    SWAP	;
383)   4682 CB 7C       		        		BIT     7,H	;
384)   4684 C4 9D 4D    		        		CALL    NZ,NEGATE	;
385)   4687 44          		        		LD      B,H	;
386)   4688 4D          		        		LD      C,L	;
387)   4689 21 00 00    		        		LD      HL,0	;
388)   468C D9          		        		EXX	;
389)   468D 44          		        		LD      B,H	;
390)   468E 4D          		        		LD      C,L	;
391)   468F 21 00 00    		        		LD      HL,0	;
392)   4692 3E DF       		        		LD      A,-33	;
393)   4694 CD F7 4F    		        		CALL    MULA            ;MULTIPLY	;MULTIPLY
394)   4697 D9          		        		EXX	;
395)   4698 0E BF       		        		LD      C,191           ;PRESET EXPONENT	;PRESET EXPONENT
396)   469A CD 99 4E    		        		CALL    TEST            ;TEST RANGE	;TEST RANGE
397)   469D 20 0D       		        		JR      NZ,IMUL1        ;TOO BIG	;TOO BIG
398)   469F CB 7A       		        		BIT     7,D	;
399)   46A1 20 09       		        		JR      NZ,IMUL1	;
400)   46A3 CD 74 4E    		        		CALL    SWAP	;
401)   46A6 4A          		        		LD      C,D             ;INTEGER MARKER	;INTEGER MARKER
402)   46A7 08          		        		EX      AF,AF'	;
403)   46A8 F0          		        		RET     P	;
404)   46A9 C3 9D 4D    		        		JP      NEGATE	;
406)   46AC 0D          		IMUL1:			DEC     C	;
407)   46AD D9          		        		EXX	;
408)   46AE CB 23       		        		SLA     E	;
409)   46B0 CB 12       		        		RL      D	;
410)   46B2 D9          		        		EXX	;
411)   46B3 CB 13       		        		RL      E	;
412)   46B5 CB 12       		        		RL      D	;
413)   46B7 D9          		        		EXX	;
414)   46B8 ED 6A       		        		ADC     HL,HL	;
415)   46BA D9          		        		EXX	;
416)   46BB ED 6A       		        		ADC     HL,HL	;
417)   46BD F2 AC 46    		        		JP      P,IMUL1         ;NORMALISE	;NORMALISE
418)   46C0 08          		        		EX      AF,AF'	;
419)   46C1 F8          		        		RET     M	;
420)   46C2 CB BC       		        		RES     7,H             ;POSITIVE	;POSITIVE
421)   46C4 C9          		        		RET	;
425)   46C5 05          		FMUL:			DEC     B               ;TEST FOR ZERO	;TEST FOR ZERO
426)   46C6 04          		        		INC     B	;
427)   46C7 CA B9 4E    		        		JP      Z,ZERO	;
428)   46CA 0D          		        		DEC     C               ;TEST FOR ZERO	;TEST FOR ZERO
429)   46CB 0C          		        		INC     C	;
430)   46CC C8          		        		RET     Z	;
431)   46CD 7C          		        		LD      A,H	;
432)   46CE AA          		        		XOR     D               ;CALC. RESULT SIGN	;CALC. RESULT SIGN
433)   46CF 08          		        		EX      AF,AF'	;
434)   46D0 CB FA       		        		SET     7,D             ;REPLACE IMPLIED 1's	;REPLACE IMPLIED 1's
435)   46D2 CB FC       		        		SET     7,H	;
436)   46D4 C5          		        		PUSH    BC              ;SAVE EXPONENTS	;SAVE EXPONENTS
437)   46D5 44          		        		LD      B,H             ;LOAD REGISTERS	;LOAD REGISTERS
438)   46D6 4D          		        		LD      C,L	;
439)   46D7 21 00 00    		        		LD      HL,0	;
440)   46DA D9          		        		EXX	;
441)   46DB 44          		        		LD      B,H	;
442)   46DC 4D          		        		LD      C,L	;
443)   46DD 21 00 00    		        		LD      HL,0	;
444)   46E0 3E E0       		        		LD      A,-32           ;LOOP COUNTER	;LOOP COUNTER
445)   46E2 CD F7 4F    		        		CALL    MULA            ;MULTIPLY	;MULTIPLY
446)   46E5 DC 0B 50    		        		CALL    C,MULB          ;NORMALISE & INC A	;NORMALISE & INC A
447)   46E8 D9          		        		EXX	;
448)   46E9 E5          		        		PUSH    HL	;
449)   46EA 21 00 80    		        		LD      HL,8000H	;
450)   46ED B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
451)   46EE ED 52       		        		SBC     HL,DE	;
452)   46F0 E1          		        		POP     HL	;
453)   46F1 CC 6E 4E    		        		CALL    Z,ODD           ;ROUND UNBIASSED	;ROUND UNBIASSED
454)   46F4 DC 60 4E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
455)   46F7 C1          		        		POP     BC              ;RESTORE EXPONENTS	;RESTORE EXPONENTS
456)   46F8 DC 88 4E    		        		CALL    C,INCC	;
457)   46FB 1F          		        		RRA                     ;LSB OF A TO CARRY	;LSB OF A TO CARRY
458)   46FC 79          		        		LD      A,C             ;COMPUTE NEW EXPONENT	;COMPUTE NEW EXPONENT
459)   46FD 88          		        		ADC     A,B	;
460)   46FE 38 05       		CHKOVF:			JR      C,CHKO1	;
461)   4700 F2 B9 4E    		        		JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
462)   4703 18 03       		        		JR      CHKO2	;
463)   4705 FA 8A 4E    		CHKO1:			JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
464)   4708 C6 80       		CHKO2:			ADD     A,80H	;
465)   470A 4F          		        		LD      C,A	;
466)   470B CA B9 4E    		        		JP      Z,ZERO	;
467)   470E 08          		        		EX      AF,AF'          ;RESTORE SIGN BIT	;RESTORE SIGN BIT
468)   470F CB BC       		        		RES     7,H	;
469)   4711 F0          		        		RET     P	;
470)   4712 CB FC       		        		SET     7,H	;
471)   4714 C9          		        		RET	;
475)   4715 CD 74 4E    		IPOW:			CALL    SWAP	;
476)   4718 CB 7C       		        		BIT     7,H	;
477)   471A F5          		        		PUSH    AF              ;SAVE SIGN	;SAVE SIGN
478)   471B C4 9D 4D    		        		CALL    NZ,NEGATE	;
479)   471E 48          		IPOW0:			LD      C,B	;
480)   471F 06 20       		        		LD      B,32            ;LOOP COUNTER	;LOOP COUNTER
481)   4721 CD 13 4F    		IPOW1:			CALL    X2	;
482)   4724 38 08       		        		JR      C,IPOW2	;
483)   4726 10 F9       		        		DJNZ    IPOW1	;
484)   4728 F1          		        		POP     AF	;
485)   4729 D9          		        		EXX	;
486)   472A 2C          		        		INC     L               ;RESULT=1	;RESULT=1
487)   472B D9          		        		EXX	;
488)   472C 4C          		        		LD      C,H	;
489)   472D C9          		        		RET	;
491)   472E F1          		IPOW2:			POP     AF	;
492)   472F C5          		        		PUSH    BC	;
493)   4730 EB          		        		EX      DE,HL	;
494)   4731 E5          		        		PUSH    HL	;
495)   4732 D9          		        		EXX	;
496)   4733 EB          		        		EX      DE,HL	;
497)   4734 E5          		        		PUSH    HL	;
498)   4735 D9          		        		EXX	;
499)   4736 DD 21 00 00 		        		LD      IX,0	;
500)   473A DD 39       		        		ADD     IX,SP	;
501)   473C 28 42       		        		JR      Z,IPOW4	;
502)   473E C5          		        		PUSH    BC	;
503)   473F D9          		        		EXX	;
504)   4740 D5          		        		PUSH    DE	;
505)   4741 D9          		        		EXX	;
506)   4742 D5          		        		PUSH    DE	;
507)   4743 CD 4A 4E    		        		CALL    SFLOAT	;
508)   4746 CD 15 4A    		        		CALL    RECIP	;
509)   4749 DD 71 04    		        		LD      (IX+4),C	;
510)   474C D9          		        		EXX	;
511)   474D DD 75 00    		        		LD      (IX+0),L	;
512)   4750 DD 74 01    		        		LD      (IX+1),H	;
513)   4753 D9          		        		EXX	;
514)   4754 DD 75 02    		        		LD      (IX+2),L	;
515)   4757 DD 74 03    		        		LD      (IX+3),H	;
516)   475A 18 1D       		        		JR      IPOW5	;
518)   475C C5          		IPOW3:			PUSH    BC	;
519)   475D D9          		        		EXX	;
520)   475E CB 23       		        		SLA     E	;
521)   4760 CB 12       		        		RL      D	;
522)   4762 D5          		        		PUSH    DE	;
523)   4763 D9          		        		EXX	;
524)   4764 CB 13       		        		RL      E	;
525)   4766 CB 12       		        		RL      D	;
526)   4768 D5          		        		PUSH    DE	;
527)   4769 3E 0A       		        		LD      A,'*' AND 0FH	;
528)   476B F5          		        		PUSH    AF	;
529)   476C CD 25 4F    		        		CALL    COPY	;
530)   476F CD B3 44    		        		CALL    OP              ;SQUARE	;SQUARE
531)   4772 F1          		        		POP     AF	;
532)   4773 CD B9 4C    		        		CALL    DLOAD5	;
533)   4776 DC B3 44    		        		CALL    C,OP            ;MULTIPLY BY X	;MULTIPLY BY X
534)   4779 D1          		IPOW5:			POP     DE	;
535)   477A D9          		        		EXX	;
536)   477B D1          		        		POP     DE	;
537)   477C D9          		        		EXX	;
538)   477D 79          		        		LD      A,C	;
539)   477E C1          		        		POP     BC	;
540)   477F 4F          		        		LD      C,A	;
541)   4780 10 DA       		IPOW4:			DJNZ    IPOW3	;
542)   4782 F1          		        		POP     AF	;
543)   4783 F1          		        		POP     AF	;
544)   4784 F1          		        		POP     AF	;
545)   4785 C9          		        		RET	;
547)   4786 F1          		FPOW0:			POP     AF	;
548)   4787 F1          		        		POP     AF	;
549)   4788 F1          		        		POP     AF	;
550)   4789 18 93       		        		JR      IPOW0	;
554)   478B CB 7A       		FPOW:			BIT     7,D	;
555)   478D F5          		        		PUSH    AF	;
556)   478E CD 74 4E    		        		CALL    SWAP	;
557)   4791 CD 33 4F    		        		CALL    PUSH5	;
558)   4794 0D          		        		DEC     C	;
559)   4795 0C          		        		INC     C	;
560)   4796 28 EE       		        		JR      Z,FPOW0	;
561)   4798 3E 9E       		        		LD      A,158	;
562)   479A B9          		        		CP      C	;
563)   479B 38 08       		        		JR      C,FPOW1	;
564)   479D 3C          		        		INC     A	;
565)   479E CD 75 4D    		        		CALL    FIX	;
566)   47A1 08          		        		EX      AF,AF'	;
567)   47A2 F2 86 47    		        		JP      P,FPOW0	;
568)   47A5 CD 74 4E    		FPOW1:			CALL    SWAP	;
569)   47A8 CD 2C 4A    		        		CALL    LN0	;
570)   47AB CD 3C 4F    		        		CALL    POP5	;
571)   47AE F1          		        		POP     AF	;
572)   47AF CD C5 46    		        		CALL    FMUL	;
573)   47B2 C3 A1 49    		        		JP      EXP0	;
578)   47B5 CD C3 4E    		FLT:			CALL    FCP	;
579)   47B8 18 03       		        		JR      ILT1	;
580)   47BA CD B6 4E    		ILT:			CALL    ICP	;
581)   47BD D0          		ILT1:			RET     NC	;
582)   47BE 18 38       		        		JR      TRUE	;
584)   47C0 CD C3 4E    		FGT:			CALL    FCP	;
585)   47C3 18 03       		        		JR      IGT1	;
586)   47C5 CD B6 4E    		IGT:			CALL    ICP	;
587)   47C8 C8          		IGT1:			RET     Z	;
588)   47C9 D8          		        		RET     C	;
589)   47CA 18 2C       		        		JR      TRUE	;
591)   47CC CD C3 4E    		FGE:			CALL    FCP	;
592)   47CF 18 03       		        		JR      IGE1	;
593)   47D1 CD B6 4E    		IGE:			CALL    ICP	;
594)   47D4 D8          		IGE1:			RET     C	;
595)   47D5 18 21       		        		JR      TRUE	;
597)   47D7 CD C3 4E    		FLE:			CALL    FCP	;
598)   47DA 18 03       		        		JR      ILE1	;
599)   47DC CD B6 4E    		ILE:			CALL    ICP	;
600)   47DF 28 17       		ILE1:			JR      Z,TRUE	;
601)   47E1 D0          		        		RET     NC	;
602)   47E2 18 14       		        		JR      TRUE	;
604)   47E4 CD C3 4E    		FNE:			CALL    FCP	;
605)   47E7 18 03       		        		JR      INE1	;
606)   47E9 CD B6 4E    		INE:			CALL    ICP	;
607)   47EC C8          		INE1:			RET     Z	;
608)   47ED 18 09       		        		JR      TRUE	;
610)   47EF CD C3 4E    		FEQ:			CALL    FCP	;
611)   47F2 18 03       		        		JR      IEQ1	;
612)   47F4 CD B6 4E    		IEQ:			CALL    ICP	;
613)   47F7 C0          		IEQ1:			RET     NZ	;
614)   47F8 21 FF FF    		TRUE:			LD      HL,-1	;
615)   47FB D9          		        		EXX	;
616)   47FC 21 FF FF    		        		LD      HL,-1	;
617)   47FF D9          		        		EXX	;
618)   4800 AF          		        		XOR     A	;
619)   4801 4F          		        		LD      C,A	;
620)   4802 C9          		        		RET	;
631)   4803 CB 7C       		ABS:			BIT     7,H	;
632)   4805 C8          		        		RET     Z               ;POSITIVE/ZERO	;POSITIVE/ZERO
633)   4806 0D          		        		DEC     C	;
634)   4807 0C          		        		INC     C	;
635)   4808 CA 9D 4D    		        		JP      Z,NEGATE        ;INTEGER	;INTEGER
636)   480B CB BC       		        		RES     7,H	;
637)   480D C9          		        		RET	;
642)   480E CD 8E 4D    		NOTK:			CALL    SFIX	;
643)   4811 7C          		        		LD      A,H	;
644)   4812 2F          		        		CPL	;
645)   4813 67          		        		LD      H,A	;
646)   4814 7D          		        		LD      A,L	;
647)   4815 2F          		        		CPL	;
648)   4816 6F          		        		LD      L,A	;
649)   4817 D9          		        		EXX	;
650)   4818 7C          		        		LD      A,H	;
651)   4819 2F          		        		CPL	;
652)   481A 67          		        		LD      H,A	;
653)   481B 7D          		        		LD      A,L	;
654)   481C 2F          		        		CPL	;
655)   481D 6F          		        		LD      L,A	;
656)   481E D9          		        		EXX	;
657)   481F AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
658)   4820 C9          		        		RET	;
663)   4821 21 0F 49    		PI:			LD      HL,490FH	;
664)   4824 D9          		        		EXX	;
665)   4825 21 A2 DA    		        		LD      HL,0DAA2H	;
666)   4828 D9          		        		EXX	;
667)   4829 0E 81       		        		LD      C,81H	;
668)   482B AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
669)   482C C9          		        		RET	;
674)   482D CD 3D 48    		DEG:			CALL    FPI180	;
675)   4830 CD C5 46    		        		CALL    FMUL	;
676)   4833 AF          		        		XOR     A	;
677)   4834 C9          		        		RET	;
682)   4835 CD 3D 48    		RAD:			CALL    FPI180	;
683)   4838 CD 32 46    		        		CALL    FDIV	;
684)   483B AF          		        		XOR     A	;
685)   483C C9          		        		RET	;
689)   483D CD 4A 4E    		FPI180:			CALL    SFLOAT	;
690)   4840 11 2E 65    		        		LD      DE,652EH	;
691)   4843 D9          		        		EXX	;
692)   4844 11 D3 E0    		        		LD      DE,0E0D3H	;
693)   4847 D9          		        		EXX	;
694)   4848 06 85       		        		LD      B,85H	;
695)   484A C9          		        		RET	;
700)   484B CD 99 4E    		SGN:			CALL    TEST	;
701)   484E B1          		        		OR      C	;
702)   484F C8          		        		RET     Z               ;ZERO	;ZERO
703)   4850 CB 7C       		        		BIT     7,H	;
704)   4852 C2 F8 47    		        		JP      NZ,TRUE         ;-1	;-1
705)   4855 CD B9 4E    		        		CALL    ZERO	;
706)   4858 C3 60 4E    		        		JP      ADD1            ;1	;1
712)   485B CD 84 50    		VAL:			CALL    SIGNQ	;
713)   485E F5          		        		PUSH    AF	;
714)   485F CD CB 4C    		        		CALL    CON	;
715)   4862 F1          		        		POP     AF	;
716)   4863 FE 2D       		        		CP      '-'	;
717)   4865 3E 00       		        		LD      A,0             ;NUMERIC MARKER	;NUMERIC MARKER
718)   4867 C0          		        		RET     NZ	;
719)   4868 0D          		        		DEC     C	;
720)   4869 0C          		        		INC     C	;
721)   486A CA 9D 4D    		        		JP      Z,NEGATE        ;ZERO/INTEGER	;ZERO/INTEGER
722)   486D 7C          		        		LD      A,H	;
723)   486E EE 80       		        		XOR     80H             ;CHANGE SIGN (FP)	;CHANGE SIGN (FP)
724)   4870 67          		        		LD      H,A	;
725)   4871 AF          		        		XOR     A	;
726)   4872 C9          		        		RET	;
731)   4873 0D          		INT:			DEC     C	;
732)   4874 0C          		        		INC     C	;
733)   4875 C8          		        		RET     Z               ;ZERO/INTEGER	;ZERO/INTEGER
734)   4876 3E 9F       		        		LD      A,159	;
735)   4878 44          		        		LD      B,H             ;B7=SIGN BIT	;B7=SIGN BIT
736)   4879 CD 75 4D    		        		CALL    FIX	;
737)   487C 08          		        		EX      AF,AF'	;
738)   487D A0          		        		AND     B	;
739)   487E FC 60 4E    		        		CALL    M,ADD1          ;NEGATIVE NON-INTEGER	;NEGATIVE NON-INTEGER
740)   4881 78          		        		LD      A,B	;
741)   4882 B7          		        		OR      A	;
742)   4883 FC 9D 4D    		        		CALL    M,NEGATE	;
743)   4886 AF          		        		XOR     A	;
744)   4887 4F          		        		LD      C,A	;
745)   4888 C9          		        		RET	;
750)   4889 CD 4A 4E    		SQR:			CALL    SFLOAT	;
751)   488C CB 7C       		SQR0:			BIT     7,H	;
752)   488E 3E 15       		        		LD      A,NGROOT	;
753)   4890 C2 AD 44    		        		JP      NZ,ERROR        ;"-ve root"	;"-ve root"
754)   4893 0D          		        		DEC     C	;
755)   4894 0C          		        		INC     C	;
756)   4895 C8          		        		RET     Z               ;ZERO	;ZERO
757)   4896 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
758)   4898 CB 41       		        		BIT     0,C	;
759)   489A CC 7C 4E    		        		CALL    Z,DIV2          ;MAKE EXPONENT ODD	;MAKE EXPONENT ODD
760)   489D 79          		        		LD      A,C	;
761)   489E D6 80       		        		SUB     80H	;
762)   48A0 CB 2F       		        		SRA     A               ;HALVE EXPONENT	;HALVE EXPONENT
763)   48A2 C6 80       		        		ADD     A,80H	;
764)   48A4 4F          		        		LD      C,A	;
765)   48A5 C5          		        		PUSH    BC              ;SAVE EXPONENT	;SAVE EXPONENT
766)   48A6 EB          		        		EX      DE,HL	;
767)   48A7 21 00 00    		        		LD      HL,0	;
768)   48AA 44          		        		LD      B,H	;
769)   48AB 4D          		        		LD      C,L	;
770)   48AC D9          		        		EXX	;
771)   48AD EB          		        		EX      DE,HL	;
772)   48AE 21 00 00    		        		LD      HL,0	;
773)   48B1 44          		        		LD      B,H	;
774)   48B2 4D          		        		LD      C,L	;
775)   48B3 3E E1       		        		LD      A,-31	;
776)   48B5 CD 2A 50    		        		CALL    SQRA            ;ROOT	;ROOT
777)   48B8 D9          		        		EXX	;
778)   48B9 CB 78       		        		BIT     7,B	;
779)   48BB D9          		        		EXX	;
780)   48BC CC 2A 50    		        		CALL    Z,SQRA          ;NORMALISE & INC A	;NORMALISE & INC A
781)   48BF CD 63 50    		        		CALL    SQRB	;
782)   48C2 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
783)   48C3 CD E4 4F    		        		CALL    DIVB	;
784)   48C6 CB 1B       		        		RR      E               ;LSB TO CARRY	;LSB TO CARRY
785)   48C8 60          		        		LD      H,B	;
786)   48C9 69          		        		LD      L,C	;
787)   48CA D9          		        		EXX	;
788)   48CB 60          		        		LD      H,B	;
789)   48CC 69          		        		LD      L,C	;
790)   48CD DC 60 4E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
791)   48D0 C1          		        		POP     BC              ;RESTORE EXPONENT	;RESTORE EXPONENT
792)   48D1 DC 88 4E    		        		CALL    C,INCC	;
793)   48D4 1F          		        		RRA	;
794)   48D5 9F          		        		SBC     A,A	;
795)   48D6 81          		        		ADD     A,C	;
796)   48D7 4F          		        		LD      C,A	;
797)   48D8 CB BC       		        		RES     7,H             ;POSITIVE	;POSITIVE
798)   48DA AF          		        		XOR     A	;
799)   48DB C9          		        		RET	;
804)   48DC CD 4A 4E    		TAN:			CALL    SFLOAT	;
805)   48DF CD 33 4F    		        		CALL    PUSH5	;
806)   48E2 CD FC 48    		        		CALL    COS0	;
807)   48E5 CD 3C 4F    		        		CALL    POP5	;
808)   48E8 CD 33 4F    		        		CALL    PUSH5	;
809)   48EB CD 74 4E    		        		CALL    SWAP	;
810)   48EE CD 07 49    		        		CALL    SIN0	;
811)   48F1 CD 3C 4F    		        		CALL    POP5	;
812)   48F4 CD 32 46    		        		CALL    FDIV	;
813)   48F7 AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
814)   48F8 C9          		        		RET	;
819)   48F9 CD 4A 4E    		COS:			CALL    SFLOAT	;
820)   48FC CD BF 4D    		COS0:			CALL    SCALE	;
821)   48FF 1C          		        		INC     E	;
822)   4900 1C          		        		INC     E	;
823)   4901 7B          		        		LD      A,E	;
824)   4902 18 0E       		        		JR      SIN1	;
829)   4904 CD 4A 4E    		SIN:			CALL    SFLOAT	;
830)   4907 E5          		SIN0:			PUSH    HL              ;H7=SIGN	;H7=SIGN
831)   4908 CD BF 4D    		        		CALL    SCALE	;
832)   490B F1          		        		POP     AF	;
833)   490C 07          		        		RLCA	;
834)   490D 07          		        		RLCA	;
835)   490E 07          		        		RLCA	;
836)   490F E6 04       		        		AND     4	;
837)   4911 AB          		        		XOR     E	;
838)   4912 F5          		SIN1:			PUSH    AF              ;OCTANT	;OCTANT
839)   4913 CB BC       		        		RES     7,H	;
840)   4915 1F          		        		RRA	;
841)   4916 CD 93 49    		        		CALL    PIBY4	;
842)   4919 DC CA 45    		        		CALL    C,RSUB          ;X=(PI/4)-X	;X=(PI/4)-X
843)   491C F1          		        		POP     AF	;
844)   491D F5          		        		PUSH    AF	;
845)   491E E6 03       		        		AND     3	;
846)   4920 E2 51 49    		        		JP      PO,SIN2         ;USE COSINE APPROX.	;USE COSINE APPROX.
847)   4923 CD 33 4F    		        		CALL    PUSH5           ;SAVE X	;SAVE X
848)   4926 CD 2D 4F    		        		CALL    SQUARE          ;PUSH X*X	;PUSH X*X
849)   4929 CD 66 4F    		        		CALL    POLY	;
850)   492C B7 A8       		        		DEFW    0A8B7H          ;a(8)	;a(8)
851)   492E 11 36       		        		DEFW    3611H	;
852)   4930 6D          		        		DEFB    6DH	;
853)   4931 26 DE       		        		DEFW    0DE26H          ;a(6)	;a(6)
854)   4933 05 D0       		        		DEFW    0D005H	;
855)   4935 73          		        		DEFB    73H	;
856)   4936 C0 80       		        		DEFW    80C0H           ;a(4)	;a(4)
857)   4938 88 08       		        		DEFW    888H	;
858)   493A 79          		        		DEFB    79H	;
859)   493B 9D AA       		        		DEFW    0AA9DH          ;a(2)	;a(2)
860)   493D AA AA       		        		DEFW    0AAAAH	;
861)   493F 7D          		        		DEFB    7DH	;
862)   4940 00 00       		        		DEFW    0               ;a(0)	;a(0)
863)   4942 00 00       		        		DEFW    0	;
864)   4944 80          		        		DEFB    80H	;
865)   4945 CD 3C 4F    		        		CALL    POP5	;
866)   4948 CD 3C 4F    		        		CALL    POP5	;
867)   494B CD C5 46    		        		CALL    FMUL	;
868)   494E C3 73 49    		        		JP      SIN3	;
870)   4951 CD 2D 4F    		SIN2:			CALL    SQUARE          ;PUSH X*X	;PUSH X*X
871)   4954 CD 66 4F    		        		CALL    POLY	;
872)   4957 71 D5       		        		DEFW    0D571H          ;b(8)	;b(8)
873)   4959 78 4C       		        		DEFW    4C78H	;
874)   495B 70          		        		DEFB    70H	;
875)   495C AF 94       		        		DEFW    94AFH           ;b(6)	;b(6)
876)   495E 03 B6       		        		DEFW    0B603H	;
877)   4960 76          		        		DEFB    76H	;
878)   4961 C8 9C       		        		DEFW    9CC8H           ;b(4)	;b(4)
879)   4963 AA 2A       		        		DEFW    2AAAH	;
880)   4965 7B          		        		DEFB    7BH	;
881)   4966 DD FF       		        		DEFW    0FFDDH          ;b(2)	;b(2)
882)   4968 FF FF       		        		DEFW    0FFFFH	;
883)   496A 7E          		        		DEFB    7EH	;
884)   496B 00 00       		        		DEFW    0               ;b(0)	;b(0)
885)   496D 00 00       		        		DEFW    0	;
886)   496F 80          		        		DEFB    80H	;
887)   4970 CD 3C 4F    		        		CALL    POP5	;
888)   4973 F1          		SIN3:			POP     AF	;
889)   4974 E6 04       		        		AND     4	;
890)   4976 C8          		        		RET     Z	;
891)   4977 0D          		        		DEC     C	;
892)   4978 0C          		        		INC     C	;
893)   4979 C8          		        		RET     Z               ;ZERO	;ZERO
894)   497A CB FC       		        		SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
895)   497C C9          		        		RET	;
899)   497D 21 00 00    		FONE:			LD      HL,0	;
900)   4980 D9          		        		EXX	;
901)   4981 21 00 00    		        		LD      HL,0	;
902)   4984 D9          		        		EXX	;
903)   4985 0E 80       		        		LD      C,80H	;
904)   4987 C9          		        		RET	;
906)   4988 11 00 00    		DONE:			LD      DE,0	;
907)   498B D9          		        		EXX	;
908)   498C 11 00 00    		        		LD      DE,0	;
909)   498F D9          		        		EXX	;
910)   4990 06 80       		        		LD      B,80H	;
911)   4992 C9          		        		RET	;
913)   4993 11 0F 49    		PIBY4:			LD      DE,490FH	;
914)   4996 D9          		        		EXX	;
915)   4997 11 A2 DA    		        		LD      DE,0DAA2H	;
916)   499A D9          		        		EXX	;
917)   499B 06 7F       		        		LD      B,7FH	;
918)   499D C9          		        		RET	;
923)   499E CD 4A 4E    		EXP:			CALL    SFLOAT	;
924)   49A1 CD 1E 4A    		EXP0:			CALL    LN2             ;LN(2)	;LN(2)
925)   49A4 D9          		        		EXX	;
926)   49A5 1D          			        	DEC     E	;
927)   49A6 01 CF D1    				        LD      BC,0D1CFH       ;0.6931471805599453	;0.6931471805599453
928)   49A9 D9          		        		EXX	;
929)   49AA E5          		        		PUSH    HL              ;H7=SIGN	;H7=SIGN
930)   49AB CD CF 4D    		        		CALL    MOD48           ;"MODULUS"	;"MODULUS"
931)   49AE F1          		        		POP     AF	;
932)   49AF CB 7B       		        		BIT     7,E	;
933)   49B1 28 09       		        		JR      Z,EXP1	;
934)   49B3 17          		        		RLA	;
935)   49B4 DA B9 4E    		        		JP      C,ZERO	;
936)   49B7 3E 18       		        		LD      A,EXPRNG	;
937)   49B9 C3 AD 44    		        		JP      ERROR           ;"Exp range"	;"Exp range"
939)   49BC E6 80       		EXP1:			AND     80H	;
940)   49BE B3          		        		OR      E	;
941)   49BF F5          		        		PUSH    AF              ;INTEGER PART	;INTEGER PART
942)   49C0 CB BC       		        		RES     7,H	;
943)   49C2 CD 33 4F    		        		CALL    PUSH5           ;PUSH X*LN(2)	;PUSH X*LN(2)
944)   49C5 CD 66 4F    		        		CALL    POLY	;
945)   49C8 72 40       		        		DEFW    4072H           ;a(7)	;a(7)
946)   49CA 2E 94       		        		DEFW    942EH	;
947)   49CC 73          		        		DEFB    73H	;
948)   49CD 65 6F       		        		DEFW    6F65H           ;a(6)	;a(6)
949)   49CF 4F 2E       		        		DEFW    2E4FH	;
950)   49D1 76          		        		DEFB    76H	;
951)   49D2 37 6D       		        		DEFW    6D37H           ;a(5)	;a(5)
952)   49D4 02 88       		        		DEFW    8802H	;
953)   49D6 79          		        		DEFB    79H	;
954)   49D7 12 E5       		        		DEFW    0E512H          ;a(4)	;a(4)
955)   49D9 A0 2A       		        		DEFW    2AA0H	;
956)   49DB 7B          		        		DEFB    7BH	;
957)   49DC 14 4F       		        		DEFW    4F14H           ;a(3)	;a(3)
958)   49DE AA AA       		        		DEFW    0AAAAH	;
959)   49E0 7D          		        		DEFB    7DH	;
960)   49E1 56 FD       		        		DEFW    0FD56H          ;a(2)	;a(2)
961)   49E3 FF 7F       		        		DEFW    7FFFH	;
962)   49E5 7E          		        		DEFB    7EH	;
963)   49E6 FE FF       		        		DEFW    0FFFEH          ;a(1)	;a(1)
964)   49E8 FF FF       		        		DEFW    0FFFFH	;
965)   49EA 7F          		        		DEFB    7FH	;
966)   49EB 00 00       		        		DEFW    0               ;a(0)	;a(0)
967)   49ED 00 00       		        		DEFW    0	;
968)   49EF 80          		        		DEFB    80H	;
969)   49F0 CD 3C 4F    		        		CALL    POP5	;
970)   49F3 F1          		        		POP     AF	;
971)   49F4 F5          		        		PUSH    AF	;
972)   49F5 F4 15 4A    		        		CALL    P,RECIP         ;X=1/X	;X=1/X
973)   49F8 F1          		        		POP     AF	;
974)   49F9 F2 00 4A    		        		JP      P,EXP4	;
975)   49FC E6 7F       		        		AND     7FH	;
976)   49FE ED 44       		        		NEG	;
977)   4A00 C6 80       		EXP4:			ADD     A,80H	;
978)   4A02 81          		        		ADD     A,C	;
979)   4A03 38 05       		        		JR      C,EXP2	;
980)   4A05 F2 B9 4E    		        		JP      P,ZERO          ;UNDERFLOW	;UNDERFLOW
981)   4A08 18 03       		        		JR      EXP3	;
982)   4A0A FA 8A 4E    		EXP2:			JP      M,OFLOW         ;OVERFLOW	;OVERFLOW
983)   4A0D C6 80       		EXP3:			ADD     A,80H	;
984)   4A0F CA B9 4E    		        		JP      Z,ZERO	;
985)   4A12 4F          		        		LD      C,A	;
986)   4A13 AF          		        		XOR     A               ;NUMERIC MARKER	;NUMERIC MARKER
987)   4A14 C9          		        		RET	;
989)   4A15 CD 88 49    		RECIP:			CALL    DONE	;
990)   4A18 CD 74 4E    		RDIV:			CALL    SWAP	;
991)   4A1B C3 32 46    		        		JP      FDIV            ;RECIPROCAL	;RECIPROCAL
993)   4A1E 11 72 31    		LN2:			LD      DE,3172H        ;LN(2)	;LN(2)
994)   4A21 D9          		        		EXX	;
995)   4A22 11 F8 17    		        		LD      DE,17F8H	;
996)   4A25 D9          		        		EXX	;
997)   4A26 06 7F       		        		LD      B,7FH	;
998)   4A28 C9          		        		RET	;
1003)   4A29 CD 4A 4E    		LN:			CALL    SFLOAT	;
1004)   4A2C 3E 16       		LN0:			LD      A,LOGRNG	;
1005)   4A2E CB 7C       		        		BIT     7,H	;
1006)   4A30 C2 AD 44    		        		JP      NZ,ERROR        ;"Log range"	;"Log range"
1007)   4A33 0C          		        		INC     C	;
1008)   4A34 0D          		        		DEC     C	;
1009)   4A35 CA AD 44    		        		JP      Z,ERROR	;
1010)   4A38 11 04 35    		        		LD      DE,3504H        ;SQR(2)	;SQR(2)
1011)   4A3B D9          		        		EXX	;
1012)   4A3C 11 33 F3    		        		LD      DE,0F333H       ;1.41421356237	;1.41421356237
1013)   4A3F D9          		        		EXX	;
1014)   4A40 CD CB 4E    		        		CALL    ICP0            ;MANTISSA>SQR(2)?	;MANTISSA>SQR(2)?
1015)   4A43 79          		        		LD      A,C             ;EXPONENT	;EXPONENT
1016)   4A44 0E 80       		        		LD      C,80H           ;1 <= X < 2	;1 <= X < 2
1017)   4A46 38 02       		        		JR      C,LN4	;
1018)   4A48 0D          		        		DEC     C	;
1019)   4A49 3C          		        		INC     A	;
1020)   4A4A F5          		LN4:			PUSH    AF              ;SAVE EXPONENT	;SAVE EXPONENT
1021)   4A4B CD 48 4F    		        		CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1022)   4A4E CD 33 4F    		        		CALL    PUSH5	;
1023)   4A51 CD 2D 4F    				        CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1024)   4A54 CD 66 4F    		        		CALL    POLY	;
1025)   4A57 48 CC       		        		DEFW    0CC48H          ;a(9)	;a(9)
1026)   4A59 FB 74       		        		DEFW    74FBH	;
1027)   4A5B 7D          		        		DEFB    7DH	;
1028)   4A5C AF AE       		        		DEFW    0AEAFH          ;a(7)	;a(7)
1029)   4A5E FF 11       		        		DEFW    11FFH	;
1030)   4A60 7E          		        		DEFB    7EH	;
1031)   4A61 8C D9       		        		DEFW    0D98CH          ;a(5)	;a(5)
1032)   4A63 CD 4C       		        		DEFW    4CCDH	;
1033)   4A65 7E          		        		DEFB    7EH	;
1034)   4A66 E3 A9       		        		DEFW    0A9E3H          ;a(3)	;a(3)
1035)   4A68 AA 2A       		        		DEFW    2AAAH	;
1036)   4A6A 7F          		        		DEFB    7FH	;
1037)   4A6B 00 00       		        		DEFW    0               ;a(1)	;a(1)
1038)   4A6D 00 00       		        		DEFW    0	;
1039)   4A6F 81          		        		DEFB    81H	;
1040)   4A70 CD 3C 4F    		        		CALL    POP5	;
1041)   4A73 CD 3C 4F    		        		CALL    POP5	;
1042)   4A76 CD C5 46    		        		CALL    FMUL	;
1043)   4A79 F1          		        		POP     AF              ;EXPONENT	;EXPONENT
1044)   4A7A CD 33 4F    		        		CALL    PUSH5	;
1045)   4A7D 08          		        		EX      AF,AF'	;
1046)   4A7E CD B9 4E    		        		CALL    ZERO	;
1047)   4A81 08          		        		EX      AF,AF'	;
1048)   4A82 D6 80       		        		SUB     80H	;
1049)   4A84 28 1B       		        		JR      Z,LN3	;
1050)   4A86 30 02       		        		JR      NC,LN1	;
1051)   4A88 2F          		        		CPL	;
1052)   4A89 3C          		        		INC     A	;
1053)   4A8A 67          		LN1:			LD      H,A	;
1054)   4A8B 0E 87       		        		LD      C,87H	;
1055)   4A8D F5          		        		PUSH    AF	;
1056)   4A8E CD 30 4E    		        		CALL    FLOAT	;
1057)   4A91 CB BC       		        		RES     7,H	;
1058)   4A93 CD 1E 4A    		        		CALL    LN2	;
1059)   4A96 CD C5 46    		        		CALL    FMUL	;
1060)   4A99 F1          		        		POP     AF	;
1061)   4A9A 30 05       		        		JR      NC,LN3	;
1062)   4A9C FA A1 4A    		        		JP      M,LN3	;
1063)   4A9F CB FC       		        		SET     7,H	;
1064)   4AA1 CD 3C 4F    		LN3:			CALL    POP5	;
1065)   4AA4 CD DA 45    		        		CALL    FADD	;
1066)   4AA7 AF          		        		XOR     A	;
1067)   4AA8 C9          		        		RET	;
1072)   4AA9 CD 29 4A    		LOG:			CALL    LN	;
1073)   4AAC 11 5B 5E    		        		LD      DE,5E5BH        ;LOG(e)	;LOG(e)
1074)   4AAF D9          		        		EXX	;
1075)   4AB0 11 A9 D8    		        		LD      DE,0D8A9H	;
1076)   4AB3 D9          		        		EXX	;
1077)   4AB4 06 7E       		        		LD      B,7EH	;
1078)   4AB6 CD C5 46    		        		CALL    FMUL	;
1079)   4AB9 AF          		        		XOR     A	;
1080)   4ABA C9          		        		RET	;
1085)   4ABB CD 4A 4E    		ASN:			CALL    SFLOAT	;
1086)   4ABE CD 33 4F    		        		CALL    PUSH5	;
1087)   4AC1 CD 25 4F    		        		CALL    COPY	;
1088)   4AC4 CD C5 46    		        		CALL    FMUL	;
1089)   4AC7 CD 88 49    		        		CALL    DONE	;
1090)   4ACA CD CA 45    		        		CALL    RSUB	;
1091)   4ACD CD 8C 48    		        		CALL    SQR0	;
1092)   4AD0 CD 3C 4F    		        		CALL    POP5	;
1093)   4AD3 0C          		        		INC     C	;
1094)   4AD4 0D          		        		DEC     C	;
1095)   4AD5 3E 02       		        		LD      A,2	;
1096)   4AD7 D5          		        		PUSH    DE	;
1097)   4AD8 28 70       		        		JR      Z,ACS1	;
1098)   4ADA D1          		        		POP     DE	;
1099)   4ADB CD 18 4A    		        		CALL    RDIV	;
1100)   4ADE 18 03       		        		JR      ATN0	;
1105)   4AE0 CD 4A 4E    		ATN:			CALL    SFLOAT	;
1106)   4AE3 E5          		ATN0:			PUSH    HL              ;SAVE SIGN	;SAVE SIGN
1107)   4AE4 CB BC       		        		RES     7,H	;
1108)   4AE6 11 13 54    		        		LD      DE,5413H        ;TAN(PI/8)=SQR(2)-1	;TAN(PI/8)=SQR(2)-1
1109)   4AE9 D9          		        		EXX	;
1110)   4AEA 11 D0 CC    		        		LD      DE,0CCD0H	;
1111)   4AED D9          		        		EXX	;
1112)   4AEE 06 7E       		        		LD      B,7EH	;
1113)   4AF0 CD C8 4E    		        		CALL    FCP0            ;COMPARE	;COMPARE
1114)   4AF3 06 00       		        		LD      B,0	;
1115)   4AF5 38 1C       		        		JR      C,ATN2	;
1116)   4AF7 11 82 1A    		        		LD      DE,1A82H        ;TAN(3*PI/8)=SQR(2)+1	;TAN(3*PI/8)=SQR(2)+1
1117)   4AFA D9          		        		EXX	;
1118)   4AFB 11 9A 79    		        		LD      DE,799AH	;
1119)   4AFE D9          		        		EXX	;
1120)   4AFF 06 81       		        		LD      B,81H	;
1121)   4B01 CD C8 4E    		        		CALL    FCP0            ;COMPARE	;COMPARE
1122)   4B04 38 08       		        		JR      C,ATN1	;
1123)   4B06 CD 15 4A    		        		CALL    RECIP           ;X=1/X	;X=1/X
1124)   4B09 06 02       		        		LD      B,2	;
1125)   4B0B C3 13 4B    		        		JP      ATN2	;
1126)   4B0E CD 48 4F    		ATN1:			CALL    RATIO           ;X=(X-1)/(X+1)	;X=(X-1)/(X+1)
1127)   4B11 06 01       		        		LD      B,1	;
1128)   4B13 C5          		ATN2:			PUSH    BC              ;SAVE FLAG	;SAVE FLAG
1129)   4B14 CD 33 4F    		        		CALL    PUSH5	;
1130)   4B17 CD 2D 4F    		        		CALL    SQUARE          ;PUSH X*X	;PUSH X*X
1131)   4B1A CD 66 4F    		        		CALL    POLY	;
1132)   4B1D 35 F3       		        		DEFW    0F335H          ;a(13)	;a(13)
1133)   4B1F D8 37       		        		DEFW    37D8H	;
1134)   4B21 7B          		        		DEFB    7BH	;
1135)   4B22 91 6B       		        		DEFW    6B91H           ;a(11)	;a(11)
1136)   4B24 B9 AA       		        		DEFW    0AAB9H	;
1137)   4B26 7C          		        		DEFB    7CH	;
1138)   4B27 DE 41       		        		DEFW    41DEH           ;a(9)	;a(9)
1139)   4B29 97 61       		        		DEFW    6197H	;
1140)   4B2B 7C          		        		DEFB    7CH	;
1141)   4B2C 7B 9D       		        		DEFW    9D7BH           ;a(7)	;a(7)
1142)   4B2E 37 92       		        		DEFW    9237H	;
1143)   4B30 7D          		        		DEFB    7DH	;
1144)   4B31 5A 2A       		        		DEFW    2A5AH           ;a(5)	;a(5)
1145)   4B33 CC 4C       		        		DEFW    4CCCH	;
1146)   4B35 7D          		        		DEFB    7DH	;
1147)   4B36 5C A9       		        		DEFW    0A95CH          ;a(3)	;a(3)
1148)   4B38 AA AA       		        		DEFW    0AAAAH	;
1149)   4B3A 7E          		        		DEFB    7EH	;
1150)   4B3B 00 00       		        		DEFW    0               ;a(1)	;a(1)
1151)   4B3D 00 00       		        		DEFW    0	;
1152)   4B3F 80          		        		DEFB    80H	;
1153)   4B40 CD 3C 4F    		        		CALL    POP5	;
1154)   4B43 CD 3C 4F    		        		CALL    POP5	;
1155)   4B46 CD C5 46    		        		CALL    FMUL	;
1156)   4B49 F1          		        		POP     AF	;
1157)   4B4A CD 93 49    		ACS1:			CALL    PIBY4           ;PI/4	;PI/4
1158)   4B4D 1F          		        		RRA	;
1159)   4B4E F5          		        		PUSH    AF	;
1160)   4B4F DC DA 45    		        		CALL    C,FADD	;
1161)   4B52 F1          		        		POP     AF	;
1162)   4B53 04          		        		INC     B	;
1163)   4B54 1F          		        		RRA	;
1164)   4B55 DC CA 45    		        		CALL    C,RSUB	;
1165)   4B58 F1          		        		POP     AF	;
1166)   4B59 B7          		        		OR      A	;
1167)   4B5A F0          		        		RET     P	;
1168)   4B5B CB FC       		        		SET     7,H             ;MAKE NEGATIVE	;MAKE NEGATIVE
1169)   4B5D AF          		        		XOR     A	;
1170)   4B5E C9          		        		RET	;
1175)   4B5F CD BB 4A    		ACS:			CALL    ASN	;
1176)   4B62 3E 02       		        		LD      A,2	;
1177)   4B64 F5          		        		PUSH    AF	;
1178)   4B65 18 E3       		        		JR      ACS1	;
1188)   4B67 CD 4A 4E    		STR:			CALL    SFLOAT	;
1189)   4B6A 06 00       		        		LD      B,0             ;DEFAULT PT. POSITION	;DEFAULT PT. POSITION
1190)   4B6C CB 7C       		        		BIT     7,H             ;NEGATIVE?	;NEGATIVE?
1191)   4B6E 28 06       		        		JR      Z,STR10	;
1192)   4B70 CB BC       		        		RES     7,H	;
1193)   4B72 3E 2D       		        		LD      A,'-'	;
1194)   4B74 12          		        		LD      (DE),A          ;STORE SIGN	;STORE SIGN
1195)   4B75 13          		        		INC     DE	;
1196)   4B76 AF          		STR10:			XOR     A               ;CLEAR A	;CLEAR A
1197)   4B77 B9          		        		CP      C	;
1198)   4B78 28 47       		        		JR      Z,STR2          ;ZERO	;ZERO
1199)   4B7A D5          		        		PUSH    DE              ;SAVE TEXT POINTER	;SAVE TEXT POINTER
1200)   4B7B 78          		        		LD      A,B	;
1201)   4B7C F5          		STR11:			PUSH    AF              ;SAVE DECIMAL COUNTER	;SAVE DECIMAL COUNTER
1202)   4B7D 79          		        		LD      A,C             ;BINARY EXPONENT	;BINARY EXPONENT
1203)   4B7E FE A1       		        		CP      161	;
1204)   4B80 30 1A       		        		JR      NC,STR14	;
1205)   4B82 FE 9B       		        		CP      155	;
1206)   4B84 30 25       		        		JR      NC,STR15	;
1207)   4B86 2F          		        		CPL	;
1208)   4B87 FE E1       		        		CP      225	;
1209)   4B89 38 02       		        		JR      C,STR13	;
1210)   4B8B 3E F8       		        		LD      A,-8	;
1211)   4B8D C6 1C       		STR13:			ADD     A,28	;
1212)   4B8F CD 8D 4F    		        		CALL    POWR10	;
1213)   4B92 F5          		        		PUSH    AF	;
1214)   4B93 CD C5 46    		        		CALL    FMUL	;
1215)   4B96 F1          		        		POP     AF	;
1216)   4B97 47          		        		LD      B,A	;
1217)   4B98 F1          		        		POP     AF	;
1218)   4B99 90          		        		SUB     B	;
1219)   4B9A 18 E0       		        		JR      STR11	;
1220)   4B9C D6 20       		STR14:			SUB     32	;
1221)   4B9E CD 8D 4F    		        		CALL    POWR10	;
1222)   4BA1 F5          		        		PUSH    AF	;
1223)   4BA2 CD 32 46    		        		CALL    FDIV	;
1224)   4BA5 F1          		        		POP     AF	;
1225)   4BA6 47          		        		LD      B,A	;
1226)   4BA7 F1          		        		POP     AF	;
1227)   4BA8 80          		        		ADD     A,B	;
1228)   4BA9 18 D1       		        		JR      STR11	;
1229)   4BAB 3E 09       		STR15:			LD      A,9	;
1230)   4BAD CD 8D 4F    		        		CALL    POWR10          ;10^9	;10^9
1231)   4BB0 CD C8 4E    		        		CALL    FCP0	;
1232)   4BB3 79          		        		LD      A,C	;
1233)   4BB4 C1          		        		POP     BC	;
1234)   4BB5 4F          		        		LD      C,A	;
1235)   4BB6 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
1236)   4BB8 DC EA 4E    		        		CALL    C,X10B          ;X10, DEC B	;X10, DEC B
1237)   4BBB D1          		        		POP     DE              ;RESTORE TEXT POINTER	;RESTORE TEXT POINTER
1238)   4BBC CB B9       		        		RES     7,C	;
1239)   4BBE 3E 00       		        		LD      A,0	;
1240)   4BC0 17          		        		RLA                     ;PUT CARRY IN LSB	;PUT CARRY IN LSB
1248)   4BC1 0C          		STR2:			INC     C	;
1249)   4BC2 08          		        		EX      AF,AF'          ;SAVE A	;SAVE A
1250)   4BC3 78          		        		LD      A,B	;
1251)   4BC4 DD CB 02 4E 		        		BIT     1,(IX+2)	;
1252)   4BC8 20 08       		        		JR      NZ,STR20	;
1253)   4BCA AF          		        		XOR     A	;
1254)   4BCB DD BE 01    		        		CP      (IX+1)	;
1255)   4BCE 28 0A       		        		JR      Z,STR21	;
1256)   4BD0 3E F6       		        		LD      A,-10	;
1257)   4BD2 DD 86 01    		STR20:			ADD     A,(IX+1)        ;SIG. FIG. COUNT	;SIG. FIG. COUNT
1258)   4BD5 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
1259)   4BD6 FA DA 4B    		        		JP      M,STR21	;
1260)   4BD9 AF          		        		XOR     A	;
1261)   4BDA F5          		STR21:			PUSH    AF	;
1262)   4BDB 08          		        		EX      AF,AF'          ;RESTORE A	;RESTORE A
1263)   4BDC CD 13 4F    		STR22:			CALL    X2              ;RL AHLH'L'	;RL AHLH'L'
1264)   4BDF 8F          		        		ADC     A,A	;
1265)   4BE0 FE 0A       		        		CP      10	;
1266)   4BE2 38 05       		        		JR      C,STR23	;
1267)   4BE4 D6 0A       		        		SUB     10	;
1268)   4BE6 D9          		        		EXX	;
1269)   4BE7 2C          		        		INC     L               ;SET RESULT BIT	;SET RESULT BIT
1270)   4BE8 D9          		        		EXX	;
1271)   4BE9 0D          		STR23:			DEC     C	;
1272)   4BEA 20 F0       		        		JR      NZ,STR22        ;32 TIMES	;32 TIMES
1273)   4BEC 4F          		        		LD      C,A             ;REMAINDER	;REMAINDER
1274)   4BED 7C          		        		LD      A,H	;
1275)   4BEE E6 3F       		        		AND     3FH             ;CLEAR OUT JUNK	;CLEAR OUT JUNK
1276)   4BF0 67          		        		LD      H,A	;
1277)   4BF1 F1          		        		POP     AF	;
1278)   4BF2 F2 FF 4B    		        		JP      P,STR24	;
1279)   4BF5 3C          		        		INC     A	;
1280)   4BF6 20 1C       		        		JR      NZ,STR26	;
1281)   4BF8 3E 04       		        		LD      A,4	;
1282)   4BFA B9          		        		CP      C               ;ROUND UP?	;ROUND UP?
1283)   4BFB 3E 00       		        		LD      A,0	;
1284)   4BFD 18 15       		        		JR      STR26	;
1285)   4BFF F5          		STR24:			PUSH    AF	;
1286)   4C00 79          		        		LD      A,C	;
1287)   4C01 CE 30       		        		ADC     A,'0'           ;ADD CARRY	;ADD CARRY
1288)   4C03 FE 30       		        		CP      '0'	;
1289)   4C05 28 05       		        		JR      Z,STR25         ;SUPPRESS ZERO	;SUPPRESS ZERO
1290)   4C07 FE 3A       		        		CP      '9'+1	;
1291)   4C09 3F          		        		CCF	;
1292)   4C0A 30 08       		        		JR      NC,STR26	;
1293)   4C0C E3          		STR25:			EX      (SP),HL	;
1294)   4C0D CB 75       		        		BIT     6,L             ;ZERO FLAG	;ZERO FLAG
1295)   4C0F E3          				        EX      (SP),HL	;
1296)   4C10 20 05       		        		JR      NZ,STR27	;
1297)   4C12 3E 30       		        		LD      A,'0'	;
1298)   4C14 3C          		STR26:			INC     A               ;SET +VE	;SET +VE
1299)   4C15 3D          		        		DEC     A	;
1300)   4C16 F5          		        		PUSH    AF              ;PUT ON STACK + CARRY	;PUT ON STACK + CARRY
1301)   4C17 04          		STR27:			INC     B	;
1302)   4C18 CD 99 4E    		        		CALL    TEST            ;IS HLH'L' ZERO?	;IS HLH'L' ZERO?
1303)   4C1B 0E 20       		        		LD      C,32	;
1304)   4C1D 3E 00       		        		LD      A,0	;
1305)   4C1F 20 BB       		        		JR      NZ,STR22	;
1306)   4C21 F1          		        		POP     AF	;
1307)   4C22 F5          		        		PUSH    AF	;
1308)   4C23 3E 00       		        		LD      A,0	;
1309)   4C25 38 B5       		        		JR      C,STR22	;
1317)   4C27 EB          		STR3:			EX      DE,HL           ;STRING POINTER	;STRING POINTER
1318)   4C28 0E FF       		        		LD      C,-1            ;FLAG "E"	;FLAG "E"
1319)   4C2A 16 01       		        		LD      D,1	;
1320)   4C2C DD 5E 01    		        		LD      E,(IX+1)        ;f2	;f2
1321)   4C2F DD CB 02 46 		        		BIT     0,(IX+2)	;
1322)   4C33 20 32       		        		JR      NZ,STR34        ;E MODE	;E MODE
1323)   4C35 DD CB 02 4E 		        		BIT     1,(IX+2)	;
1324)   4C39 28 11       		        		JR      Z,STR31	;
1325)   4C3B 78          		        		LD      A,B             ;F MODE	;F MODE
1326)   4C3C B7          		        		OR      A	;
1327)   4C3D 28 04       		        		JR      Z,STR30	;
1328)   4C3F FA 43 4C    		        		JP      M,STR30	;
1329)   4C42 50          		        		LD      D,B	;
1330)   4C43 7A          		STR30:			LD      A,D	;
1331)   4C44 DD 86 01    		        		ADD     A,(IX+1)	;
1332)   4C47 5F          		        		LD      E,A	;
1333)   4C48 FE 0B       		        		CP      11	;
1334)   4C4A 38 17       		        		JR      C,STR32	;
1335)   4C4C 78          		STR31:			LD      A,B             ;G MODE	;G MODE
1336)   4C4D 11 01 01    		        		LD      DE,101H	;
1337)   4C50 B7          		        		OR      A	;
1338)   4C51 FA 67 4C    		        		JP      M,STR34	;
1339)   4C54 28 0D       		        		JR      Z,STR32	;
1340)   4C56 DD 7E 01    		        		LD      A,(IX+1)	;
1341)   4C59 B7          		        		OR      A	;
1342)   4C5A 20 02       		        		JR      NZ,STR3A	;
1343)   4C5C 3E 0A       		        		LD      A,10	;
1344)   4C5E B8          		STR3A:			CP      B	;
1345)   4C5F 38 06       		        		JR      C,STR34	;
1346)   4C61 50          		        		LD      D,B	;
1347)   4C62 58          		        		LD      E,B	;
1348)   4C63 78          		STR32:			LD      A,B	;
1349)   4C64 C6 81       		        		ADD     A,129	;
1350)   4C66 4F          		        		LD      C,A	;
1351)   4C67 CB FA       		STR34:			SET     7,D	;
1352)   4C69 1D          		        		DEC     E	;
1353)   4C6A 7A          		STR35:			LD      A,D	;
1354)   4C6B B9          		        		CP      C	;
1355)   4C6C 30 0C       		        		JR      NC,STR33	;
1356)   4C6E F1          		STR36:			POP     AF	;
1357)   4C6F 28 03       		        		JR      Z,STR37	;
1358)   4C71 F2 7C 4C    		        		JP      P,STR38	;
1359)   4C74 F5          		STR37:			PUSH    AF	;
1360)   4C75 1C          		        		INC     E	;
1361)   4C76 1D          		        		DEC     E	;
1362)   4C77 FA 8B 4C    		        		JP      M,STR4	;
1363)   4C7A 3E 30       		STR33:			LD      A,'0'	;
1364)   4C7C 15          		STR38:			DEC     D	;
1365)   4C7D E2 83 4C    		        		JP      PO,STR39	;
1366)   4C80 36 2E       		        		LD      (HL),'.'	;
1367)   4C82 23          		        		INC     HL	;
1368)   4C83 77          		STR39:			LD      (HL),A	;
1369)   4C84 23          		        		INC     HL	;
1370)   4C85 1D          		        		DEC     E	;
1371)   4C86 F2 6A 4C    		        		JP      P,STR35	;
1372)   4C89 18 E3       		        		JR      STR36	;
1374)   4C8B F1          		STR4:			POP     AF	;
1375)   4C8C 0C          		STR40:			INC     C	;
1376)   4C8D 4D          		        		LD      C,L	;
1377)   4C8E 20 27       		        		JR      NZ,STR44	;
1378)   4C90 36 45       		        		LD      (HL),'E'        ;EXPONENT	;EXPONENT
1379)   4C92 23          		        		INC     HL	;
1380)   4C93 78          		        		LD      A,B	;
1381)   4C94 3D          		        		DEC     A	;
1382)   4C95 F2 9D 4C    		        		JP      P,STR41	;
1383)   4C98 36 2D       		        		LD      (HL),'-'	;
1384)   4C9A 23          		        		INC     HL	;
1385)   4C9B ED 44       		        		NEG	;
1386)   4C9D 36 30       		STR41:			LD      (HL),'0'	;
1387)   4C9F 28 15       		        		JR      Z,STR47	;
1388)   4CA1 FE 0A       		        		CP      10	;
1389)   4CA3 47          		        		LD      B,A	;
1390)   4CA4 3E 3A       		        		LD      A,':'	;
1391)   4CA6 38 03       		        		JR      C,STR42	;
1392)   4CA8 23          		        		INC     HL	;
1393)   4CA9 36 30       		        		LD      (HL),'0'	;
1394)   4CAB 34          		STR42:			INC     (HL)	;
1395)   4CAC BE          		        		CP      (HL)	;
1396)   4CAD 20 05       		        		JR      NZ,STR43	;
1397)   4CAF 36 30       		        		LD      (HL),'0'	;
1398)   4CB1 2B          		        		DEC     HL	;
1399)   4CB2 34          		        		INC     (HL)	;
1400)   4CB3 23          		        		INC     HL	;
1401)   4CB4 10 F5       		STR43:			DJNZ    STR42	;
1402)   4CB6 23          		STR47:			INC     HL	;
1403)   4CB7 EB          		STR44:			EX      DE,HL	;
1404)   4CB8 C9          		      			RET	;
1408)   4CB9 DD 46 04    		DLOAD5:			LD      B,(IX+4)	;
1409)   4CBC D9          		        		EXX	;
1410)   4CBD DD 5E 00    		        		LD      E,(IX+0)	;
1411)   4CC0 DD 56 01    		        		LD      D,(IX+1)	;
1412)   4CC3 D9          		        		EXX	;
1413)   4CC4 DD 5E 02    		        		LD      E,(IX+2)	;
1414)   4CC7 DD 56 03    		        		LD      D,(IX+3)	;
1415)   4CCA C9          		        		RET	;
1423)   4CCB CD B9 4E    		CON:			CALL    ZERO            ;INITIALISE TO ZERO	;INITIALISE TO ZERO
1424)   4CCE 0E 00       		        		LD      C,0             ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1425)   4CD0 CD 50 4D    		        		CALL    NUMBER          ;GET INTEGER PART	;GET INTEGER PART
1426)   4CD3 FE 2E       		        		CP      '.'	;
1427)   4CD5 06 00       		        		LD      B,0             ;DECL. PLACE COUNTER	;DECL. PLACE COUNTER
1428)   4CD7 CC 4E 4D    		        		CALL    Z,NUMBIX        ;GET FRACTION PART	;GET FRACTION PART
1429)   4CDA FE 45       		        		CP      'E'	;
1430)   4CDC 3E 00       		        		LD      A,0             ;INITIALISE EXPONENT	;INITIALISE EXPONENT
1431)   4CDE CC 1F 4D    		        		CALL    Z,GETEXP        ;GET EXPONENT	;GET EXPONENT
1432)   4CE1 CB 7C       		        		BIT     7,H	;
1433)   4CE3 20 08       		        		JR      NZ,CON0         ;INTEGER OVERFLOW	;INTEGER OVERFLOW
1434)   4CE5 B7          		        		OR      A	;
1435)   4CE6 20 05       		        		JR      NZ,CON0         ;EXPONENT NON-ZERO	;EXPONENT NON-ZERO
1436)   4CE8 B8          		        		CP      B	;
1437)   4CE9 20 02       		        		JR      NZ,CON0         ;DECIMAL POINT	;DECIMAL POINT
1438)   4CEB B9          		        		CP      C	;
1439)   4CEC C8          		        		RET     Z               ;INTEGER	;INTEGER
1440)   4CED 90          		CON0:			SUB     B	;
1441)   4CEE 81          		        		ADD     A,C	;
1442)   4CEF 0E 9F       		        		LD      C,159	;
1443)   4CF1 CD 30 4E    		        		CALL    FLOAT	;
1444)   4CF4 CB BC       		        		RES     7,H             ;DITCH IMPLIED 1	;DITCH IMPLIED 1
1445)   4CF6 B7          		        		OR      A	;
1446)   4CF7 C8          		        		RET     Z               ;DONE	;DONE
1447)   4CF8 FA 03 4D    		        		JP      M,CON2          ;NEGATIVE EXPONENT	;NEGATIVE EXPONENT
1448)   4CFB CD 8D 4F    		        		CALL    POWR10	;
1449)   4CFE CD C5 46    		        		CALL    FMUL            ;SCALE	;SCALE
1450)   4D01 AF          		        		XOR     A	;
1451)   4D02 C9          		        		RET	;
1452)   4D03 FE DA       		CON2:			CP      -38	;
1453)   4D05 38 0A       		        		JR      C,CON3          ;CAN'T SCALE IN ONE GO	;CAN'T SCALE IN ONE GO
1454)   4D07 ED 44       		        		NEG	;
1455)   4D09 CD 8D 4F    		        		CALL    POWR10	;
1456)   4D0C CD 32 46    		        		CALL    FDIV            ;SCALE	;SCALE
1457)   4D0F AF          		        		XOR     A	;
1458)   4D10 C9          		        		RET	;
1459)   4D11 F5          		CON3:			PUSH    AF	;
1460)   4D12 3E 26       		        		LD      A,38	;
1461)   4D14 CD 8D 4F    		        		CALL    POWR10	;
1462)   4D17 CD 32 46    		        		CALL    FDIV	;
1463)   4D1A F1          		        		POP     AF	;
1464)   4D1B C6 26       		        		ADD     A,38	;
1465)   4D1D 18 E4       		        		JR      CON2	;
1475)   4D1F C5          		GETEXP:			PUSH    BC              ;SAVE REGISTERS	;SAVE REGISTERS
1476)   4D20 47          		        		LD      B,A             ;INITIAL VALUE	;INITIAL VALUE
1477)   4D21 0E 02       		        		LD      C,2             ;2 DIGITS MAX	;2 DIGITS MAX
1478)   4D23 DD 23       		        		INC     IX              ;BUMP PAST 'E'	;BUMP PAST 'E'
1479)   4D25 CD 84 50    		        		CALL    SIGNQ	;
1480)   4D28 08          		        		EX      AF,AF'          ;SAVE EXPONENT SIGN	;SAVE EXPONENT SIGN
1481)   4D29 CD 7A 50    		GETEX1:			CALL    DIGITQ	;
1482)   4D2C 38 17       		        		JR      C,GETEX2	;
1483)   4D2E 78          		        		LD      A,B             ;B=B*10	;B=B*10
1484)   4D2F 87          		        		ADD     A,A	;
1485)   4D30 87          		        		ADD     A,A	;
1486)   4D31 80          		        		ADD     A,B	;
1487)   4D32 87          		        		ADD     A,A	;
1488)   4D33 47          		        		LD      B,A	;
1489)   4D34 DD 7E 00    		        		LD      A,(IX)          ;GET BACK DIGIT	;GET BACK DIGIT
1490)   4D37 DD 23       		        		INC     IX	;
1491)   4D39 E6 0F       		        		AND     0FH             ;MASK UNWANTED BITS	;MASK UNWANTED BITS
1492)   4D3B 80          		        		ADD     A,B             ;ADD IN DIGIT	;ADD IN DIGIT
1493)   4D3C 47          		        		LD      B,A	;
1494)   4D3D 0D          		        		DEC     C	;
1495)   4D3E F2 29 4D    		        		JP      P,GETEX1	;
1496)   4D41 06 64       		        		LD      B,100           ;FORCE OVERFLOW	;FORCE OVERFLOW
1497)   4D43 18 E4       		        		JR      GETEX1	;
1498)   4D45 08          		GETEX2:			EX      AF,AF'          ;RESTORE SIGN	;RESTORE SIGN
1499)   4D46 FE 2D       		        		CP      '-'	;
1500)   4D48 78          		        		LD      A,B	;
1501)   4D49 C1          		        		POP     BC              ;RESTORE	;RESTORE
1502)   4D4A C0          		        		RET     NZ	;
1503)   4D4B ED 44       		        		NEG                     ;NEGATE EXPONENT	;NEGATE EXPONENT
1504)   4D4D C9          		        		RET	;
1517)   4D4E DD 23       		NUMBIX:			INC     IX	;
1518)   4D50 CD 7A 50    		NUMBER:			CALL    DIGITQ	;
1519)   4D53 D8          		        		RET     C	;
1520)   4D54 04          		        		INC     B               ;INCREMENT DIGIT COUNT	;INCREMENT DIGIT COUNT
1521)   4D55 DD 23       		        		INC     IX	;
1522)   4D57 CD 04 4F    		        		CALL    X10             ;*10 & COPY OLD VALUE	;*10 & COPY OLD VALUE
1523)   4D5A 38 13       		        		JR      C,NUMB1         ;OVERFLOW	;OVERFLOW
1524)   4D5C 0D          		        		DEC     C               ;SEE IF TRUNCATED	;SEE IF TRUNCATED
1525)   4D5D 0C          		        		INC     C	;
1526)   4D5E 20 0F       		        		JR      NZ,NUMB1        ;IMPORTANT!	;IMPORTANT!
1527)   4D60 E6 0F       		        		AND     0FH	;
1528)   4D62 D9          		        		EXX	;
1529)   4D63 06 00       		        		LD      B,0	;
1530)   4D65 4F          		        		LD      C,A	;
1531)   4D66 09          		        		ADD     HL,BC           ;ADD IN DIGIT	;ADD IN DIGIT
1532)   4D67 D9          		        		EXX	;
1533)   4D68 30 E6       		        		JR      NC,NUMBER	;
1534)   4D6A 23          		        		INC     HL              ;CARRY	;CARRY
1535)   4D6B 7C          		        		LD      A,H	;
1536)   4D6C B5          		        		OR      L	;
1537)   4D6D 20 E1       		        		JR      NZ,NUMBER	;
1538)   4D6F 0C          		NUMB1:			INC     C               ;TRUNCATION COUNTER	;TRUNCATION COUNTER
1539)   4D70 CD 77 4E    		        		CALL    SWAP1           ;RESTORE PREVIOUS VALUE	;RESTORE PREVIOUS VALUE
1540)   4D73 18 DB       		        		JR      NUMBER	;
1550)   4D75 08          		FIX:			EX      AF,AF'	;
1551)   4D76 AF          		        		XOR     A	;
1552)   4D77 08          		        		EX      AF,AF'	;
1553)   4D78 CB FC       		        		SET     7,H             ;IMPLIED 1	;IMPLIED 1
1554)   4D7A CD 7C 4E    		FIX1:			CALL    DIV2	;
1555)   4D7D B9          		        		CP      C	;
1556)   4D7E C8          		        		RET     Z	;
1557)   4D7F D2 7A 4D    		        		JP      NC,FIX1	;
1558)   4D82 C3 8A 4E    		        		JP      OFLOW	;
1568)   4D85 CD 74 4E    		FIX2:			CALL    SWAP	;
1569)   4D88 CD 8E 4D    		        		CALL    SFIX	;
1570)   4D8B CD 74 4E    		        		CALL    SWAP	;
1571)   4D8E 0D          		SFIX:			DEC     C	;
1572)   4D8F 0C          		        		INC     C	;
1573)   4D90 C8          		        		RET     Z               ;INTEGER/ZERO	;INTEGER/ZERO
1574)   4D91 CB 7C       		        		BIT     7,H             ;SIGN	;SIGN
1575)   4D93 F5          		        		PUSH    AF	;
1576)   4D94 3E 9F       		        		LD      A,159	;
1577)   4D96 CD 75 4D    		        		CALL    FIX	;
1578)   4D99 F1          		        		POP     AF	;
1579)   4D9A 0E 00       		        		LD      C,0	;
1580)   4D9C C8          		        		RET     Z	;
1581)   4D9D B7          		NEGATE:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
1582)   4D9E D9          		        		EXX	;
1583)   4D9F D5          		NEG0:			PUSH    DE	;
1584)   4DA0 EB          		        		EX      DE,HL	;
1585)   4DA1 21 00 00    		        		LD      HL,0	;
1586)   4DA4 ED 52       		        		SBC     HL,DE	;
1587)   4DA6 D1          		        		POP     DE	;
1588)   4DA7 D9          		        		EXX	;
1589)   4DA8 D5          		        		PUSH    DE	;
1590)   4DA9 EB          		        		EX      DE,HL	;
1591)   4DAA 21 00 00    		        		LD      HL,0	;
1592)   4DAD ED 52       		        		SBC     HL,DE	;
1593)   4DAF D1          		        		POP     DE	;
1594)   4DB0 C9          		        		RET	;
1600)   4DB1 D9          		NEG:			EXX	;
1601)   4DB2 2F          		        		CPL	;
1602)   4DB3 E5          		        		PUSH    HL	;
1603)   4DB4 B7          		        		OR      A               ;CLEAR CARRY	;CLEAR CARRY
1604)   4DB5 21 00 00    		        		LD      HL,0	;
1605)   4DB8 ED 42       		        		SBC     HL,BC	;
1606)   4DBA 44          		        		LD      B,H	;
1607)   4DBB 4D          		        		LD      C,L	;
1608)   4DBC E1          		        		POP     HL	;
1609)   4DBD 18 E0       		        		JR      NEG0	;
1622)   4DBF 3E 96       		SCALE:			LD      A,150	;
1623)   4DC1 B9          		        		CP      C	;
1624)   4DC2 3E 17       		        		LD      A,ACLOST	;
1625)   4DC4 DA AD 44    		        		JP      C,ERROR         ;"Accuracy lost"	;"Accuracy lost"
1626)   4DC7 CD 93 49    		        		CALL    PIBY4	;
1627)   4DCA D9          		        		EXX	;
1628)   4DCB 01 69 21    		        		LD      BC,2169H        ;3.141592653589793238	;3.141592653589793238
1629)   4DCE D9          		        		EXX	;
1630)   4DCF CB FA       		MOD48:			SET     7,D             ;IMPLIED 1	;IMPLIED 1
1631)   4DD1 CB FC       		        		SET     7,H	;
1632)   4DD3 79          		        		LD      A,C	;
1633)   4DD4 0E 00       		        		LD      C,0             ;INIT QUOTIENT	;INIT QUOTIENT
1634)   4DD6 DD 21 00 00 		        		LD      IX,0	;
1635)   4DDA DD E5       		        		PUSH    IX              ;PUT ZERO ON STACK	;PUT ZERO ON STACK
1636)   4DDC B8          		        		CP      B	;
1637)   4DDD 38 3A       		        		JR      C,MOD485        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1638)   4DDF D9          		MOD481:			EXX                     ;CARRY=0 HERE	;CARRY=0 HERE
1639)   4DE0 E3          		        		EX      (SP),HL	;
1640)   4DE1 ED 42       		        		SBC     HL,BC	;
1641)   4DE3 E3          		        		EX      (SP),HL	;
1642)   4DE4 ED 52       		        		SBC     HL,DE	;
1643)   4DE6 D9          		        		EXX	;
1644)   4DE7 ED 52       		        		SBC     HL,DE	;
1645)   4DE9 30 09       		        		JR      NC,MOD482       ;DIVIDEND>=DIVISOR	;DIVIDEND>=DIVISOR
1646)   4DEB D9          		        		EXX	;
1647)   4DEC E3          		        		EX      (SP),HL	;
1648)   4DED 09          		        		ADD     HL,BC	;
1649)   4DEE E3          		        		EX      (SP),HL	;
1650)   4DEF ED 5A       		        		ADC     HL,DE	;
1651)   4DF1 D9          		        		EXX	;
1652)   4DF2 ED 5A       		        		ADC     HL,DE	;
1653)   4DF4 3F          		MOD482:			CCF	;
1654)   4DF5 CB 11       		        		RL      C               ;QUOTIENT	;QUOTIENT
1655)   4DF7 30 02       		        		JR      NC,MOD483	;
1656)   4DF9 CB F9       		        		SET     7,C             ;STICKY BIT	;STICKY BIT
1657)   4DFB 3D          		MOD483:			DEC     A	;
1658)   4DFC B8          		        		CP      B	;
1659)   4DFD 38 19       		        		JR      C,MOD484        ;DIVIDEND<DIVISOR	;DIVIDEND<DIVISOR
1660)   4DFF E3          		        		EX      (SP),HL	;
1661)   4E00 29          		        		ADD     HL,HL           ;DIVIDEND * 2	;DIVIDEND * 2
1662)   4E01 E3          		        		EX      (SP),HL	;
1663)   4E02 D9          		        		EXX	;
1664)   4E03 ED 6A       		        		ADC     HL,HL	;
1665)   4E05 D9          		        		EXX	;
1666)   4E06 ED 6A       		        		ADC     HL,HL	;
1667)   4E08 30 D5       		        		JR      NC,MOD481       ;AGAIN	;AGAIN
1668)   4E0A B7          		        		OR      A	;
1669)   4E0B D9          		        		EXX	;
1670)   4E0C E3          		        		EX      (SP),HL	;
1671)   4E0D ED 42       		        		SBC     HL,BC           ;OVERFLOW, SO SUBTRACT	;OVERFLOW, SO SUBTRACT
1672)   4E0F E3          		        		EX      (SP),HL	;
1673)   4E10 ED 52       		        		SBC     HL,DE	;
1674)   4E12 D9          		        		EXX	;
1675)   4E13 ED 52       		        		SBC     HL,DE	;
1676)   4E15 B7          		        		OR      A	;
1677)   4E16 18 DC       		        		JR      MOD482	;
1679)   4E18 3C          		MOD484:			INC     A	;
1680)   4E19 59          		MOD485:			LD      E,C             ;QUOTIENT	;QUOTIENT
1681)   4E1A 4F          		        		LD      C,A             ;REMAINDER EXPONENT	;REMAINDER EXPONENT
1682)   4E1B D9          		        		EXX	;
1683)   4E1C C1          		        		POP     BC	;
1684)   4E1D D9          		        		EXX	;
1685)   4E1E CB 7C       		FLO48:			BIT     7,H	;
1686)   4E20 C0          		        		RET     NZ	;
1687)   4E21 D9          		        		EXX	;
1688)   4E22 CB 21       		        		SLA     C	;
1689)   4E24 CB 10       		        		RL      B	;
1690)   4E26 ED 6A       		        		ADC     HL,HL	;
1691)   4E28 D9          		        		EXX	;
1692)   4E29 ED 6A       		        		ADC     HL,HL	;
1693)   4E2B 0D          		        		DEC     C	;
1694)   4E2C C2 1E 4E    		        		JP      NZ,FLO48	;
1695)   4E2F C9          		        		RET	;
1701)   4E30 CB 7C       		FLOAT:			BIT     7,H	;
1702)   4E32 C0          		        		RET     NZ	;
1703)   4E33 D9          		        		EXX                     ;SAME AS "X2"	;SAME AS "X2"
1704)   4E34 29          		        		ADD     HL,HL           ;TIME-CRITICAL	;TIME-CRITICAL
1705)   4E35 D9          		        		EXX                     ;REGION	;REGION
1706)   4E36 ED 6A       		        		ADC     HL,HL           ;(BENCHMARKS)	;(BENCHMARKS)
1707)   4E38 0D          		        		DEC     C	;
1708)   4E39 C2 30 4E    		        		JP      NZ,FLOAT	;
1709)   4E3C C9          		        		RET	;
1716)   4E3D 08          		FLOATA:			EX      AF,AF'	;
1717)   4E3E C6 2A       		        		ADD     A,(RTABLE-DTABLE)/2	;
1718)   4E40 08          		        		EX      AF,AF'	;
1719)   4E41 CD 74 4E    		FLOAT2:			CALL    SWAP	;
1720)   4E44 CD 4A 4E    		        		CALL    SFLOAT	;
1721)   4E47 CD 74 4E    		        		CALL    SWAP	;
1722)   4E4A 0D          		SFLOAT:			DEC     C	;
1723)   4E4B 0C          		        		INC     C	;
1724)   4E4C C0          		        		RET     NZ              ;ALREADY FLOATING-POINT	;ALREADY FLOATING-POINT
1725)   4E4D CD 99 4E    		        		CALL    TEST	;
1726)   4E50 C8          		        		RET     Z               ;ZERO	;ZERO
1727)   4E51 7C          		        		LD      A,H	;
1728)   4E52 B7          		        		OR      A	;
1729)   4E53 FC 9D 4D    		        		CALL    M,NEGATE	;
1730)   4E56 0E 9F       		        		LD      C,159	;
1731)   4E58 CD 30 4E    		        		CALL    FLOAT	;
1732)   4E5B B7          		        		OR      A	;
1733)   4E5C F8          		        		RET     M               ;NEGATIVE	;NEGATIVE
1734)   4E5D CB BC       		        		RES     7,H	;
1735)   4E5F C9          		        		RET	;
1741)   4E60 D9          		ADD1:			EXX	;
1742)   4E61 01 01 00    		        		LD      BC,1	;
1743)   4E64 09          		        		ADD     HL,BC	;
1744)   4E65 D9          		        		EXX	;
1745)   4E66 D0          		        		RET     NC	;
1746)   4E67 C5          		        		PUSH    BC	;
1747)   4E68 01 01 00    		        		LD      BC,1	;
1748)   4E6B 09          		        		ADD     HL,BC	;
1749)   4E6C C1          		        		POP     BC	;
1750)   4E6D C9          		        		RET	;
1757)   4E6E B7          		ODD:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
1758)   4E6F D9          		        		EXX	;
1759)   4E70 CB C5       		        		SET     0,L             ;MAKE ODD	;MAKE ODD
1760)   4E72 D9          		        		EXX	;
1761)   4E73 C9          		        		RET	;
1769)   4E74 79          		SWAP:			LD      A,C	;
1770)   4E75 48          		        		LD      C,B	;
1771)   4E76 47          		        		LD      B,A	;
1772)   4E77 EB          		SWAP1:			EX      DE,HL	;
1773)   4E78 D9          		        		EXX	;
1774)   4E79 EB          		        		EX      DE,HL	;
1775)   4E7A D9          		        		EXX	;
1776)   4E7B C9          		        		RET	;
1782)   4E7C CD 1A 4F    		DIV2:			CALL    D2	;
1783)   4E7F D9          		        		EXX	;
1784)   4E80 CB 18       		        		RR      B	;
1785)   4E82 CB 19       		        		RR      C	;
1786)   4E84 08          		        		EX      AF,AF'	;
1787)   4E85 B0          		        		OR      B	;
1788)   4E86 08          		        		EX      AF,AF'	;
1789)   4E87 D9          		        		EXX	;
1790)   4E88 0C          		INCC:			INC     C	;
1791)   4E89 C0          		        		RET     NZ	;
1792)   4E8A 3E 14       		OFLOW:			LD      A,TOOBIG	;
1793)   4E8C C3 AD 44    		        		JP      ERROR           ;"Too big"	;"Too big"
1798)   4E8F CD 99 4E    		FTEST:			CALL    TEST	;
1799)   4E92 C8          		        		RET     Z	;
1800)   4E93 7C          		        		LD      A,H	;
1801)   4E94 E6 80       		        		AND     10000000B	;
1802)   4E96 F6 40       		        		OR      01000000B	;
1803)   4E98 C9          		        		RET	;
1809)   4E99 7C          		TEST:			LD      A,H	;
1810)   4E9A B5          		        		OR      L	;
1811)   4E9B D9          		        		EXX	;
1812)   4E9C B4          		        		OR      H	;
1813)   4E9D B5          		        		OR      L	;
1814)   4E9E D9          		        		EXX	;
1815)   4E9F C9          		        		RET	;
1820)   4EA0 78          		FCOMP:			LD      A,B	;
1821)   4EA1 B1          		        		OR      C               ;Both integer?	;Both integer?
1822)   4EA2 20 0A       		        		JR      NZ,FCOMP1	;
1823)   4EA4 CD B6 4E    		        		CALL    ICP	;
1824)   4EA7 3E 00       		FCOMP0:			LD      A,0	;
1825)   4EA9 C8          		        		RET     Z               ;Equal	;Equal
1826)   4EAA 3E 80       		        		LD      A,80H	;
1827)   4EAC 1F          		        		RRA	;
1828)   4EAD C9          		        		RET	;
1830)   4EAE CD 41 4E    		FCOMP1:			CALL    FLOAT2          ;Float both	;Float both
1831)   4EB1 CD C3 4E    		        		CALL    FCP	;
1832)   4EB4 18 F1       		        		JR      FCOMP0	;
1842)   4EB6 CD E2 4E    		ICP:			CALL    ICP1	;
1843)   4EB9 3E 00       		ZERO:			LD      A,0	;
1844)   4EBB D9          		        		EXX	;
1845)   4EBC 67          		        		LD      H,A	;
1846)   4EBD 6F          		        		LD      L,A	;
1847)   4EBE D9          		        		EXX	;
1848)   4EBF 67          		        		LD      H,A	;
1849)   4EC0 6F          		        		LD      L,A	;
1850)   4EC1 4F          		        		LD      C,A	;
1851)   4EC2 C9          		        		RET	;
1853)   4EC3 CD D5 4E    		FCP:			CALL    FCP1	;
1854)   4EC6 18 F1       		        		JR      ZERO            ;PRESET FALSE	;PRESET FALSE
1856)   4EC8 79          		FCP0:			LD      A,C	;
1857)   4EC9 B8          		        		CP      B               ;COMPARE EXPONENTS	;COMPARE EXPONENTS
1858)   4ECA C0          		        		RET     NZ	;
1859)   4ECB ED 52       		ICP0:			SBC     HL,DE           ;COMP MANTISSA MSB	;COMP MANTISSA MSB
1860)   4ECD 19          		        		ADD     HL,DE	;
1861)   4ECE C0          		        		RET     NZ	;
1862)   4ECF D9          		        		EXX	;
1863)   4ED0 ED 52       		        		SBC     HL,DE           ;COMP MANTISSA LSB	;COMP MANTISSA LSB
1864)   4ED2 19          		        		ADD     HL,DE	;
1865)   4ED3 D9          		        		EXX	;
1866)   4ED4 C9          		        		RET	;
1868)   4ED5 7C          		FCP1:			LD      A,H	;
1869)   4ED6 AA          		        		XOR     D	;
1870)   4ED7 7C          		        		LD      A,H	;
1871)   4ED8 17          		        		RLA	;
1872)   4ED9 F8          		        		RET     M	;
1873)   4EDA 30 EC       		        		JR      NC,FCP0	;
1874)   4EDC CD C8 4E    		        		CALL    FCP0	;
1875)   4EDF C8          		        		RET     Z               ;** V0.1 BUG FIX	;** V0.1 BUG FIX
1876)   4EE0 3F          		        		CCF	;
1877)   4EE1 C9          		        		RET	;
1879)   4EE2 7C          		ICP1:			LD      A,H	;
1880)   4EE3 AA          		        		XOR     D	;
1881)   4EE4 F2 CB 4E    		        		JP      P,ICP0	;
1882)   4EE7 7C          		        		LD      A,H	;
1883)   4EE8 17          		        		RLA	;
1884)   4EE9 C9          		        		RET	;
1890)   4EEA 05          		X10B:			DEC     B	;
1891)   4EEB 0C          		        		INC     C	;
1892)   4EEC CD 26 4F    		X5:			CALL    COPY0	;
1893)   4EEF CD 19 4F    		        		CALL    D2C	;
1894)   4EF2 CD 19 4F    		        		CALL    D2C	;
1895)   4EF5 08          		        		EX      AF,AF'          ;SAVE CARRY	;SAVE CARRY
1896)   4EF6 D9          		ADD:			EXX	;
1897)   4EF7 19          		        		ADD     HL,DE	;
1898)   4EF8 D9          		        		EXX	;
1899)   4EF9 ED 5A       		        		ADC     HL,DE	;
1900)   4EFB C9          		        		RET	;
1906)   4EFC D9          		SUB:			EXX	;
1907)   4EFD B7          		        		OR      A	;
1908)   4EFE ED 52       		        		SBC     HL,DE	;
1909)   4F00 D9          		        		EXX	;
1910)   4F01 ED 52       		        		SBC     HL,DE	;
1911)   4F03 C9          		        		RET	;
1924)   4F04 CD 26 4F    		X10:			CALL    COPY0           ;DED'E'=HLH'L'	;DED'E'=HLH'L'
1925)   4F07 CD 13 4F    		        		CALL    X2	;
1926)   4F0A D8          		        		RET     C               ;TOO BIG	;TOO BIG
1927)   4F0B CD 13 4F    		        		CALL    X2	;
1928)   4F0E D8          		        		RET     C	;
1929)   4F0F CD F6 4E    		        		CALL    ADD	;
1930)   4F12 D8          		        		RET     C	;
1931)   4F13 D9          		X2:			EXX	;
1932)   4F14 29          		        		ADD     HL,HL	;
1933)   4F15 D9          		        		EXX	;
1934)   4F16 ED 6A       		        		ADC     HL,HL	;
1935)   4F18 C9          		        		RET	;
1941)   4F19 0C          		D2C:			INC     C	;
1942)   4F1A CB 3C       		D2:			SRL     H	;
1943)   4F1C CB 1D       		        		RR      L	;
1944)   4F1E D9          		        		EXX	;
1945)   4F1F CB 1C       		        		RR      H	;
1946)   4F21 CB 1D       		        		RR      L	;
1947)   4F23 D9          		        		EXX	;
1948)   4F24 C9          		        		RET	;
1953)   4F25 41          		COPY:			LD      B,C	;
1954)   4F26 54          		COPY0:			LD      D,H	;
1955)   4F27 5D          		        		LD      E,L	;
1956)   4F28 D9          		        		EXX	;
1957)   4F29 54          		        		LD      D,H	;
1958)   4F2A 5D          		        		LD      E,L	;
1959)   4F2B D9          		        		EXX	;
1960)   4F2C C9          		        		RET	;
1966)   4F2D CD 25 4F    		SQUARE:			CALL    COPY	;
1967)   4F30 CD C5 46    		        		CALL    FMUL	;
1968)   4F33 DD E1       		PUSH5:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1969)   4F35 C5          		        		PUSH    BC	;
1970)   4F36 E5          		        		PUSH    HL	;
1971)   4F37 D9          		        		EXX	;
1972)   4F38 E5          		        		PUSH    HL	;
1973)   4F39 D9          		        		EXX	;
1974)   4F3A DD E9       		        		JP      (IX)            ;"RETURN"	;"RETURN"
1979)   4F3C DD E1       		POP5:			POP     IX              ;RETURN ADDRESS	;RETURN ADDRESS
1980)   4F3E D9          		        		EXX	;
1981)   4F3F D1          		        		POP     DE	;
1982)   4F40 D9          		        		EXX	;
1983)   4F41 D1          		        		POP     DE	;
1984)   4F42 79          		        		LD      A,C	;
1985)   4F43 C1          		        		POP     BC	;
1986)   4F44 41          		        		LD      B,C	;
1987)   4F45 4F          		        		LD      C,A	;
1988)   4F46 DD E9       		        		JP      (IX)            ;"RETURN"	;"RETURN"
1995)   4F48 CD 33 4F    		RATIO:			CALL    PUSH5           ;SAVE X	;SAVE X
1996)   4F4B CD 88 49    		        		CALL    DONE	;
1997)   4F4E CD DA 45    		        		CALL    FADD	;
1998)   4F51 CD 3C 4F    		        		CALL    POP5            ;RESTORE X	;RESTORE X
1999)   4F54 CD 33 4F    		        		CALL    PUSH5           ;SAVE X+1	;SAVE X+1
2000)   4F57 CD 74 4E    		        		CALL    SWAP	;
2001)   4F5A CD 88 49    		        		CALL    DONE	;
2002)   4F5D CD C4 45    		        		CALL    FSUB	;
2003)   4F60 CD 3C 4F    		        		CALL    POP5            ;RESTORE X+1	;RESTORE X+1
2004)   4F63 C3 32 46    		        		JP      FDIV	;
2015)   4F66 DD 21 02 00 		POLY:			LD      IX,2	;
2016)   4F6A DD 39       		        		ADD     IX,SP	;
2017)   4F6C DD E3       		        		EX      (SP),IX	;
2018)   4F6E CD B9 4C    		        		CALL    DLOAD5          ;FIRST COEFFICIENT	;FIRST COEFFICIENT
2019)   4F71 CD C5 46    		POLY1:			CALL    FMUL	;
2020)   4F74 11 05 00    		        		LD      DE,5	;
2021)   4F77 DD 19       		        		ADD     IX,DE	;
2022)   4F79 CD B9 4C    		        		CALL    DLOAD5          ;NEXT COEFFICIENT	;NEXT COEFFICIENT
2023)   4F7C DD E3       		        		EX      (SP),IX	;
2024)   4F7E 04          		        		INC     B	;
2025)   4F7F 05          		        		DEC     B               ;TEST	;TEST
2026)   4F80 FA DA 45    		        		JP      M,FADD	;
2027)   4F83 CD DA 45    		        		CALL    FADD	;
2028)   4F86 CD B9 4C    		        		CALL    DLOAD5          ;X	;X
2029)   4F89 DD E3       		        		EX      (SP),IX	;
2030)   4F8B 18 E4       		        		JR      POLY1	;
2039)   4F8D 3C          		POWR10:			INC     A	;
2040)   4F8E 08          		        		EX      AF,AF'	;
2041)   4F8F E5          		        		PUSH    HL	;
2042)   4F90 D9          		        		EXX	;
2043)   4F91 E5          		        		PUSH    HL	;
2044)   4F92 D9          		        		EXX	;
2045)   4F93 CD 88 49    		        		CALL    DONE	;
2046)   4F96 CD 74 4E    		        		CALL    SWAP	;
2047)   4F99 AF          		        		XOR     A	;
2048)   4F9A 08          		POWR11:			EX      AF,AF'	;
2049)   4F9B 3D          		        		DEC     A	;
2050)   4F9C 28 20       		        		JR      Z,POWR14        ;EXIT TYPE 1	;EXIT TYPE 1
2051)   4F9E F2 A5 4F    		        		JP      P,POWR13	;
2052)   4FA1 B9          		        		CP      C	;
2053)   4FA2 38 1A       		        		JR      C,POWR14        ;EXIT TYPE 2	;EXIT TYPE 2
2054)   4FA4 3C          		        		INC     A	;
2055)   4FA5 08          		POWR13:			EX      AF,AF'	;
2056)   4FA6 3C          		        		INC     A	;
2057)   4FA7 CB FC       		        		SET     7,H	;
2058)   4FA9 CD EC 4E    		        		CALL    X5	;
2059)   4FAC 30 05       		        		JR      NC,POWR12	;
2060)   4FAE 08          		        		EX      AF,AF'	;
2061)   4FAF CD 19 4F    		        		CALL    D2C	;
2062)   4FB2 08          		        		EX      AF,AF'	;
2063)   4FB3 08          		POWR12:			EX      AF,AF'	;
2064)   4FB4 DC 60 4E    		        		CALL    C,ADD1          ;ROUND UP	;ROUND UP
2065)   4FB7 0C          		        		INC     C	;
2066)   4FB8 FA 9A 4F    		        		JP      M,POWR11	;
2067)   4FBB C3 8A 4E    		        		JP      OFLOW	;
2068)   4FBE CD 74 4E    		POWR14:			CALL    SWAP	;
2069)   4FC1 CB BA       		        		RES     7,D	;
2070)   4FC3 D9          		        		EXX	;
2071)   4FC4 E1          		        		POP     HL	;
2072)   4FC5 D9          		        		EXX	;
2073)   4FC6 E1          		        		POP     HL	;
2074)   4FC7 08          		        		EX      AF,AF'	;
2075)   4FC8 C9          		        		RET	;
2083)   4FC9 B7          		DIVA:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
2084)   4FCA ED 42       		DIV0:			SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2085)   4FCC D9          		        		EXX	;
2086)   4FCD ED 42       		        		SBC     HL,BC	;
2087)   4FCF D9          		        		EXX	;
2088)   4FD0 30 05       		        		JR      NC,DIV1	;
2089)   4FD2 09          		        		ADD     HL,BC           ;DIVIDEND+DIVISOR	;DIVIDEND+DIVISOR
2090)   4FD3 D9          		        		EXX	;
2091)   4FD4 ED 4A       		        		ADC     HL,BC	;
2092)   4FD6 D9          		        		EXX	;
2093)   4FD7 3F          		DIV1:			CCF	;
2094)   4FD8 CB 13       		DIVC:			RL      E               ;SHIFT RESULT INTO DE	;SHIFT RESULT INTO DE
2095)   4FDA CB 12       		        		RL      D	;
2096)   4FDC D9          		        		EXX	;
2097)   4FDD CB 13       		        		RL      E	;
2098)   4FDF CB 12       		        		RL      D	;
2099)   4FE1 D9          		        		EXX	;
2100)   4FE2 3C          		        		INC     A	;
2101)   4FE3 F0          		        		RET     P	;
2102)   4FE4 ED 6A       		DIVB:			ADC     HL,HL           ;DIVIDEND*2	;DIVIDEND*2
2103)   4FE6 D9          		        		EXX	;
2104)   4FE7 ED 6A       		        		ADC     HL,HL	;
2105)   4FE9 D9          		        		EXX	;
2106)   4FEA 30 DE       		        		JR      NC,DIV0	;
2107)   4FEC B7          		        		OR      A	;
2108)   4FED ED 42       		        		SBC     HL,BC           ;DIVIDEND-DIVISOR	;DIVIDEND-DIVISOR
2109)   4FEF D9          		        		EXX	;
2110)   4FF0 ED 42       		        		SBC     HL,BC	;
2111)   4FF2 D9          		        		EXX	;
2112)   4FF3 37          		        		SCF	;
2113)   4FF4 C3 D8 4F    		        		JP      DIVC	;
2121)   4FF7 B7          		MULA:			OR      A               ;CLEAR CARRY	;CLEAR CARRY
2122)   4FF8 D9          		MUL0:			EXX	;
2123)   4FF9 CB 1A       		        		RR      D               ;MULTIPLIER/2	;MULTIPLIER/2
2124)   4FFB CB 1B       		        		RR      E	;
2125)   4FFD D9          		        		EXX	;
2126)   4FFE CB 1A       		        		RR      D	;
2127)   5000 CB 1B       		        		RR      E	;
2128)   5002 30 05       		        		JR      NC,MUL1	;
2129)   5004 09          		        		ADD     HL,BC           ;ADD IN MULTIPLICAND	;ADD IN MULTIPLICAND
2130)   5005 D9          		        		EXX	;
2131)   5006 ED 4A       		        		ADC     HL,BC	;
2132)   5008 D9          		        		EXX	;
2133)   5009 3C          		MUL1:			INC     A	;
2134)   500A F0          		        		RET     P	;
2135)   500B D9          		MULB:			EXX	;
2136)   500C CB 1C       		        		RR      H               ;PRODUCT/2	;PRODUCT/2
2137)   500E CB 1D       		        		RR      L	;
2138)   5010 D9          		        		EXX	;
2139)   5011 CB 1C       		        		RR      H	;
2140)   5013 CB 1D       		        		RR      L	;
2141)   5015 C3 F8 4F    		        		JP      MUL0	;
2149)   5018 ED 42       		SQR1:		SBC     HL,BC	;
2150)   501A D9          		        		EXX	;
2151)   501B ED 42       		        		SBC     HL,BC	;
2152)   501D D9          		        		EXX	;
2153)   501E 0C          		        		INC     C	;
2154)   501F 30 07       		        		JR      NC,SQR2	;
2155)   5021 0D          		        		DEC     C	;
2156)   5022 09          		        		ADD     HL,BC	;
2157)   5023 D9          		        		EXX	;
2158)   5024 ED 4A       		        		ADC     HL,BC	;
2159)   5026 D9          		        		EXX	;
2160)   5027 0D          		        		DEC     C	;
2161)   5028 3C          		SQR2:			INC     A	;
2162)   5029 F0          		        		RET     P	;
2163)   502A CB 21       		SQRA:			SLA     C	;
2164)   502C CB 10       		        		RL      B	;
2165)   502E D9          		        		EXX	;
2166)   502F CB 11       		        		RL      C	;
2167)   5031 CB 10       		        		RL      B	;
2168)   5033 D9          		        		EXX	;
2169)   5034 0C          		        		INC     C	;
2170)   5035 CB 23       		        		SLA     E	;
2171)   5037 CB 12       		        		RL      D	;
2172)   5039 D9          		        		EXX	;
2173)   503A CB 13       		        		RL      E	;
2174)   503C CB 12       		        		RL      D	;
2175)   503E D9          		        		EXX	;
2176)   503F ED 6A       		        		ADC     HL,HL	;
2177)   5041 D9          		        		EXX	;
2178)   5042 ED 6A       		        		ADC     HL,HL	;
2179)   5044 D9          		        		EXX	;
2180)   5045 CB 23       		        		SLA     E	;
2181)   5047 CB 12       		        		RL      D	;
2182)   5049 D9          		        		EXX	;
2183)   504A CB 13       		        		RL      E	;
2184)   504C CB 12       		        		RL      D	;
2185)   504E D9          		        		EXX	;
2186)   504F ED 6A       		        		ADC     HL,HL	;
2187)   5051 D9          		        		EXX	;
2188)   5052 ED 6A       		        		ADC     HL,HL	;
2189)   5054 D9          		        		EXX	;
2190)   5055 D2 18 50    		        		JP      NC,SQR1	;
2191)   5058 B7          		SQR3:			OR      A	;
2192)   5059 ED 42       		        		SBC     HL,BC	;
2193)   505B D9          		        		EXX	;
2194)   505C ED 42       		        		SBC     HL,BC	;
2195)   505E D9          		        		EXX	;
2196)   505F 0C          		        		INC     C	;
2197)   5060 C3 28 50    		        		JP      SQR2	;
2199)   5063 29          		SQRB:			ADD     HL,HL	;
2200)   5064 D9          		        		EXX	;
2201)   5065 ED 6A       		        		ADC     HL,HL	;
2202)   5067 D9          		        		EXX	;
2203)   5068 38 EE       		        		JR      C,SQR3	;
2204)   506A 3C          		        		INC     A	;
2205)   506B 0C          		        		INC     C	;
2206)   506C ED 42       		        		SBC     HL,BC	;
2207)   506E D9          		        		EXX	;
2208)   506F ED 42       		        		SBC     HL,BC	;
2209)   5071 D9          		        		EXX	;
2210)   5072 D0          		        		RET     NC	;
2211)   5073 09          		        		ADD     HL,BC	;
2212)   5074 D9          		        		EXX	;
2213)   5075 ED 4A       		        		ADC     HL,BC	;
2214)   5077 D9          		        		EXX	;
2215)   5078 0D          		        		DEC     C	;
2216)   5079 C9          		        		RET	;
2218)   507A DD 7E 00    		DIGITQ:			LD      A,(IX)	;
2219)   507D FE 3A       		        		CP      '9'+1	;
2220)   507F 3F          		        		CCF	;
2221)   5080 D8          		        		RET     C	;
2222)   5081 FE 30       		        		CP      '0'	;
2223)   5083 C9          		        		RET	;
2225)   5084 DD 7E 00    		SIGNQ:			LD      A,(IX)	;
2226)   5087 DD 23       		        		INC     IX	;
2227)   5089 FE 20       		        		CP      ' '	;
2228)   508B 28 F7       		        		JR      Z,SIGNQ	;
2229)   508D FE 2B       		        		CP      '+'	;
2230)   508F C8          		        		RET     Z	;
2231)   5090 FE 2D       		        		CP      '-'	;
2232)   5092 C8          		        		RET     Z	;
2233)   5093 DD 2B       		        		DEC     IX	;
2234)   5095 C9          		        		RET	;
 16)   8000 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8004 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8008 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   800C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8010 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8014 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8018 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   801C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8020 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8024 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8028 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   802C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8030 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8034 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8038 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   803C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8040 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8044 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8048 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   804C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8050 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8054 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8058 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   805C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8060 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8064 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8068 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   806C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8070 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8074 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8078 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   807C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8080 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8084 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8088 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   808C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8090 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8094 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   8098 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   809C 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80A0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80A4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80A8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80AC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80B0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80B4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80B8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80BC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80C0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80C4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80C8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80CC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80D0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80D4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80D8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80DC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80E0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80E4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80E8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80EC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80F0 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80F4 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80F8 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 16)   80FC 00 00 00 00 		@ACCS:			DEFS    256             ;STRING ACCUMULATOR	;STRING ACCUMULATOR
 17)   8100 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8104 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8108 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   810C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8110 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8114 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8118 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   811C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8120 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8124 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8128 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   812C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8130 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8134 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8138 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   813C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8140 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8144 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8148 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   814C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8150 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8154 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8158 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   815C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8160 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8164 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8168 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   816C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8170 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8174 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8178 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   817C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8180 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8184 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8188 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   818C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8190 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8194 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   8198 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   819C 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81A0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81A4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81A8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81AC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81B0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81B4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81B8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81BC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81C0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81C4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81C8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81CC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81D0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81D4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81D8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81DC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81E0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81E4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81E8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81EC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81F0 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81F4 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81F8 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 17)   81FC 00 00 00 00 		@BUFFER:		DEFS    256             ;STRING INPUT BUFFER	;STRING INPUT BUFFER
 18)   8200 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8204 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8208 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   820C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8210 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8214 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8218 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   821C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8220 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8224 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8228 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   822C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8230 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8234 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8238 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   823C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8240 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8244 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8248 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   824C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8250 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8254 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8258 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   825C 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8260 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8264 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 18)   8268 00 00 00 00 		@STAVAR:		DEFS    27*4            ;STATIC VARIABLES	;STATIC VARIABLES
 21)   826C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8270 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8274 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8278 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   827C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8280 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8284 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8288 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   828C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8290 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8294 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   8298 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   829C 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82A0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82A4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82A8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82AC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82B0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82B4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82B8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82BC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82C0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82C4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82C8 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82CC 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82D0 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 21)   82D4 00 00 00 00 		@DYNVAR: 		DEFS    54*2            ;DYN. VARIABLE POINTERS	;DYN. VARIABLE POINTERS
 22)   82D8 00 00       		@FNPTR:  		DEFS    2               ;DYN. FUNCTION POINTER	;DYN. FUNCTION POINTER
 23)   82DA 00 00       		@PROPTR: 		DEFS    2               ;DYN. PROCEDURE POINTER	;DYN. PROCEDURE POINTER
 25)   82DC 00 00       		@PAGE:   		DEFS    2               ;START OF USER PROGRAM	;START OF USER PROGRAM
 26)   82DE 00 00       		@TOP:    		DEFS    2               ;FIRST LOCN AFTER PROG.	;FIRST LOCN AFTER PROG.
 27)   82E0 00 00       		@LOMEM:  		DEFS    2               ;START OF DYN. STORAGE	;START OF DYN. STORAGE
 28)   82E2 00 00       		@FREE:   		DEFS    2               ;FIRST FREE-SPACE BYTE	;FIRST FREE-SPACE BYTE
 29)   82E4 00 00       		@HIMEM:  		DEFS    2               ;FIRST PROTECTED BYTE	;FIRST PROTECTED BYTE
 31)   82E6 00 00       		@LINENO: 		DEFS    2               ;LINE NUMBER	;LINE NUMBER
 32)   82E8 00 00       		@TRACEN:		DEFS    2               ;TRACE FLAG	;TRACE FLAG
 33)   82EA 00 00       		@AUTONO:		DEFS    2               ;AUTO FLAG	;AUTO FLAG
 34)   82EC 00 00       		@ERRTRP:		DEFS    2               ;ERROR TRAP	;ERROR TRAP
 35)   82EE 00 00       		@ERRTXT:		DEFS    2               ;ERROR MESSAGE POINTER	;ERROR MESSAGE POINTER
 36)   82F0 00 00       		@DATPTR:		DEFS    2               ;DATA POINTER	;DATA POINTER
 37)   82F2 00 00       		@ERL:			DEFS    2               ;ERROR LINE	;ERROR LINE
 38)   82F4 00 00       		@ERRLIN:		DEFS    2               ;"ON ERROR" LINE	;"ON ERROR" LINE
 39)   82F6 00 00 00 00 		@RANDOM:		DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 39)   82FA 00          		@RANDOM:		DEFS    5               ;RANDOM NUMBER	;RANDOM NUMBER
 40)   82FB 00          		@COUNT:			DEFS    1               ;PRINT POSITION	;PRINT POSITION
 41)   82FC 00          		@WIDTH:			DEFS    1               ;PRINT WIDTH	;PRINT WIDTH
 42)   82FD 00          		@ERR:			DEFS    1               ;ERROR NUMBER	;ERROR NUMBER
 43)   82FE 00          		@LISTON:		DEFS    1               ;LISTO & OPT FLAG	;LISTO & OPT FLAG
 44)   82FF 00          		@INCREM:		DEFS    1               ;AUTO INCREMENT	;AUTO INCREMENT
