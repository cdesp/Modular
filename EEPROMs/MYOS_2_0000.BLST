  5)   0000 00          		 NOP	;
  6)   0001 C3 00 02    		 JP START	;
  7)   0004 C3 89 02    		 JP MENU	;
  8)   0007 02          		 VERSION DEFB 2 ; AT ADDR=7	; AT ADDR=7
  9)   0008 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   000C 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0010 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0014 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0018 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   001C 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0020 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0024 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0028 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   002C 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0030 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0034 00 00 00 00 		 DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
 12)   0038 ED 4D       		 RETI	;
 15)   003A 00 00 00 00 		 ALIGN 256	;
 15)   003E 00 00 00 00 		 ALIGN 256	;
 15)   0042 00 00 00 00 		 ALIGN 256	;
 15)   0046 00 00 00 00 		 ALIGN 256	;
 15)   004A 00 00 00 00 		 ALIGN 256	;
 15)   004E 00 00 00 00 		 ALIGN 256	;
 15)   0052 00 00 00 00 		 ALIGN 256	;
 15)   0056 00 00 00 00 		 ALIGN 256	;
 15)   005A 00 00 00 00 		 ALIGN 256	;
 15)   005E 00 00 00 00 		 ALIGN 256	;
 15)   0062 00 00 00 00 		 ALIGN 256	;
 15)   0066 00 00 00 00 		 ALIGN 256	;
 15)   006A 00 00 00 00 		 ALIGN 256	;
 15)   006E 00 00 00 00 		 ALIGN 256	;
 15)   0072 00 00 00 00 		 ALIGN 256	;
 15)   0076 00 00 00 00 		 ALIGN 256	;
 15)   007A 00 00 00 00 		 ALIGN 256	;
 15)   007E 00 00 00 00 		 ALIGN 256	;
 15)   0082 00 00 00 00 		 ALIGN 256	;
 15)   0086 00 00 00 00 		 ALIGN 256	;
 15)   008A 00 00 00 00 		 ALIGN 256	;
 15)   008E 00 00 00 00 		 ALIGN 256	;
 15)   0092 00 00 00 00 		 ALIGN 256	;
 15)   0096 00 00 00 00 		 ALIGN 256	;
 15)   009A 00 00 00 00 		 ALIGN 256	;
 15)   009E 00 00 00 00 		 ALIGN 256	;
 15)   00A2 00 00 00 00 		 ALIGN 256	;
 15)   00A6 00 00 00 00 		 ALIGN 256	;
 15)   00AA 00 00 00 00 		 ALIGN 256	;
 15)   00AE 00 00 00 00 		 ALIGN 256	;
 15)   00B2 00 00 00 00 		 ALIGN 256	;
 15)   00B6 00 00 00 00 		 ALIGN 256	;
 15)   00BA 00 00 00 00 		 ALIGN 256	;
 15)   00BE 00 00 00 00 		 ALIGN 256	;
 15)   00C2 00 00 00 00 		 ALIGN 256	;
 15)   00C6 00 00 00 00 		 ALIGN 256	;
 15)   00CA 00 00 00 00 		 ALIGN 256	;
 15)   00CE 00 00 00 00 		 ALIGN 256	;
 15)   00D2 00 00 00 00 		 ALIGN 256	;
 15)   00D6 00 00 00 00 		 ALIGN 256	;
 15)   00DA 00 00 00 00 		 ALIGN 256	;
 15)   00DE 00 00 00 00 		 ALIGN 256	;
 15)   00E2 00 00 00 00 		 ALIGN 256	;
 15)   00E6 00 00 00 00 		 ALIGN 256	;
 15)   00EA 00 00 00 00 		 ALIGN 256	;
 15)   00EE 00 00 00 00 		 ALIGN 256	;
 15)   00F2 00 00 00 00 		 ALIGN 256	;
 15)   00F6 00 00 00 00 		 ALIGN 256	;
 15)   00FA 00 00 00 00 		 ALIGN 256	;
 15)   00FE 00 00       		 ALIGN 256	;
 18)   0100 C3 B5 17    		     JP MYOS_CLRSCN	;
 19)   0103 C3 B8 17    		     JP MYOS_PUTIME	;
 20)   0106 C3 B9 17    		     JP MYOS_GETIME	;
 21)   0109 C3 C0 17    		     JP MYOS_PUTCSR	;
 22)   010C C3 D2 17    		     JP MYOS_GETCSR	;
 23)   010F C3 E1 17    		     JP MYOS_OSRDCH	;
 24)   0112 C3 9A 19    		     JP MYOS_PROMPT	;
 25)   0115 C3 EC 17    		     JP MYOS_OSWRCH	;
 26)   0118 C3 C8 19    		     JP MYOS_OSKEY	;
 27)   011B C3 04 1A    		     JP MYOS_OSINIT	;
 28)   011E C3 C0 1B    		     JP MYOS_OSLINE	;
 29)   0121 C3 C2 1A    		     JP MYOS_OSCLI	;
 30)   0124 C3 4F 1B    		     JP MYOS_OSBPUT 	;
 31)   0127 C3 4F 1B    		     JP MYOS_OSBGET 	;
 32)   012A C3 4F 1B    		     JP MYOS_OSSTAT 	;
 33)   012D C3 4F 1B    		     JP MYOS_OSSHUT 	;
 34)   0130 C3 4F 1B    		     JP MYOS_OSOPEN 	;
 35)   0133 C3 4F 1B    		     JP MYOS_OSCALL 	;
 36)   0136 C3 E7 1C    		     JP MYOS_OSSAVE 	;
 37)   0139 C3 10 1D    		     JP MYOS_OSLOAD 	;
 38)   013C C3 4F 1B    		     JP MYOS_GETPTR 	;
 39)   013F C3 4F 1B    		     JP MYOS_PUTPTR 	;
 40)   0142 C3 4F 1B    		     JP MYOS_GETEXT 	;
 41)   0145 C3 52 1B    		     JP MYOS_RESET 	;
 42)   0148 C3 F4 19    		     JP MYOS_TRAP	;
 43)   014B C3 F7 19    		     JP MYOS_LTRAP  	;
 44)   014E C3 5A 1B    		     JP MYOS_CLG	;
 45)   0151 C3 72 1B    		     JP MYOS_COLOUR	;
 46)   0154 C3 7D 1B    		     JP MYOS_DRAW	;
 47)   0157 C3 A3 1B    		     JP MYOS_ENVEL	;
 48)   015A C3 66 1B    		     JP MYOS_GCOL	;
 49)   015D C3 53 1B    		     JP MYOS_MODE	;
 50)   0160 C3 87 1B    		     JP MYOS_MOVE	;
 51)   0163 C3 91 1B    		     JP MYOS_PLOT	;
 52)   0166 C3 A3 1B    		     JP MYOS_SOUND	;
 53)   0169 C3 A3 1B    		     JP MYOS_ADVAL	;
 54)   016C C3 9B 1B    		     JP MYOS_POINT	;
 55)   016F C3 A3 1B    		     JP MYOS_GETIMS	;
 56)   0172 C3 A3 1B    		     JP MYOS_PUTIMS    	;
 58)   0175 00 00 00 00 		 ALIGN 256     	;
 58)   0179 00 00 00 00 		 ALIGN 256     	;
 58)   017D 00 00 00 00 		 ALIGN 256     	;
 58)   0181 00 00 00 00 		 ALIGN 256     	;
 58)   0185 00 00 00 00 		 ALIGN 256     	;
 58)   0189 00 00 00 00 		 ALIGN 256     	;
 58)   018D 00 00 00 00 		 ALIGN 256     	;
 58)   0191 00 00 00 00 		 ALIGN 256     	;
 58)   0195 00 00 00 00 		 ALIGN 256     	;
 58)   0199 00 00 00 00 		 ALIGN 256     	;
 58)   019D 00 00 00 00 		 ALIGN 256     	;
 58)   01A1 00 00 00 00 		 ALIGN 256     	;
 58)   01A5 00 00 00 00 		 ALIGN 256     	;
 58)   01A9 00 00 00 00 		 ALIGN 256     	;
 58)   01AD 00 00 00 00 		 ALIGN 256     	;
 58)   01B1 00 00 00 00 		 ALIGN 256     	;
 58)   01B5 00 00 00 00 		 ALIGN 256     	;
 58)   01B9 00 00 00 00 		 ALIGN 256     	;
 58)   01BD 00 00 00 00 		 ALIGN 256     	;
 58)   01C1 00 00 00 00 		 ALIGN 256     	;
 58)   01C5 00 00 00 00 		 ALIGN 256     	;
 58)   01C9 00 00 00 00 		 ALIGN 256     	;
 58)   01CD 00 00 00 00 		 ALIGN 256     	;
 58)   01D1 00 00 00 00 		 ALIGN 256     	;
 58)   01D5 00 00 00 00 		 ALIGN 256     	;
 58)   01D9 00 00 00 00 		 ALIGN 256     	;
 58)   01DD 00 00 00 00 		 ALIGN 256     	;
 58)   01E1 00 00 00 00 		 ALIGN 256     	;
 58)   01E5 00 00 00 00 		 ALIGN 256     	;
 58)   01E9 00 00 00 00 		 ALIGN 256     	;
 58)   01ED 00 00 00 00 		 ALIGN 256     	;
 58)   01F1 00 00 00 00 		 ALIGN 256     	;
 58)   01F5 00 00 00 00 		 ALIGN 256     	;
 58)   01F9 00 00 00 00 		 ALIGN 256     	;
 58)   01FD 00 00 00    		 ALIGN 256     	;
 45)   0200 F3          		@START: DI	;
 46)   0201 21 00 A0    		 LD HL,$A000 ;TEMPORARY INTERRUPT SERVICE IN RAM	;TEMPORARY INTERRUPT SERVICE IN RAM
 47)   0204 3E ED       		 LD A,$ED ;RETI	;RETI
 48)   0206 77          		 LD (HL),A	;
 49)   0207 23          		 INC HL	;
 50)   0208 3E 4D       		 LD A,$4D ;RETI	;RETI
 51)   020A 77          		 LD (HL),A	;
 61)   020B 06 05       		CN1: LD B,5	;
 62)   020D 0E 00       		AGN1: LD C,0	;
 63)   020F 3E 00       		 LD A,0	;
 64)   0211 ED 79       		 OUT (C),A	;
 65)   0213 0E 00       		 LD C,0	;
 66)   0215 3E FF       		 LD A,255	;
 67)   0217 ED 79       		 OUT (C),A	;
 68)   0219 10 F2       		 DJNZ AGN1	;
 73)   021B 11 01 00    		 LD DE,1	;
 74)   021E 3E 00       		 LD A,0 ;WRITE 0	;WRITE 0
 75)   0220 4F          		 LD C,A	;
 76)   0221 21 00 80    		 LD HL,RAMAD 	;
 77)   0224 06 08       		 LD B,8	;
 78)   0226 77          		AGN2: LD (HL),A	;
 79)   0227 4E          		 LD C,(HL)	;
 80)   0228 B9          		 CP C	;
 81)   0229 C2 43 02    		 JP NZ, ERR	;
 82)   022C 19          		 ADD HL,DE	;
 83)   022D C6 20       		 ADD A,32 ;WRITE +32	;WRITE +32
 84)   022F 4F          		 LD C,A	;
 85)   0230 10 F4       		 DJNZ AGN2	;
 87)   0232 06 05       		 LD B,5	;
 88)   0234 0E 08       		AGN3: LD C,00001000B ;LLH ON 138 Y1 OUT	;LLH ON 138 Y1 OUT
 89)   0236 3E 40       		 LD A,64	;
 90)   0238 ED 79       		 OUT (C),A	;
 91)   023A C6 80       		 ADD A,128	;
 92)   023C ED 79       		 OUT (C),A 	;
 93)   023E 10 F4       		 DJNZ AGN3  ; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 8	; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 8
 94)   0240 C3 4C 02    		 JP BOOT	;
 97)   0243 0E 38       		ERR: LD C,00111000B ;HHH ON 138 Y7 OUT	;HHH ON 138 Y7 OUT
 98)   0245 3E 40       		 LD A,64	;
 99)   0247 ED 79       		 OUT (C),A	;
101)   0249 C3 43 02    		 JP ERR ;DO AGAIN PORT 1	;DO AGAIN PORT 1
105)   024C F3          		@BOOT: DI	;
106)   024D ED 56       		 IM 1 	;
107)   024F 31 F0 FF    		 LD SP,STACKP 	;
108)   0252 CD F7 03    		 CALL EPROMOFF	;
109)   0255 CD CE 13    		 CALL KEYBDATON 	;
112)   0258 CD 4A 05    		 CALL RS_INI ;RS232 INITIALIZE	;RS232 INITIALIZE
113)   025B 21 13 05    		 LD HL,STR00	;
114)   025E CD 72 05    		 CALL RS_TXT	;
122)   0261 CD F0 05    		 CALL LCD_INIT	;
123)   0264 21 3F 00    		 LD HL,COL_BLUE	;
124)   0267 22 03 83    		 LD (BCOLOR),HL	;
125)   026A 21 C0 FF    		 LD HL,COL_YELLOW	;
126)   026D 22 01 83    		 LD (FCOLOR),HL	;
127)   0270 21 00 05    		 LD HL,STRSCR 	;
128)   0273 CD 72 05    		 CALL RS_TXT	;
129)   0276 CD 54 0D    		 CALL LCD_CLRSCR  	;
130)   0279 3E 00       		 LD A,0	;
131)   027B 32 0D 83    		 LD (CURSORX),A	;
132)   027E 3E 00       		 LD A,0	;
133)   0280 32 0E 83    		 LD (CURSORY),A  	;
134)   0283 21 5C 04    		 LD HL,STR0  ;LCD INIT MSG	;LCD INIT MSG
135)   0286 CD 94 0D    		 CALL LCD_MSG	;
143)   0289 21 D1 04    		 LD HL,STRMN	;
144)   028C CD 72 05    		 CALL RS_TXT ;OUTPUT MENU COMMANDS AT RS232 	;OUTPUT MENU COMMANDS AT RS232
145)   028F 21 29 05    		 LD HL,STR01	;
146)   0292 CD 72 05    		 CALL RS_TXT ;OUTPUT WAITING AT RS232	;OUTPUT WAITING AT RS232
153)   0295 21 27 04    		 LD HL,SMENU	;
154)   0298 3E 05       		 LD A,5	;
155)   029A 32 0D 83    		 LD (CURSORX),A	;
156)   029D 3E 02       		 LD A,2	;
157)   029F 32 0E 83    		 LD (CURSORY),A  	;
158)   02A2 CD 94 0D    		 CALL LCD_MSG	;
160)   02A5 CD FD 02    		 CALL GET_CHAR ;TAKE A CHAR FROM RS232 OR PS2 KEYB	;TAKE A CHAR FROM RS232 OR PS2 KEYB
163)   02A8 FE 55       		 CP 'U' ;UPLOAD PROGRAM	;UPLOAD PROGRAM
164)   02AA CC 2C 03    		 CALL Z, UPLOD	;
165)   02AD FE 58       		 CP 'X'	;
166)   02AF CA 1E 03    		 JP Z,EXEC	;
167)   02B2 FE 54       		 CP 'T'	;
168)   02B4 CC A3 03    		 CALL Z,RSTST	;
169)   02B7 FE 53       		 CP 'S'	;
170)   02B9 CC D5 03    		 CALL Z,TXTSCR	;
171)   02BC FE 49       		 CP 'I'	;
172)   02BE CC 63 03    		 CALL Z,UPLOD2	;
173)   02C1 FE 59       		 CP 'Y'	;
174)   02C3 CC B9 03    		 CALL Z,RSTST2	;
175)   02C6 FE 48       		 CP 'H'	;
176)   02C8 CC C8 03    		 CALL Z,XMTST	;
177)   02CB FE 4A       		 CP 'J'	;
178)   02CD CC 88 03    		 CALL Z,DNLOD	;
181)   02D0 FE 43       		 CP 'C'	;
182)   02D2 CC 54 0D    		 CALL Z,LCD_CLRSCR	;
183)   02D5 FE 42       		 CP 'B'	;
184)   02D7 CA 00 40    		 JP Z,BBCBASIC	;
186)   02DA C3 89 02    		 JP MENU	;
193)   02DD AF          		@GET_CHARNW: XOR A	;
196)   02DE CD A0 05    		 CALL RS_KEYRD ;CHAR IN RS232?	;CHAR IN RS232?
197)   02E1 28 04       		 JR Z,CNW_TST2 	;
198)   02E3 CD 7C 05    		 CALL RS_RX ; GET THAT CHAR	; GET THAT CHAR
199)   02E6 C9          		 RET	;
202)   02E7 CD BB 14    		 CALL READCHAR ;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)	;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)
203)   02EA FE 00       		 CP 0         ;IF KEY=0 THEN IT IS INVALID	;IF KEY=0 THEN IT IS INVALID
204)   02EC C8          		 RET Z        ;EXIT IF Z TODO LOOP THIS FOR 10MS THEN EXIT	;EXIT IF Z TODO LOOP THIS FOR 10MS THEN EXIT
207)   02ED F5          		 PUSH AF	;
208)   02EE CD 63 05    		 CALL RS_TX	;
209)   02F1 3E 0A       		 LD A,10	;
210)   02F3 CD 63 05    		 CALL RS_TX	;
211)   02F6 3E 0D       		 LD A,13	;
212)   02F8 CD 63 05    		 CALL RS_TX	;
213)   02FB F1          		 POP AF	;
214)   02FC C9          		 RET	;
219)   02FD AF          		@GET_CHAR: XOR A	;
222)   02FE CD A0 05    		 CALL RS_KEYRD ;CHAR IN RS232?	;CHAR IN RS232?
223)   0301 28 04       		 JR Z,CW_TST2	;
224)   0303 CD 7C 05    		 CALL RS_RX ; GET THAT CHAR	; GET THAT CHAR
225)   0306 C9          		 RET	;
232)   0307 CD BB 14    		 CALL READCHAR ;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)	;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)
233)   030A FE 00       		 CP 0         ;IF KEY=0 THEN IT IS INVALID	;IF KEY=0 THEN IT IS INVALID
234)   030C 28 EF       		 JR Z,GET_CHAR	;
237)   030E F5          		 PUSH AF	;
238)   030F CD 63 05    		 CALL RS_TX	;
239)   0312 3E 0A       		 LD A,10	;
240)   0314 CD 63 05    		 CALL RS_TX	;
241)   0317 3E 0D       		 LD A,13	;
242)   0319 CD 63 05    		 CALL RS_TX	;
243)   031C F1          		 POP AF	;
244)   031D C9          		 RET	;
255)   031E 3E 05       		 LD A,5	;
256)   0320 CD F1 16    		 CALL SCPRN  	;
258)   0323 11 8C 83    		 LD DE,PRGEX	;
259)   0326 1A          		 LD A,(DE)	;
260)   0327 6F          		 LD L,A	;
261)   0328 13          		 INC DE	;
262)   0329 1A          		 LD A,(DE)	;
263)   032A 67          		 LD H,A	;
264)   032B E9          		 JP (HL)	;
271)   032C F3          		UPLOD: DI 	;
276)   032D CD 7C 05    		 CALL RS_RX ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
277)   0330 6F          		 LD L,A	;
278)   0331 CD 7C 05    		 CALL RS_RX	;
279)   0334 67          		 LD H,A	;
280)   0335 CD 7C 05    		 CALL RS_RX ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
281)   0338 4F          		 LD C,A	;
282)   0339 CD 7C 05    		 CALL RS_RX	;
283)   033C 47          		 LD B,A	;
285)   033D 11 8C 83    		 LD DE,PRGEX ;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
286)   0340 7D          		 LD A,L	;
287)   0341 12          		 LD (DE),A	;
288)   0342 13          		 INC DE	;
289)   0343 7C          		 LD A,H	;
290)   0344 12          		 LD (DE),A	;
292)   0345 FE 80       		 CP $80	;
293)   0347 DC 01 04    		 CALL C,EPROMON ;C ROM IN 0-8000 NC ROM IN 8000-FFFF ;SET ROM WRITABLE = '0'	;C ROM IN 0-8000 NC ROM IN 8000-FFFF ;SET ROM WRITABLE = '0'
295)   034A E5          		NORWR: PUSH HL	;
296)   034B CD 7C 05    		NXB: CALL RS_RX	;
297)   034E 77          		 LD (HL),A	;
298)   034F 23          		 INC HL	;
299)   0350 0B          		 DEC BC	;
300)   0351 78          		 LD A,B	;
301)   0352 B1          		 OR C	;
302)   0353 20 F6       		 JR NZ,NXB ;LOOP ALL BYTES 	;LOOP ALL BYTES
303)   0355 CD F7 03    		 CALL EPROMOFF	;
308)   0358 3E 05       		 LD A,5 	;
309)   035A CD F1 16    		 CALL SCPRN  	;
310)   035D CD FE 16    		 CALL DELAY	;
312)   0360 E1          		 POP HL	;
315)   0361 FB          		 EI	;
316)   0362 C9          		 RET	;
320)   0363 F3          		UPLOD2: DI	;
325)   0364 CD 7C 05    		 CALL RS_RX ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
326)   0367 6F          		 LD L,A	;
327)   0368 CD 7C 05    		 CALL RS_RX	;
328)   036B 67          		 LD H,A	;
329)   036C CD 7C 05    		 CALL RS_RX ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
330)   036F 4F          		 LD C,A	;
331)   0370 CD 7C 05    		 CALL RS_RX	;
332)   0373 47          		 LD B,A	;
334)   0374 11 8C 83    		 LD DE,PRGEX ;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
335)   0377 7D          		 LD A,L	;
336)   0378 12          		 LD (DE),A	;
337)   0379 13          		 INC DE	;
338)   037A 7C          		 LD A,H	;
339)   037B 12          		 LD (DE),A	;
341)   037C CD 7C 05    		NXB2: CALL RS_RX	;
342)   037F 77          		 LD (HL),A	;
343)   0380 23          		 INC HL	;
344)   0381 0B          		 DEC BC	;
345)   0382 78          		 LD A,B	;
346)   0383 B1          		 OR C	;
347)   0384 20 F6       		 JR NZ,NXB2 ;LOOP ALL BYTES   	;LOOP ALL BYTES
349)   0386 FB          		 EI	;
351)   0387 C9          		 RET	;
362)   0388 CD 7C 05    		 CALL RS_RX ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
363)   038B 6F          		 LD L,A	;
364)   038C CD 7C 05    		 CALL RS_RX	;
365)   038F 67          		 LD H,A	;
366)   0390 CD 7C 05    		 CALL RS_RX ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
367)   0393 4F          		 LD C,A	;
368)   0394 CD 7C 05    		 CALL RS_RX	;
369)   0397 47          		 LD B,A	;
371)   0398 7E          		NXB3: LD A,(HL)	;
372)   0399 CD 63 05    		 CALL RS_TX ;SEND BYTE	;SEND BYTE
373)   039C 23          		 INC HL	;
374)   039D 0B          		 DEC BC	;
375)   039E 78          		 LD A,B	;
376)   039F B1          		 OR C	;
377)   03A0 20 F6       		 JR NZ,NXB3 ;LOOP ALL BYTES    	;LOOP ALL BYTES
378)   03A2 C9          		 RET	;
380)   03A3 00          		RSTST: NOP ;GET A KEY FROM RS232	;GET A KEY FROM RS232
381)   03A4 06 0A       		 LD B,10	;
382)   03A6 C5          		TEN: PUSH BC	;
383)   03A7 CD 7C 05    		 CALL RS_RX	;
385)   03AA CD 63 05    		 CALL RS_TX ;SEND BACK THE CHAR	;SEND BACK THE CHAR
387)   03AD 3E 20       		 LD A,' '	;
389)   03AF 3E 52       		 LD A,'R'	;
392)   03B1 CD 0B 17    		 CALL DEL2	;
394)   03B4 C1          		 POP BC	;
395)   03B5 10 EF       		 DJNZ TEN	;
397)   03B7 AF          		 XOR A	;
398)   03B8 C9          		 RET	;
400)   03B9 00          		RSTST2: NOP ;TEST RECEIVING AND SENDING 255 BYTES	;TEST RECEIVING AND SENDING 255 BYTES
401)   03BA 06 FF       		 LD B,255	;
402)   03BC C5          		TEN2: PUSH BC	;
403)   03BD CD 7C 05    		 CALL RS_RX	;
405)   03C0 CD 63 05    		 CALL RS_TX ;SEND BACK THE CHAR 	;SEND BACK THE CHAR
407)   03C3 C1          		 POP BC	;
408)   03C4 10 F6       		 DJNZ TEN2	;
409)   03C6 AF          		 XOR A	;
410)   03C7 C9          		 RET	;
413)   03C8 00          		XMTST: NOP ;TEST XMIT ALL 8 BITS	;TEST XMIT ALL 8 BITS
414)   03C9 06 FF       		 LD B,255	;
415)   03CB C5          		TEN3: PUSH BC	;
416)   03CC 78          		 LD A,B	;
417)   03CD CD 63 05    		 CALL RS_TX ;SEND THE BYTE	;SEND THE BYTE
418)   03D0 C1          		 POP BC	;
419)   03D1 10 F8       		 DJNZ TEN3	;
420)   03D3 AF          		 XOR A	;
421)   03D4 C9          		 RET	;
423)   03D5 C9          		TXTSCR: RET	;
430)   03D6 04          		@FF_OFF: INC B  ; DO 0-7 TO 1-8	; DO 0-7 TO 1-8
431)   03D7 AF          		      XOR A	;
432)   03D8 37          		      SCF	;
433)   03D9 17          		SBAGN: RLA        ; MOVE IT TO THE RIGHT PLACE	; MOVE IT TO THE RIGHT PLACE
434)   03DA 10 FD       		      DJNZ SBAGN	;
435)   03DC 2F          		      CPL     ;INVERSE BITS ON A	;INVERSE BITS ON A
436)   03DD 47          		      LD B,A	;
437)   03DE 21 85 83    		      LD HL,FFSTAT	;
438)   03E1 7E          		      LD A,(HL)	;
439)   03E2 A0          		      AND B        ;ZERO THE BIT	;ZERO THE BIT
440)   03E3 77          		      LD (HL),A	;
441)   03E4 D3 08       		      OUT (DEVFFS),A	;
442)   03E6 C9          		      RET	;
445)   03E7 04          		@FF_ON: INC B  ; DO 0-7 TO 1-8	; DO 0-7 TO 1-8
446)   03E8 AF          		      XOR A	;
447)   03E9 37          		      SCF	;
448)   03EA 17          		SBAGN: RLA        ; MOVE IT TO THE RIGHT PLACE	; MOVE IT TO THE RIGHT PLACE
449)   03EB 10 FD       		      DJNZ SBAGN	;
450)   03ED 47          		      LD B,A	;
451)   03EE 21 85 83    		      LD HL,FFSTAT	;
452)   03F1 7E          		      LD A,(HL)	;
453)   03F2 B0          		      OR B        ;SET THE BIT	;SET THE BIT
454)   03F3 77          		      LD (HL),A	;
455)   03F4 D3 08       		      OUT (DEVFFS),A	;
456)   03F6 C9          		      RET	;
458)   03F7 E5          		@EPROMOFF: PUSH HL	;
459)   03F8 C5          		      PUSH BC	;
460)   03F9 06 00       		      LD B,0	;
461)   03FB CD D6 03    		      CALL FF_OFF	;
462)   03FE C1          		      POP BC	;
463)   03FF E1          		      POP HL	;
464)   0400 C9          		      RET	;
466)   0401 E5          		@EPROMON: PUSH HL	;
467)   0402 C5          		         PUSH BC	;
468)   0403 06 00       		     LD B,0	;
469)   0405 CD E7 03    		     CALL FF_ON	;
470)   0408 C1          		     POP BC	;
471)   0409 E1          		     POP HL	;
472)   040A C9          		     RET	;
478)   040B F5          		SOUTAS: PUSH AF  ;SERIAL PRINT ASCII IN DECIMAL	;SERIAL PRINT ASCII IN DECIMAL
479)   040C 26 00       		 LD H,0	;
480)   040E 6F          		 LD L,A	;
481)   040F 11 8F 83    		 LD DE,MYNUM	;
482)   0412 CD 25 17    		 CALL OUTASC	;
484)   0415 3E 0A       		 LD A,10	;
485)   0417 12          		 LD (DE),A	;
486)   0418 13          		 INC DE	;
487)   0419 3E 0D       		 LD A,13	;
488)   041B 12          		 LD (DE),A	;
489)   041C 13          		 INC DE	;
490)   041D AF          		 XOR A	;
491)   041E 12          		 LD (DE),A	;
493)   041F 21 8F 83    		 LD HL,MYNUM	;
494)   0422 CD 72 05    		 CALL RS_TXT	;
495)   0425 F1          		 POP AF	;
496)   0426 C9          		 RET	;
501)   0427 55 49 3A 55 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   042B 50 20 4A 3A 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   042F 44 4E 20 58 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0433 3A 52 55 4E 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0437 20 54 59 48 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   043B 3A 52 53 20 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   043F 53 3A 44 49 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0443 53 50 20 43 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0447 3A 43 4C 53 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   044B 20 4C 3A 4C 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   044F 43 44 53 54 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0453 20 42 3A 42 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
501)   0457 41 53 49 43 		SMENU DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
502)   045B 00          		 DB 0	;
504)   045C 4C 43 44 20 		STR0 DEFM "LCD INITIALIZED"	;
504)   0460 49 4E 49 54 		STR0 DEFM "LCD INITIALIZED"	;
504)   0464 49 41 4C 49 		STR0 DEFM "LCD INITIALIZED"	;
504)   0468 5A 45 44    		STR0 DEFM "LCD INITIALIZED"	;
505)   046B 00          		 DB 0	;
507)   046C 52 53 32 33 		STR1 DEFM "RS232 INIT"	;
507)   0470 32 20 49 4E 		STR1 DEFM "RS232 INIT"	;
507)   0474 49 54       		STR1 DEFM "RS232 INIT"	;
508)   0476 00          		 DB 0	;
510)   0477 50 52 4F 47 		STR2 DEFM "PROGRAM HALTED"	;
510)   047B 52 41 4D 20 		STR2 DEFM "PROGRAM HALTED"	;
510)   047F 48 41 4C 54 		STR2 DEFM "PROGRAM HALTED"	;
510)   0483 45 44       		STR2 DEFM "PROGRAM HALTED"	;
511)   0485 00          		 DB 0	;
513)   0486 57 41 49 54 		STR02 DEFM "WAITING..."	;
513)   048A 49 4E 47 2E 		STR02 DEFM "WAITING..."	;
513)   048E 2E 2E       		STR02 DEFM "WAITING..."	;
514)   0490 00          		 DB 0	;
516)   0491 50 52 47 20 		DATTR DEFM "PRG TRANSFERED"	;
516)   0495 54 52 41 4E 		DATTR DEFM "PRG TRANSFERED"	;
516)   0499 53 46 45 52 		DATTR DEFM "PRG TRANSFERED"	;
516)   049D 45 44       		DATTR DEFM "PRG TRANSFERED"	;
517)   049F 00          		 DB 0	;
519)   04A0 52 45 43 45 		DATST DEFM "RECEIVING..."	;
519)   04A4 49 56 49 4E 		DATST DEFM "RECEIVING..."	;
519)   04A8 47 2E 2E 2E 		DATST DEFM "RECEIVING..."	;
520)   04AC 00          		 DB 0 	;
522)   04AD 50 52 47 20 		SPRGX DEFM "PRG EXECUTE"	;
522)   04B1 45 58 45 43 		SPRGX DEFM "PRG EXECUTE"	;
522)   04B5 55 54 45    		SPRGX DEFM "PRG EXECUTE"	;
523)   04B8 00          		 DB 0	;
525)   04B9 49 4D 41 47 		STIMG DEFM "IMAGE COPY"	;
525)   04BD 45 20 43 4F 		STIMG DEFM "IMAGE COPY"	;
525)   04C1 50 59       		STIMG DEFM "IMAGE COPY"	;
526)   04C3 00          		 DB 0	;
528)   04C4 53 43 52 45 		TXTMES DEFM "SCREEN READY"	;
528)   04C8 45 4E 20 52 		TXTMES DEFM "SCREEN READY"	;
528)   04CC 45 41 44 59 		TXTMES DEFM "SCREEN READY"	;
529)   04D0 00          		 DB 0	;
531)   04D1 55 49 3A 55 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04D5 50 20 4A 3A 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04D9 44 4E 20 58 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04DD 3A 52 55 4E 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04E1 20 54 59 48 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04E5 3A 52 53 20 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04E9 53 3A 44 49 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04ED 53 50 20 43 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04F1 3A 43 4C 53 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04F5 20 42 3A 42 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
531)   04F9 41 53 49 43 		STRMN DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
532)   04FD 0A 0D 00    		 DB 10,13,0	;
534)   0500 43 4C 45 41 		STRSCR DEFM "CLEARING SCREEN."	;
534)   0504 52 49 4E 47 		STRSCR DEFM "CLEARING SCREEN."	;
534)   0508 20 53 43 52 		STRSCR DEFM "CLEARING SCREEN."	;
534)   050C 45 45 4E 2E 		STRSCR DEFM "CLEARING SCREEN."	;
535)   0510 0A 0D 00    		 DB 10,13,0	;
537)   0513 0A 0D       		STR00 DB 10,13	;
538)   0515 52 53 32 33 		 DEFM "RS232 INITIALIZED"	;
538)   0519 32 20 49 4E 		 DEFM "RS232 INITIALIZED"	;
538)   051D 49 54 49 41 		 DEFM "RS232 INITIALIZED"	;
538)   0521 4C 49 5A 45 		 DEFM "RS232 INITIALIZED"	;
538)   0525 44          		 DEFM "RS232 INITIALIZED"	;
539)   0526 0A 0D 00    		 DB 10,13,0	;
541)   0529 0A 0D       		STR01 DB 10,13	;
542)   052B 57 41 49 54 		 DEFM "WAITING..."	;
542)   052F 49 4E 47 2E 		 DEFM "WAITING..."	;
542)   0533 2E 2E       		 DEFM "WAITING..."	;
543)   0535 0A 0D 00    		 DB 10,13,0	;
544)   0538 00          		 DB 0	;
546)   0539 0A 0D       		STR06 DB 10,13	;
547)   053B 4B 45 59 20 		 DEFM "KEY PRESSED"	;
547)   053F 50 52 45 53 		 DEFM "KEY PRESSED"	;
547)   0543 53 45 44    		 DEFM "KEY PRESSED"	;
548)   0546 0A 0D 00    		 DB 10,13,0	;
549)   0549 00          		 DB 0	;
 15)   054A 	            		 RBR EQU DEVSER+0 ;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)	;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)
 16)   054A 	            		 THR EQU DEVSER+0 ;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)	;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)
 17)   054A 	            		 IER EQU DEVSER+1 ;INTERRUPT ENABLE REGISTER (DLAB = 0)	;INTERRUPT ENABLE REGISTER (DLAB = 0)
 22)   054A 	            		 IIR EQU DEVSER+2 ;INTERRUPT IDENT. REGISTER (READ ONLY)	;INTERRUPT IDENT. REGISTER (READ ONLY)
 27)   054A 	            		 FCR EQU DEVSER+2 ;FIFO CONTROL REGISTER (WRITE ONLY)	;FIFO CONTROL REGISTER (WRITE ONLY)
 35)   054A 	            		 LCR EQU DEVSER+3 ;LINE CONTROL REGISTER	;LINE CONTROL REGISTER
 43)   054A 	            		 MCR EQU DEVSER+4 ;MODEM CONTROL REGISTER 	;MODEM CONTROL REGISTER
 44)   054A 	            		 LSR EQU DEVSER+5 ;LINE STATUS REGISTER	;LINE STATUS REGISTER
 53)   054A 	            		 MSR EQU DEVSER+6 ;MODEM STATUS REGISTER	;MODEM STATUS REGISTER
 54)   054A 	            		 SCR EQU DEVSER+7 ;SCRATCH REGISTER	;SCRATCH REGISTER
 55)   054A 	            		 DLL EQU DEVSER+0 ;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)
 56)   054A 	            		 DLM EQU DEVSER+1 ;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)
 62)   054A 3E 80       		 LD     A,$80           ; Mask to set DLAB on	; Mask to set DLAB on
 63)   054C D3 23       		 OUT    (LCR),A         ; Send to LINe Control Register	; Send to LINe Control Register
 64)   054E 3E 0C       		 LD     A,12           ; Divisor of 12 = 9600 bps with 1.8432 MHz clock	; Divisor of 12 = 9600 bps with 1.8432 MHz clock
 69)   0550 D3 20       		 OUT    (DLL),A         ; Set LSB of divisor	; Set LSB of divisor
 70)   0552 3E 00       		 LD     A,00            ; This will be the MSB of the divisior	; This will be the MSB of the divisior
 71)   0554 D3 21       		 OUT    (DLM),A         ; Send to the MSB register	; Send to the MSB register
 72)   0556 3E 03       		 LD     A,$03           ; 8 bits, 1 stop, no parity (and clear DLAB)	; 8 bits, 1 stop, no parity (and clear DLAB)
 73)   0558 D3 23       		 OUT    (LCR),A         ; Write new value to LCR	; Write new value to LCR
 75)   055A 3E 00       		 LD A, 0       	;
 76)   055C D3 22       		 OUT  (FCR),A      ;//was commented	;//was commented
 77)   055E 3E 00       		 LD     A,$00           ; 5 A=0 Disable all INterrupts	; 5 A=0 Disable all INterrupts
 78)   0560 D3 21       		 OUT    (IER),A         ; Send to INterrupt Enable Register 	; Send to INterrupt Enable Register
 79)   0562 C9          		 RET	;
 82)   0563 CD 69 05    		RS_TX: CALL   RSTXRD	;
 83)   0566 D3 20       		       OUT     (THR),A	;
 85)   0568 C9          		       RET	;
 89)   0569 F5          		RSTXRD: PUSH   AF	;
 90)   056A DB 25       		RSTXLP: IN     A,(LSR)         ; fetch the control register	; fetch the control register
 91)   056C CB 6F       		       BIT     5,A             ; bit will be set if UART is ready	; bit will be set if UART is ready
 92)   056E 28 FA       		       JR      Z,RSTXLP	;
 93)   0570 F1          		       POP     AF	;
 94)   0571 C9          		       RET  	;
 97)   0572 7E          		RS_TXT: LD A,(HL)	;
 98)   0573 23          		 INC HL 	;
 99)   0574 FE 00       		 CP 0	;
100)   0576 C8          		 RET Z	;
101)   0577 CD 63 05    		       CALL RS_TX	;
102)   057A 18 F6       		 JR RS_TXT	;
109)   057C 3E 01       		RS_RX: LD A,1     ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
110)   057E D3 24       		       OUT (MCR),A	;
111)   0580 CD 97 05    		   CALL    RSRXRD              	;
112)   0583 AF          		RS_GTCH: XOR A     ;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
113)   0584 D3 24       		       OUT (MCR),A        	;
115)   0586 DB 20       		      IN A,(RBR)	;
116)   0588 C9          		       RET	;
118)   0589 3E 01       		RS_RXNW:LD A,1    ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
119)   058B D3 24       		       OUT (MCR),A	;
120)   058D DB 25       		   IN      A,(LSR)         ; fetch the conrtol register	; fetch the conrtol register
121)   058F CB 47       		       BIT     0,A                    	;
122)   0591 28 02       		       JR Z,RS_NOCHAR	;
123)   0593 18 EE       		       JR RS_GTCH	;
125)   0595 AF          		RS_NOCHAR: XOR A ;RETURN ZERO	;RETURN ZERO
126)   0596 C9          		       RET	;
133)   0597 F5          		RSRXRD: PUSH   AF	;
134)   0598 DB 25       		RSRXLP: IN     A,(LSR)         ; fetch the conrtol register	; fetch the conrtol register
135)   059A CB 47       		       BIT     0,A             ; bit will be set if UART has data	; bit will be set if UART has data
136)   059C 28 FA       		       JR      Z,RSRXLP	;
137)   059E F1          		       POP     AF	;
138)   059F C9          		       RET  	;
142)   05A0 DB 25       		RS_KEYRD:IN     A,(LSR)         ; fetch the conrtol register	; fetch the conrtol register
143)   05A2 CB 47       		        BIT     0,A             ; bit will be set if UART has data        	; bit will be set if UART has data
144)   05A4 C9          		        RET 	;
146)   05A5 F5          		SHLCD: PUSH AF	;
148)   05A6 F1          		 POP AF	;
150)   05A7 C9          		 RET	;
154)   05A8 F5          		CHKERR: PUSH AF	;
155)   05A9 E5          		 PUSH HL	;
156)   05AA C5          		 PUSH BC	;
157)   05AB DB 25       		 IN A,(LSR)  ;FETCH LINE STATUS REGISTER	;FETCH LINE STATUS REGISTER
158)   05AD CB 67       		 BIT 4,A	;
159)   05AF 28 04       		 JR Z,LBLPE	;
160)   05B1 3E 42       		 LD A,'B' ;$20 ;BREAK	;$20 ;BREAK
161)   05B3 18 1A       		 JR EXIT	;
162)   05B5 CB 57       		LBLPE: BIT 2,A 	;
163)   05B7 28 04       		 JR Z,LBLFE	;
164)   05B9 3E 50       		 LD A,'P' ;$40 ;PARITY	;$40 ;PARITY
165)   05BB 18 12       		 JR EXIT	;
166)   05BD CB 5F       		LBLFE: BIT 3,A	;
167)   05BF 28 04       		 JR Z,LBLOE	;
168)   05C1 3E 46       		 LD A,'F' ;$60 ;FRAME 	;$60 ;FRAME
169)   05C3 18 0A       		 JR EXIT	;
170)   05C5 CB 4F       		LBLOE: BIT 1,A	;
171)   05C7 28 04       		 JR Z,LBLNE	;
172)   05C9 3E 4F       		 LD A,'O' ;$80  ;OVERRUN	;$80  ;OVERRUN
173)   05CB 18 02       		 JR EXIT	;
174)   05CD 3E 4E       		LBLNE: LD A,'N' ;NO ERROR	;NO ERROR
175)   05CF 21 87 83    		EXIT: LD HL,SERERR	;
176)   05D2 77          		 LD (HL),A	;
178)   05D3 C1          		 POP BC	;
179)   05D4 E1          		 POP HL	;
180)   05D5 F1          		 POP AF	;
181)   05D6 C9          		 RET	;
 16)   05D7 	            		      LCD_RS EQU DEVTFT;  ;PORT TO CONTROL RS PIN 17=cs+rs+low = COMMAND  A0 CONNECT TO RS	;  ;PORT TO CONTROL RS PIN 17=cs+rs+low = COMMAND  A0 CONNECT TO RS
 17)   05D7 	            		      LCD_CS EQU DEVTFT+1;  ;PORT TO CONTROL CS PIN 16=cs+rs_high  = DATA	;  ;PORT TO CONTROL CS PIN 16=cs+rs_high  = DATA
 30)   05D7 7B          		   LD A,E	;
 31)   05D8 D3 11       		   OUT (LCD_CS),A	;
 36)   05DA DB 11       		   IN A,(LCD_CS)	;
 37)   05DC C9          		   RET	;
 44)   05DD 7A          		   LD A,D  	;
 45)   05DE D3 11       		   OUT (LCD_CS),A	;
 46)   05E0 C9          		   RET	;
 52)   05E1 7A          		   LD A,D  	;
 53)   05E2 D3 10       		   OUT (LCD_RS),A	;
 54)   05E4 C9          		   RET	;
 61)   05E5 AF          		   XOR A	;
 62)   05E6 D3 10       		   OUT (LCD_RS),A  ;RS LOW = COMMAND BYTE      	;RS LOW = COMMAND BYTE
 63)   05E8 CD DD 05    		   CALL LCD_WR_BUS	;
 64)   05EB 3E 01       		   LD A,1	;
 65)   05ED D3 10       		   OUT (LCD_RS),A  ;RS HIGH  = DATA BYTE	;RS HIGH  = DATA BYTE
 66)   05EF C9          		   RET	;
 70)   05F0 16 E2       		   LD D,0xE2         ;PLL multiplier, set PLL clock to 120M	;PLL multiplier, set PLL clock to 120M
 71)   05F2 CD E1 05    		   CALL LCD_WR_COM   ;N=0x36 for 6.5M, 0x23 for 10M crystal	;N=0x36 for 6.5M, 0x23 for 10M crystal
 72)   05F5 16 23       		   LD D,0x23 ;1E	;1E
 73)   05F7 CD DD 05    		   CALL LCD_WR_DAT	;
 74)   05FA 16 02       		   LD D,0x02	;
 75)   05FC CD DD 05    		   CALL LCD_WR_DAT	;
 76)   05FF 16 54       		   LD D,0x54	;
 77)   0601 CD DD 05    		   CALL LCD_WR_DAT	;
 78)   0604 16 E0       		   LD D,0xE0         ; PLL enable    	; PLL enable
 79)   0606 CD E1 05    		   CALL LCD_WR_COM	;
 80)   0609 16 01       		   LD D,0x01	;
 81)   060B CD DD 05    		   CALL LCD_WR_DAT	;
 82)   060E 06 0A       		   LD B,10        ;delay(10);	;delay(10);
 83)   0610 CD F8 16    		   CALL DELAYMICRO	;
 84)   0613 16 E0       		   LD D,0xE0         ; PLL enable    	; PLL enable
 85)   0615 CD E1 05    		   CALL LCD_WR_COM   	;
 86)   0618 16 03       		   LD D,0x03	;
 87)   061A CD DD 05    		   CALL LCD_WR_DAT	;
 88)   061D 06 0A       		   LD B,10        ;delay(10);	;delay(10);
 89)   061F CD F8 16    		   CALL DELAYMICRO    	;
 91)   0622 16 01       		   LD D,0x01         ; software reset  	; software reset
 92)   0624 CD E1 05    		   CALL LCD_WR_COM   	;
 93)   0627 06 14       		   LD B,20       ;delay(20); MICROSECS	;delay(20); MICROSECS
 94)   0629 CD F8 16    		   CALL DELAYMICRO        	;
 95)   062C 16 E6       		   LD D,0xE6         ;PLL setting for PCLK, depends on resolution  	;PLL setting for PCLK, depends on resolution
 96)   062E CD E1 05    		   CALL LCD_WR_COM           	;
 97)   0631 16 03       		   LD D,0x03	;
 98)   0633 CD DD 05    		   CALL LCD_WR_DAT   	;
 99)   0636 16 33       		   LD D,0x33 ;FF	;FF
100)   0638 CD DD 05    		   CALL LCD_WR_DAT       	;
101)   063B 16 33       		   LD D,0x33 ;FF	;FF
102)   063D CD DD 05    		   CALL LCD_WR_DAT   	;
104)   0640 16 B0       		   LD D,0xB0         ;LCD SPECIFICATION	;LCD SPECIFICATION
105)   0642 CD E1 05    		   CALL LCD_WR_COM       	;
106)   0645 16 20       		   LD D,0x20	;
107)   0647 CD DD 05    		   CALL LCD_WR_DAT   	;
108)   064A 16 00       		   LD D,0x00	;
109)   064C CD DD 05    		   CALL LCD_WR_DAT       	;
110)   064F 16 03       		   LD D,0x03         ;Set HDP  799	;Set HDP  799
111)   0651 CD DD 05    		   CALL LCD_WR_DAT   	;
112)   0654 16 1F       		   LD D,0x1F	;
113)   0656 CD DD 05    		   CALL LCD_WR_DAT   	;
114)   0659 16 01       		   LD D,0x01         ;Set VDP  479	;Set VDP  479
115)   065B CD DD 05    		   CALL LCD_WR_DAT   	;
116)   065E 16 DF       		   LD D,0xDF	;
117)   0660 CD DD 05    		   CALL LCD_WR_DAT 	;
118)   0663 16 00       		   LD D,0x00	;
119)   0665 CD DD 05    		   CALL LCD_WR_DAT     	;
122)   0668 16 B4       		   LD D,0xB4         ;HSYNC	;HSYNC
123)   066A CD E1 05    		   CALL LCD_WR_COM       	;
124)   066D 16 04       		   LD D,0x04 ;03         ;Set HT 928	;03         ;Set HT 928
125)   066F CD DD 05    		   CALL LCD_WR_DAT   	;
126)   0672 16 1F       		   LD D,0x1F ;A0	;A0
127)   0674 CD DD 05    		   CALL LCD_WR_DAT       	;
128)   0677 16 00       		   LD D,0x00         ;Set HPS  46	;Set HPS  46
129)   0679 CD DD 05    		   CALL LCD_WR_DAT   	;
130)   067C 16 D2       		   LD D,0xD2 ;2E	;2E
131)   067E CD DD 05    		   CALL LCD_WR_DAT   	;
132)   0681 16 00       		   LD D,0x00 ;30         ;Set HPW  48	;30         ;Set HPW  48
133)   0683 CD DD 05    		   CALL LCD_WR_DAT   	;
134)   0686 16 00       		   LD D,0x00         ;Set LPS  15	;Set LPS  15
135)   0688 CD DD 05    		   CALL LCD_WR_DAT 	;
136)   068B 16 00       		   LD D,0x00 ;0F	;0F
137)   068D CD DD 05    		   CALL LCD_WR_DAT   	;
138)   0690 16 00       		   LD D,0x00	;
139)   0692 CD DD 05    		   CALL LCD_WR_DAT     	;
141)   0695 16 B6       		   LD D,0xB6         ;VSYNC	;VSYNC
142)   0697 CD E1 05    		   CALL LCD_WR_COM       	;
143)   069A 16 02       		   LD D,0x02         ;Set VT 525	;Set VT 525
144)   069C CD DD 05    		   CALL LCD_WR_DAT   	;
145)   069F 16 0C       		   LD D,0x0C ;0D	;0D
146)   06A1 CD DD 05    		   CALL LCD_WR_DAT       	;
147)   06A4 16 00       		   LD D,0x00         ;Set VPS  16	;Set VPS  16
148)   06A6 CD DD 05    		   CALL LCD_WR_DAT   	;
149)   06A9 16 22       		   LD D,0x22 ;10	;10
150)   06AB CD DD 05    		   CALL LCD_WR_DAT   	;
151)   06AE 16 00       		   LD D,0x00 ;10         ;Set VPW  16	;10         ;Set VPW  16
152)   06B0 CD DD 05    		   CALL LCD_WR_DAT   	;
153)   06B3 16 00       		   LD D,0x00         ;Set FPS  8	;Set FPS  8
154)   06B5 CD DD 05    		   CALL LCD_WR_DAT 	;
155)   06B8 16 00       		   LD D,0x00 ; 08	; 08
156)   06BA CD DD 05    		   CALL LCD_WR_DAT   	;
158)   06BD 16 B8       		   LD D,0xB8         	;
159)   06BF CD E1 05    		   CALL LCD_WR_COM           	;
160)   06C2 16 0F       		   LD D,0x0F ;07         ;GPIO3=input, GPIO[2:0]=output	;07         ;GPIO3=input, GPIO[2:0]=output
161)   06C4 CD DD 05    		   CALL LCD_WR_DAT         	;
162)   06C7 16 01       		   LD D,0x01         ;GPIO0 normal	;GPIO0 normal
163)   06C9 CD DD 05    		   CALL LCD_WR_DAT 	;
165)   06CC 16 BA       		   LD D,0xBA         	;
166)   06CE CD E1 05    		   CALL LCD_WR_COM           	;
167)   06D1 16 01       		   LD D,0x01 ;0F	;0F
168)   06D3 CD DD 05    		   CALL LCD_WR_DAT   ;GPIO[3:0] out 1	;GPIO[3:0] out 1
170)   06D6 16 36       		   LD D,0x36         ;rotation	;rotation
171)   06D8 CD E1 05    		   CALL LCD_WR_COM           	;
172)   06DB 16 08       		   LD D,0x08 ;2A         	;2A
173)   06DD CD DD 05    		   CALL LCD_WR_DAT         	;
175)   06E0 16 F0       		   LD D,0xF0         ;pixel data interface	;pixel data interface
176)   06E2 CD E1 05    		   CALL LCD_WR_COM           	;
177)   06E5 16 06       		   LD D,0x06         ;CHANGE THIS FOR 8 BIT INTERFACE  6=9BIT SEND 2 BYTES 	;CHANGE THIS FOR 8 BIT INTERFACE  6=9BIT SEND 2 BYTES
178)   06E7 CD DD 05    		   CALL LCD_WR_DAT     	;
180)   06EA 06 05       		   LD B,5       ;delay(5);	;delay(5);
181)   06EC CD F8 16    		   CALL DELAYMICRO        	;
183)   06EF 16 BC       		   LD D,0xBC         	;
184)   06F1 CD E1 05    		   CALL LCD_WR_COM           	;
185)   06F4 16 40       		   LD D,0x40	;
186)   06F6 CD DD 05    		   CALL LCD_WR_DAT   	;
187)   06F9 16 80       		   LD D,0x80	;
188)   06FB CD DD 05    		   CALL LCD_WR_DAT   	;
189)   06FE 16 40       		   LD D,0x40	;
190)   0700 CD DD 05    		   CALL LCD_WR_DAT   	;
191)   0703 16 01       		   LD D,0x01	;
192)   0705 CD DD 05    		   CALL LCD_WR_DAT       	;
193)   0708 06 05       		   LD B,5       ;delay(5);	;delay(5);
194)   070A CD F8 16    		   CALL DELAYMICRO  	;
196)   070D 16 29       		   LD D,0x29         ;display on 	;display on
197)   070F CD E1 05    		   CALL LCD_WR_COM       	;
198)   0712 16 BE       		   LD D,0xBE         ;set PWM for B/L	;set PWM for B/L
199)   0714 CD E1 05    		   CALL LCD_WR_COM                 	;
200)   0717 16 06       		   LD D,0x06	;
201)   0719 CD DD 05    		   CALL LCD_WR_DAT                 	;
202)   071C 16 F0       		   LD D,0xF0         	;
203)   071E CD DD 05    		   CALL LCD_WR_DAT   	;
204)   0721 16 01       		   LD D,0x01         	;
205)   0723 CD DD 05    		   CALL LCD_WR_DAT   	;
206)   0726 16 F0       		   LD D,0xF0         	;
207)   0728 CD DD 05    		   CALL LCD_WR_DAT   	;
208)   072B 16 00       		   LD D,0x00         	;
209)   072D CD DD 05    		   CALL LCD_WR_DAT   	;
210)   0730 16 00       		   LD D,0x00         	;
211)   0732 CD DD 05    		   CALL LCD_WR_DAT                   	;
213)   0735 16 D0       		   LD D,0xD0         	;
214)   0737 CD E1 05    		   CALL LCD_WR_COM                 	;
215)   073A 16 0D       		   LD D,0x0D         	;
216)   073C CD DD 05    		   CALL LCD_WR_DAT         	;
219)   073F 21 00 00    		   LD HL,0	;
220)   0742 E5          		   PUSH HL	;
221)   0743 E5          		   PUSH HL	;
222)   0744 21 1F 03    		   LD HL,799	;
223)   0747 E5          		   PUSH HL	;
224)   0748 21 DF 01    		   LD HL,479	;
225)   074B E5          		   PUSH HL	;
226)   074C CD 50 07    		   CALL LCD_SETXY	;
227)   074F C9          		   RET	;
244)   0750 DD 21 02 00 		   LD IX,2	;
245)   0754 DD 39       		   ADD IX,SP         	;
246)   0756 16 2A       		   LD D,0x2A         ;SEND IX PARAMS	;SEND IX PARAMS
247)   0758 CD E1 05    		   CALL LCD_WR_COM    	;
248)   075B DD 56 07    		   LD D,(IX+7)	;
249)   075E CD DD 05    		   CALL LCD_WR_DAT	;
250)   0761 DD 56 06    		   LD D,(IX+6)	;
251)   0764 CD DD 05    		   CALL LCD_WR_DAT	;
252)   0767 DD 56 03    		   LD D,(IX+3)	;
253)   076A CD DD 05    		   CALL LCD_WR_DAT	;
254)   076D DD 56 02    		   LD D,(IX+2)	;
255)   0770 CD DD 05    		   CALL LCD_WR_DAT       	;
256)   0773 16 2B       		   LD D,0x2B         ;SEND Y PARAMS	;SEND Y PARAMS
257)   0775 CD E1 05    		   CALL LCD_WR_COM   	;
258)   0778 DD 56 05    		   LD D,(IX+5)	;
259)   077B CD DD 05    		   CALL LCD_WR_DAT	;
260)   077E DD 56 04    		   LD D,(IX+4)	;
261)   0781 CD DD 05    		   CALL LCD_WR_DAT	;
262)   0784 DD 56 01    		   LD D,(IX+1)	;
263)   0787 CD DD 05    		   CALL LCD_WR_DAT	;
264)   078A DD 56 00    		   LD D,(IX)	;
265)   078D CD DD 05    		   CALL LCD_WR_DAT       	;
266)   0790 16 2C       		   LD D,0x2C         ;SEND DATA	;SEND DATA
267)   0792 CD E1 05    		   CALL LCD_WR_COM   	;
268)   0795 D1          		   POP DE	;
269)   0796 21 08 00    		   LD HL,4*2       ;REMOVE 4 PARAMS FROM STACK	;REMOVE 4 PARAMS FROM STACK
270)   0799 39          		   ADD HL,SP	;
271)   079A F9          		   LD SP,HL	;
272)   079B EB          		   EX DE,HL	;
273)   079C E9          		   JP (HL)        	;
279)   079D 54          		   LD D,H        	;
280)   079E CD DD 05    		   CALL LCD_WR_DAT 	;
281)   07A1 55          		   LD D,L	;
282)   07A2 CD DD 05    		   CALL LCD_WR_DAT 	;
283)   07A5 C9          		   RET	;
288)   07A6 16 2E       		   LD D,0x2E         ;READ DATA	;READ DATA
289)   07A8 CD E1 05    		   CALL LCD_WR_COM           	;
290)   07AB CD DA 05    		   CALL LCD_RD_DAT 	;
291)   07AE 67          		   LD H,A	;
292)   07AF CD DA 05    		   CALL LCD_RD_DAT 	;
293)   07B2 6F          		   LD L,A	;
294)   07B3 C9          		   RET    	;
300)   07B4 DD E5       		@LCD_READPIXEL: PUSH IX ; 2 PARAMS ON STACK TOTAL 4 BYTES	; 2 PARAMS ON STACK TOTAL 4 BYTES
301)   07B6 DD 21 04 00 		   LD IX,4    ;2 FOR RET ADDR AND 2 FOR PUSH IX	;2 FOR RET ADDR AND 2 FOR PUSH IX
302)   07BA DD 39       		   ADD IX,SP    	;
303)   07BC DD 66 03    		   LD H,(IX+3)   ;X	;X
304)   07BF DD 6E 02    		   LD L,(IX+2)   ;X	;X
305)   07C2 DD 56 01    		   LD D,(IX+1) ;Y	;Y
306)   07C5 DD 5E 00    		   LD E,(IX) ;Y	;Y
307)   07C8 E5          		   PUSH HL	;
308)   07C9 D5          		   PUSH DE	;
309)   07CA E5          		   PUSH HL	;
310)   07CB D5          		   PUSH DE	;
311)   07CC CD 50 07    		   CALL LCD_SETXY	;
312)   07CF CD A6 07    		   CALL LCD_GETPIXEL	;
313)   07D2 E5          		   PUSH HL    	;
314)   07D3 CD 05 08    		   CALL LCD_CLRXY	;
315)   07D6 D1          		   POP DE  ;RESULT COLOR	;RESULT COLOR
316)   07D7 DD E1       		   POP IX	;
317)   07D9 C1          		   POP BC  ;RET ADDR	;RET ADDR
318)   07DA 21 04 00    		   LD HL,2*2        ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
319)   07DD 39          		   ADD HL,SP	;
320)   07DE F9          		   LD SP,HL	;
321)   07DF EB          		   EX DE,HL ;HL RESULT	;HL RESULT
322)   07E0 C5          		   PUSH BC  ;RET ADDR ON STACK	;RET ADDR ON STACK
323)   07E1 C9          		   RET	;
327)   07E2 DD 21 02 00 		   LD IX,2     ;setXY(x, y, x, y);	;setXY(x, y, x, y);
328)   07E6 DD 39       		   ADD IX,SP	;
329)   07E8 DD 66 03    		   LD H,(IX+3)   ;X	;X
330)   07EB DD 6E 02    		   LD L,(IX+2)   ;X	;X
331)   07EE DD 56 01    		   LD D,(IX+1) ;Y	;Y
332)   07F1 DD 5E 00    		   LD E,(IX) ;Y	;Y
333)   07F4 E5          		   PUSH HL	;
334)   07F5 D5          		   PUSH DE	;
335)   07F6 E5          		   PUSH HL	;
336)   07F7 D5          		   PUSH DE	;
337)   07F8 CD 50 07    		   CALL LCD_SETXY	;
338)   07FB 2A 01 83    		   LD HL,(FCOLOR)	;
339)   07FE CD 9D 07    		   CALL LCD_SETPIXEL	;
340)   0801 CD 05 08    		   CALL LCD_CLRXY	;
341)   0804 C9          		   RET	;
344)   0805 21 00 00    		    LD HL,0	;
345)   0808 E5          		    PUSH HL	;
346)   0809 E5          		    PUSH HL	;
347)   080A 21 1F 03    		    LD HL,LCD_WIDTH	;
348)   080D E5          		    PUSH HL	;
349)   080E 21 DF 01    		    LD HL,LCD_HEIGHT	;
350)   0811 E5          		    PUSH HL	;
351)   0812 CD 50 07    		    CALL LCD_SETXY	;
352)   0815 C9          		    RET	;
356)   0816 DD 21 02 00 		     LD IX,2	;
357)   081A DD 39       		     ADD IX,SP	;
358)   081C DD 66 05    		     LD H,(IX+5)   ;X  	;X
359)   081F DD 6E 04    		     LD L,(IX+4)   ;X	;X
360)   0822 DD 56 03    		     LD D,(IX+3)   ;Y	;Y
361)   0825 DD 5E 02    		     LD E,(IX+2)   ;Y	;Y
362)   0828 DD 46 01    		     LD B,(IX+1)   ;LENGTH	;LENGTH
363)   082B DD 4E 00    		     LD C,(IX)     ;LENGTH	;LENGTH
366)   082E E5          		     PUSH HL	;
367)   082F 21 00 00    		     LD HL,0	;
368)   0832 B7          		     OR A           ;CLEAR CARRY	;CLEAR CARRY
369)   0833 ED 42       		     SBC HL,BC      ;CHECK IF LENGTH<0	;CHECK IF LENGTH<0
370)   0835 38 0A       		     JR C,POSH1	;
371)   0837 AF          		     XOR A          ;l=-l	;l=-l
372)   0838 91          		  SUB C	;
373)   0839 4F          		  LD C,A	;
374)   083A 9F          		  SBC A,A	;
375)   083B 90          		  SUB B	;
376)   083C 47          		  LD B,A	;
377)   083D E1          		  POP HL	;
378)   083E ED 42       		     SBC HL,BC       ;x -= l;	;x -= l;
379)   0840 E5          		     PUSH HL                    	;
380)   0841 E1          		POSH1: POP HL	;
381)   0842 E5          		  PUSH HL	;
382)   0843 D5          		     PUSH DE	;
383)   0844 09          		     ADD HL,BC	;
384)   0845 E5          		     PUSH HL	;
385)   0846 D5          		     PUSH DE	;
386)   0847 CD 50 07    		     CALL LCD_SETXY   ;setXY(x, y, x+l, y);	;setXY(x, y, x+l, y);
387)   084A 2A 01 83    		     LD HL,(FCOLOR)    	;
388)   084D CD 9D 07    		NXTH1: CALL LCD_SETPIXEL	;
389)   0850 0B          		     DEC BC	;
390)   0851 79          		     LD A,C	;
391)   0852 B0          		     OR B	;
392)   0853 20 F8       		     JR NZ, NXTH1     	;
393)   0855 CD 05 08    		     CALL LCD_CLRXY	;
394)   0858 D1          		     POP DE	;
395)   0859 21 06 00    		     LD HL,6       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
396)   085C 39          		     ADD HL,SP	;
397)   085D F9          		     LD SP,HL      	;
398)   085E EB          		     EX DE,HL	;
399)   085F E9          		     JP (HL)	;
405)   0860 DD 21 02 00 		     LD IX,2	;
406)   0864 DD 39       		     ADD IX,SP	;
407)   0866 DD 56 05    		     LD D,(IX+5)   ;X  	;X
408)   0869 DD 5E 04    		     LD E,(IX+4)   ;X	;X
409)   086C DD 66 03    		     LD H,(IX+3)   ;Y	;Y
410)   086F DD 6E 02    		     LD L,(IX+2)   ;Y	;Y
411)   0872 DD 46 01    		     LD B,(IX+1)   ;LENGTH	;LENGTH
412)   0875 DD 4E 00    		     LD C,(IX)     ;LENGTH     	;LENGTH
413)   0878 E5          		     PUSH HL	;
414)   0879 21 00 00    		     LD HL,0	;
415)   087C B7          		     OR A           ;CLEAR CARRY	;CLEAR CARRY
416)   087D ED 42       		     SBC HL,BC      ;CHECK IF LENGTH<0	;CHECK IF LENGTH<0
417)   087F 38 0A       		     JR C,POSV1	;
418)   0881 AF          		     XOR A          ;l=-l	;l=-l
419)   0882 91          		  SUB C	;
420)   0883 4F          		  LD C,A	;
421)   0884 9F          		  SBC A,A	;
422)   0885 90          		  SUB B	;
423)   0886 47          		  LD B,A	;
424)   0887 E1          		  POP HL	;
425)   0888 ED 42       		     SBC HL,BC       ;Y -= l;	;Y -= l;
426)   088A E5          		     PUSH HL                   	;
427)   088B E1          		POSV1: POP HL	;
428)   088C D5          		  PUSH DE	;
429)   088D E5          		     PUSH HL	;
430)   088E D5          		     PUSH DE	;
431)   088F 09          		     ADD HL,BC	;
432)   0890 E5          		     PUSH HL	;
433)   0891 CD 50 07    		     CALL LCD_SETXY   ;setXY(x, y, x, y+l);	;setXY(x, y, x, y+l);
434)   0894 2A 01 83    		     LD HL,(FCOLOR)    	;
435)   0897 CD 9D 07    		NXTV1: CALL LCD_SETPIXEL	;
436)   089A 0B          		     DEC BC	;
437)   089B 79          		     LD A,C	;
438)   089C B0          		     OR B	;
439)   089D 20 F8       		     JR NZ, NXTV1     	;
440)   089F CD 05 08    		     CALL LCD_CLRXY	;
441)   08A2 D1          		     POP DE	;
442)   08A3 21 06 00    		     LD HL,6       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
443)   08A6 39          		     ADD HL,SP	;
444)   08A7 F9          		     LD SP,HL	;
445)   08A8 EB          		     EX DE,HL	;
446)   08A9 E9          		     JP (HL)	;
450)   08AA DD 21 02 00 		     LD IX,2	;
451)   08AE DD 39       		     ADD IX,SP	;
461)   08B0 DD 66 05    		     LD H,(IX+5)   ;Y1	;Y1
462)   08B3 DD 6E 04    		     LD L,(IX+4)   ;Y1	;Y1
463)   08B6 DD 56 01    		     LD D,(IX+1)   ;Y2	;Y2
464)   08B9 DD 5E 00    		     LD E,(IX)     ;Y2	;Y2
465)   08BC B7          		     OR A	;
466)   08BD ED 52       		     SBC HL,DE	;
467)   08BF 20 17       		     JR NZ,YNOTEQ	;
469)   08C1 DD 46 07    		     LD B,(IX+7)   ;X1	;X1
470)   08C4 DD 4E 06    		     LD C,(IX+6)   ;X1	;X1
471)   08C7 C5          		     PUSH BC       ;X1 1ST PARAM ON STACK	;X1 1ST PARAM ON STACK
472)   08C8 D5          		     PUSH DE    ;Y 2ND PARAM ON STACK	;Y 2ND PARAM ON STACK
473)   08C9 DD 66 03    		     LD H,(IX+3)   ;X2	;X2
474)   08CC DD 6E 02    		     LD L,(IX+2)   ;X2       	;X2
475)   08CF ED 42       		     SBC HL,BC     ;X2-X1 = LENGTH OF HORIZ LINE	;X2-X1 = LENGTH OF HORIZ LINE
476)   08D1 E5          		     PUSH HL       ;LENGTH 3RD PARAM ON STACK 	;LENGTH 3RD PARAM ON STACK
477)   08D2 CD 16 08    		     CALL LCD_DRAWHLINE	;
478)   08D5 C3 85 0A    		     JP DLNEX	;
480)   08D8 DD 66 07    		     LD H,(IX+7)   ;X1	;X1
481)   08DB DD 6E 06    		     LD L,(IX+6)   ;X1	;X1
482)   08DE DD 56 03    		     LD D,(IX+3)   ;X2	;X2
483)   08E1 DD 5E 02    		     LD E,(IX+2)   ;X2 	;X2
484)   08E4 B7          		     OR A	;
485)   08E5 ED 52       		     SBC HL,DE	;
486)   08E7 20 17       		     JR NZ,XNOTEQ	;
488)   08E9 D5          		     PUSH DE       ;X2=X1 1ST PARAM ON STACK	;X2=X1 1ST PARAM ON STACK
489)   08EA DD 46 05    		     LD B,(IX+5)   ;Y1	;Y1
490)   08ED DD 4E 04    		     LD C,(IX+4)   ;Y1	;Y1
491)   08F0 C5          		     PUSH BC       ;Y1 2ND PARAM ON STACK	;Y1 2ND PARAM ON STACK
492)   08F1 DD 66 01    		     LD H,(IX+1)   ;Y2	;Y2
493)   08F4 DD 6E 00    		     LD L,(IX)   ;Y2       	;Y2
494)   08F7 ED 42       		     SBC HL,BC     ;Y2-Y1 = LENGTH OF VERT LINE	;Y2-Y1 = LENGTH OF VERT LINE
495)   08F9 E5          		     PUSH HL       ;LENGTH 3RD PARAM ON STACK 	;LENGTH 3RD PARAM ON STACK
496)   08FA CD 60 08    		     CALL LCD_DRAWVLINE	;
497)   08FD C3 85 0A    		     JP DLNEX	;
500)   0900 38 04       		     JR C,X2GTX1	;
502)   0902 AF          		     XOR A  	;
503)   0903 3D          		     DEC A  ;XSTEP=-1	;XSTEP=-1
504)   0904 18 0D       		     JR DLNXT1	;
507)   0906 D5          		     PUSH DE	;
508)   0907 E1          		     POP HL	;
509)   0908 DD 56 07    		     LD D,(IX+7)   ;X1	;X1
510)   090B DD 5E 06    		     LD E,(IX+6)   ;X1 	;X1
511)   090E B7          		     OR A     	;
512)   090F ED 52       		     SBC HL,DE     ;X2-X1 ON HL	;X2-X1 ON HL
514)   0911 3E 01       		     LD A,1        ;XSTEP=1	;XSTEP=1
516)   0913 06 00       		     LD B,0	;
517)   0915 0E 00       		     LD C,0	;
518)   0917 C5          		     PUSH BC       ;T	;T
519)   0918 E5          		     PUSH HL       ;DX	;DX
520)   0919 FE 01       		     CP 1	;
521)   091B 28 02       		     JR Z,DLXMINUS1	;
522)   091D 06 FF       		     LD B,0XFF	;
523)   091F 4F          		DLXMINUS1:LD C,A     	;
524)   0920 C5          		     PUSH BC       ;XSTEP	;XSTEP
525)   0921 DD 66 05    		     LD H,(IX+5)   ;Y1	;Y1
526)   0924 DD 6E 04    		     LD L,(IX+4)   ;Y1	;Y1
527)   0927 DD 56 01    		     LD D,(IX+1)   ;Y2	;Y2
528)   092A DD 5E 00    		     LD E,(IX)     ;Y2      	;Y2
529)   092D B7          		     OR A	;
530)   092E ED 52       		     SBC HL,DE	;
531)   0930 38 04       		     JR C,Y2GTY1  ;HL=Y1-Y2	;HL=Y1-Y2
532)   0932 AF          		     XOR A	;
533)   0933 3D          		     DEC A         ;YSTEP=-1	;YSTEP=-1
534)   0934 18 0F       		     JR DLNXT2	;
537)   0936 D5          		     PUSH DE	;
538)   0937 E1          		     POP HL	;
539)   0938 DD 56 05    		     LD D,(IX+5)   ;Y1	;Y1
540)   093B DD 5E 04    		     LD E,(IX+4)   ;Y1  	;Y1
541)   093E B7          		     OR A	;
542)   093F ED 52       		     SBC HL,DE  ;HL=Y2-Y1    HL=DY      	;HL=Y2-Y1    HL=DY
543)   0941 06 00       		     LD B,0	;
544)   0943 3E 01       		     LD A,1        ;YSTEP=1	;YSTEP=1
546)   0945 FE 01       		     CP 1	;
547)   0947 28 02       		     JR Z,DLYMINUS1	;
548)   0949 06 FF       		     LD B,0XFF	;
550)   094B 4F          		     LD C,A      	;
551)   094C E5          		     PUSH HL       ;DY	;DY
552)   094D C5          		     PUSH BC       ;YSTEP   	;YSTEP
553)   094E FD 21 00 00 		     LD IY,0	;
554)   0952 FD 39       		     ADD IY,SP	;
569)   0954 FD 56 07    		     LD D,(IY+7)    ;DX	;DX
570)   0957 FD 5E 06    		     LD E,(IY+6)    ;DX	;DX
571)   095A B7          		     OR A	;
572)   095B ED 52       		     SBC HL,DE      ;DY-DX	;DY-DX
573)   095D DA F2 09    		     JP C,DXGTDY	;
574)   0960 CA F2 09    		     JP Z,DXGTDY	;
576)   0963 19          		     ADD HL,DE      ;HL=DY	;HL=DY
577)   0964 44          		     LD B,H	;
578)   0965 4D          		     LD C,L	;
579)   0966 CB 38       		     SRL B	;
580)   0968 CB 19       		     RR C           ;(dy >> 1)	;(dy >> 1)
581)   096A 21 00 00    		     LD HL,0	;
582)   096D ED 42       		     SBC HL,BC      ;t = - (dy >> 1);	;t = - (dy >> 1);
583)   096F FD 74 09    		     LD (IY+9),H    ;SAVE T	;SAVE T
584)   0972 FD 75 08    		     LD (IY+8),L    ;SAVE T	;SAVE T
586)   0975 DD 56 05    		     LD D,(IX+5)   ;ROW	;ROW
587)   0978 DD 5E 04    		     LD E,(IX+4)   ;ROW=Y1	;ROW=Y1
588)   097B DD 66 07    		     LD H,(IX+7)   ;COL	;COL
589)   097E DD 6E 06    		     LD L,(IX+6)   ;COL=X1	;COL=X1
590)   0981 D5          		     PUSH DE	;
591)   0982 DD E5       		     PUSH IX	;
592)   0984 E5          		     PUSH HL	;
593)   0985 D5          		     PUSH DE	;
594)   0986 E5          		     PUSH HL	;
595)   0987 D5          		     PUSH DE	;
596)   0988 CD 50 07    		     CALL LCD_SETXY	;
597)   098B 2A 01 83    		     LD HL,(FCOLOR)    	;
598)   098E CD 9D 07    		     CALL LCD_SETPIXEL	;
599)   0991 DD E1       		     POP IX	;
600)   0993 D1          		     POP DE	;
601)   0994 DD 66 01    		     LD H,(IX+1)   ;Y2	;Y2
602)   0997 DD 6E 00    		     LD L,(IX)     ;Y2 	;Y2
603)   099A ED 52       		     SBC HL,DE     ; ROW=Y2	; ROW=Y2
604)   099C CA 80 0A    		     JP Z,DLEXIT	;
605)   099F FD 46 01    		     LD B,(IY+1)   ;YSTEP HI	;YSTEP HI
606)   09A2 FD 4E 00    		     LD C,(IY)     ;YSTEP LO	;YSTEP LO
607)   09A5 EB          		     EX DE,HL	;
608)   09A6 09          		     ADD HL,BC     ;row += ystep;	;row += ystep;
609)   09A7 DD 74 05    		     LD (IX+5),H   ;SAVE ROW	;SAVE ROW
610)   09AA DD 75 04    		     LD (IX+4),L   ;   	;
612)   09AD FD 56 09    		     LD D,(IY+9)   ; T	; T
613)   09B0 FD 5E 08    		     LD E,(IY+8)   ; T      	; T
614)   09B3 FD 66 07    		     LD H,(IY+7)   ;DX	;DX
615)   09B6 FD 6E 06    		     LD L,(IY+6)   ;DX	;DX
616)   09B9 19          		     ADD HL,DE	;
617)   09BA FD 74 09    		     LD (IY+9),H   ;t += dx;	;t += dx;
618)   09BD FD 75 08    		     LD (IY+8),L	;
619)   09C0 EB          		     EX DE,HL	;
620)   09C1 21 00 80    		     LD HL,$8000	;
621)   09C4 ED 52       		     SBC HL,DE     ;CHECK IF T<0	;CHECK IF T<0
622)   09C6 38 AD       		     JR C,DLAGN1   ; CARRY SET IF NEGATIVE	; CARRY SET IF NEGATIVE
623)   09C8 FD 46 05    		     LD B,(IY+5)   ;XSTEP HI	;XSTEP HI
624)   09CB FD 4E 04    		     LD C,(IY+4)   ;XSTEP LO	;XSTEP LO
625)   09CE DD 66 07    		     LD H,(IX+7)   ;COL HI	;COL HI
626)   09D1 DD 6E 06    		     LD L,(IX+6)   ;COL LO	;COL LO
627)   09D4 09          		     ADD HL,BC     ;col += xstep;	;col += xstep;
628)   09D5 DD 74 07    		     LD (IX+7),H   ;SAVE COL	;SAVE COL
629)   09D8 DD 75 06    		     LD (IX+6),L   ;         	;
631)   09DB FD 66 09    		     LD H,(IY+9)   ; T	; T
632)   09DE FD 6E 08    		     LD L,(IY+8)   ; T      	; T
633)   09E1 FD 46 03    		     LD B,(IY+3)   ;DY	;DY
634)   09E4 FD 4E 02    		     LD C,(IY+2)   ;DY	;DY
635)   09E7 ED 42       		     SBC HL,BC	;
636)   09E9 FD 74 09    		     LD (IY+9),H   ;t -= dY;	;t -= dY;
637)   09EC FD 75 08    		     LD (IY+8),L       	;
638)   09EF C3 75 09    		     JP DLAGN1	;
640)   09F2 19          		     ADD HL,DE      ;HL=DY DE=DX	;HL=DY DE=DX
641)   09F3 42          		     LD B,D	;
642)   09F4 4B          		     LD C,E	;
643)   09F5 CB 38       		     SRL B	;
644)   09F7 CB 19       		     RR C           ;(dX >> 1)	;(dX >> 1)
645)   09F9 21 00 00    		     LD HL,0	;
646)   09FC ED 42       		     SBC HL,BC      ;t = - (dX >> 1);	;t = - (dX >> 1);
647)   09FE FD 74 09    		     LD (IY+9),H    ;SAVE T	;SAVE T
648)   0A01 FD 75 08    		     LD (IY+8),L    ;SAVE T	;SAVE T
650)   0A04 DD 56 05    		     LD D,(IX+5)   ;ROW	;ROW
651)   0A07 DD 5E 04    		     LD E,(IX+4)   ;ROW=Y1	;ROW=Y1
652)   0A0A DD 66 07    		     LD H,(IX+7)   ;COL	;COL
653)   0A0D DD 6E 06    		     LD L,(IX+6)   ;COL=X1	;COL=X1
654)   0A10 E5          		     PUSH HL       ;SAVE COL	;SAVE COL
655)   0A11 DD E5       		     PUSH IX	;
656)   0A13 E5          		     PUSH HL	;
657)   0A14 D5          		     PUSH DE	;
658)   0A15 E5          		     PUSH HL	;
659)   0A16 D5          		     PUSH DE	;
660)   0A17 CD 50 07    		     CALL LCD_SETXY	;
661)   0A1A 2A 01 83    		     LD HL,(FCOLOR)    	;
662)   0A1D CD 9D 07    		     CALL LCD_SETPIXEL	;
663)   0A20 DD E1       		     POP IX	;
664)   0A22 D1          		     POP DE        ;RETRIEVE COL	;RETRIEVE COL
665)   0A23 DD 66 03    		     LD H,(IX+3)   ;X2	;X2
666)   0A26 DD 6E 02    		     LD L,(IX+2)   ;X2 	;X2
667)   0A29 ED 52       		     SBC HL,DE     ; COL=X2?	; COL=X2?
668)   0A2B 28 53       		     JR Z,DLEXIT	;
669)   0A2D EB          		     EX DE,HL      ;HL=COL	;HL=COL
670)   0A2E FD 46 05    		     LD B,(IY+5)   ;XSTEP HI	;XSTEP HI
671)   0A31 FD 4E 04    		     LD C,(IY+4)   ;XSTEP LO	;XSTEP LO
672)   0A34 09          		     ADD HL,BC     ;col += xstep;	;col += xstep;
673)   0A35 DD 74 07    		     LD (IX+7),H   ;SAVE COL	;SAVE COL
674)   0A38 DD 75 06    		     LD (IX+6),L   ;   	;
675)   0A3B FD 56 09    		     LD D,(IY+9)   ; T	; T
676)   0A3E FD 5E 08    		     LD E,(IY+8)   ; T      	; T
677)   0A41 FD 66 03    		     LD H,(IY+3)   ;DY	;DY
678)   0A44 FD 6E 02    		     LD L,(IY+2)   ;DY	;DY
679)   0A47 19          		     ADD HL,DE	;
680)   0A48 FD 74 09    		     LD (IY+9),H   ;t += dY;	;t += dY;
681)   0A4B FD 75 08    		     LD (IY+8),L	;
682)   0A4E EB          		     EX DE,HL      ;T=DE	;T=DE
683)   0A4F 21 00 80    		     LD HL,$8000  	;
684)   0A52 ED 52       		     SBC HL,DE    ;CHECK IF T<0	;CHECK IF T<0
685)   0A54 38 AE       		     JR C,DLAGN2  ;CARRY SET IF NEGATIVE    	;CARRY SET IF NEGATIVE
686)   0A56 FD 46 01    		     LD B,(IY+1)   ;YSTEP HI	;YSTEP HI
687)   0A59 FD 4E 00    		     LD C,(IY)     ;YSTEP LO	;YSTEP LO
688)   0A5C DD 66 05    		     LD H,(IX+5)   ;ROW HI	;ROW HI
689)   0A5F DD 6E 04    		     LD L,(IX+4)   ;ROW LO	;ROW LO
690)   0A62 09          		     ADD HL,BC     ;ROW += Ystep;	;ROW += Ystep;
691)   0A63 DD 74 05    		     LD (IX+5),H   ;SAVE COL	;SAVE COL
692)   0A66 DD 75 04    		     LD (IX+4),L   ;         	;
694)   0A69 FD 66 09    		     LD H,(IY+9)   ; T	; T
695)   0A6C FD 6E 08    		     LD L,(IY+8)   ; T      	; T
696)   0A6F FD 46 07    		     LD B,(IY+7)   ;DX	;DX
697)   0A72 FD 4E 06    		     LD C,(IY+6)   ;DX	;DX
698)   0A75 ED 42       		     SBC HL,BC	;
699)   0A77 FD 74 09    		     LD (IY+9),H   ;t -= dX;	;t -= dX;
700)   0A7A FD 75 08    		     LD (IY+8),L       	;
701)   0A7D C3 04 0A    		     JP DLAGN2	;
704)   0A80 21 0A 00    		     LD HL,5*2     ;REMOVE 5 IY PARAMS FROM STACK	;REMOVE 5 IY PARAMS FROM STACK
705)   0A83 39          		     ADD HL,SP     ;	;
706)   0A84 F9          		     LD SP,HL           	;
707)   0A85 D1          		DLNEX:POP DE       ;RET ADDR	;RET ADDR
708)   0A86 21 08 00    		     LD HL,4*2       ;REMOVE 4 PARAMS FROM STACK	;REMOVE 4 PARAMS FROM STACK
709)   0A89 39          		     ADD HL,SP	;
710)   0A8A F9          		     LD SP,HL     	;
711)   0A8B EB          		     EX DE,HL	;
712)   0A8C E9          		     JP (HL)	;
717)   0A8D C5          		@PLOTP:PUSH BC      ;SAVE BC	;SAVE BC
718)   0A8E DD E5       		     PUSH IX	;
720)   0A90 D5          		     PUSH DE	;
721)   0A91 E5          		     PUSH HL	;
722)   0A92 D5          		     PUSH DE	;
723)   0A93 E5          		     PUSH HL	;
724)   0A94 CD 50 07    		     CALL LCD_SETXY      	;
725)   0A97 2A 01 83    		     LD HL,(FCOLOR)	;
726)   0A9A CD 9D 07    		     CALL LCD_SETPIXEL  	;
728)   0A9D DD E1       		     POP IX	;
729)   0A9F C1          		     POP BC        ;RESTORE BC	;RESTORE BC
730)   0AA0 C9          		     RET   	;
735)   0AA1 E1          		     POP HL         ;GET THE RETURN ADDRESS	;GET THE RETURN ADDRESS
736)   0AA2 D5          		     PUSH DE        ;F VAR 	;F VAR
737)   0AA3 D5          		     PUSH DE        ;DDF_X 	;DDF_X
738)   0AA4 D5          		     PUSH DE        ;DDF_Y	;DDF_Y
739)   0AA5 D5          		     PUSH DE        ;X1	;X1
740)   0AA6 D5          		     PUSH DE        ;Y1	;Y1
741)   0AA7 E5          		     PUSH HL        ;RET ADDR	;RET ADDR
742)   0AA8 DD 21 02 00 		     LD IX,2	;
743)   0AAC DD 39       		     ADD IX,SP	;
761)   0AAE AF          		     XOR A	;
762)   0AAF DD 56 0B    		     LD D,(IX+11)    ;R	;R
763)   0AB2 DD 5E 0A    		     LD E,(IX+10)    ;R	;R
764)   0AB5 DD 72 01    		     LD (IX+1),D     ;Y1=R	;Y1=R
765)   0AB8 DD 73 00    		     LD (IX+0),E	;
766)   0ABB 21 01 00    		     LD HL,1	;
767)   0ABE DD 74 07    		     LD (IX+7),H     ;DDF_X=1	;DDF_X=1
768)   0AC1 DD 75 06    		     LD (IX+6),L	;
769)   0AC4 DD 74 03    		     LD (IX+3),H     ;X1=0	;X1=0
770)   0AC7 DD 74 02    		     LD (IX+2),H      	;
771)   0ACA ED 52       		     SBC HL,DE	;
772)   0ACC DD 74 09    		     LD (IX+9),H     ;F	;F
773)   0ACF DD 75 08    		     LD (IX+8),L     ;F	;F
775)   0AD2 EB          		     EX DE,HL        ;HL=RADIUS	;HL=RADIUS
776)   0AD3 29          		     ADD HL,HL       ;2*R	;2*R
777)   0AD4 EB          		     EX DE,HL	;
778)   0AD5 21 00 00    		     LD HL,0	;
779)   0AD8 ED 52       		     SBC HL,DE          ;-2*R	;-2*R
780)   0ADA DD 74 05    		     LD (IX+5),H	;
781)   0ADD DD 75 04    		     LD (IX+4),L     ;DDF_Y	;DDF_Y
783)   0AE0 DD 66 0D    		     LD H,(IX+13)    ;Y	;Y
784)   0AE3 DD 6E 0C    		     LD L,(IX+12)	;
785)   0AE6 E5          		     PUSH HL         ;SAVE Y	;SAVE Y
786)   0AE7 DD 56 0B    		     LD D,(IX+11)    ;R	;R
787)   0AEA DD 5E 0A    		     LD E,(IX+10)	;
788)   0AED D5          		     PUSH DE         ;SAVE R	;SAVE R
789)   0AEE 19          		     ADD HL,DE       ;Y+R      	;Y+R
790)   0AEF DD 56 0F    		     LD D,(IX+15)    ;X	;X
791)   0AF2 DD 5E 0E    		     LD E,(IX+14)	;
792)   0AF5 D5          		     PUSH DE         ;SAVE X	;SAVE X
794)   0AF6 CD 8D 0A    		     CALL PLOTP      	;
796)   0AF9 D1          		     POP DE        ;GET X	;GET X
797)   0AFA C1          		     POP BC        ;GET R	;GET R
798)   0AFB E1          		     POP HL        ;GET Y	;GET Y
799)   0AFC E5          		     PUSH HL       ;SAVE VARS	;SAVE VARS
800)   0AFD C5          		     PUSH BC	;
801)   0AFE D5          		     PUSH DE	;
802)   0AFF AF          		     XOR A	;
803)   0B00 ED 42       		     SBC HL,BC     ;	;
805)   0B02 CD 8D 0A    		     CALL PLOTP      	;
807)   0B05 E1          		    POP HL        ;GET X	;GET X
808)   0B06 C1          		    POP BC        ;GET R	;GET R
809)   0B07 D1          		    POP DE        ;GET Y	;GET Y
810)   0B08 D5          		    PUSH DE       ;SAVE VARS	;SAVE VARS
811)   0B09 C5          		    PUSH BC	;
812)   0B0A E5          		    PUSH HL	;
813)   0B0B AF          		    XOR A	;
814)   0B0C ED 4A       		    ADC HL,BC	;
815)   0B0E EB          		    EX DE,HL	;
817)   0B0F CD 8D 0A    		     CALL PLOTP      	;
819)   0B12 E1          		    POP HL        ;GET X	;GET X
820)   0B13 C1          		    POP BC        ;GET R	;GET R
821)   0B14 D1          		    POP DE        ;GET Y	;GET Y
822)   0B15 AF          		    XOR A	;
823)   0B16 ED 42       		    SBC HL,BC	;
824)   0B18 EB          		    EX DE,HL	;
826)   0B19 CD 8D 0A    		     CALL PLOTP      	;
829)   0B1C DD 66 03    		CIRC_AGN:LD H,(IX+3)   ;X1	;X1
830)   0B1F DD 6E 02    		     LD L,(IX+2)    ;X1	;X1
831)   0B22 DD 56 01    		     LD D,(IX+1)    ;Y1	;Y1
832)   0B25 DD 5E 00    		     LD E,(IX+0)    ;Y1	;Y1
833)   0B28 AF          		     XOR A	;
834)   0B29 ED 52       		     SBC HL,DE	;
835)   0B2B D2 1A 0C    		     JP NC,CIRC_EXIT	;
837)   0B2E 19          		    ADD HL,DE	;
838)   0B2F E5          		    PUSH HL        ;SAVE X1	;SAVE X1
839)   0B30 D5          		    PUSH DE        ;SAVE Y1	;SAVE Y1
840)   0B31 21 00 00    		    LD HL,0	;
841)   0B34 AF          		    XOR A	;
844)   0B35 DD 7E 09    		    LD A,(IX+9)     ;F HI BYTE	;F HI BYTE
845)   0B38 FE 50       		    CP 80	;
846)   0B3A 30 26       		    JR NC,CIRC_SKIP	;
847)   0B3C 28 24       		    JR Z,CIRC_SKIP	;
851)   0B3E D1          		    POP DE        ;Y1	;Y1
852)   0B3F 1B          		    DEC DE	;
853)   0B40 DD 72 01    		    LD (IX+1),D   ;SAVE Y1	;SAVE Y1
854)   0B43 DD 73 00    		    LD (IX+0),E	;
855)   0B46 D5          		    PUSH DE       ;Y1	;Y1
856)   0B47 DD 66 05    		    LD H,(IX+5)   ;DDF_Y	;DDF_Y
857)   0B4A DD 6E 04    		    LD L,(IX+4)   	;
858)   0B4D 23          		    INC HL	;
859)   0B4E 23          		    INC HL	;
860)   0B4F DD 74 05    		    LD (IX+5),H   ;SAVE DDF_Y	;SAVE DDF_Y
861)   0B52 DD 75 04    		    LD (IX+4),L	;
862)   0B55 DD 56 09    		    LD D,(IX+9)   ;F	;F
863)   0B58 DD 5E 08    		    LD E,(IX+8)	;
864)   0B5B 19          		    ADD HL,DE	;
865)   0B5C DD 74 09    		    LD (IX+9),H    ;SAVE F	;SAVE F
866)   0B5F DD 75 08    		    LD (IX+8),L          	;
870)   0B62 C1          		   POP BC       ;Y1	;Y1
871)   0B63 E1          		   POP HL       ;X1	;X1
872)   0B64 23          		   INC HL	;
873)   0B65 DD 74 03    		   LD (IX+3),H  ;SAVE X1	;SAVE X1
874)   0B68 DD 75 02    		   LD (IX+2),L	;
875)   0B6B E5          		   PUSH HL      ;X1	;X1
876)   0B6C DD 66 07    		    LD H,(IX+7)   ;DDF_X	;DDF_X
877)   0B6F DD 6E 06    		    LD L,(IX+6)   	;
878)   0B72 23          		    INC HL	;
879)   0B73 23          		    INC HL	;
880)   0B74 DD 74 07    		    LD (IX+7),H   ;SAVE DDF_X	;SAVE DDF_X
881)   0B77 DD 75 06    		    LD (IX+6),L	;
882)   0B7A DD 56 09    		    LD D,(IX+9)   ;F	;F
883)   0B7D DD 5E 08    		    LD E,(IX+8)	;
884)   0B80 19          		    ADD HL,DE	;
885)   0B81 DD 74 09    		    LD (IX+9),H    ;SAVE F	;SAVE F
886)   0B84 DD 75 08    		    LD (IX+8),L      	;
889)   0B87 E1          		     POP HL        ;X1	;X1
890)   0B88 E5          		     PUSH HL	;
891)   0B89 DD 56 0F    		     LD D,(IX+15)  ;X	;X
892)   0B8C DD 5E 0E    		     LD E,(IX+14)	;
893)   0B8F D5          		     PUSH DE	;
894)   0B90 19          		     ADD HL,DE	;
895)   0B91 EB          		     EX DE,HL      ;DE=X+X1	;DE=X+X1
896)   0B92 DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
897)   0B95 DD 6E 0C    		     LD L,(IX+12)	;
898)   0B98 09          		     ADD HL,BC     ;HL=Y+Y1	;HL=Y+Y1
900)   0B99 CD 8D 0A    		     CALL PLOTP	;
902)   0B9C E1          		   POP HL        ;X	;X
903)   0B9D D1          		   POP DE        ;X1	;X1
904)   0B9E D5          		   PUSH DE	;
905)   0B9F E5          		   PUSH HL	;
906)   0BA0 AF          		   XOR A	;
907)   0BA1 ED 52       		   SBC HL,DE	;
908)   0BA3 EB          		   EX DE,HL      ;DE=X-X1	;DE=X-X1
909)   0BA4 DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
910)   0BA7 DD 6E 0C    		     LD L,(IX+12)	;
911)   0BAA 09          		     ADD HL,BC     ;HL=Y+Y1	;HL=Y+Y1
913)   0BAB CD 8D 0A    		     CALL PLOTP	;
915)   0BAE E1          		   POP HL        ;X	;X
916)   0BAF D1          		   POP DE        ;X1 	;X1
917)   0BB0 D5          		   PUSH DE	;
918)   0BB1 E5          		   PUSH HL	;
919)   0BB2 19          		   ADD HL,DE	;
920)   0BB3 EB          		   EX DE,HL      ;DE=X+X1	;DE=X+X1
921)   0BB4 DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
922)   0BB7 DD 6E 0C    		     LD L,(IX+12)	;
923)   0BBA AF          		     XOR A	;
924)   0BBB ED 42       		     SBC HL,BC     ;HL=Y+Y1	;HL=Y+Y1
926)   0BBD CD 8D 0A    		     CALL PLOTP	;
928)   0BC0 E1          		   POP HL        ;X	;X
929)   0BC1 D1          		   POP DE        ;X1  	;X1
930)   0BC2 D5          		   PUSH DE	;
931)   0BC3 E5          		   PUSH HL	;
932)   0BC4 AF          		   XOR A	;
933)   0BC5 ED 52       		   SBC HL,DE	;
934)   0BC7 EB          		   EX DE,HL      ;DE=X-X1	;DE=X-X1
935)   0BC8 DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
936)   0BCB DD 6E 0C    		     LD L,(IX+12)	;
937)   0BCE AF          		     XOR A	;
938)   0BCF ED 42       		     SBC HL,BC     ;HL=Y-Y1	;HL=Y-Y1
940)   0BD1 CD 8D 0A    		     CALL PLOTP	;
942)   0BD4 E1          		     POP HL         ;X	;X
943)   0BD5 D1          		     POP DE         ;X1	;X1
944)   0BD6 C5          		     PUSH BC        ;SAVE Y1 SWITCH DE AND BC	;SAVE Y1 SWITCH DE AND BC
945)   0BD7 E5          		     PUSH HL        ;SAVE X      	;SAVE X
946)   0BD8 D5          		     PUSH DE        ;SAVE X1      	;SAVE X1
947)   0BD9 09          		     ADD HL,BC      ;	;
948)   0BDA C1          		     POP BC         ;BC=X1	;BC=X1
949)   0BDB EB          		     EX DE,HL       ;DE=X+Y1	;DE=X+Y1
950)   0BDC DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
951)   0BDF DD 6E 0C    		     LD L,(IX+12)	;
952)   0BE2 09          		     ADD HL,BC     ;HL=Y+X1	;HL=Y+X1
954)   0BE3 CD 8D 0A    		     CALL PLOTP	;
956)   0BE6 E1          		   POP HL        ;X	;X
957)   0BE7 D1          		   POP DE        ;Y1	;Y1
958)   0BE8 D5          		   PUSH DE	;
959)   0BE9 E5          		   PUSH HL	;
960)   0BEA AF          		   XOR A	;
961)   0BEB ED 52       		   SBC HL,DE	;
962)   0BED EB          		   EX DE,HL      ;DE=X-Y1	;DE=X-Y1
963)   0BEE DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
964)   0BF1 DD 6E 0C    		     LD L,(IX+12)	;
965)   0BF4 09          		     ADD HL,BC     ;HL=Y+X1	;HL=Y+X1
967)   0BF5 CD 8D 0A    		     CALL PLOTP	;
969)   0BF8 E1          		   POP HL        ;X	;X
970)   0BF9 D1          		   POP DE        ;Y1	;Y1
971)   0BFA D5          		   PUSH DE	;
972)   0BFB E5          		   PUSH HL	;
973)   0BFC 19          		     ADD HL,DE	;
974)   0BFD EB          		     EX DE,HL      ;DE=X+Y1	;DE=X+Y1
975)   0BFE DD 66 0D    		     LD H,(IX+13)  ;Y	;Y
976)   0C01 DD 6E 0C    		     LD L,(IX+12)	;
977)   0C04 AF          		     XOR A	;
978)   0C05 ED 42       		     SBC HL,BC     ;HL=Y-X1	;HL=Y-X1
979)   0C07 E5          		     PUSH HL	;
981)   0C08 CD 8D 0A    		     CALL PLOTP	;
983)   0C0B C1          		     POP BC        ;Y-X1	;Y-X1
984)   0C0C E1          		     POP HL        ;X	;X
985)   0C0D D1          		     POP DE        ;Y1 	;Y1
986)   0C0E AF          		     XOR A	;
987)   0C0F ED 52       		     SBC HL,DE	;
988)   0C11 EB          		     EX DE,HL      ;DE=X-Y1	;DE=X-Y1
989)   0C12 C5          		     PUSH BC	;
990)   0C13 E1          		     POP HL        ;HL=Y-X1	;HL=Y-X1
992)   0C14 CD 8D 0A    		     CALL PLOTP        	;
993)   0C17 C3 1C 0B    		    JP CIRC_AGN	;
994)   0C1A CD 05 08    		CIRC_EXIT: CALL LCD_CLRXY	;
995)   0C1D D1          		     POP DE ;GET RET ADDR	;GET RET ADDR
996)   0C1E 21 10 00    		     LD HL,8*2       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
997)   0C21 39          		     ADD HL,SP     ;	;
998)   0C22 F9          		     LD SP,HL 	;
999)   0C23 EB          		     EX DE,HL     	;
1000)   0C24 E9          		     JP (HL)	;
1007)   0C25 D9          		   EXX	;
1008)   0C26 D1          		   POP DE  ;save return addr to de'	;save return addr to de'
1009)   0C27 D9          		   EXX  	;
1010)   0C28 CD 26 0E    		   CALL _FILL         	;
1011)   0C2B D9          		   EXX	;
1012)   0C2C D5          		   PUSH DE ;restore return addr from de'	;restore return addr from de'
1013)   0C2D D9          		   EXX	;
1014)   0C2E C9          		   RET	;
1021)   0C2F FE 08       		     CP 0X08   ;BACKSPACE	;BACKSPACE
1022)   0C31 CA 41 0C    		     JP Z,PRCH_DOBCKSPC	;
1023)   0C34 FE 0A       		     CP 0X0A   ;LINE FEED JUST IGNORE IT	;LINE FEED JUST IGNORE IT
1024)   0C36 C8          		     RET Z	;
1025)   0C37 FE 0D       		     CP 0X0D   ;CHECK FOR ENTER	;CHECK FOR ENTER
1026)   0C39 20 3A       		     JR NZ,PRCH_DOPRN	;
1027)   0C3B 21 0D 83    		     LD HL,CURSORX	;
1028)   0C3E C3 01 0D    		     JP PRCH_NEWLN 	;
1030)   0C41 21 0D 83    		     LD HL,CURSORX      	;
1031)   0C44 7E          		     LD A,(HL)	;
1032)   0C45 38 05       		     JR C,DOREALBCKSPC	;
1034)   0C47 FE 01       		     CP 1      ;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0	;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0
1035)   0C49 C8          		     RET Z	;
1036)   0C4A 35          		     DEC (HL)	;
1037)   0C4B C9          		     RET      	;
1039)   0C4C FE 01       		     CP 1      ;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0	;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0
1040)   0C4E 28 0A       		     JR Z,PRCH_DOBCKSPC2     ;IF 0 WE ARE ON THE 1ST COLUMN SO NOTHING TO DO JUST DELETE THE 8=BS FROM BUFFER	;IF 0 WE ARE ON THE 1ST COLUMN SO NOTHING TO DO JUST DELETE THE 8=BS FROM BUFFER
1041)   0C50 35          		     DEC (HL)  ;GO 1 POSITION BACK	;GO 1 POSITION BACK
1042)   0C51 E5          		     PUSH HL	;
1043)   0C52 3E 20       		     LD A,32   ;PRINT SPACE	;PRINT SPACE
1044)   0C54 CD 75 0C    		     CALL PRCH_DOPRN ;THIS FORWARDS THE CURSOR SO WE SHOULD GO BACK AGAIN	;THIS FORWARDS THE CURSOR SO WE SHOULD GO BACK AGAIN
1045)   0C57 E1          		     POP HL	;
1046)   0C58 35          		     DEC (HL)  ;GO 1 POSITION BACK	;GO 1 POSITION BACK
1047)   0C59 B7          		     OR A      	;
1051)   0C5A DD 21 02 00 		     LD IX,2	;
1052)   0C5E DD 39       		     ADD IX,SP	;
1053)   0C60 DD 66 01    		     LD H,(IX+1);POSITION IN ACCS FOR THE NEW CHARACTER      	;POSITION IN ACCS FOR THE NEW CHARACTER
1054)   0C63 DD 6E 00    		     LD L,(IX) ;POSITION IN ACCS FOR THE NEW CHARACTER  	;POSITION IN ACCS FOR THE NEW CHARACTER
1055)   0C66 3E 00       		     LD A,0    ;NOT XOR WE DONT WANT TO MESS WITH ZERO FLAG	;NOT XOR WE DONT WANT TO MESS WITH ZERO FLAG
1056)   0C68 28 02       		     JR Z,PRCH_SKIP1  ;WE ARE ON COLUMN 1	;WE ARE ON COLUMN 1
1057)   0C6A 2B          		     DEC HL     ;PREVIOUS POSITION DELETE BACKSPACE	;PREVIOUS POSITION DELETE BACKSPACE
1058)   0C6B 77          		     LD (HL),A  ;PUT 0 ON LAST POSITION	;PUT 0 ON LAST POSITION
1060)   0C6C 2B          		     DEC HL     ;PREVIOUS POSITION DELETE PREVIOUS CHAR	;PREVIOUS POSITION DELETE PREVIOUS CHAR
1061)   0C6D 77          		     LD (HL),A  ;PUT 0 ON LAST POSITION      	;PUT 0 ON LAST POSITION
1062)   0C6E DD 74 01    		     LD (IX+1),H ;PUT POSITION BACK ON STACK IT WILL POPED	;PUT POSITION BACK ON STACK IT WILL POPED
1063)   0C71 DD 75 00    		     LD (IX),L	;
1064)   0C74 C9          		     RET	;
1067)   0C75 F5          		     PUSH AF  ;SAVE CHAR TO STACK	;SAVE CHAR TO STACK
1068)   0C76 32 0F 83    		     LD (LASTCHAR),A ;SAVE LAST PRINTED CHAR	;SAVE LAST PRINTED CHAR
1072)   0C79 3A 14 83    		     LD A,(VDUMODE)	;
1073)   0C7C FE 05       		     CP 5	;
1074)   0C7E 20 19       		     JR NZ,VDU4	;
1075)   0C80 2A 5D 83    		     LD HL,(GR_LASTX)	;
1076)   0C83 E5          		     PUSH HL	;
1077)   0C84 ED 5B 5F 83 		     LD DE,(GR_LASTY)	;
1078)   0C88 D5          		     PUSH DE	;
1079)   0C89 01 07 00    		     LD BC,FONT_WIDTH-1	;
1080)   0C8C 09          		     ADD HL,BC	;
1081)   0C8D E5          		     PUSH HL	;
1082)   0C8E 01 09 00    		     LD BC,FONT_HEIGHT-1	;
1083)   0C91 EB          		     EX DE,HL	;
1084)   0C92 09          		     ADD HL,BC	;
1085)   0C93 E5          		     PUSH HL	;
1086)   0C94 CD 50 07    		     CALL LCD_SETXY	;
1087)   0C97 18 34       		     JR PRCHDO	;
1088)   0C99 3A 0D 83    		VDU4: LD A,(CURSORX)	;
1089)   0C9C 06 08       		     LD B,FONT_WIDTH	;
1090)   0C9E 16 00       		     LD D,0	;
1091)   0CA0 5F          		     LD E,A	;
1092)   0CA1 21 00 00    		     LD HL,0	;
1093)   0CA4 B7          		     OR A          ; CLEAR CARRY	; CLEAR CARRY
1095)   0CA5 ED 5A       		     ADC HL,DE	;
1096)   0CA7 10 FC       		     DJNZ PRCH_AGN1 ;HL=DE*B	;HL=DE*B
1097)   0CA9 E5          		     PUSH HL       ;1ST PARAM X1	;1ST PARAM X1
1098)   0CAA 11 08 00    		     LD DE,FONT_WIDTH 	;
1099)   0CAD ED 5A       		     ADC HL,DE      	;
1100)   0CAF 2B          		     DEC HL	;
1101)   0CB0 E5          		     PUSH HL       ;SAVE 3RD PARAM X2	;SAVE 3RD PARAM X2
1102)   0CB1 3A 0E 83    		     LD A,(CURSORY)	;
1103)   0CB4 06 0A       		     LD B,FONT_HEIGHT 	;
1104)   0CB6 16 00       		     LD D,0	;
1105)   0CB8 5F          		     LD E,A	;
1106)   0CB9 21 00 00    		     LD HL,0	;
1108)   0CBC ED 5A       		     ADC HL,DE	;
1109)   0CBE 10 FC       		     DJNZ PRCH_AGN2      	;
1110)   0CC0 D1          		     POP DE        ;RETREIVE 3RD PARAM X2	;RETREIVE 3RD PARAM X2
1111)   0CC1 E5          		     PUSH HL       ;2ND PARAM Y1	;2ND PARAM Y1
1112)   0CC2 D5          		     PUSH DE       ;3RD PARAM X2	;3RD PARAM X2
1113)   0CC3 11 0A 00    		     LD DE,FONT_HEIGHT	;
1114)   0CC6 ED 5A       		     ADC HL,DE     ;CALC 4TH PARAM      	;CALC 4TH PARAM
1115)   0CC8 2B          		     DEC HL        ;4TH PARAM -1  	;4TH PARAM -1
1116)   0CC9 E5          		     PUSH HL    ;4TH PARAM Y2	;4TH PARAM Y2
1117)   0CCA CD 50 07    		     CALL LCD_SETXY	;
1118)   0CCD F1          		PRCHDO: POP AF       ;CHAR TO PRINT FROM STACK	;CHAR TO PRINT FROM STACK
1119)   0CCE 21 00 75    		     LD HL,FONT_ADDR	;
1120)   0CD1 16 00       		     LD D,0	;
1121)   0CD3 5F          		     LD E,A	;
1122)   0CD4 ED 5A       		     ADC HL,DE     ;THIS IS THE CHAR ADDRESS	;THIS IS THE CHAR ADDRESS
1123)   0CD6 E5          		     PUSH HL	;
1124)   0CD7 D1          		     POP DE        ; CHAR ADDRESS ON DE	; CHAR ADDRESS ON DE
1125)   0CD8 0E 0A       		     LD C,FONT_HEIGHT   ; TOTAL FONT LINES	; TOTAL FONT LINES
1127)   0CDA 1A          		     LD A,(DE)           ;FONT 8BIT PATTERN FOR A LINE	;FONT 8BIT PATTERN FOR A LINE
1128)   0CDB 06 08       		     LD B,FONT_WIDTH      	;
1130)   0CDD CB 27       		     SLA A               ;CHECK BIT FOR 1=FCOLOR OR 0=BCOLOR	;CHECK BIT FOR 1=FCOLOR OR 0=BCOLOR
1131)   0CDF 38 05       		     JR C,FORECOLOR	;
1132)   0CE1 2A 03 83    		     LD HL,(BCOLOR)	;
1133)   0CE4 18 03       		     JR PRCH_CONT	;
1135)   0CE6 2A 01 83    		     LD HL,(FCOLOR)      	;
1137)   0CE9 F5          		     PUSH AF	;
1138)   0CEA D5          		     PUSH DE             ;TODO:PROBABLY NOT NEEDED HERE 	;TODO:PROBABLY NOT NEEDED HERE
1139)   0CEB CD 9D 07    		     CALL LCD_SETPIXEL	;
1140)   0CEE D1          		     POP DE	;
1141)   0CEF F1          		     POP AF      	;
1142)   0CF0 10 EB       		     DJNZ PRCH_AGN4	;
1143)   0CF2 14          		     INC D             ;ADD 256 FOR NEXT CHAR PATTERN	;ADD 256 FOR NEXT CHAR PATTERN
1144)   0CF3 0D          		     DEC C	;
1145)   0CF4 20 E4       		     JR NZ,PRCH_AGN3	;
1147)   0CF6 21 0D 83    		     LD HL,CURSORX	;
1148)   0CF9 7E          		     LD A,(HL)	;
1149)   0CFA 3C          		     INC A	;
1150)   0CFB FE 50       		     CP 80	;
1151)   0CFD 28 02       		     JR Z,PRCH_NEWLN  ;NEW LINE	;NEW LINE
1152)   0CFF 77          		     LD (HL),A	;
1153)   0D00 C9          		     RET	;
1156)   0D01 AF          		     XOR A  	;
1157)   0D02 77          		     LD (HL),A   	;
1158)   0D03 23          		     INC HL	;
1159)   0D04 7E          		     LD A,(HL)	;
1160)   0D05 3C          		     INC A       	;
1162)   0D06 FE 2F       		     CP 47         ;47 LINES MAX THEN WRAP OR BETTER SCROLL THE SCREEN!!!	;47 LINES MAX THEN WRAP OR BETTER SCROLL THE SCREEN!!!
1163)   0D08 20 01       		     JR NZ,PRCH_NOTYET	;
1164)   0D0A AF          		     XOR A	;
1166)   0D0B 77          		     LD (HL),A                             	;
1167)   0D0C C9          		     RET	;
1180)   0D0D 2A 03 83    		     LD HL,(BCOLOR);      	;
1181)   0D10 18 03       		     JR LCD_SETCURS	;
1192)   0D12 2A 01 83    		     LD HL,(FCOLOR)      ;COLOR PARAM      	;COLOR PARAM
1195)   0D15 E5          		     PUSH HL             ;COLOR PARAM	;COLOR PARAM
1196)   0D16 3A 0D 83    		     LD A,(CURSORX)	;
1197)   0D19 06 08       		     LD B,FONT_WIDTH	;
1198)   0D1B 16 00       		     LD D,0	;
1199)   0D1D 5F          		     LD E,A	;
1200)   0D1E 21 00 00    		     LD HL,0	;
1201)   0D21 B7          		     OR A                ;CLEAR CARRY	;CLEAR CARRY
1203)   0D22 ED 5A       		     ADC HL,DE	;
1204)   0D24 10 FC       		     DJNZ SCUR_AGN1      ;HL = DE * B 	;HL = DE * B
1205)   0D26 E5          		     PUSH HL             ;1ST PARAM X1	;1ST PARAM X1
1206)   0D27 01 08 00    		     LD BC,FONT_WIDTH	;
1207)   0D2A ED 4A       		     ADC HL,BC           ;NEXT CHAR	;NEXT CHAR
1208)   0D2C 2B          		     DEC HL              ;MINUS 1	;MINUS 1
1209)   0D2D E5          		     PUSH HL             ;SAVE 3RD PARAM X2      	;SAVE 3RD PARAM X2
1210)   0D2E 3A 0E 83    		     LD A,(CURSORY)      	;
1211)   0D31 06 0A       		     LD B,FONT_HEIGHT 	;
1212)   0D33 16 00       		     LD D,0	;
1213)   0D35 5F          		     LD E,A	;
1214)   0D36 21 00 00    		     LD HL,0	;
1216)   0D39 ED 5A       		     ADC HL,DE	;
1217)   0D3B 10 FC       		     DJNZ SCUR_AGN2      ;HL=B*DE	;HL=B*DE
1218)   0D3D 0E 08       		     LD C,FONT_HEIGHT-2  ;2 PIXEL HEIGTH CURSOR       	;2 PIXEL HEIGTH CURSOR
1219)   0D3F 06 00       		     LD B,0	;
1220)   0D41 ED 4A       		     ADC HL,BC           ;ADD FONT_HEIGHT-2 PIXELS	;ADD FONT_HEIGHT-2 PIXELS
1221)   0D43 D1          		     POP DE              ;RETREIVE 3RD PARAM ON DE	;RETREIVE 3RD PARAM ON DE
1222)   0D44 E5          		     PUSH HL             ;2ND PARAM Y1	;2ND PARAM Y1
1223)   0D45 D5          		     PUSH DE             ;3RD PARAM X2	;3RD PARAM X2
1225)   0D46 23          		     INC HL              ; Y2 ADD THE LAST +2 PIXELS  	; Y2 ADD THE LAST +2 PIXELS
1226)   0D47 E5          		     PUSH HL             ;4TH PARAM Y2	;4TH PARAM Y2
1227)   0D48 CD 50 07    		     CALL LCD_SETXY	;
1229)   0D4B E1          		     POP HL              ;GET THE COLOR	;GET THE COLOR
1230)   0D4C 06 10       		     LD B,2*FONT_WIDTH   ;2*8=16	;2*8=16
1232)   0D4E CD 9D 07    		     CALL LCD_SETPIXEL   ;DESTROYS D,A	;DESTROYS D,A
1233)   0D51 10 FB       		     DJNZ SCUR_AGN3                            	;
1238)   0D53 C9          		     RET	;
1241)   0D54 CD 05 08    		    CALL LCD_CLRXY;	;
1242)   0D57 2A 03 83    		    LD HL,(BCOLOR)     	;
1244)   0D5A 01 DF 01    		    LD BC,LCD_HEIGHT	;
1245)   0D5D C5          		CS_AGNA2: PUSH BC	;
1246)   0D5E 01 1F 03    		    LD BC,LCD_WIDTH	;
1247)   0D61 CD 9D 07    		CS_AGNA1: CALL LCD_SETPIXEL         ;DESTROYS D,A, HL HAS COLOR INFO	;DESTROYS D,A, HL HAS COLOR INFO
1248)   0D64 0B          		    DEC BC	;
1249)   0D65 78          		    LD A,B	;
1250)   0D66 B1          		    OR C	;
1251)   0D67 20 F8       		    JR NZ,CS_AGNA1	;
1252)   0D69 C1          		    POP BC	;
1253)   0D6A 0B          		    DEC BC	;
1254)   0D6B 78          		    LD A,B	;
1255)   0D6C B1          		    OR C     	;
1256)   0D6D 20 EE       		    JR NZ,CS_AGNA2	;
1257)   0D6F 21 00 00    		    LD HL,0                   ;RESET CURSOR AT 0,0	;RESET CURSOR AT 0,0
1258)   0D72 22 0D 83    		    LD (CURSORX),HL       	;
1259)   0D75 C9          		  RET	;
1264)   0D76 06 DF       		    LD B,LCD_HEIGHT.AND.0xFF   ;lsb	;lsb
1265)   0D78 0E 02       		    LD C,LCD_HEIGHT.SHR.8+1      ;MSB+1	;MSB+1
1267)   0D7A C5          		    PUSH BC          	;
1269)   0D7B 06 1F       		    LD B,LCD_WIDTH.AND.0xFF   ;lsb	;lsb
1270)   0D7D 0E 04       		    LD C,LCD_WIDTH.SHR.8+1      ;MSV+1          	;MSV+1
1272)   0D7F CD 9D 07    		    CALL LCD_SETPIXEL         ;DESTROYS D,A, HL HAS COLOR INFO	;DESTROYS D,A, HL HAS COLOR INFO
1273)   0D82 10 FB       		    DJNZ CS_AGN1	;
1274)   0D84 0D          		    DEC C	;
1275)   0D85 20 F8       		    JR NZ,CS_AGN1     	;
1276)   0D87 C1          		    POP BC	;
1277)   0D88 10 F0       		    DJNZ CS_AGN2	;
1278)   0D8A 0D          		    DEC C	;
1279)   0D8B 20 ED       		    JR NZ,CS_AGN2 	;
1280)   0D8D 21 00 00    		    LD HL,0                   ;RESET CURSOR AT 0,0	;RESET CURSOR AT 0,0
1281)   0D90 22 0D 83    		    LD (CURSORX),HL       	;
1282)   0D93 C9          		    RET	;
1288)   0D94 7E          		    LD A,(HL)	;
1289)   0D95 FE 00       		    CP 0	;
1290)   0D97 C8          		    RET Z	;
1291)   0D98 E5          		    PUSH HL	;
1292)   0D99 CD 2F 0C    		    CALL LCD_PRINTCHAR     	;
1293)   0D9C E1          		    POP HL	;
1294)   0D9D 23          		    INC HL	;
1295)   0D9E 18 F4       		    JR LCD_MSG	;
  4)   0DA0 AF          		NEGHL:xor a	;
  5)   0DA1 95          		     sub l	;
  6)   0DA2 6F          		     ld l,a	;
  7)   0DA3 9F          		     sbc a,a	;
  8)   0DA4 94          		     sub h	;
  9)   0DA5 67          		     ld h,a	;
 10)   0DA6 C9          		     RET	;
 14)   0DA7 2A 77 83    		     LD HL,(FILL_IDX)	;
 15)   0DAA 01 58 02    		     LD BC,MAXQ	;
 16)   0DAD A7          		     AND A	;
 17)   0DAE ED 42       		     SBC HL,BC	;
 18)   0DB0 D0          		     RET NC ;IF IDX=HL>=MAXQ THEN EXIT	;IF IDX=HL>=MAXQ THEN EXIT
 19)   0DB1 2A 79 83    		     LD HL,(FILL_PY)	;
 20)   0DB4 ED 5B 7F 83 		     LD DE,(FILL_PDY)	;
 21)   0DB8 19          		     ADD HL,DE	;
 22)   0DB9 7C          		     LD A,H	;
 23)   0DBA FE 80       		     CP 80H	;
 24)   0DBC D0          		     RET NC ;NC MEANS NEGATIVE <0	;NC MEANS NEGATIVE <0
 25)   0DBD 11 1F 03    		     LD DE,LCD_WIDTH	;
 26)   0DC0 ED 52       		     SBC HL,DE	;
 27)   0DC2 D0          		     RET NC  ;C MEANS Y+DY<=LCD_WIDTH	;C MEANS Y+DY<=LCD_WIDTH
 29)   0DC3 2A 75 83    		     LD HL,(FILL_Q)	;
 30)   0DC6 ED 4B 77 83 		     LD BC,(FILL_IDX)	;
 31)   0DCA 78          		     LD A,B	;
 32)   0DCB B1          		     OR C         ;IF IDX=0 THEN NXT1	;IF IDX=0 THEN NXT1
 33)   0DCC 28 08       		     JR Z,QPS_NXT1 	;
 34)   0DCE EB          		     EX DE,HL	;
 35)   0DCF C5          		     PUSH BC	;
 36)   0DD0 E1          		     POP HL      	;
 37)   0DD1 29          		     ADD HL, HL	;
 38)   0DD2 29          		     ADD HL, HL	;
 39)   0DD3 29          		     ADD HL, HL        ; SLEFT 3 TIMES MEANS *8	; SLEFT 3 TIMES MEANS *8
 40)   0DD4 EB          		     EX DE,HL	;
 41)   0DD5 19          		     ADD HL,DE      	;
 43)   0DD6 11 79 83    		     LD DE,FILL_PY	;
 44)   0DD9 EB          		     EX DE,HL  ;DEST=QUEUE ORIGIN=FILL_PY	;DEST=QUEUE ORIGIN=FILL_PY
 45)   0DDA 01 08 00    		     LD BC,8   ;8 BYTES	;8 BYTES
 46)   0DDD ED B0       		     LDIR      ;COPY	;COPY
 47)   0DDF 2A 77 83    		     LD HL,(FILL_IDX)      	;
 48)   0DE2 23          		     INC HL	;
 49)   0DE3 22 77 83    		     LD (FILL_IDX),HL	;
 50)   0DE6 C9          		QPS_EXT: RET   	;
 52)   0DE7 2A 75 83    		QPOP: LD HL,(FILL_Q)	;
 53)   0DEA ED 4B 77 83 		     LD BC,(FILL_IDX)	;
 54)   0DEE 0B          		     DEC BC      	;
 55)   0DEF C5          		     PUSH BC	;
 56)   0DF0 78          		     LD A,B	;
 57)   0DF1 B1          		     OR C         ;IF IDX=0 THEN WE ARE ON START	;IF IDX=0 THEN WE ARE ON START
 58)   0DF2 28 08       		     JR Z,QPP_NXT1                        	;
 59)   0DF4 EB          		     EX DE,HL	;
 60)   0DF5 C5          		     PUSH BC	;
 61)   0DF6 E1          		     POP HL      	;
 62)   0DF7 29          		     ADD HL, HL	;
 63)   0DF8 29          		     ADD HL, HL	;
 64)   0DF9 29          		     ADD HL, HL        ; SLEFT 3 TIMES MEANS *8	; SLEFT 3 TIMES MEANS *8
 65)   0DFA EB          		     EX DE,HL	;
 66)   0DFB 19          		     ADD HL,DE      	;
 67)   0DFC C1          		QPP_NXT1: POP BC 	;
 68)   0DFD ED 43 77 83 		     LD (FILL_IDX),BC	;
 70)   0E01 11 79 83    		     LD DE,FILL_PY  ;ORIGIN=QUEUE DEST=FILL_PY               	;ORIGIN=QUEUE DEST=FILL_PY
 71)   0E04 01 08 00    		     LD BC,8   ;8 BYTES	;8 BYTES
 72)   0E07 ED B0       		     LDIR      ;COPY	;COPY
 73)   0E09 2A 7B 83    		     LD HL,(FILL_PXL)	;
 74)   0E0C 22 6F 83    		     LD (FILL_X1),HL	;
 75)   0E0F 2A 7D 83    		     LD HL,(FILL_PXR)	;
 76)   0E12 22 71 83    		     LD (FILL_X2),HL	;
 77)   0E15 ED 5B 7F 83 		     LD DE,(FILL_PDY)	;
 78)   0E19 ED 53 73 83 		     LD (FILL_DY),DE      	;
 79)   0E1D 2A 79 83    		     LD HL,(FILL_PY)	;
 80)   0E20 A7          		     AND A	;
 81)   0E21 19          		     ADD HL,DE	;
 82)   0E22 22 6B 83    		     LD (FILL_Y),HL 	;
 90)   0E25 C9          		     RET	;
 92)   0E26 E1          		@_FILL: POP HL        ;GET THE RETURN ADDRESS	;GET THE RETURN ADDRESS
 93)   0E27 D1          		     POP DE          ;Y	;Y
 94)   0E28 C1          		     POP BC          ;X      	;X
 95)   0E29 E5          		     PUSH HL         ;RET ADDR TO SP	;RET ADDR TO SP
 96)   0E2A ED 43 69 83 		     LD (FILL_X),BC	;
 97)   0E2E ED 53 6B 83 		     LD (FILL_Y),DE   	;
 98)   0E32 ED 73 83 83 		     LD (FILL_OLDSP),SP   	;
 99)   0E36 21 3E ED    		     LD HL,-((MAXQ*8)+2) ; MAKE SPACE FOR OUR QUEUE	; MAKE SPACE FOR OUR QUEUE
100)   0E39 39          		     ADD HL,SP	;
101)   0E3A F9          		     LD SP,HL        ;NEW SP	;NEW SP
104)   0E3B 22 75 83    		     LD (FILL_Q),HL  ;START OF QUEUE STACK VAR IN C	;START OF QUEUE STACK VAR IN C
105)   0E3E 21 00 00    		     LD HL,0	;
106)   0E41 22 77 83    		     LD (FILL_IDX),HL ;INDEX OF ITEMS SP IN C	;INDEX OF ITEMS SP IN C
110)   0E44 2A 69 83    		     LD HL,(FILL_X);	;
111)   0E47 E5          		     PUSH HL	;
112)   0E48 2A 6B 83    		     LD HL,(FILL_y);	;
113)   0E4B E5          		     PUSH HL	;
114)   0E4C CD B4 07    		     CALL LCD_READPIXEL	;
115)   0E4F 22 81 83    		     LD (FILL_OV),HL	;
117)   0E52 ED 5B 01 83 		     LD DE,(FCOLOR)	;
118)   0E56 A7          		     AND A	;
119)   0E57 ED 52       		     SBC HL,DE      ;CHK OV=NV	;CHK OV=NV
120)   0E59 CA DE 0F    		     JP Z,FL_EXIT	;
121)   0E5C 2A 69 83    		     LD HL,(FILL_X)	;
122)   0E5F 7C          		     LD A,H	;
123)   0E60 FE 80       		     CP 0x80         ;CHK <0	;CHK <0
124)   0E62 D2 DE 0F    		     JP NC,FL_EXIT	;
125)   0E65 11 1F 03    		     LD DE,LCD_WIDTH 	;
126)   0E68 A7          		     AND A	;
127)   0E69 ED 52       		     SBC HL,DE       ;CHK>799	;CHK>799
128)   0E6B D2 DE 0F    		     JP NC,FL_EXIT	;
129)   0E6E 2A 6B 83    		     LD HL,(FILL_Y)	;
130)   0E71 7C          		     LD A,H	;
131)   0E72 FE 80       		     CP 0x80         ;CHK <0	;CHK <0
132)   0E74 D2 DE 0F    		     JP NC,FL_EXIT	;
133)   0E77 11 DF 01    		     LD DE,LCD_HEIGHT 	;
134)   0E7A A7          		     AND A	;
135)   0E7B ED 52       		     SBC HL,DE       ;CHK>480	;CHK>480
136)   0E7D D2 DE 0F    		     JP NC,FL_EXIT           	;
138)   0E80 2A 6B 83    		     LD HL,(FILL_Y)	;
139)   0E83 22 79 83    		     LD (FILL_PY),HL	;
140)   0E86 2A 69 83    		     LD HL,(FILL_X)	;
141)   0E89 22 7B 83    		     LD (FILL_PXL),HL	;
142)   0E8C 22 7D 83    		     LD (FILL_PXR),HL	;
143)   0E8F 21 01 00    		     LD HL,1	;
144)   0E92 22 7F 83    		     LD (FILL_PDY),HL	;
145)   0E95 CD A7 0D    		     CALL QPUSH         ;     /PUSH VALUES TO QUEUE ADD 8 TO IDX	;     /PUSH VALUES TO QUEUE ADD 8 TO IDX
147)   0E98 2A 6B 83    		     LD HL,(FILL_Y)	;
148)   0E9B 23          		     INC HL	;
149)   0E9C 22 79 83    		     LD (FILL_PY),HL	;
150)   0E9F 21 FF FF    		     LD HL,-1	;
151)   0EA2 22 7F 83    		     LD (FILL_PDY),HL	;
152)   0EA5 CD A7 0D    		     CALL QPUSH	;
154)   0EA8 ED 5B 77 83 		    LD DE,(FILL_IDX)	;
155)   0EAC 7A          		    LD A,D	;
156)   0EAD B3          		    OR E	;
157)   0EAE CA DE 0F    		    JP Z,FL_EXIT    ; IF FILL_IDX=0 THEN NO MORE ITEMS ON QUEUE SO EXIT 	; IF FILL_IDX=0 THEN NO MORE ITEMS ON QUEUE SO EXIT
161)   0EB1 CD E7 0D    		     CALL QPOP            ;POP VALUES FROM QUEUE SUB 8 FROM IDX TO Y,X1,X2,DY	;POP VALUES FROM QUEUE SUB 8 FROM IDX TO Y,X1,X2,DY
164)   0EB4 2A 6F 83    		      LD HL,(FILL_X1)	;
165)   0EB7 22 69 83    		     LD (FILL_X),HL	;
166)   0EBA 7C          		FL_LP1: LD A,H	;
167)   0EBB FE 80       		     CP 0x80          ;CHK X<0 THEN EXIT LOOP	;CHK X<0 THEN EXIT LOOP
168)   0EBD D2 E5 0E    		     JP NC,FL_NXT1	;
169)   0EC0 ED 5B 6B 83 		     LD DE,(FILL_Y)	;
170)   0EC4 E5          		     PUSH HL	;
171)   0EC5 D5          		     PUSH DE	;
172)   0EC6 CD B4 07    		     CALL LCD_READPIXEL	;
173)   0EC9 ED 5B 81 83 		     LD DE,(FILL_OV)	;
174)   0ECD A7          		     AND A	;
175)   0ECE ED 52       		     SBC HL,DE      ;PIXELREAD<>0 THEN  EXIT LOOP	;PIXELREAD<>0 THEN  EXIT LOOP
176)   0ED0 C2 E5 0E    		     JP NZ,FL_NXT1	;
177)   0ED3 ED 5B 69 83 		     LD DE,(FILL_X)	;
178)   0ED7 2A 6B 83    		     LD HL,(FILL_Y)	;
179)   0EDA D5          		     PUSH DE	;
180)   0EDB CD 8D 0A    		     CALL PLOTP	;
181)   0EDE E1          		     POP HL	;
182)   0EDF 2B          		     DEC HL	;
183)   0EE0 22 69 83    		     LD (FILL_X),HL	;
184)   0EE3 18 D5       		     JR FL_LP1     	;
188)   0EE5 2A 69 83    		     LD HL,(FILL_X)	;
189)   0EE8 ED 5B 6F 83 		     LD DE,(FILL_X1)	;
190)   0EEC 7C          		     LD A,H	;
191)   0EED FE 80       		     CP 80H	;
192)   0EEF 30 08       		     JR NC,FL_NXT1A   ;IF X<0 THEN X<X1 IF NEGATIVE DON'T SKIP      	;IF X<0 THEN X<X1 IF NEGATIVE DON'T SKIP
193)   0EF1 A7          		     AND A	;
194)   0EF2 ED 52       		     SBC HL,DE       ;CHK X-X1<0 THEN CONTINUE ELSE SKIP	;CHK X-X1<0 THEN CONTINUE ELSE SKIP
195)   0EF4 D2 9C 0F    		     JP NC,FL_SKIP   ;C IF DE>HL X1>X, NC IF X>=X1    	;C IF DE>HL X1>X, NC IF X>=X1
196)   0EF7 ED 5A       		     ADC HL,DE	;
199)   0EF9 23          		    INC HL	;
200)   0EFA 22 6D 83    		    LD (FILL_L),HL	;
203)   0EFD A7          		    AND A     	;
204)   0EFE ED 52       		    SBC HL,DE   ;CHK L-X1	;CHK L-X1
205)   0F00 30 1E       		    JR NC,FL_NXT2   ;C IF DE>HL X1>L	;C IF DE>HL X1>L
206)   0F02 28 1C       		    JR Z,FL_NXT2	;
207)   0F04 ED 5A       		    ADC HL,DE	;
208)   0F06 22 7B 83    		    LD (FILL_PXL),HL ;L	;L
209)   0F09 2A 6B 83    		    LD HL,(FILL_Y)	;
210)   0F0C 22 79 83    		    LD (FILL_PY),HL	;
211)   0F0F 1B          		    DEC DE	;
212)   0F10 ED 53 7D 83 		    LD (FILL_PXR),DE	;
213)   0F14 2A 73 83    		    LD HL,(FILL_DY) 	;
214)   0F17 CD A0 0D    		    CALL NEGHL	;
215)   0F1A 22 7F 83    		    LD (FILL_PDY),HL     	;
216)   0F1D CD A7 0D    		    CALL QPUSH     	;
220)   0F20 2A 6F 83    		     LD HL,(FILL_X1)  ;COULD USE DE=X1 OR DE=X1-1 IF WE INCREASE IT	;COULD USE DE=X1 OR DE=X1-1 IF WE INCREASE IT
221)   0F23 23          		     INC HL	;
222)   0F24 22 69 83    		     LD (FILL_X),HL	;
226)   0F27 11 1F 03    		   LD DE,LCD_WIDTH	;
227)   0F2A A7          		   AND A	;
228)   0F2B EB          		   EX DE,HL	;
229)   0F2C ED 52       		   SBC HL,DE    ;800-(X=DE)	;800-(X=DE)
230)   0F2E 38 24       		   JR C,FL_NXT3   ;C IF X>800	;C IF X>800
231)   0F30 EB          		   EX DE,HL      ;HL=X	;HL=X
232)   0F31 E5          		   PUSH HL	;
233)   0F32 2A 6B 83    		   LD HL,(FILL_Y)	;
234)   0F35 E5          		   PUSH HL	;
235)   0F36 CD B4 07    		   CALL LCD_READPIXEL	;
236)   0F39 ED 5B 81 83 		   LD DE,(FILL_OV)	;
237)   0F3D A7          		   AND A	;
238)   0F3E ED 52       		   SBC HL,DE       ;PIXELREAD=OV	;PIXELREAD=OV
239)   0F40 20 12       		   JR NZ,FL_NXT3	;
240)   0F42 ED 5B 69 83 		   LD DE,(FILL_X)	;
241)   0F46 2A 6B 83    		   LD HL,(FILL_Y)	;
242)   0F49 D5          		   PUSH DE	;
243)   0F4A CD 8D 0A    		   CALL PLOTP	;
244)   0F4D E1          		   POP HL	;
245)   0F4E 23          		   INC HL	;
246)   0F4F 22 69 83    		   LD (FILL_X),HL	;
247)   0F52 18 D3       		   JR FL_LP2	;
250)   0F54 2A 6B 83    		    LD HL,(FILL_Y)	;
251)   0F57 22 79 83    		    LD (FILL_PY),HL	;
252)   0F5A 2A 6D 83    		    LD HL,(FILL_L)	;
253)   0F5D 22 7B 83    		    LD (FILL_PXL),HL	;
254)   0F60 2A 69 83    		    LD HL,(FILL_X)	;
255)   0F63 2B          		    DEC HL	;
256)   0F64 22 7D 83    		    LD (FILL_PXR),HL	;
257)   0F67 2A 73 83    		    LD HL,(FILL_DY)	;
258)   0F6A 22 7F 83    		    LD (FILL_PDY),HL	;
259)   0F6D CD A7 0D    		    CALL QPUSH         	;
261)   0F70 2A 69 83    		    LD HL,(FILL_X)	;
262)   0F73 ED 5B 71 83 		    LD DE,(FILL_X2)	;
263)   0F77 13          		    INC DE	;
264)   0F78 A7          		    AND A	;
265)   0F79 ED 52       		    SBC HL,DE    ;X-(X2+1) C IF X2+1>X 	;X-(X2+1) C IF X2+1>X
266)   0F7B 38 1F       		    JR C,FL_NXT4	;
267)   0F7D 28 1D       		    JR Z,FL_NXT4	;
268)   0F7F 2A 6B 83    		    LD HL,(FILL_Y)	;
269)   0F82 22 79 83    		    LD (FILL_PY),HL	;
270)   0F85 ED 53 7B 83 		    LD (FILL_PXL),DE	;
271)   0F89 2A 69 83    		    LD HL,(FILL_X);	;
272)   0F8C 2B          		    DEC HL	;
273)   0F8D 22 7D 83    		    LD (FILL_PXR),HL	;
274)   0F90 2A 73 83    		    LD HL,(FILL_DY)	;
275)   0F93 CD A0 0D    		    CALL NEGHL	;
276)   0F96 22 7F 83    		    LD (FILL_PDY),HL  	;
277)   0F99 CD A7 0D    		    CALL QPUSH         	;
280)   0F9C 2A 69 83    		       LD HL,(FILL_X)	;
281)   0F9F 23          		       INC HL	;
282)   0FA0 22 69 83    		       LD (FILL_X),HL	;
283)   0FA3 ED 5B 71 83 		FL_LP3: LD DE,(FILL_X2)	;
284)   0FA7 A7          		       AND A	;
285)   0FA8 EB          		       EX DE,HL         ;X2=HL X=DE	;X2=HL X=DE
286)   0FA9 ED 52       		       SBC HL,DE        ;C IF DE>HL X>X2       	;C IF DE>HL X>X2
287)   0FAB 38 1C       		       JR C,FL_NXT5	;
288)   0FAD 19          		       ADD HL,DE        ;	;
289)   0FAE EB          		       EX DE,HL         ;X=HL X2=DE	;X=HL X2=DE
290)   0FAF E5          		       PUSH HL	;
291)   0FB0 2A 6B 83    		       LD HL,(FILL_Y)	;
292)   0FB3 E5          		       PUSH HL	;
293)   0FB4 CD B4 07    		       CALL LCD_READPIXEL	;
294)   0FB7 ED 5B 81 83 		       LD DE,(FILL_OV)	;
295)   0FBB A7          		       AND A	;
296)   0FBC ED 52       		       SBC HL,DE     ;CHK PIXELREAD!=OV ELSE EXIT LOOP	;CHK PIXELREAD!=OV ELSE EXIT LOOP
297)   0FBE 28 09       		       JR Z,FL_NXT5	;
298)   0FC0 2A 69 83    		       LD HL,(FILL_X)	;
299)   0FC3 23          		       INC HL	;
300)   0FC4 22 69 83    		       LD (FILL_X),HL	;
301)   0FC7 18 DA       		       JR FL_LP3	;
304)   0FC9 2A 69 83    		       LD HL,(FILL_X)	;
305)   0FCC 22 6D 83    		       LD (FILL_L),HL	;
307)   0FCF ED 5B 71 83 		      LD DE,(FILL_X2)	;
308)   0FD3 A7          		      AND A	;
309)   0FD4 EB          		      EX DE,HL    ;X2=HL X=DE	;X2=HL X=DE
310)   0FD5 ED 52       		      SBC HL,DE   ;X2-X C IF X>X2	;X2-X C IF X>X2
311)   0FD7 EB          		      EX DE,HL    ;X=HL X2-X=DE	;X=HL X2-X=DE
312)   0FD8 DA A8 0E    		      JP C,FL_LP0 ; IF X>X2 THEN EXIT DO WHILE GOTO ;while (sp>stack)	; IF X>X2 THEN EXIT DO WHILE GOTO ;while (sp>stack)
313)   0FDB C3 27 0F    		      JP FL_LP2   ;GOTO DO WHILE	;GOTO DO WHILE
316)   0FDE 21 C2 12    		FL_EXIT: LD HL,(MAXQ*8)+2 ; RETREIVE SPACE FOR OUR QUEUE	; RETREIVE SPACE FOR OUR QUEUE
317)   0FE1 39          		        ADD HL,SP	;
318)   0FE2 F9          		        LD SP,HL        ;NEW SP	;NEW SP
319)   0FE3 C9          		        RET	;
  9)   0FE4 FE 01       		    CP 1          ;IS IT FOR GRAPHICS?	;IS IT FOR GRAPHICS?
 10)   0FE6 28 0E       		    JR Z,GRCOLS	;
 11)   0FE8 21 03 83    		    LD HL,BCOLOR	;
 12)   0FEB 22 67 83    		    LD (GR_PARAM4),HL	;
 13)   0FEE 21 01 83    		    LD HL,FCOLOR	;
 14)   0FF1 22 65 83    		    LD (GR_PARAM3),HL	;
 15)   0FF4 18 0C       		    JR BS_DOCOL	;
 16)   0FF6 21 07 83    		GRCOLS: LD HL,BGRCOL	;
 17)   0FF9 22 67 83    		    LD (GR_PARAM4),HL	;
 18)   0FFC 21 05 83    		    LD HL,FGRCOL	;
 19)   0FFF 22 65 83    		    LD (GR_PARAM3),HL         	;
 20)   1002 CD 94 5E    		BS_DOCOL: CALL EXPRI   ;GET 1ST PARAM	;GET 1ST PARAM
 21)   1005 D9          		    EXX	;
 22)   1006 FD 7E 00    		    LD A,(IY)	;
 23)   1009 FE 0D       		    CP 0x0D       ;FINISHED COMD LINE	;FINISHED COMD LINE
 24)   100B 28 32       		    JR Z,COLSEL	;
 25)   100D FE 3A       		    CP ':'	;
 26)   100F 28 2E       		    JR Z,COLSEL	;
 27)   1011 FE 2C       		    CP ','        ;CHECK FOR ','	;CHECK FOR ','
 28)   1013 C2 B2 13    		    JP NZ,GRPHERR	;
 30)   1016 E5          		    PUSH HL       ;SAVE 1ST PARAM	;SAVE 1ST PARAM
 31)   1017 FD 23       		    INC IY        ;NEXT PARAM	;NEXT PARAM
 32)   1019 CD 94 5E    		    CALL EXPRI    ;GET 2ND PARAM	;GET 2ND PARAM
 33)   101C D9          		    EXX	;
 34)   101D D1          		    POP DE        ;RESTORE 1ST PARAM ON DE HL HAS THE 2ND	;RESTORE 1ST PARAM ON DE HL HAS THE 2ND
 35)   101E 7B          		    LD A,E	;
 36)   101F D6 80       		    SUB 128	;
 37)   1021 38 07       		    JR C,COLFC	;
 38)   1023 5F          		    LD E,A	;
 39)   1024 DD 21 35 83 		    LD IX,BCOLPAL	;
 40)   1028 18 04       		    JR DOPALCOL	;
 41)   102A DD 21 15 83 		COLFC: LD IX,FCOLPAL	;
 43)   102E 7B          		    LD A,E	;
 44)   102F FE 0F       		    CP 15     ;MAX 16 COLORS	;MAX 16 COLORS
 45)   1031 D2 B2 13    		    JP NC,GRPHERR	;
 46)   1034 DD 19       		    ADD IX,DE     	;
 47)   1036 DD 19       		    ADD IX,DE     ;2*DE CAUSE ITS A 2 BYTE ARRAY	;2*DE CAUSE ITS A 2 BYTE ARRAY
 48)   1038 DD 75 00    		    LD (IX),L    ;SAVE THE NEW COLOR 	;SAVE THE NEW COLOR
 49)   103B DD 74 01    		    LD (IX+1),H  	;
 50)   103E C9          		    RET  	;
 53)   103F E5          		    PUSH HL	;
 54)   1040 D1          		    POP DE     	;
 55)   1041 7B          		    LD A,E	;
 56)   1042 D6 80       		    SUB 128        ;CHECK MSB	;CHECK MSB
 57)   1044 38 11       		    JR C,CFC	;
 58)   1046 5F          		    LD E,A	;
 59)   1047 DD 21 67 83 		    LD IX,GR_PARAM4	;
 60)   104B DD 6E 00    		    LD L,(IX)	;
 61)   104E DD 66 01    		    LD H,(IX+1)     	;
 62)   1051 DD 21 35 83 		    LD IX,BCOLPAL  ;BACKCOLOR	;BACKCOLOR
 63)   1055 18 0E       		    JR SFC	;
 64)   1057 DD 21 65 83 		CFC: LD IX,GR_PARAM3	;
 65)   105B DD 6E 00    		    LD L,(IX)	;
 66)   105E DD 66 01    		    LD H,(IX+1)     	;
 67)   1061 DD 21 15 83 		    LD IX,FCOLPAL  ;FRONTCOLOR	;FRONTCOLOR
 68)   1065 7B          		SFC: LD A,E	;
 69)   1066 FE 10       		    CP 16     ;MAX 16 COLORS	;MAX 16 COLORS
 70)   1068 D2 B2 13    		    JP NC,GRPHERR	;
 71)   106B DD 19       		    ADD IX,DE	;
 72)   106D DD 19       		    ADD IX,DE	;
 73)   106F DD 56 00    		    LD D,(IX)	;
 74)   1072 DD 5E 01    		    LD E,(IX+1)     	;
 75)   1075 72          		    LD (HL),D  ;SAVE AGAIN 	;SAVE AGAIN
 76)   1076 23          		    INC HL     	;
 77)   1077 73          		    LD (HL),E       	;
 78)   1078 C9          		    RET          	;
 84)   1079 AF          		    XOR A	;
 85)   107A 21 61 83    		    LD HL,GR_PARAM1	;
 87)   107D F5          		    PUSH AF	;
 88)   107E E5          		    PUSH HL	;
 89)   107F CD 94 5E    		    CALL EXPRI    ;GET 1ST PARAM	;GET 1ST PARAM
 90)   1082 D9          		    EXX           ;HL HAS THE PARAM     	;HL HAS THE PARAM
 91)   1083 D1          		    POP DE        ;GET PARAM ADDRESS	;GET PARAM ADDRESS
 92)   1084 EB          		    EX DE,HL	;
 93)   1085 73          		    LD (HL),E	;
 94)   1086 23          		    INC HL	;
 95)   1087 72          		    LD (HL),D	;
 96)   1088 23          		    INC HL        ;PARAM SAVED     	;PARAM SAVED
 97)   1089 F1          		    POP AF	;
 98)   108A 3C          		    INC A          	;
 99)   108B FE 04       		    CP 4	;
100)   108D C8          		    RET Z     	;
101)   108E F5          		    PUSH AF	;
102)   108F FD 7E 00    		    LD A,(IY)     	;
103)   1092 FE 0D       		    CP 0x0D       ;FINISHED COMD LINE	;FINISHED COMD LINE
104)   1094 28 0D       		    JR Z,NOMORE 	;
105)   1096 FE 3A       		    CP ':'       ;FINISHED COMD LINE	;FINISHED COMD LINE
106)   1098 28 09       		    JR Z,NOMORE      	;
107)   109A FE 2C       		    CP ','        ;CHECK FOR ','	;CHECK FOR ','
108)   109C 20 05       		    JR NZ,NOMORE     	;
109)   109E FD 23       		    INC IY        ;NEXT PARAM	;NEXT PARAM
110)   10A0 F1          		    POP AF    	;
111)   10A1 18 DA       		    JR GBP_NXT     	;
112)   10A3 F1          		NOMORE:POP AF    	;
113)   10A4 C9          		    RET	;
118)   10A5 01 08 00    		    LD BC,8     ;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD	;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD
119)   10A8 11 55 83    		    LD DE,GR_LASTX3	;
120)   10AB 21 59 83    		    LD HL,GR_LASTX2	;
121)   10AE ED B0       		    LDIR     	;
122)   10B0 2A 61 83    		    LD HL,(GR_PARAM1)	;
123)   10B3 22 5D 83    		    LD (GR_LASTX),HL  ;SAVE TO LAST              	;SAVE TO LAST
124)   10B6 2A 63 83    		    LD HL,(GR_PARAM2)	;
125)   10B9 22 5F 83    		    LD (GR_LASTY),HL  ;SAVE TO LAST     	;SAVE TO LAST
126)   10BC C9          		  RET	;
130)   10BD CD 79 10    		    CALL GETBASICPARAMS	;
131)   10C0 FE 02       		    CP 2	;
132)   10C2 C2 B2 13    		    JP NZ,GRPHERR          	;
133)   10C5 CD DF 11    		BAS_DODRAW: CALL GRPH_SAVECOLORS	;
134)   10C8 FD E5       		    PUSH IY	;
137)   10CA 2A 5D 83    		    LD HL,(GR_LASTX)	;
138)   10CD E5          		    PUSH HL	;
139)   10CE 2A 5F 83    		    LD HL,(GR_LASTY)	;
140)   10D1 E5          		    PUSH HL	;
141)   10D2 CD A5 10    		    CALL GRPH_SAVELASTPOS	;
142)   10D5 2A 61 83    		    LD HL,(GR_PARAM1)	;
143)   10D8 E5          		    PUSH HL	;
144)   10D9 2A 63 83    		    LD HL,(GR_PARAM2)	;
145)   10DC E5          		    PUSH HL 	;
146)   10DD CD AA 08    		    CALL LCD_DRAWLINE 	;
148)   10E0 FD E1       		    POP IY	;
149)   10E2 CD F6 11    		    CALL GRPH_RESTORECOLORS	;
150)   10E5 C9          		    RET           ;RETURN TO BASIC  	;RETURN TO BASIC
154)   10E6 CD 79 10    		@BAS_MOVE: CALL GETBASICPARAMS	;
155)   10E9 FE 02       		         CP 2	;
156)   10EB C2 B2 13    		         JP NZ,GRPHERR   	;
158)   10EE CD A5 10    		         CALL GRPH_SAVELASTPOS	;
159)   10F1 C9          		         RET	;
165)   10F2 CD 79 10    		@BAS_POINT:CALL GETBASICPARAMS	;
166)   10F5 FE 02       		          CP 2	;
167)   10F7 C2 B2 13    		          JP NZ,GRPHERR   	;
170)   10FA 2A 61 83    		          LD HL,(GR_PARAM1)	;
171)   10FD E5          		          PUSH HL	;
172)   10FE 2A 63 83    		          LD HL,(GR_PARAM2)	;
173)   1101 E5          		          PUSH HL           	;
174)   1102 CD B4 07    		          CALL LCD_READPIXEL	;
178)   1105 FD 7E 00    		          LD A,(IY)  	;
179)   1108 FE 29       		          CP ')'	;
180)   110A C2 B2 13    		          JP NZ,GRPHERR 	;
181)   110D FD 23       		          INC IY 	;
184)   110F 01 00 00    		          LD BC,0	;
185)   1112 F3          		          DI	;
186)   1113 E5          		          PUSH HL	;
187)   1114 D9          		          EXX	;
188)   1115 E1          		          POP HL	;
189)   1116 D9          		          EXX           	;
190)   1117 21 00 00    		          LD HL,0	;
191)   111A FB          		          EI	;
192)   111B C9          		          RET	;
198)   111C FE 00       		GRPH_GETGROUP: CP 0	;
200)   111E 21 22 13    		    LD HL,PLOT00	;
201)   1121 C8          		    RET Z	;
202)   1122 FE 0A       		         CP 80.SHR.3	;
203)   1124 21 32 13    		    LD HL,PLOT80	;
204)   1127 C8          		    RET Z	;
205)   1128 FE 0C       		         CP 96.SHR.3	;
206)   112A 21 42 13    		    LD HL,PLOT96	;
207)   112D C8          		    RET Z       	;
208)   112E FE 10       		         CP 128.SHR.3	;
209)   1130 21 52 13    		    LD HL,PLOT128	;
210)   1133 C8          		    RET Z                   	;
211)   1134 FE 12       		        CP 144.SHR.3	;
212)   1136 21 62 13    		    LD HL,PLOT144	;
213)   1139 C8          		    RET Z                   	;
214)   113A FE 13       		         CP 152.SHR.3	;
215)   113C 21 72 13    		    LD HL,PLOT152	;
216)   113F C8          		    RET Z                   	;
217)   1140 FE 14       		         CP 160.SHR.3	;
218)   1142 21 82 13    		    LD HL,PLOT160	;
219)   1145 C8          		    RET Z                   	;
220)   1146 FE 18       		         CP 192.SHR.3	;
221)   1148 21 92 13    		    LD HL,PLOT192	;
222)   114B C8          		    RET Z                   	;
223)   114C FE 19       		         CP 200.SHR.3	;
224)   114E 21 A2 13    		         LD HL,PLOT200	;
225)   1151 C8          		         RET Z 	;
226)   1152 21 00 00    		    LD HL,0	;
227)   1155 C9          		    RET                                  	;
230)   1156 CD 79 10    		@BAS_PLOT:CALL GETBASICPARAMS	;
231)   1159 FE 03       		         CP 3	;
232)   115B C2 B2 13    		         JP NZ,GRPHERR   	;
233)   115E 3A 61 83    		         LD A,(GR_PARAM1)	;
235)   1161 01 04 00    		         LD BC,4	;
236)   1164 21 63 83    		         LD HL,GR_PARAM2	;
237)   1167 11 61 83    		         LD DE,GR_PARAM1	;
238)   116A ED B0       		         LDIR                    	;
239)   116C 47          		         LD B,A  ;COMMAND GROUP 5 BITS	;COMMAND GROUP 5 BITS
240)   116D CB 38       		         SRL B	;
241)   116F CB 38       		         SRL B	;
242)   1171 CB 38       		         SRL B          	;
243)   1173 E6 07       		         AND 7  	;
244)   1175 4F          		         LD C,A  ;SPECIFIC COMMAND IN GROUP	;SPECIFIC COMMAND IN GROUP
245)   1176 78          		         LD A,B	;
246)   1177 CD 1C 11    		         CALL GRPH_GETGROUP	;
247)   117A 7C          		         LD A,H	;
248)   117B FE 00       		         CP 0	;
249)   117D C8          		         RET Z ;RET IF HL=0 GROUP NOT IMPLEMENTED	;RET IF HL=0 GROUP NOT IMPLEMENTED
250)   117E 06 00       		         LD B,0	;
251)   1180 CB 21       		         SLA C      ;C=C*2 2BYTE ADDRESSES	;C=C*2 2BYTE ADDRESSES
252)   1182 09          		         ADD HL,BC  ;C IS 0-7 SPECIFIC COMMD	;C IS 0-7 SPECIFIC COMMD
253)   1183 5E          		         LD E,(HL)	;
254)   1184 23          		         INC HL	;
255)   1185 56          		         LD D,(HL)	;
256)   1186 EB          		         EX DE,HL	;
257)   1187 E9          		         JP (HL)	;
259)   1188 AF          		GRPH_NOTIMPL:  XOR     A	;
260)   1189 CD F0 46    		  CALL    EXTERR	;
261)   118C 4E 4F 54 20 		  DEFM    'NOT IMPLEMENTED'	;
261)   1190 49 4D 50 4C 		  DEFM    'NOT IMPLEMENTED'	;
261)   1194 45 4D 45 4E 		  DEFM    'NOT IMPLEMENTED'	;
261)   1198 54 45 44    		  DEFM    'NOT IMPLEMENTED'	;
262)   119B 00          		  DEFB    0     	;
266)   119C 2A 61 83    		GRPH_CALCREL: LD HL,(GR_PARAM1)	;
267)   119F ED 5B 5D 83 		        LD DE,(GR_LASTX)	;
268)   11A3 19          		        ADD HL,DE	;
269)   11A4 22 61 83    		        LD (GR_PARAM1),HL	;
270)   11A7 2A 63 83    		        LD HL,(GR_PARAM2)	;
271)   11AA ED 5B 5F 83 		        LD DE,(GR_LASTY)	;
272)   11AE 19          		        ADD HL,DE	;
273)   11AF 22 63 83    		        LD (GR_PARAM2),HL	;
274)   11B2 C9          		    RET	;
277)   11B3 CD 9C 11    		        CALL GRPH_CALCREL	;
278)   11B6 CD A5 10    		        CALL GRPH_SAVELASTPOS         	;
279)   11B9 C9          		        RET	;
282)   11BA CD 9C 11    		        CALL GRPH_CALCREL	;
283)   11BD CD C5 10    		        CALL BAS_DODRAW	;
284)   11C0 C9          		        RET	;
287)   11C1 2A 01 83    		        LD HL,(FCOLOR)	;
288)   11C4 E5          		        PUSH HL	;
289)   11C5 2A 03 83    		        LD HL,(BCOLOR)	;
290)   11C8 22 01 83    		        LD (FCOLOR),HL	;
291)   11CB E1          		        POP HL	;
292)   11CC 22 03 83    		        LD (BCOLOR),HL	;
293)   11CF C9          		        RET	;
296)   11D0 2A 05 83    		        LD HL,(FGRCOL)	;
297)   11D3 E5          		        PUSH HL	;
298)   11D4 2A 07 83    		        LD HL,(BGRCOL)	;
299)   11D7 22 05 83    		        LD (FGRCOL),HL	;
300)   11DA E1          		        POP HL	;
301)   11DB 22 07 83    		        LD (BGRCOL),HL	;
302)   11DE C9          		        RET	;
306)   11DF 01 04 00    		        LD BC,4 ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
307)   11E2 21 01 83    		        LD HL,FCOLOR	;
308)   11E5 11 09 83    		        LD DE,FCOLTM 	;
309)   11E8 ED B0       		        LDIR	;
310)   11EA 01 04 00    		        LD BC,4 ;2 FGRCOL + 2 BGRCOL	;2 FGRCOL + 2 BGRCOL
311)   11ED 21 05 83    		        LD HL,FGRCOL	;
312)   11F0 11 01 83    		        LD DE,FCOLOR	;
313)   11F3 ED B0       		        LDIR         	;
314)   11F5 C9          		    RET	;
318)   11F6 01 04 00    		        LD BC,4 ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
319)   11F9 21 09 83    		        LD HL,FCOLTM	;
320)   11FC 11 01 83    		        LD DE,FCOLOR 	;
321)   11FF ED B0       		        LDIR	;
322)   1201 C9          		    RET	;
326)   1202 CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
327)   1205 CD 9C 11    		        CALL GRPH_CALCREL	;
328)   1208 CD C5 10    		        CALL BAS_DODRAW	;
329)   120B CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
330)   120E C9          		        RET	;
333)   120F CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
334)   1212 CD C5 10    		        CALL BAS_DODRAW	;
335)   1215 CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
336)   1218 C9          		        RET	;
339)   1219 CD C5 10    		        CALL BAS_DODRAW  ;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT	;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT
340)   121C 2A 55 83    		        LD HL,(GR_LASTX3)	;
341)   121F 22 61 83    		        LD (GR_PARAM1),HL	;
342)   1222 2A 57 83    		        LD HL,(GR_LASTY3)	;
343)   1225 22 63 83    		        LD (GR_PARAM2),HL	;
344)   1228 CD C5 10    		        CALL BAS_DODRAW  ;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT	;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT
345)   122B 2A 55 83    		        LD HL,(GR_LASTX3)	;
346)   122E 22 61 83    		        LD (GR_PARAM1),HL	;
347)   1231 2A 57 83    		        LD HL,(GR_LASTY3)	;
348)   1234 22 63 83    		        LD (GR_PARAM2),HL	;
349)   1237 CD C5 10    		        CALL BAS_DODRAW  ;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT	;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT
350)   123A 01 04 00    		        LD BC,4	;
351)   123D 21 55 83    		        LD HL,GR_LASTX3	;
352)   1240 11 5D 83    		        LD DE,GR_LASTX	;
353)   1243 ED B0       		        LDIR               ;SET LASTX,LASTY         	;SET LASTX,LASTY
354)   1245 C9          		    RET	;
356)   1246 CD D0 11    		GRPH_TRIANGLEBC:CALL GRPH_SWAPGRCOLS	;
357)   1249 CD 19 12    		        CALL GRPH_TRIANGLE	;
358)   124C CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
359)   124F C9          		    RET	;
362)   1250 21 61 83    		GRPH_RECT:LD HL,GR_PARAM1	;
363)   1253 11 65 83    		        LD DE,GR_PARAM3	;
364)   1256 01 04 00    		        LD BC,4	;
365)   1259 ED B0       		        LDIR               ;COPY PARAM1,2 TO 3,4         	;COPY PARAM1,2 TO 3,4
366)   125B 2A 5F 83    		        LD HL,(GR_LASTY)	;
367)   125E E5          		        PUSH HL            ;PT1_Y	;PT1_Y
368)   125F 2A 5D 83    		        LD HL,(GR_LASTX)	;
369)   1262 E5          		        PUSH HL            ;PT1_X         	;PT1_X
370)   1263 2A 5F 83    		        LD HL,(GR_LASTY)         	;
371)   1266 22 63 83    		        LD (GR_PARAM2),HL         	;
372)   1269 CD C5 10    		        CALL BAS_DODRAW    ;PT1_X,PT1_Y TO PT2_X,PT1_Y	;PT1_X,PT1_Y TO PT2_X,PT1_Y
373)   126C 2A 67 83    		        LD HL,(GR_PARAM4)	;
374)   126F 22 63 83    		        LD (GR_PARAM2),HL	;
375)   1272 CD C5 10    		        CALL BAS_DODRAW    ;PT2_X,PT1_Y TO PT2_X,PT2_Y	;PT2_X,PT1_Y TO PT2_X,PT2_Y
376)   1275 E1          		        POP HL             ;PT1_X	;PT1_X
377)   1276 22 61 83    		        LD (GR_PARAM1),HL         	;
378)   1279 CD C5 10    		        CALL BAS_DODRAW    ;PT2_X,PT2_Y TO PT1_X,PT2_Y	;PT2_X,PT2_Y TO PT1_X,PT2_Y
379)   127C E1          		        POP HL             ;PT1_Y	;PT1_Y
380)   127D 22 63 83    		        LD (GR_PARAM2),HL	;
381)   1280 CD C5 10    		        CALL BAS_DODRAW    ;PT1_X,PT2_Y TO PT1_X,PT1_Y	;PT1_X,PT2_Y TO PT1_X,PT1_Y
382)   1283 01 04 00    		        LD BC,4	;
383)   1286 21 65 83    		        LD HL,GR_PARAM3	;
384)   1289 11 5D 83    		        LD DE,GR_LASTX	;
385)   128C ED B0       		        LDIR               ;SET LASTX,LASTY	;SET LASTX,LASTY
386)   128E C9          		        RET	;
388)   128F CD D0 11    		GRPH_RECTBC:CALL GRPH_SWAPGRCOLS	;
389)   1292 CD 50 12    		        CALL GRPH_RECT	;
390)   1295 CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
391)   1298 C9          		    RET	;
394)   1299 CD DF 11    		GRPH_CIRCREL: CALL GRPH_SAVECOLORS	;
395)   129C 2A 61 83    		        LD HL,(GR_PARAM1)	;
396)   129F 7C          		        LD A,H	;
397)   12A0 B5          		        OR L	;
398)   12A1 20 06       		        JR NZ,CIRE_DOIT 	;
399)   12A3 2A 63 83    		        LD HL,(GR_PARAM2)	;
400)   12A6 7C          		        LD A,H	;
401)   12A7 B5          		        OR L	;
402)   12A8 C8          		        RET Z              ; RETURN IF BOTH PARAMS ARE ZERO         	; RETURN IF BOTH PARAMS ARE ZERO
403)   12A9 ED 5B 5D 83 		CIRE_DOIT:LD DE,(GR_LASTX)	;
404)   12AD D5          		        PUSH DE	;
405)   12AE ED 5B 5F 83 		        LD DE,(GR_LASTY)	;
406)   12B2 D5          		        PUSH DE 	;
407)   12B3 E5          		        PUSH HL	;
408)   12B4 CD A1 0A    		        CALL LCD_CIRCLE	;
409)   12B7 CD F6 11    		        CALL GRPH_RESTORECOLORS	;
410)   12BA C9          		        RET  	;
412)   12BB CD D0 11    		GRPH_CIRCRELBC:CALL GRPH_SWAPGRCOLS	;
413)   12BE CD 99 12    		        CALL GRPH_CIRCREL	;
414)   12C1 CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
415)   12C4 C9          		        RET	;
421)   12C5 C9          		GRPH_CIRCLE:RET	;
422)   12C6 2A 5D 83    		        LD HL,(GR_LASTX)	;
423)   12C9 ED 5B 61 83 		        LD DE,(GR_PARAM1)	;
424)   12CD AF          		        XOR A	;
425)   12CE ED 42       		        SBC HL,BC	;
426)   12D0 22 65 83    		        LD (GR_PARAM3),HL    ;X2-X1	;X2-X1
427)   12D3 2A 5F 83    		        LD HL,(GR_LASTY)	;
428)   12D6 ED 5B 63 83 		        LD DE,(GR_PARAM2)	;
429)   12DA AF          		        XOR A	;
430)   12DB ED 42       		        SBC HL,BC	;
431)   12DD 22 67 83    		        LD (GR_PARAM4),HL    ;Y2-Y1         	;Y2-Y1
433)   12E0 ED 4B 65 83 		        LD BC,(GR_PARAM3)	;
434)   12E4 C5          		        PUSH BC	;
435)   12E5 D1          		        POP DE	;
436)   12E6 CD 7A 17    		        CALL MULT32   ;BCHL RESULT	;BCHL RESULT
437)   12E9 D9          		        EXX	;
438)   12EA C5          		        PUSH BC	;
439)   12EB D1          		        POP DE	;
440)   12EC D9          		        EXX	;
441)   12ED E5          		        PUSH HL       ;DE LOW         	;DE LOW
442)   12EE ED 4B 67 83 		        LD BC,(GR_PARAM4)	;
443)   12F2 C5          		        PUSH BC	;
444)   12F3 D1          		        POP DE	;
445)   12F4 CD 7A 17    		        CALL MULT32   ;BCHL RESULT	;BCHL RESULT
446)   12F7 D9          		        EXX         	;
447)   12F8 C5          		        PUSH BC	;
448)   12F9 E1          		        POP HL	;
449)   12FA D9          		        EXX	;
450)   12FB D1          		        POP DE	;
452)   12FC CD 95 17    		        CALL ADD32	;
456)   12FF C9          		        RET	;
458)   1300 CD D0 11    		GRPH_CIRCLEBC:CALL GRPH_SWAPGRCOLS	;
459)   1303 CD C5 12    		        CALL GRPH_CIRCLE	;
460)   1306 CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
461)   1309 C9          		        RET  	;
465)   130A CD D0 11    		GRPH_FILL: CALL GRPH_SWAPGRCOLS 	;
466)   130D CD DF 11    		        CALL GRPH_SAVECOLORS	;
467)   1310 2A 61 83    		        LD HL,(GR_PARAM1)	;
468)   1313 E5          		        PUSH HL	;
469)   1314 2A 63 83    		        LD HL,(GR_PARAM2)	;
470)   1317 E5          		        PUSH HL	;
471)   1318 CD 25 0C    		        CALL LCD_FILL	;
472)   131B CD F6 11    		        CALL GRPH_RESTORECOLORS	;
473)   131E CD D0 11    		        CALL GRPH_SWAPGRCOLS	;
474)   1321 C9          		        RET         	;
476)   1322 B3 11       		PLOT00: DW GRPH_MOVEREL	;
477)   1324 BA 11       		    DW GRPH_LINEREL	;
478)   1326 88 11       		    DW GRPH_NOTIMPL	;
479)   1328 02 12       		    DW GRPH_LINERELBC	;
480)   132A A5 10       		    DW GRPH_SAVELASTPOS	;
481)   132C C5 10       		    DW BAS_DODRAW	;
482)   132E 88 11       		    DW GRPH_NOTIMPL     	;
483)   1330 0F 12       		    DW GRPH_DRAWBC	;
485)   1332 88 11       		PLOT80: DW GRPH_NOTIMPL	;
486)   1334 19 12       		    DW GRPH_TRIANGLE	;
487)   1336 88 11       		    DW GRPH_NOTIMPL	;
488)   1338 46 12       		    DW GRPH_TRIANGLEBC	;
489)   133A 88 11       		    DW GRPH_NOTIMPL	;
490)   133C 19 12       		    DW GRPH_TRIANGLE	;
491)   133E 88 11       		    DW GRPH_NOTIMPL     	;
492)   1340 46 12       		    DW GRPH_TRIANGLEBC	;
494)   1342 88 11       		PLOT96: DW GRPH_NOTIMPL	;
495)   1344 50 12       		    DW GRPH_RECT	;
496)   1346 88 11       		    DW GRPH_NOTIMPL	;
497)   1348 8F 12       		    DW GRPH_RECTBC	;
498)   134A 88 11       		    DW GRPH_NOTIMPL	;
499)   134C 50 12       		    DW GRPH_RECT	;
500)   134E 88 11       		    DW GRPH_NOTIMPL     	;
501)   1350 8F 12       		    DW GRPH_RECTBC	;
503)   1352 88 11       		PLOT128: DW GRPH_NOTIMPL	;
504)   1354 0A 13       		    DW GRPH_FILL	;
505)   1356 88 11       		    DW GRPH_NOTIMPL	;
506)   1358 88 11       		    DW GRPH_NOTIMPL	;
507)   135A 88 11       		    DW GRPH_NOTIMPL	;
508)   135C 88 11       		    DW GRPH_NOTIMPL	;
509)   135E 88 11       		    DW GRPH_NOTIMPL     	;
510)   1360 88 11       		    DW GRPH_NOTIMPL	;
512)   1362 99 12       		PLOT144: DW GRPH_CIRCREL	;
513)   1364 99 12       		    DW GRPH_CIRCREL	;
514)   1366 88 11       		    DW GRPH_NOTIMPL	;
515)   1368 BB 12       		    DW GRPH_CIRCRELBC	;
516)   136A C5 12       		    DW GRPH_CIRCLE	;
517)   136C C5 12       		    DW GRPH_CIRCLE	;
518)   136E 88 11       		    DW GRPH_NOTIMPL     	;
519)   1370 00 13       		    DW GRPH_CIRCLEBC	;
521)   1372 88 11       		PLOT152: DW GRPH_NOTIMPL	;
522)   1374 88 11       		    DW GRPH_NOTIMPL	;
523)   1376 88 11       		    DW GRPH_NOTIMPL	;
524)   1378 88 11       		    DW GRPH_NOTIMPL	;
525)   137A 88 11       		    DW GRPH_NOTIMPL	;
526)   137C 88 11       		    DW GRPH_NOTIMPL	;
527)   137E 88 11       		    DW GRPH_NOTIMPL     	;
528)   1380 88 11       		    DW GRPH_NOTIMPL	;
530)   1382 88 11       		PLOT160: DW GRPH_NOTIMPL	;
531)   1384 88 11       		    DW GRPH_NOTIMPL	;
532)   1386 88 11       		    DW GRPH_NOTIMPL	;
533)   1388 88 11       		    DW GRPH_NOTIMPL	;
534)   138A 88 11       		    DW GRPH_NOTIMPL	;
535)   138C 88 11       		    DW GRPH_NOTIMPL	;
536)   138E 88 11       		    DW GRPH_NOTIMPL     	;
537)   1390 88 11       		    DW GRPH_NOTIMPL	;
539)   1392 88 11       		PLOT192: DW GRPH_NOTIMPL	;
540)   1394 88 11       		    DW GRPH_NOTIMPL	;
541)   1396 88 11       		    DW GRPH_NOTIMPL	;
542)   1398 88 11       		    DW GRPH_NOTIMPL	;
543)   139A 88 11       		    DW GRPH_NOTIMPL	;
544)   139C 88 11       		    DW GRPH_NOTIMPL	;
545)   139E 88 11       		    DW GRPH_NOTIMPL     	;
546)   13A0 88 11       		    DW GRPH_NOTIMPL	;
548)   13A2 88 11       		PLOT200: DW GRPH_NOTIMPL	;
549)   13A4 88 11       		    DW GRPH_NOTIMPL	;
550)   13A6 88 11       		    DW GRPH_NOTIMPL	;
551)   13A8 88 11       		    DW GRPH_NOTIMPL	;
552)   13AA 88 11       		    DW GRPH_NOTIMPL	;
553)   13AC 88 11       		    DW GRPH_NOTIMPL	;
554)   13AE 88 11       		    DW GRPH_NOTIMPL     	;
555)   13B0 88 11       		    DW GRPH_NOTIMPL	;
558)   13B2 AF          		  XOR     A	;
559)   13B3 CD F0 46    		  CALL    EXTERR	;
560)   13B6 70 61 72 61 		  DEFM    'param error'	;
560)   13BA 6D 20 65 72 		  DEFM    'param error'	;
560)   13BE 72 6F 72    		  DEFM    'param error'	;
561)   13C1 00          		  DEFB    0     	;
 14)   13C2 	            		DEVKBI EQU DEVINP; INPUT FROM THE KEYBOARD IS ROUTED TO BITS 7,6(DAT,CLK) OF THE INPUT DEVICE 74LS257 CHIP	; INPUT FROM THE KEYBOARD IS ROUTED TO BITS 7,6(DAT,CLK) OF THE INPUT DEVICE 74LS257 CHIP
 17)   13C2 06 01       		@KEYBCLKON: LD B,UKB_OUT_CLK	;
 18)   13C4 CD D6 03    		      CALL FF_OFF	;
 19)   13C7 C9          		      RET	;
 21)   13C8 06 01       		@KEYBCLKOFF: LD B,UKB_OUT_CLK	;
 22)   13CA CD E7 03    		     CALL FF_ON	;
 23)   13CD C9          		     RET	;
 25)   13CE 06 02       		@KEYBDATON: LD B,UKB_OUT_DAT	;
 26)   13D0 CD D6 03    		      CALL FF_OFF	;
 27)   13D3 C9          		      RET	;
 29)   13D4 06 02       		@KEYBDATOFF: LD B,UKB_OUT_DAT	;
 30)   13D6 CD E7 03    		     CALL FF_ON	;
 31)   13D9 C9          		     RET	;
 33)   13DA CD C2 13    		PS2ISK:CALL KEYBCLKON ;KEYBOARD ENABLED	;KEYBOARD ENABLED
 34)   13DD 06 1E       		   LD B,30 ;CHECK SEVERAL TIMES 0.2 MS (30 ON 10mHZ)	;CHECK SEVERAL TIMES 0.2 MS (30 ON 10mHZ)
 35)   13DF DB 18       		CHAG: IN A,(DEVKBI)	;
 36)   13E1 57          		   LD D,A	;
 37)   13E2 CB 77       		   BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK	;CHECK BIT 6=CLOCK
 38)   13E4 28 08       		   JR Z,KEYOK	;
 39)   13E6 10 F7       		   DJNZ CHAG	;
 41)   13E8 3E 01       		PS2NTP: LD A,1 ;SET A TO 1 MEANS NO KEY AVAILABLE  	;SET A TO 1 MEANS NO KEY AVAILABLE
 42)   13EA CD C8 13    		   CALL KEYBCLKOFF	;
 43)   13ED C9          		   RET	;
 44)   13EE AF          		KEYOK: XOR A ;SET A TO 0 MEANS WE HAVE A KEY	;SET A TO 0 MEANS WE HAVE A KEY
 45)   13EF C9          		   RET	;
 49)   13F0 06 32       		   LD B,50	;
 50)   13F2 B7          		   OR A   ;CLEAR CARRY	;CLEAR CARRY
 51)   13F3 DB 18       		WH1:IN A,(DEVKBI)	;
 52)   13F5 57          		   LD D,A    	;
 53)   13F6 CB 77       		   BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK	;CHECK BIT 6=CLOCK
 54)   13F8 C0          		   RET NZ	;
 55)   13F9 10 F8       		   DJNZ WH1	;
 56)   13FB 37          		   SCF	;
 57)   13FC C9          		   RET	;
 60)   13FD 06 32       		  LD B,50	;
 61)   13FF B7          		  OR A    ;CLEAR CARRY	;CLEAR CARRY
 62)   1400 DB 18       		WL1:IN A,(DEVKBI)	;
 63)   1402 57          		   LD D,A    	;
 64)   1403 CB 77       		   BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK    	;CHECK BIT 6=CLOCK
 65)   1405 C8          		   RET Z	;
 66)   1406 10 F8       		   DJNZ WL1	;
 67)   1408 37          		   SCF	;
 68)   1409 C9          		   RET	;
 70)   140A CD FD 13    		WAITFORLOW:CALL WAITFORLOW1	;
 71)   140D D8          		          RET C	;
 72)   140E DB 18       		           IN A,(DEVKBI);SOME MORE TIMES TO BE SURE	;SOME MORE TIMES TO BE SURE
 73)   1410 DB 18       		           IN A,(DEVKBI)	;
 74)   1412 57          		           LD D,A	;
 75)   1413 C9          		           RET	;
 79)   1414 7A          		   LD A,D ;BIT 7 HAS THE DATA	;BIT 7 HAS THE DATA
 80)   1415 CB 7F       		   BIT UKB_IN_DAT,A	;
 81)   1417 20 2C       		   JR NZ,ERROR0 ;ALWAYS START WITH 0	;ALWAYS START WITH 0
 82)   1419 06 08       		   LD B,8	;
 83)   141B 48          		NXTBIT: LD C,B ;SAVE B	;SAVE B
 84)   141C CD F0 13    		   CALL WAITFORHIGH 	;
 85)   141F D8          		   RET C	;
 86)   1420 CD 0A 14    		   CALL WAITFORLOW	;
 87)   1423 D8          		   RET C	;
 88)   1424 CB 27       		   SLA A ;BIT 7=DATA IS ON C FLAG	;BIT 7=DATA IS ON C FLAG
 89)   1426 CB 1B       		   RR E ;CARRY GOES TO BIT 7 OF E  	;CARRY GOES TO BIT 7 OF E
 90)   1428 41          		   LD B,C  ;RESTORE C	;RESTORE C
 91)   1429 10 F0       		   DJNZ NXTBIT	;
 92)   142B CD F0 13    		   CALL WAITFORHIGH 	;
 93)   142E D8          		   RET C	;
 94)   142F CD 0A 14    		   CALL WAITFORLOW     	;
 95)   1432 D8          		   RET C	;
 97)   1433 CD F0 13    		   CALL WAITFORHIGH 	;
 98)   1436 D8          		   RET C	;
 99)   1437 CD 0A 14    		   CALL WAITFORLOW 	;
100)   143A D8          		   RET C	;
101)   143B CB 7F       		   BIT UKB_IN_DAT,A	;
102)   143D 28 0E       		   JR Z,ERROR1 ;ALWAYS ENDS WITH 1  	;ALWAYS ENDS WITH 1
103)   143F CD F0 13    		   CALL WAITFORHIGH    ;WAIT FOR END OF TRANSMITION	;WAIT FOR END OF TRANSMITION
104)   1442 D8          		   RET C	;
106)   1443 7B          		   LD A,E	;
107)   1444 C9          		   RET	;
108)   1445 21 58 14    		ERROR0: LD HL,MSER4	;
109)   1448 CD 72 05    		   CALL RS_TXT	;
110)   144B 37          		   SCF ;FLAGS AN ERROR OCCURED	;FLAGS AN ERROR OCCURED
111)   144C C9          		   RET	;
112)   144D D5          		ERROR1:PUSH DE	;
113)   144E 21 7B 14    		   LD HL,MSER5	;
114)   1451 CD 72 05    		   CALL RS_TXT	;
115)   1454 37          		   SCF ;FLAGS AN ERROR OCCURED	;FLAGS AN ERROR OCCURED
116)   1455 D1          		   POP DE	;
117)   1456 7B          		   LD A,E ;MAYBE IGNORE THIS	;MAYBE IGNORE THIS
118)   1457 C9          		   RET	;
119)   1458 45 52 52 4F 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   145C 52 20 53 54 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   1460 41 52 54 20 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   1464 42 49 54 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   1468 4E 4F 54 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   146C 41 53 20 45 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   1470 58 50 45 43 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   1474 54 45 44 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
120)   1478 0A 0D 00    		   DB 10,13,0	;
121)   147B 45 52 52 4F 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   147F 52 20 53 54 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   1483 4F 50 20 42 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   1487 49 54 2E 4E 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   148B 4F 54 2E 41 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   148F 53 20 45 58 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   1493 50 45 43 54 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   1497 45 44 2E    		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
122)   149A 0A 0D 00    		   DB 10,13,0	;
124)   149D 01 0A 00    		PS2KEY: LD BC,10       	;
125)   14A0 0B          		PS2AGN DEC BC	;
126)   14A1 78          		       LD A,B	;
127)   14A2 B1          		       OR C	;
128)   14A3 28 0F       		       JR Z,PS2TIMEOUT	;
129)   14A5 C5          		       PUSH BC	;
130)   14A6 CD DA 13    		       CALL PS2ISK	;
131)   14A9 B7          		       OR A	;
132)   14AA C1          		       POP BC	;
133)   14AB 20 F3       		       JR NZ, PS2AGN ;NO KEY YET	;NO KEY YET
135)   14AD CD 14 14    		       CALL NEWBYTE 	;
136)   14B0 38 02       		       JR C,PS2TIMEOUT ;ERROR SO INVALIDATE A	;ERROR SO INVALIDATE A
137)   14B2 18 01       		       JR PS2EX	;
138)   14B4 AF          		PS2TIMEOUT:XOR A ;0 CODE IS INVALID	;0 CODE IS INVALID
139)   14B5 F5          		PS2EX  PUSH AF       	;
140)   14B6 CD C8 13    		       CALL KEYBCLKOFF	;
141)   14B9 F1          		       POP AF	;
142)   14BA C9          		       RET	;
145)   14BB CD C2 14    		READCHAR:CALL GTKEY	;
146)   14BE CD 81 15    		      CALL PS2LOK	;
147)   14C1 C9          		      RET	;
150)   14C2 CD 9D 14    		@GTKEY: CALL PS2KEY ;GET A KEY FROM PS2	;GET A KEY FROM PS2
151)   14C5 FE E1       		 CP $E1 ;BREAK KEY	;BREAK KEY
152)   14C7 CC EE 14    		 CALL Z,GTBRK	;
153)   14CA FE F0       		 CP $F0 ;240 KEY RELEASED	;240 KEY RELEASED
154)   14CC CC 32 15    		 CALL Z,GTREL	;
155)   14CF FE E0       		 CP $E0 ;224 EXTENDED KEYS	;224 EXTENDED KEYS
156)   14D1 CC F8 14    		 CALL Z,GTEXT	;
159)   14D4 FE 12       		 CP 18 ;LEFT SHIFT	;LEFT SHIFT
160)   14D6 CC 5D 15    		 CALL Z,SHFTOG	;
161)   14D9 FE 59       		 CP 89 ;RIGHT SHIFT	;RIGHT SHIFT
162)   14DB CC 5D 15    		 CALL Z,SHFTOG	;
163)   14DE FE 14       		 CP 20 ;RIGHT CONTROL	;RIGHT CONTROL
164)   14E0 CC 66 15    		 CALL Z,CTRTOG 	;
165)   14E3 FE 11       		 CP 17 ;LEFT ALT	;LEFT ALT
166)   14E5 CC 6F 15    		 CALL Z,ALTTOG	;
167)   14E8 FE 58       		 CP $58 ;CAPS LOCK	;CAPS LOCK
168)   14EA CC 78 15    		 CALL Z,CAPSTOG	;
171)   14ED C9          		 RET	;
173)   14EE CD 9D 14    		GTBRK: CALL PS2KEY ;$14 OR $F0	;$14 OR $F0
174)   14F1 FE F0       		 CP $F0	;
175)   14F3 C8          		 RET Z	;
176)   14F4 CD 9D 14    		 CALL PS2KEY ;$77	;$77
177)   14F7 C9          		 RET	;
179)   14F8 CD 9D 14    		GTEXT: CALL PS2KEY ; THIS IS THE EXTENDED KEY	; THIS IS THE EXTENDED KEY
180)   14FB FE 6B       		 CP $6B ;LEFT	;LEFT
181)   14FD C8          		 RET Z	;
182)   14FE FE 72       		 CP $72 ;DOWN	;DOWN
183)   1500 C8          		 RET Z	;
184)   1501 FE 74       		 CP $74 ;RIGHT	;RIGHT
185)   1503 C8          		 RET Z	;
186)   1504 FE 75       		 CP $75 ;UP	;UP
187)   1506 C8          		 RET Z	;
188)   1507 FE 70       		 CP $70 ;INSERT	;INSERT
189)   1509 C8          		 RET Z	;
190)   150A FE 6C       		 CP $6C ;HOME	;HOME
191)   150C C8          		 RET Z	;
192)   150D FE 7D       		 CP $7D ;PG UP	;PG UP
193)   150F C8          		 RET Z	;
194)   1510 FE 7A       		 CP $7A ;PG DN	;PG DN
195)   1512 C8          		 RET Z	;
196)   1513 FE 69       		 CP $69 ;END	;END
197)   1515 C8          		 RET Z	;
198)   1516 FE 71       		 CP $71 ;DEL	;DEL
199)   1518 C8          		 RET Z	;
200)   1519 FE 66       		 CP $66  ;BACKSPACE	;BACKSPACE
201)   151B C8          		 RET Z	;
202)   151C FE 5A       		 CP $5A ;ENTER NUM	;ENTER NUM
203)   151E C8          		 RET Z	;
204)   151F FE 11       		 CP $11 ;RIGHT ALT	;RIGHT ALT
205)   1521 C8          		 RET Z	;
206)   1522 FE 14       		 CP $14 ;LEFT ALT	;LEFT ALT
207)   1524 C8          		 RET Z	;
208)   1525 FE 4A       		 CP $4A ;NUMLOCK /	;NUMLOCK /
209)   1527 C8          		 RET Z	;
210)   1528 FE F0       		 CP $F0	;
211)   152A C2 30 15    		 JP NZ, EXGTEX ;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY	;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY
212)   152D CD 9D 14    		 CALL PS2KEY ; THIS IS THE EXTENDED RELEASED KEY JUST IGNORE IT	; THIS IS THE EXTENDED RELEASED KEY JUST IGNORE IT
214)   1530 AF          		EXGTEX XOR A ;NOT VALID EXTENDED KEY	;NOT VALID EXTENDED KEY
215)   1531 C9          		 RET	;
218)   1532 CD 9D 14    		GTREL: CALL PS2KEY ; THIS IS THE RELEASED KEY	; THIS IS THE RELEASED KEY
219)   1535 FE 12       		 CP 18 ; LSHIFT RELEASED	; LSHIFT RELEASED
220)   1537 CC 4B 15    		 CALL Z,SHFRES ; RESET SHIFT	; RESET SHIFT
221)   153A FE 14       		 CP 20 ; LCTRL RELEASED	; LCTRL RELEASED
222)   153C CC 51 15    		 CALL Z,CTRRES ; RESET CONTROL	; RESET CONTROL
223)   153F FE 11       		 CP 17 ; LALT RELEASED	; LALT RELEASED
224)   1541 CC 57 15    		 CALL Z,ALTRES ; RESET ALT	; RESET ALT
225)   1544 FE 59       		 CP 89 ; RSHIFT RELEASED	; RSHIFT RELEASED
226)   1546 CC 4B 15    		 CALL Z,SHFRES ; RESET SHIFT	; RESET SHIFT
227)   1549 AF          		 XOR A ; NO KEY	; NO KEY
228)   154A C9          		 RET	;
230)   154B 21 86 83    		SHFRES: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH 	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
231)   154E CB B6       		 RES 6,(HL)  ; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
232)   1550 C9          		 RET	;
234)   1551 21 86 83    		CTRRES: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
235)   1554 CB BE       		 RES 7,(HL) ; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
236)   1556 C9          		 RET	;
238)   1557 21 86 83    		ALTRES: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
239)   155A CB AE       		 RES 5,(HL) ; BIT 5 IS SHIFT $20=32 	; BIT 5 IS SHIFT $20=32
240)   155C C9          		 RET	;
242)   155D 21 86 83    		SHFTOG: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH 	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
243)   1560 3E 40       		 LD A,$40 ; MASK	; MASK
244)   1562 AE          		 XOR (HL)  ; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
245)   1563 77          		 LD (HL),A ; SAVE	; SAVE
246)   1564 AF          		 XOR A ; NO KEY	; NO KEY
247)   1565 C9          		 RET	;
249)   1566 21 86 83    		CTRTOG: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
250)   1569 3E 80       		 LD A,$80 ; MASK	; MASK
251)   156B AE          		 XOR (HL) ; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
252)   156C 77          		 LD (HL),A ; SAVE	; SAVE
253)   156D AF          		 XOR A ; NO KEY	; NO KEY
254)   156E C9          		 RET	;
256)   156F 21 86 83    		ALTTOG: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
257)   1572 3E 20       		 LD A,$20	;
258)   1574 AE          		 XOR (HL) ; BIT 5 IS ALT $20=32 	; BIT 5 IS ALT $20=32
259)   1575 77          		 LD (HL),A ; SAVE	; SAVE
260)   1576 AF          		 XOR A ; NO KEY	; NO KEY
261)   1577 C9          		 RET	;
263)   1578 21 86 83    		CAPSTOG: LD HL,KEYCTR ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS
264)   157B 3E 10       		 LD A,$10	;
265)   157D AE          		 XOR (HL) ; BIT 4 IS CAPS $10=16 	; BIT 4 IS CAPS $10=16
266)   157E 77          		 LD (HL),A ; SAVE	; SAVE
267)   157F AF          		 XOR A ; NO KEY	; NO KEY
268)   1580 C9          		 RET	;
272)   1581 21 86 83    		 LD HL,KEYCTR	;
273)   1584 47          		 LD B,A  ; SAVE A	; SAVE A
274)   1585 7E          		 LD A,(HL); GET KEYBFLAGS ON A SHIFT	; GET KEYBFLAGS ON A SHIFT
275)   1586 4F          		 LD C,A  ;CAPS ON C	;CAPS ON C
276)   1587 CB 1F       		 RR A	;
277)   1589 CB 1F       		 RR A    ;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6	;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6
278)   158B A9          		 XOR C   ;XOR SHIFT WITH CAPS	;XOR SHIFT WITH CAPS
279)   158C CB 67       		 BIT 4,A ;CHECK IF BIT 4 IS 0 = UNSHIFTED	;CHECK IF BIT 4 IS 0 = UNSHIFTED
280)   158E 78          		 LD A,B  ;RESTORE A	;RESTORE A
285)   158F 21 9D 15    		 LD HL,PS2TAB1 ;UNSHIFTED	;UNSHIFTED
286)   1592 28 03       		 JR Z,PLK1	;
287)   1594 21 47 16    		 LD HL,PS2TAB2 ;SHIFTED	;SHIFTED
288)   1597 06 00       		PLK1:  LD B,0	;
289)   1599 4F          		 LD C,A	;
290)   159A 09          		 ADD HL,BC       	;
291)   159B 7E          		 LD A,(HL) ;GET THE CHAR	;GET THE CHAR
292)   159C C9          		 RET	;
296)   159D 00 00 00 00 		PS2TAB1 DB 0,0,0,0,0,0,0,0,0,0	;
296)   15A1 00 00 00 00 		PS2TAB1 DB 0,0,0,0,0,0,0,0,0,0	;
296)   15A5 00 00       		PS2TAB1 DB 0,0,0,0,0,0,0,0,0,0	;
297)   15A7 00 00 00 00 		      DB 0,0,0,0,'`',0,0,0,0,0	;
297)   15AB 60 00 00 00 		      DB 0,0,0,0,'`',0,0,0,0,0	;
297)   15AF 00 00       		      DB 0,0,0,0,'`',0,0,0,0,0	;
298)   15B1 00 71 31 00 		      DB 0,'q','1',0,0,0,'z','s','a','w'	;
298)   15B5 00 00 7A 73 		      DB 0,'q','1',0,0,0,'z','s','a','w'	;
298)   15B9 61 77       		      DB 0,'q','1',0,0,0,'z','s','a','w'	;
299)   15BB 32 00 00 63 		      DB '2',0,0,'c','x','d','e','4','3',0	;
299)   15BF 78 64 65 34 		      DB '2',0,0,'c','x','d','e','4','3',0	;
299)   15C3 33 00       		      DB '2',0,0,'c','x','d','e','4','3',0	;
300)   15C5 00 20 76 66 		      DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
300)   15C9 74 72 35 00 		      DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
300)   15CD 00 6E       		      DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
301)   15CF 62 68 67 6D 		      DB 'b','h','g','m','6',0,0,44,'m','j'     ;50-59	;50-59
301)   15D3 36 00 00 2C 		      DB 'b','h','g','m','6',0,0,44,'m','j'     ;50-59	;50-59
301)   15D7 6D 6A       		      DB 'b','h','g','m','6',0,0,44,'m','j'     ;50-59	;50-59
302)   15D9 75 37 38 00 		      DB 'u','7','8',0,0,',','k','i','o','0'   ;60-69	;60-69
302)   15DD 00 2C 6B 69 		      DB 'u','7','8',0,0,',','k','i','o','0'   ;60-69	;60-69
302)   15E1 6F 30       		      DB 'u','7','8',0,0,',','k','i','o','0'   ;60-69	;60-69
303)   15E3 39 00 00 2E 		      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
303)   15E7 2F 6C 3B 70 		      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
303)   15EB 2D 00       		      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
304)   15ED 00 00 27 00 		      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
304)   15F1 5B 3D 00 00 		      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
304)   15F5 00 00       		      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
305)   15F7 0D 5D 00 5C 		      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
305)   15FB 00 00 00 00 		      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
305)   15FF 00 00       		      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
306)   1601 00 00 06 00 		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
306)   1605 00 08 00 04 		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
306)   1609 09 00       		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
307)   160B 00 00 01 07 		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
307)   160F 0A 00 03 0B 		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
307)   1613 1B 00       		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
308)   1615 00 00 2B 2D 		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
308)   1619 2A 39 00 00 		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
308)   161D 00 00       		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
309)   161F 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
309)   1623 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
309)   1627 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
310)   1629 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
310)   162D 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
310)   1631 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
311)   1633 00 00 00 00 		       DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
311)   1637 00 00 00 00 		       DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
311)   163B 00 00       		       DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
312)   163D 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
312)   1641 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
312)   1645 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
315)   1647 00 00 00 00 		PS2TAB2 DB 0,0,0,0,0,0,0,0,0,0	;
315)   164B 00 00 00 00 		PS2TAB2 DB 0,0,0,0,0,0,0,0,0,0	;
315)   164F 00 00       		PS2TAB2 DB 0,0,0,0,0,0,0,0,0,0	;
316)   1651 00 00 00 00 		      DB 0,0,0,0,'~',0,0,0,0,0	;
316)   1655 7E 00 00 00 		      DB 0,0,0,0,'~',0,0,0,0,0	;
316)   1659 00 00       		      DB 0,0,0,0,'~',0,0,0,0,0	;
317)   165B 00 51 21 00 		      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
317)   165F 00 00 5A 53 		      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
317)   1663 41 57       		      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
318)   1665 40 00 00 43 		      DB '@',0,0,'C','X','D','E','$','#',0	;
318)   1669 58 44 45 24 		      DB '@',0,0,'C','X','D','E','$','#',0	;
318)   166D 23 00       		      DB '@',0,0,'C','X','D','E','$','#',0	;
319)   166F 00 20 56 46 		      DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
319)   1673 54 52 25 00 		      DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
319)   1677 00 4E       		      DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
320)   1679 42 48 47 59 		      DB 'B','H','G','Y','^',0,0,'"','M','J'   ;50-59	;50-59
320)   167D 5E 00 00 22 		      DB 'B','H','G','Y','^',0,0,'"','M','J'   ;50-59	;50-59
320)   1681 4D 4A       		      DB 'B','H','G','Y','^',0,0,'"','M','J'   ;50-59	;50-59
321)   1683 55 5E 2A 00 		      DB 'U','^','*',0,0,'<','K','I','O',')'   ;60-69	;60-69
321)   1687 00 3C 4B 49 		      DB 'U','^','*',0,0,'<','K','I','O',')'   ;60-69	;60-69
321)   168B 4F 29       		      DB 'U','^','*',0,0,'<','K','I','O',')'   ;60-69	;60-69
322)   168D 28 00 00 3E 		      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
322)   1691 3F 4C 3A 50 		      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
322)   1695 5F 00       		      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
323)   1697 00 00 22 00 		      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
323)   169B 7B 2B 00 00 		      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
323)   169F 00 00       		      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
324)   16A1 0D 7D 00 7C 		      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
324)   16A5 00 00 00 00 		      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
324)   16A9 00 00       		      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
325)   16AB 00 00 06 00 		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
325)   16AF 00 08 00 04 		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
325)   16B3 09 00       		      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
326)   16B5 00 00 01 07 		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
326)   16B9 0A 00 03 0B 		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
326)   16BD 1B 00       		      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
327)   16BF 00 00 2B 2D 		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
327)   16C3 2A 39 00 00 		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
327)   16C7 00 00       		      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
328)   16C9 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
328)   16CD 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
328)   16D1 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                 ;130-139	;130-139
329)   16D3 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
329)   16D7 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
329)   16DB 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
330)   16DD 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
330)   16E1 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
330)   16E5 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                  ;150-159	;150-159
331)   16E7 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
331)   16EB 00 00 00 00 		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
331)   16EF 00 00       		      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
 14)   16F1 C9          		     RET 	;
 17)   16F2 F5          		DELAYMICROSEC: PUSH AF	;
 18)   16F3 D5          		 PUSH DE	;
 19)   16F4 1B          		 DEC DE	;
 20)   16F5 D1          		 POP DE	;
 21)   16F6 F1          		 POP AF	;
 22)   16F7 C9          		 RET	;
 25)   16F8 CD F2 16    		S21: CALL DELAYMICROSEC	;
 26)   16FB 10 FB       		 DJNZ S21 	;
 27)   16FD C9          		 RET	;
 31)   16FE F5          		DELAYMILISEC: PUSH AF	;
 32)   16FF D5          		 PUSH DE	;
 33)   1700 11 2C 01    		 LD DE,300 ;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS	;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS
 34)   1703 1B          		DEL1: DEC DE	;
 35)   1704 7A          		 LD A,D           ;TEST FOR DE=00	;TEST FOR DE=00
 36)   1705 B3          		 OR E	;
 37)   1706 20 FB       		 JR NZ,DEL1 	;
 38)   1708 D1          		 POP DE	;
 39)   1709 F1          		 POP AF	;
 40)   170A C9          		 RET	;
 42)   170B 06 50       		DEL2:LD B,80	;
 44)   170D CD FE 16    		S1: CALL DELAYMILISEC	;
 45)   1710 10 FB       		 DJNZ S1 	;
 46)   1712 C9          		 RET	;
 51)   1713 C5          		@DELAYSEC:PUSH BC 	;
 52)   1714 01 E8 03    		        LD BC,1000 	;
 53)   1717 C5          		MYDLAGN: PUSH BC	;
 54)   1718 CD FE 16    		        CALL DELAY  ;1MS ON 8 MHZ	;1MS ON 8 MHZ
 55)   171B C1          		       POP BC	;
 56)   171C 0B          		       DEC BC	;
 57)   171D 78          		        LD A,B	;
 58)   171E B1          		        OR C	;
 59)   171F 20 F6       		        JR NZ,MYDLAGN	;
 60)   1721 C1          		        POP BC	;
 61)   1722 10 EF       		        DJNZ DELAYSEC	;
 62)   1724 C9          		        RET	;
 67)   1725 F5          		OUTASC PUSH AF	;
 68)   1726 D5          		 PUSH DE	;
 69)   1727 CD 30 17    		 CALL B2Bcd	;
 70)   172A D1          		 POP DE	;
 71)   172B CD 47 17    		 CALL BCD2HA	;
 72)   172E F1          		 POP AF	;
 73)   172F C9          		 RET 	;
 86)   1730 01 00 10    		LD BC, 16*256+0 ; handle 16 bits, one bit per iteration	; handle 16 bits, one bit per iteration
 87)   1733 11 00 00    		LD DE, 0	;
 89)   1736 29          		ADD HL, HL	;
 90)   1737 7B          		LD A, E	;
 91)   1738 8F          		ADC A, A	;
 92)   1739 27          		DAA	;
 93)   173A 5F          		LD E, A	;
 94)   173B 7A          		LD A, D	;
 95)   173C 8F          		ADC A, A	;
 96)   173D 27          		DAA	;
 97)   173E 57          		LD D, A	;
 98)   173F 79          		LD A, C	;
 99)   1740 8F          		ADC A, A	;
100)   1741 27          		DAA	;
101)   1742 4F          		LD C, A	;
102)   1743 10 F1       		DJNZ cvtLp	;
103)   1745 EB          		EX DE,HL	;
104)   1746 C9          		RET	;
115)   1747 79          		LD A, C	;
116)   1748 CD 5E 17    		CALL cvtUN	;
117)   174B 79          		LD A, C	;
118)   174C CD 62 17    		CALL cvtLN	;
119)   174F 7C          		LD A, H	;
120)   1750 CD 5E 17    		CALL cvtUN	;
121)   1753 7C          		LD A, H	;
122)   1754 CD 62 17    		CALL cvtLN	;
123)   1757 7D          		LD A, L	;
124)   1758 CD 5E 17    		CALL cvtUN	;
125)   175B 7D          		LD A, L	;
126)   175C 18 04       		JR cvtLN	;
128)   175E 1F          		RRA ; move upper nibble into lower nibble	; move upper nibble into lower nibble
129)   175F 1F          		RRA	;
130)   1760 1F          		RRA	;
131)   1761 1F          		RRA	;
133)   1762 E6 0F       		AND 0Fh ; isolate lower nibble	; isolate lower nibble
134)   1764 C6 90       		ADD A, 90h ; old trick	; old trick
135)   1766 27          		DAA ; for converting	; for converting
136)   1767 CE 40       		ADC A, 40h ; one nibble	; one nibble
137)   1769 27          		DAA ; to hex ASCII	; to hex ASCII
138)   176A 12          		LD (DE), A	;
139)   176B 13          		INC DE	;
140)   176C C9          		RET	;
  9)   176D 78          		   ld a,b	;
 10)   176E 06 10       		   ld b,16	;
 12)   1770 29          		   add hl,hl	;
 13)   1771 CB 21       		   sla c	;
 14)   1773 17          		   rla	;
 15)   1774 30 01       		   jr nc,Mult16_NoAdd	;
 16)   1776 19          		   add hl,de	;
 18)   1777 10 F7       		   djnz Mult16_Loop	;
 19)   1779 C9          		   ret	;
 25)   177A D5          		@Mult32:PUSH DE	;
 26)   177B 79          		   ld a,c	;
 27)   177C 48          		   ld c,b	;
 28)   177D 21 00 00    		   ld hl,0	;
 29)   1780 06 10       		   ld b,16	;
 31)   1782 29          		   add hl,hl	;
 32)   1783 17          		   rla	;
 33)   1784 CB 11       		   rl c	;
 34)   1786 30 07       		   jr nc,Mult32_NoAdd	;
 35)   1788 19          		   add hl,de	;
 36)   1789 CE 00       		   adc a,0	;
 37)   178B D2 8F 17    		   jp nc,Mult32_NoAdd	;
 38)   178E 0C          		   inc c	;
 40)   178F 10 F1       		   djnz Mult32_Loop	;
 41)   1791 41          		   ld b,c	;
 42)   1792 4F          		   ld c,a	;
 43)   1793 D1          		   POP DE	;
 44)   1794 C9          		   ret	;
 52)   1795 19          		       ADD     HL,DE   ; 16-BIT ADD OF HL AND DE	; 16-BIT ADD OF HL AND DE
 53)   1796 D9          		       EXX	;
 54)   1797 ED 5A       		       ADC     HL,DE   ; 16-BIT ADD OF HL AND DE WITH CARRY	; 16-BIT ADD OF HL AND DE WITH CARRY
 55)   1799 D9          		       EXX	;
 58)   179A C9          		       RET	;
 68)   179B 11 40 00    		   ld de,$0040	;
 69)   179E 7D          		   ld a,l	;
 70)   179F 6C          		   ld l,h	;
 71)   17A0 62          		   ld h,d	;
 72)   17A1 B7          		   or a	;
 73)   17A2 06 08       		   ld b,8	;
 75)   17A4 ED 52       		   sbc hl,de	;
 76)   17A6 30 01       		   jr nc,Sqr16_Skip	;
 77)   17A8 19          		   add hl,de	;
 79)   17A9 3F          		   ccf	;
 80)   17AA CB 12       		   rl d	;
 81)   17AC 87          		   add a,a	;
 82)   17AD ED 6A       		   adc hl,hl	;
 83)   17AF 87          		   add a,a	;
 84)   17B0 ED 6A       		   adc hl,hl	;
 85)   17B2 10 F0       		   djnz Sqr16_Loop	;
 86)   17B4 C9          		   ret        	;
 30)   17B5 C3 54 0D    		@MYOS_CLRSCN:JP LCD_CLRSCR       ; CLRSCN: clears the screen.	; CLRSCN: clears the screen.
 33)   17B8 C9          		        RET	;
 35)   17B9 11 00 00    		         LD DE, 0	;
 36)   17BC 21 00 00    		        LD HL, 0	;
 37)   17BF C9          		       RET         	;
 39)   17C0 63          		          LD H,E	;
 40)   17C1 E5          		          PUSH HL	;
 41)   17C2 CD 0D 0D    		          CALL LCD_RMVCURS	;
 42)   17C5 E1          		          POP HL	;
 43)   17C6 7C          		          LD A,H	;
 44)   17C7 32 0D 83    		          LD (CURSORX),A	;
 45)   17CA 7D          		          LD A,L	;
 46)   17CB 32 0E 83    		          LD (CURSORY),A	;
 47)   17CE CD 12 0D    		          CALL LCD_PRNCURS                      	;
 48)   17D1 C9          		          RET	;
 50)   17D2 16 00       		          LD D,0	;
 51)   17D4 3A 0D 83    		          LD A,(CURSORX)	;
 52)   17D7 5F          		          LD E,A	;
 53)   17D8 26 00       		          LD H,0	;
 54)   17DA 3A 0E 83    		          LD A,(CURSORY)	;
 55)   17DD 6F          		       LD L,A	;
 56)   17DE C9          		       RET	;
 57)   17DF 06 50       		KEYGET: LD      B,80 ;SCREEN WIDTH IN CHARS      	;SCREEN WIDTH IN CHARS
 59)   17E1 E5          		         PUSH    HL	;
 60)   17E2 ED 62       		          SBC     HL,HL           ;HL=0	;HL=0
 61)   17E4 CD C8 19    		          CALL    MYOS_OSKEY	;
 62)   17E7 E1          		          POP     HL	;
 63)   17E8 D8          		          RET     C	;
 64)   17E9 18 F6       		          JR      MYOS_OSRDCH           	;
 65)   17EB C9          		       RET  	;
 67)   17EC F5          		       PUSH    AF	;
 68)   17ED D5          		          PUSH    DE	;
 69)   17EE E5          		          PUSH    HL	;
 70)   17EF DD E5       		          PUSH    IX                      	;
 71)   17F1 5F          		          LD      E,A	;
 72)   17F2 CD E7 19    		          CALL    ESCTEST	;
 75)   17F5 7B          		          LD A,E	;
 76)   17F6 FE 20       		          CP 32	;
 77)   17F8 38 0D       		          JR C,CTRCODE	;
 78)   17FA FE 7F       		          CP 127   ;BACKSPACE 	;BACKSPACE
 79)   17FC C2 7C 19    		          JP NZ,PRINTIT	;
 80)   17FF 3E 08       		          LD A,8            ;DO A BACKSPACE	;DO A BACKSPACE
 81)   1801 CD 2F 0C    		          CALL LCD_PRINTCHAR	;
 82)   1804 C3 7F 19    		          JP OSWREXIT	;
 83)   1807 FE 04       		CTRCODE:  CP 4 ;WRITE TEXT AT TEXT POS	;WRITE TEXT AT TEXT POS
 84)   1809 20 06       		          JR NZ,CC1	;
 85)   180B 32 14 83    		          LD (VDUMODE),A           	;
 86)   180E C3 7F 19    		          JP OSWREXIT	;
 87)   1811 FE 05       		CC1:      CP 5 ;WRITE TEXT AT GRAPH POS    	;WRITE TEXT AT GRAPH POS
 88)   1813 20 06       		          JR NZ,CC2	;
 89)   1815 32 14 83    		          LD (VDUMODE),A	;
 90)   1818 C3 7F 19    		          JP OSWREXIT	;
 91)   181B FE 06       		CC2:      CP 6 ;ENABLE OUTPUT TO SCREEN	;ENABLE OUTPUT TO SCREEN
 92)   181D 20 03       		          JR NZ,CC3	;
 93)   181F C3 7F 19    		          JP OSWREXIT	;
 94)   1822 FE 07       		CC3:      CP 7 ;BEEP	;BEEP
 95)   1824 20 03       		          JR NZ,CC4	;
 96)   1826 C3 7F 19    		          JP OSWREXIT	;
 97)   1829 FE 08       		CC4:      CP 8 ;MOVE TEXT CURSOR BACK A CHAR	;MOVE TEXT CURSOR BACK A CHAR
 98)   182B 20 03       		          JR NZ,CC5	;
 99)   182D C3 7C 19    		          JP PRINTIT	;
106)   1830 FE 09       		CC5:      CP 9 ;MOVE TEXT CURSOR FORWARD A CHAR	;MOVE TEXT CURSOR FORWARD A CHAR
107)   1832 20 0F       		          JR NZ,CC6	;
108)   1834 3A 0D 83    		          LD A,(CURSORX)	;
109)   1837 3C          		          INC A	;
110)   1838 FE 50       		          CP 80	;
111)   183A D2 7F 19    		          JP NC,OSWREXIT	;
112)   183D 32 0D 83    		          LD (CURSORX),A         	;
113)   1840 C3 7F 19    		          JP OSWREXIT   	;
114)   1843 FE 0A       		CC6:      CP 10 ;MOVE TEXT DOWN LF	;MOVE TEXT DOWN LF
115)   1845 CA 7C 19    		          JP Z,PRINTIT	;
116)   1848 FE 0B       		CC7:      CP 11 ;MOVE TEXT UP	;MOVE TEXT UP
117)   184A 20 0F       		          JR NZ,CC8	;
118)   184C 3A 0E 83    		          LD A,(CURSORY)	;
119)   184F 3D          		          DEC A	;
120)   1850 FE FF       		          CP 0XFF	;
121)   1852 CA 7F 19    		          JP Z,OSWREXIT	;
122)   1855 32 0E 83    		          LD (CURSORY),A           	;
123)   1858 C3 7F 19    		          JP OSWREXIT   	;
124)   185B FE 0C       		CC8:      CP 12 ; CLS	; CLS
125)   185D 20 06       		          JR NZ,CC9	;
126)   185F CD 54 0D    		          CALL LCD_CLRSCR	;
127)   1862 C3 7F 19    		          JP OSWREXIT   	;
128)   1865 FE 0D       		CC9:      CP 13 ;GOTO START OF LINE CR	;GOTO START OF LINE CR
129)   1867 CA 7C 19    		          JP Z,PRINTIT	;
130)   186A FE 0E       		CC10:     CP 14 ;ENABLE THE AUTOPAGING MODE	;ENABLE THE AUTOPAGING MODE
131)   186C 20 03       		          JR NZ,CC11	;
132)   186E C3 7F 19    		          JP OSWREXIT   	;
133)   1871 FE 0F       		CC11:     CP 15 ;DISABLE THE AUTOPAGING MODE	;DISABLE THE AUTOPAGING MODE
134)   1873 20 03       		          JR NZ,CC12	;
135)   1875 C3 7F 19    		          JP OSWREXIT   	;
136)   1878 FE 10       		CC12:     CP 16 ;CLG	;CLG
137)   187A 20 06       		          JR NZ,CC13	;
138)   187C CD 5A 1B    		          CALL MYOS_CLG       	;
139)   187F C3 7F 19    		          JP OSWREXIT   	;
140)   1882 FE 11       		CC13:     CP 17 ; SAME AS COLOUR	; SAME AS COLOUR
141)   1884 20 09       		          JR NZ,CC14	;
143)   1886 FD 23       		          INC IY ;SKIP ','	;SKIP ','
144)   1888 CD 94 5E    		          CALL    EXPRI	;
145)   188B D9          		          EXX ;l has the param  color	;l has the param  color
146)   188C C3 7F 19    		          JP OSWREXIT   	;
147)   188F FE 12       		CC14:     CP 18 ;SAME AS GCOL	;SAME AS GCOL
148)   1891 20 0F       		          JR NZ,CC15	;
149)   1893 FD 23       		          INC IY ;SKIP ','	;SKIP ','
150)   1895 CD 94 5E    		          CALL    EXPRI	;
151)   1898 D9          		          EXX ;l has the param  mode	;l has the param  mode
152)   1899 FD 23       		          INC IY ;SKIP ','	;SKIP ','
153)   189B CD 94 5E    		          CALL    EXPRI	;
154)   189E D9          		          EXX ;l has the param  color                                        	;l has the param  color
156)   189F C3 7F 19    		          JP OSWREXIT   	;
157)   18A2 FE 13       		CC15:     CP 19 ;SELECT A COLOR PALLETTE???	;SELECT A COLOR PALLETTE???
158)   18A4 20 0F       		          JR NZ,CC16	;
160)   18A6 06 05       		          LD B,5	;
161)   18A8 C5          		CC15AGN:  PUSH BC	;
162)   18A9 FD 23       		          INC IY ;SKIP ','	;SKIP ','
163)   18AB CD 94 5E    		          CALL    EXPRI	;
164)   18AE D9          		          EXX ;l has the param	;l has the param
165)   18AF C1          		          POP BC	;
166)   18B0 10 F6       		          DJNZ CC15AGN           	;
167)   18B2 C3 7F 19    		          JP OSWREXIT   	;
168)   18B5 FE 14       		CC16:     CP 20 ;RESTORE THE DEFAULT LOGICAL COLORS	;RESTORE THE DEFAULT LOGICAL COLORS
169)   18B7 20 03       		          JR NZ,CC17           	;
171)   18B9 C3 7F 19    		          JP OSWREXIT   	;
172)   18BC FE 15       		CC17:     CP 21 ;NO OUTPUT TO SCREEN	;NO OUTPUT TO SCREEN
173)   18BE 20 03       		          JR NZ,CC18	;
175)   18C0 C3 7F 19    		          JP OSWREXIT   	;
176)   18C3 FE 16       		CC18:     CP 22 ;LIKE MODE	;LIKE MODE
177)   18C5 20 09       		          JR NZ,CC19	;
178)   18C7 FD 23       		          INC IY ;SKIP ','	;SKIP ','
179)   18C9 CD 94 5E    		          CALL    EXPRI	;
180)   18CC D9          		          EXX ;l has the param           	;l has the param
181)   18CD C3 7F 19    		          JP OSWREXIT   	;
182)   18D0 FE 17       		CC19:     CP 23 ;Program characters and control the cursor.???	;Program characters and control the cursor.???
183)   18D2 20 23       		          JR NZ,CC20	;
184)   18D4 06 09       		          LD B,9   ;9 PARAMS CHAR_NO +8 ROWS OF A CHAR	;9 PARAMS CHAR_NO +8 ROWS OF A CHAR
185)   18D6 FD 7E 00    		          LD A,(IY)	;
186)   18D9 FD 23       		          INC IY ;SKIP ',' OR ';'	;SKIP ',' OR ';'
187)   18DB FE 3B       		          CP ';'	;
188)   18DD 20 01       		          JR NZ,CC19AGN	;
189)   18DF 05          		          DEC B ; IF ; THE DELIMETER THEN 2 BYTES AT START   	; IF ; THE DELIMETER THEN 2 BYTES AT START
190)   18E0 C5          		CC19AGN:  PUSH BC	;
191)   18E1 CD 94 5E    		          CALL    EXPRI	;
192)   18E4 D9          		          EXX ;l has the param           	;l has the param
193)   18E5 FD 7E 00    		     LD A,(IY)	;
194)   18E8 FD 23       		          INC IY ;SKIP ','	;SKIP ','
195)   18EA FE 3B       		          CP ';'           	;
196)   18EC 20 03       		          JR NZ,CC19NXT	;
197)   18EE C1          		          POP BC	;
198)   18EF 05          		          DEC B	;
199)   18F0 C5          		          PUSH BC	;
200)   18F1 C1          		CC19NXT:  POP BC	;
201)   18F2 10 EC       		          DJNZ CC19AGN                     	;
202)   18F4 C3 7F 19    		          JP OSWREXIT   	;
203)   18F7 FE 18       		CC20:     CP 24 ;Define a graphics window	;Define a graphics window
204)   18F9 20 11       		          JR NZ,CC21	;
205)   18FB FD 23       		          INC IY ;SKIP ','	;SKIP ','
206)   18FD 06 04       		          LD B,4   ;4 PARAMS TWO CORNERS OF A RECT	;4 PARAMS TWO CORNERS OF A RECT
207)   18FF C5          		CC20AGN:  PUSH BC           	;
208)   1900 CD 94 5E    		          CALL    EXPRI	;
209)   1903 D9          		          EXX ;HL has the param	;HL has the param
210)   1904 FD 23       		          INC IY ;SKIP ';'	;SKIP ';'
211)   1906 C1          		          POP BC	;
212)   1907 10 F6       		          DJNZ CC20AGN                                	;
213)   1909 C3 7F 19    		          JP OSWREXIT   	;
214)   190C FE 19       		CC21:     CP 25 ;Identical to PLOT.	;Identical to PLOT.
215)   190E 20 17       		          JR NZ,CC22	;
216)   1910 FD 23       		          INC IY ;SKIP ','	;SKIP ','
217)   1912 CD 94 5E    		          CALL    EXPRI	;
218)   1915 D9          		          EXX ;L has the param PLOTMODE	;L has the param PLOTMODE
219)   1916 FD 23       		          INC IY ;SKIP ','	;SKIP ','
220)   1918 CD 94 5E    		          CALL    EXPRI	;
221)   191B D9          		          EXX ;HL has the param X	;HL has the param X
222)   191C FD 23       		          INC IY ;SKIP ';'	;SKIP ';'
223)   191E CD 94 5E    		          CALL    EXPRI	;
224)   1921 D9          		          EXX ;HL has the param Y	;HL has the param Y
225)   1922 FD 23       		          INC IY ;SKIP ';'	;SKIP ';'
228)   1924 C3 7F 19    		          JP OSWREXIT   	;
229)   1927 FE 1A       		CC22:     CP 26 ;Restore the default text and graphics windows.	;Restore the default text and graphics windows.
230)   1929 20 02       		          JR NZ,CC23	;
231)   192B 18 52       		          JR OSWREXIT   	;
232)   192D FE 1B       		CC23:     CP 27 ;Send the next character to the screen.	;Send the next character to the screen.
233)   192F 20 07       		          JR NZ,CC24	;
234)   1931 CD 94 5E    		          CALL    EXPRI	;
235)   1934 D9          		          EXX ;	;
236)   1935 7D          		          LD A,L	;
237)   1936 18 44       		          JR PRINTIT           	;
238)   1938 FE 1C       		CC24:     CP 28 ;Define a text window.	;Define a text window.
239)   193A 20 0E       		          JR NZ,CC25	;
240)   193C 06 04       		          LD B,4   ;4 PARAMS UPPERLEFT AND LOWERRIGHT	;4 PARAMS UPPERLEFT AND LOWERRIGHT
241)   193E C5          		CC24AGN:  PUSH BC	;
242)   193F FD 23       		     INC IY ;SKIP ','	;SKIP ','
243)   1941 CD 94 5E    		          CALL    EXPRI	;
244)   1944 D9          		          EXX ;l has the param	;l has the param
245)   1945 C1          		          POP BC           	;
246)   1946 10 F6       		          DJNZ CC24AGN                                	;
247)   1948 18 35       		          JR OSWREXIT   	;
248)   194A FE 1D       		CC25:     CP 29 ;Set the graphics origin.	;Set the graphics origin.
249)   194C 20 10       		          JR NZ,CC26	;
250)   194E FD 23       		          INC IY ;SKIP ','	;SKIP ','
251)   1950 CD 94 5E    		          CALL    EXPRI	;
252)   1953 D9          		          EXX ;HL has the param X	;HL has the param X
253)   1954 FD 23       		          INC IY ;SKIP ';'	;SKIP ';'
254)   1956 CD 94 5E    		          CALL    EXPRI	;
255)   1959 D9          		          EXX ;HL has the param Y	;HL has the param Y
256)   195A FD 23       		          INC IY ;SKIP ';'	;SKIP ';'
258)   195C 18 21       		          JR OSWREXIT   	;
259)   195E FE 1E       		CC26:     CP 30 ;Home the text cursor to the top left of the screen.	;Home the text cursor to the top left of the screen.
260)   1960 20 08       		          JR NZ,CC27	;
261)   1962 21 00 00    		          LD HL,0	;
262)   1965 22 0D 83    		          LD (CURSORX),HL	;
263)   1968 18 15       		          JR OSWREXIT   	;
264)   196A FE 1F       		CC27:     CP 31 ;Move the text cursor - identical to TAB(x,y).	;Move the text cursor - identical to TAB(x,y).
265)   196C 20 11       		          JR NZ,OSWREXIT   	;
266)   196E FD 23       		          INC IY ;SKIP ','	;SKIP ','
267)   1970 CD 94 5E    		          CALL    EXPRI	;
268)   1973 D9          		          EXX ;l has the param X	;l has the param X
269)   1974 FD 23       		          INC IY ;SKIP ','	;SKIP ','
270)   1976 CD 94 5E    		          CALL    EXPRI	;
271)   1979 D9          		          EXX ;l has the param Y	;l has the param Y
273)   197A 18 03       		          JR OSWREXIT   	;
276)   197C CD 85 19    		PRINTIT:  CALL    EDPUT	;
277)   197F DD E1       		OSWREXIT: POP     IX	;
278)   1981 E1          		          POP     HL	;
279)   1982 D1          		          POP     DE	;
280)   1983 F1          		          POP     AF	;
281)   1984 C9          		          RET	;
286)   1985 3A 00 83    		EDPUT: LD      A,(FLAGS)	;
287)   1988 CB 5F       		       BIT     3,A	;
288)   198A 28 10       		       JR      Z,WRCH	;
289)   198C 7B          		       LD      A,E	;
290)   198D FE 20       		       CP      ' '	;
291)   198F D8          		       RET     C	;
292)   1990 2A 10 83    		       LD      HL,(EDPTR)	;
293)   1993 73          		       LD      (HL),E	;
294)   1994 2C          		       INC     L	;
295)   1995 C8          		       RET     Z	;
296)   1996 22 10 83    		       LD      (EDPTR),HL	;
297)   1999 C9          		       RET           	;
300)   199A 1E 3E       		          LD E,'>'        	;
301)   199C 7B          		WRCH:     LD A,E	;
303)   199D F5          		          PUSH AF	;
304)   199E C5          		          PUSH BC	;
305)   199F D5          		          PUSH DE	;
306)   19A0 E5          		     PUSH HL	;
307)   19A1 DD E5       		     PUSH IX	;
308)   19A3 FD E5       		     PUSH IY	;
310)   19A5 F5          		          PUSH AF	;
311)   19A6 C5          		          PUSH BC	;
312)   19A7 D5          		          PUSH DE	;
313)   19A8 E5          		     PUSH HL	;
314)   19A9 CD 0D 0D    		     CALL LCD_RMVCURS	;
315)   19AC E1          		          POP HL	;
316)   19AD D1          		          POP DE	;
317)   19AE C1          		          POP BC	;
318)   19AF F1          		          POP AF	;
319)   19B0 CD 2F 0C    		          CALL LCD_PRINTCHAR	;
320)   19B3 CD 12 0D    		          CALL LCD_PRNCURS	;
322)   19B6 FD E1       		          POP IY	;
323)   19B8 DD E1       		          POP IX	;
324)   19BA E1          		          POP HL	;
325)   19BB D1          		          POP DE	;
326)   19BC C1          		          POP BC	;
327)   19BD F1          		          POP AF	;
328)   19BE C9          		       RET 	;
330)   19BF 3A 00 83    		TOGGLE: LD     A,(FLAGS)	;
331)   19C2 EE 04       		       XOR     00000100B	;
332)   19C4 32 00 83    		       LD      (FLAGS),A	;
333)   19C7 C9          		       RET	;
342)   19C8 E5          		@MYOS_OSKEY: PUSH   HL	;
343)   19C9 21 13 83    		           LD      HL,INKEY	;
344)   19CC 7E          		           LD      A,(HL)	;
345)   19CD 36 00       		           LD      (HL),0	;
346)   19CF E1          		           POP     HL	;
347)   19D0 B7          		           OR      A	;
348)   19D1 37          		           SCF	;
349)   19D2 C0          		           RET     NZ  	;
351)   19D3 CD B7 1B    		           CALL    GETKEYNW	;
353)   19D6 D0          		           RET     NC	;
354)   19D7 FE 1B       		           CP      ESC	;
355)   19D9 37          		           SCF	;
356)   19DA C0          		           RET     NZ                        	;
357)   19DB E5          		ESCSET:  PUSH    HL	;
358)   19DC 21 00 83    		         LD      HL,FLAGS	;
359)   19DF CB 76       		         BIT     6,(HL)          ; ESC DISABLED?	; ESC DISABLED?
360)   19E1 20 02       		         JR      NZ,ESCDIS	;
361)   19E3 CB FE       		         SET     7,(HL)          ; SET ESCAPE FLAG	; SET ESCAPE FLAG
362)   19E5 E1          		ESCDIS:  POP     HL	;
363)   19E6 C9          		         RET 	;
364)   19E7 CD 89 05    		ESCTEST: CALL RS_RXNW	;
365)   19EA B7          		        OR A	;
366)   19EB C8          		        RET Z	;
367)   19EC FE 1B       		        CP 0x1B   ; ESC 	; ESC
368)   19EE 28 EB       		        JR Z,ESCSET	;
369)   19F0 32 13 83    		        LD (INKEY),A	;
370)   19F3 C9          		         RET	;
372)   19F4 CD E7 19    		@MYOS_TRAP:  CALL ESCTEST	;
373)   19F7 3A 00 83    		@MYOS_LTRAP:  LD A,(FLAGS)	;
374)   19FA B7          		            OR A	;
375)   19FB F0          		             RET P	;
376)   19FC 21 00 83    		ABORT:        LD HL,FLAGS 	;
377)   19FF CB BE       		            RES 7,(HL)	;
378)   1A01 C3 C2 4D    		            JP ESCAPE          	;
387)   1A04 F3          		           DI	;
388)   1A05 21 F6 82    		           LD HL,RANDOM    ; SET RANDOM SEED TO NON 0	; SET RANDOM SEED TO NON 0
389)   1A08 3E 06       		           LD A,0x06	;
390)   1A0A 77          		           LD (HL),A	;
391)   1A0B 3E BB       		           LD A,0xBB	;
392)   1A0D 77          		           LD (HL),A	;
393)   1A0E 21 00 00    		           LD HL,0	;
394)   1A11 22 0D 83    		           LD (CURSORX),HL  ; CURSOR X 7 Y ZEROED            	; CURSOR X 7 Y ZEROED
395)   1A14 11 FF FF    		           LD DE,COL_WHITE   ; SET FCOLOR AND BCOLOR DEFAULT VALUES	; SET FCOLOR AND BCOLOR DEFAULT VALUES
396)   1A17 21 01 83    		           LD HL,FCOLOR	;
397)   1A1A 73          		           LD (HL),E	;
398)   1A1B 23          		           INC HL	;
399)   1A1C 72          		           LD (HL),D	;
400)   1A1D 23          		           INC HL	;
401)   1A1E 11 00 00    		           LD DE,COL_BLACK	;
402)   1A21 73          		           LD (HL),E	;
403)   1A22 23          		           INC HL	;
404)   1A23 72          		           LD (HL),D     	;
405)   1A24 01 04 00    		           LD BC,4     ; COPY SAME COLORS TO GRAPHICS	; COPY SAME COLORS TO GRAPHICS
406)   1A27 11 05 83    		           LD DE,FGRCOL	;
407)   1A2A 21 01 83    		           LD HL,FCOLOR	;
408)   1A2D ED B0       		           LDIR                                          	;
409)   1A2F 11 15 83    		           LD DE,FCOLPAL	;
410)   1A32 CD 3D 1A    		           CALL COPYPAL	;
411)   1A35 11 35 83    		           LD DE,BCOLPAL            	;
412)   1A38 CD 3D 1A    		           CALL COPYPAL	;
413)   1A3B 18 09       		           JR OSFINSH;	;
414)   1A3D 21 A2 1A    		COPYPAL:   LD HL,COL_PALET   	;
415)   1A40 01 20 00    		           LD BC,16*2         ;SHOULD ADD 8 MORE COLORS 	;SHOULD ADD 8 MORE COLORS
416)   1A43 ED B0       		           LDIR	;
417)   1A45 C9          		           RET	;
419)   1A46 CD 54 0D    		OSFINSH:   CALL LCD_CLRSCR	;
420)   1A49 CD 2B 4C    		           CALL    TELL	;
421)   1A4C 20 20 43 44 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A50 65 73 70 20 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A54 4D 6F 64 75 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A58 6C 61 72 20 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A5C 5A 38 30 20 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A60 43 6F 6D 70 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A64 75 74 65 72 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A68 20 32 30 32 		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
421)   1A6C 30 20 20    		     DEFM "  CDesp Modular Z80 Computer 2020  "	;
422)   1A6F 0A 0D       		     DEFB 0AH,0DH	;
423)   1A71 41 54 4C 41 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A75 53 20 6F 70 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A79 65 72 61 74 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A7D 69 6E 67 20 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A81 73 79 73 74 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A85 65 6D 20 76 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A89 65 72 73 69 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A8D 6F 6E 20 32 		     DEFM "ATLAS operating system version 2.02"      	;
423)   1A91 2E 30 32    		     DEFM "ATLAS operating system version 2.02"      	;
424)   1A94 0A 0D 0A 0D 		     DEFB 0AH,0DH,0AH,0DH      	;
425)   1A98 00          		     DEFB 00H	;
426)   1A99 AF          		           XOR A	;
427)   1A9A 11 FF FF    		          LD DE,0xFFFF  ;DE = HIMEM	;DE = HIMEM
428)   1A9D 5F          		          LD E,A              ;PAGE BOUNDARY	;PAGE BOUNDARY
429)   1A9E 21 9C 83    		          LD HL,@USER           	;
430)   1AA1 C9          		          RET 	;
431)   1AA2 00 00       		COL_PALET: DW COL_BLACK	;
432)   1AA4 00 F8       		           DW COL_RED	;
433)   1AA6 C0 07       		           DW COL_GREEN	;
434)   1AA8 C0 FF       		           DW COL_YELLOW	;
435)   1AAA 3F 00       		           DW COL_BLUE	;
436)   1AAC 3F F8       		           DW COL_MAGENTA	;
437)   1AAE FF 07       		           DW COL_CYAN	;
438)   1AB0 FF FF       		           DW COL_WHITE            	;
439)   1AB2 00 00       		          DW COL_BLACK ;TODO PICK 8 MORE COLORS	;TODO PICK 8 MORE COLORS
440)   1AB4 00 F8       		           DW COL_RED	;
441)   1AB6 C0 07       		           DW COL_GREEN	;
442)   1AB8 C0 FF       		           DW COL_YELLOW	;
443)   1ABA 3F 00       		           DW COL_BLUE	;
444)   1ABC 3F F8       		           DW COL_MAGENTA	;
445)   1ABE FF 07       		           DW COL_CYAN	;
446)   1AC0 FF FF       		           DW COL_WHITE            	;
452)   1AC2 CD 1C 1B    		     CALL    SKIPSP	;
453)   1AC5 FE 0D       		  CP      CR	;
454)   1AC7 C8          		  RET     Z	;
455)   1AC8 FE 7C       		  CP      '|'	;
456)   1ACA C8          		  RET     Z	;
457)   1ACB FE 2E       		  CP      '.'	;
458)   1ACD CA 49 1B    		  JP      Z,DOT           ;*.	;*.
459)   1AD0 EB          		  EX      DE,HL	;
460)   1AD1 21 2B 1B    		  LD      HL,COMDS	;
461)   1AD4 1A          		OSCLI0:  LD      A,(DE)	;
462)   1AD5 CD 23 1B    		  CALL    UPPRC	;
463)   1AD8 BE          		  CP      (HL)	;
464)   1AD9 28 0B       		  JR      Z,OSCLI2	;
465)   1ADB 38 2E       		  JR      C,HUH	;
466)   1ADD CB 7E       		OSCLI1:  BIT     7,(HL)	;
467)   1ADF 23          		  INC     HL	;
468)   1AE0 28 FB       		  JR      Z,OSCLI1	;
469)   1AE2 23          		  INC     HL	;
470)   1AE3 23          		  INC     HL	;
471)   1AE4 18 EE       		  JR      OSCLI0	;
473)   1AE6 D5          		OSCLI2:  PUSH    DE	;
474)   1AE7 13          		OSCLI3:  INC     DE	;
475)   1AE8 23          		  INC     HL	;
476)   1AE9 1A          		  LD      A,(DE)	;
477)   1AEA CD 23 1B    		  CALL    UPPRC	;
478)   1AED FE 2E       		  CP      '.'             ;ABBREVIATED?	;ABBREVIATED?
479)   1AEF 28 0A       		  JR      Z,OSCLI4	;
480)   1AF1 AE          		  XOR     (HL)	;
481)   1AF2 28 F3       		  JR      Z,OSCLI3	;
482)   1AF4 FE 80       		  CP      80H	;
483)   1AF6 28 03       		  JR      Z,OSCLI4	;
484)   1AF8 D1          		  POP     DE	;
485)   1AF9 18 E2       		  JR      OSCLI1	;
487)   1AFB F1          		OSCLI4:  POP     AF	;
488)   1AFC 13          		         INC     DE	;
489)   1AFD CB 7E       		OSCLI5:  BIT     7,(HL)	;
490)   1AFF 23          		  INC     HL	;
491)   1B00 28 FB       		  JR      Z,OSCLI5	;
492)   1B02 7E          		  LD      A,(HL)	;
493)   1B03 23          		  INC     HL	;
494)   1B04 66          		  LD      H,(HL)	;
495)   1B05 6F          		  LD      L,A	;
496)   1B06 E5          		  PUSH    HL	;
497)   1B07 EB          		  EX      DE,HL	;
498)   1B08 C3 1C 1B    		  JP      SKIPSP	;
500)   1B0B 3E FE       		HUH:     LD      A,254	;
501)   1B0D CD F0 46    		         CALL    EXTERR	;
502)   1B10 42 61 64 20 		         DEFM    'Bad command'	;
502)   1B14 63 6F 6D 6D 		         DEFM    'Bad command'	;
502)   1B18 61 6E 64    		         DEFM    'Bad command'	;
503)   1B1B 00          		         DEFB    0   	;
505)   1B1C 7E          		SKIPSP:  LD      A,(HL)	;
506)   1B1D FE 20       		         CP      ' '	;
507)   1B1F C0          		         RET     NZ	;
508)   1B20 23          		         INC     HL	;
509)   1B21 18 F9       		         JR      SKIPSP 	;
511)   1B23 E6 7F       		UPPRC:   AND     7FH	;
512)   1B25 FE 60       		  CP      '`'	;
513)   1B27 D8          		  RET     C	;
514)   1B28 E6 5F       		  AND     5FH             ;CONVERT TO UPPER CASE	;CONVERT TO UPPER CASE
515)   1B2A C9          		  RET     	;
519)   1B2B 42 59       		COMDS:DEFM   'BY'	;
520)   1B2D C5          		  DEFB    'E'+80H	;
521)   1B2E 4A 1B       		  DEFW    BYE	;
522)   1B30 43          		     DEFM    'C'	;
523)   1B31 C4          		  DEFB    'D'+80H	;
524)   1B32 4E 1B       		  DEFW    NIMP   	;
525)   1B34 44 49       		     DEFM    'DI'	;
526)   1B36 D2          		  DEFB    'R'+80H	;
527)   1B37 4E 1B       		  DEFW    NIMP   	;
528)   1B39 46          		     DEFM    'F'	;
529)   1B3A D8          		  DEFB    'X'+80H	;
530)   1B3B 4D 1B       		  DEFW    FX   	;
531)   1B3D 50 57       		     DEFM    'PW'	;
532)   1B3F C4          		  DEFB    'D'+80H	;
533)   1B40 4E 1B       		  DEFW    NIMP   	;
534)   1B42 54 59 50    		     DEFM    'TYP'	;
535)   1B45 C5          		  DEFB    'E'+80H	;
536)   1B46 4E 1B       		  DEFW    NIMP      	;
538)   1B48 FF          		  DEFB 0FFH	;
541)   1B49 C9          		DOT:  RET	;
546)   1B4A C3 00 00    		BYE:  JP 0	;
549)   1B4D C9          		FX: RET  	;
552)   1B4E C9          		NIMP: RET  ;NOT IMPLEMENTED YET	;NOT IMPLEMENTED YET
566)   1B4F 3E 01       		@MYOS_GETEXT: LD A,1	;
567)   1B51 C9          		             RET 	;
569)   1B52 C9          		@MYOS_RESET: RET	;
571)   1B53 CD 94 5E    		@MYOS_MODE:CALL EXPRI   ;GET PARAM	;GET PARAM
572)   1B56 D9          		          EXX           ;HL HAS THE PARAM      	;HL HAS THE PARAM
573)   1B57 C3 E8 4C    		          JP XEQ	;
575)   1B5A CD DF 11    		@MYOS_CLG: CALL GRPH_SAVECOLORS	;
576)   1B5D CD 54 0D    		          CALL LCD_CLRSCR	;
577)   1B60 CD F6 11    		          CALL GRPH_RESTORECOLORS	;
578)   1B63 C3 E8 4C    		          JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
581)   1B66 DD E5       		@MYOS_GCOL:  PUSH IX	;
582)   1B68 3E 01       		             LD A,1	;
583)   1B6A CD E4 0F    		             CALL BAS_COLOUR     	;
584)   1B6D DD E1       		             POP IX	;
585)   1B6F C3 E8 4C    		             JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
587)   1B72 DD E5       		@MYOS_COLOUR: PUSH IX	;
588)   1B74 AF          		             XOR A   	;
589)   1B75 CD E4 0F    		             CALL BAS_COLOUR     	;
590)   1B78 DD E1       		             POP IX	;
591)   1B7A C3 E8 4C    		             JP XEQ           ;RETURN TO BASIC              	;RETURN TO BASIC
593)   1B7D DD E5       		@MYOS_DRAW: PUSH IX 	;
594)   1B7F CD BD 10    		           CALL BAS_DRAW	;
595)   1B82 DD E1       		           POP IX	;
596)   1B84 C3 E8 4C    		           JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
598)   1B87 DD E5       		@MYOS_MOVE:PUSH IX	;
599)   1B89 CD E6 10    		          CALL BAS_MOVE	;
600)   1B8C DD E1       		          POP IX	;
601)   1B8E C3 E8 4C    		          JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
603)   1B91 DD E5       		@MYOS_PLOT:PUSH IX	;
604)   1B93 CD 56 11    		          CALL BAS_PLOT	;
605)   1B96 DD E1       		          POP IX	;
606)   1B98 C3 E8 4C    		          JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
608)   1B9B DD E5       		@MYOS_POINT:PUSH IX	;
609)   1B9D CD F2 10    		          CALL BAS_POINT ;RETURNS A VALUE TO BASIC	;RETURNS A VALUE TO BASIC
610)   1BA0 DD E1       		          POP IX	;
611)   1BA2 C9          		          RET	;
621)   1BA3 CD 79 10    		@MYOS_PUTIMS:CALL GETBASICPARAMS;            	;
622)   1BA6 C3 E8 4C    		            JP XEQ	;
624)   1BA9 CD F0 46    		  CALL    EXTERR	;
625)   1BAC 53 6F 72 72 		  DEFM    'Sorry'	;
625)   1BB0 79          		  DEFM    'Sorry'	;
626)   1BB1 00          		  DEFB    0            	;
633)   1BB2 CD FD 02    		GETKEY:   CALL GET_CHAR	;
634)   1BB5 37          		           SCF	;
635)   1BB6 C9          		        RET       	;
640)   1BB7 CD DD 02    		GETKEYNW: CALL GET_CHARNW	;
641)   1BBA 3F          		           CCF	;
642)   1BBB FE 00       		           CP 0	;
643)   1BBD C8          		           RET Z	;
644)   1BBE 37          		           SCF	;
645)   1BBF C9          		        RET       	;
658)   1BC0 3A 00 83    		       LD      A,(FLAGS)	;
659)   1BC3 CB 5F       		       BIT     3,A             ;EDIT MODE?	;EDIT MODE?
660)   1BC5 28 09       		       JR      Z,OSLIN1	;
661)   1BC7 CB 9F       		       RES     3,A	;
662)   1BC9 32 00 83    		       LD      (FLAGS),A	;
663)   1BCC 2A 10 83    		       LD      HL,(EDPTR)	;
664)   1BCF BD          		       CP      L	;
665)   1BD0 3E 0D       		OSLIN1: LD     A,CR	;
666)   1BD2 77          		       LD      (HL),A	;
667)   1BD3 C4 EC 17    		       CALL    NZ,MYOS_OSWRCH	;
668)   1BD6 2E 00       		       LD      L,0	;
669)   1BD8 4D          		       LD      C,L             ;REPEAT FLAG	;REPEAT FLAG
670)   1BD9 28 20       		       JR      Z,OSWAIT        ;SUPPRESS UNWANTED SPACE	;SUPPRESS UNWANTED SPACE
671)   1BDB 06 00       		UPDATE: LD     B,0	;
672)   1BDD 7E          		UPD1:  LD      A,(HL)	;
673)   1BDE 04          		       INC     B	;
674)   1BDF 23          		       INC     HL	;
675)   1BE0 FE 0D       		       CP      CR	;
676)   1BE2 F5          		       PUSH    AF	;
677)   1BE3 E5          		       PUSH    HL	;
678)   1BE4 5F          		       LD      E,A	;
679)   1BE5 C4 9C 19    		       CALL    NZ,WRCH         ;FAST WRCH	;FAST WRCH
680)   1BE8 E1          		       POP     HL	;
681)   1BE9 F1          		       POP     AF	;
682)   1BEA 20 F1       		       JR      NZ,UPD1	;
683)   1BEC 3E 20       		       LD      A,' '	;
684)   1BEE CD EC 17    		       CALL    MYOS_OSWRCH	;
685)   1BF1 1E 08       		       LD      E,BS	;
686)   1BF3 E5          		UPD2:  PUSH    HL	;
687)   1BF4 CD 9C 19    		       CALL    WRCH            ;FAST WRCH	;FAST WRCH
688)   1BF7 E1          		       POP     HL	;
689)   1BF8 2B          		       DEC     HL	;
690)   1BF9 10 F8       		       DJNZ    UPD2	;
691)   1BFB 79          		OSWAIT: LD     A,C	;
692)   1BFC 05          		       DEC     B	;
693)   1BFD 28 01       		       JR      Z,LIMIT	;
694)   1BFF B7          		       OR      A               ;REPEAT COMMAND?	;REPEAT COMMAND?
695)   1C00 CC DF 17    		LIMIT: CALL    Z,KEYGET        ;READ KEYBOARD	;READ KEYBOARD
696)   1C03 4F          		       LD      C,A             ;SAVE FOR REPEAT	;SAVE FOR REPEAT
697)   1C04 11 FB 1B    		       LD      DE,OSWAIT       ;RETURN ADDRESS	;RETURN ADDRESS
698)   1C07 D5          		       PUSH    DE	;
699)   1C08 3A 00 83    		       LD      A,(FLAGS)	;
700)   1C0B B7          		       OR      A               ;TEST FOR ESCAPE	;TEST FOR ESCAPE
701)   1C0C 79          		       LD      A,C	;
702)   1C0D FA 4F 1C    		       JP      M,OSEXIT	;
703)   1C10 FE 0B       		       CP      11         ;CURSOR UP     (IX-11)	;CURSOR UP     (IX-11)
704)   1C12 CA 93 1C    		       JP      Z,LEFT	;
705)   1C15 FE 0A       		       CP      10         ;CURSOR DOWN   (IX-10)	;CURSOR DOWN   (IX-10)
706)   1C17 CA C6 1C    		       JP      Z,RIGHT	;
707)   1C1A 06 00       		       LD      B,0	;
708)   1C1C FE 05       		       CP      5          ;CLEAR LEFT    (IX-5)	;CLEAR LEFT    (IX-5)
709)   1C1E 28 72       		       JR      Z,BACK	;
710)   1C20 FE 09       		       CP      9          ;START OF LINE (IX-9)	;START OF LINE (IX-9)
711)   1C22 28 6F       		       JR      Z,LEFT	;
712)   1C24 FE 07       		       CP      7          ;CLEAR RIGHT   (IX-7)	;CLEAR RIGHT   (IX-7)
713)   1C26 28 76       		       JR      Z,DELETE	;
714)   1C28 FE 08       		       CP      8          ;END OF LINE   (IX-8)	;END OF LINE   (IX-8)
715)   1C2A CA C6 1C    		       JP      Z,RIGHT	;
716)   1C2D 0E 00       		       LD      C,0             ;INHIBIT REPEAT	;INHIBIT REPEAT
717)   1C2F FE 10       		       CP      'P' AND 1FH	;
718)   1C31 CA BF 19    		       JP      Z,TOGGLE	;
719)   1C34 FE 06       		       CP      6          ;DELETE LEFT   (IX-6)	;DELETE LEFT   (IX-6)
720)   1C36 28 5A       		       JR      Z,BACK	;
721)   1C38 FE 04       		       CP      4          ;CURSOR LEFT   (IX-4)	;CURSOR LEFT   (IX-4)
722)   1C3A 28 57       		       JR      Z,LEFT	;
723)   1C3C FE 02       		       CP      2          ;DELETE RIGHT  (IX-2)	;DELETE RIGHT  (IX-2)
724)   1C3E 28 5E       		       JR      Z,DELETE	;
725)   1C40 FE 01       		       CP      1          ;INSERT SPACE  (IX-1)	;INSERT SPACE  (IX-1)
726)   1C42 28 6E       		       JR      Z,INSERT	;
727)   1C44 FE 03       		       CP      3          ;CURSOR RIGHT  (IX-3)	;CURSOR RIGHT  (IX-3)
728)   1C46 28 7E       		       JR      Z,RIGHT	;
729)   1C48 FE 20       		       CP      ' '             ;PRINTING CHARACTER	;PRINTING CHARACTER
730)   1C4A 30 7F       		       JR      NC,SAVECH	;
731)   1C4C FE 0D       		       CP      CR              ;ENTER LINE	;ENTER LINE
732)   1C4E C0          		       RET     NZ	;
733)   1C4F 7E          		OSEXIT: LD     A,(HL)	;
734)   1C50 CD EC 17    		       CALL    MYOS_OSWRCH          ;WRITE REST OF LINE	;WRITE REST OF LINE
735)   1C53 23          		       INC     HL	;
736)   1C54 D6 0D       		       SUB     CR	;
737)   1C56 20 F7       		       JR      NZ,OSEXIT	;
738)   1C58 D1          		       POP     DE              ;DITCH RETURN ADDRESS	;DITCH RETURN ADDRESS
739)   1C59 B9          		       CP      C	;
740)   1C5A C2 FC 19    		       JP      NZ,ABORT        ;ESCAPE	;ESCAPE
741)   1C5D 3E 0A       		       LD      A,LF	;
742)   1C5F CD EC 17    		       CALL    MYOS_OSWRCH	;
743)   1C62 ED 5B F4 82 		       LD      DE,(ERRLIN)	;
744)   1C66 AF          		       XOR     A	;
745)   1C67 6F          		       LD      L,A	;
746)   1C68 22 10 83    		       LD      (EDPTR),HL	;
747)   1C6B BA          		       CP      D	;
748)   1C6C C0          		       RET     NZ	;
749)   1C6D BB          		       CP      E	;
750)   1C6E C0          		       RET     NZ	;
751)   1C6F 11 DF 1C    		       LD      DE,EDITST	;
752)   1C72 06 04       		       LD      B,4	;
753)   1C74 1A          		CMPARE: LD     A,(DE)	;
754)   1C75 BE          		       CP      (HL)	;
755)   1C76 3E 00       		       LD      A,0	;
756)   1C78 C0          		       RET     NZ	;
757)   1C79 23          		       INC     HL	;
758)   1C7A 13          		       INC     DE	;
759)   1C7B 7E          		       LD      A,(HL)	;
760)   1C7C FE 2E       		       CP      '.'	;
761)   1C7E 28 02       		       JR      Z,ABBR	;
762)   1C80 10 F2       		       DJNZ    CMPARE	;
763)   1C82 AF          		ABBR:  XOR     A	;
764)   1C83 47          		       LD      B,A	;
765)   1C84 4D          		       LD      C,L	;
766)   1C85 6F          		       LD      L,A	;
767)   1C86 11 E3 1C    		       LD      DE,LISTST	;
768)   1C89 EB          		       EX      DE,HL	;
769)   1C8A ED B0       		       LDIR	;
770)   1C8C 21 00 83    		       LD      HL,FLAGS	;
771)   1C8F CB DE       		       SET     3,(HL)	;
772)   1C91 C9          		       RET	;
774)   1C92 37          		BACK:  SCF                     ;DELETE LEFT	;DELETE LEFT
775)   1C93 2C          		LEFT:  INC     L               ;CURSOR LEFT	;CURSOR LEFT
776)   1C94 2D          		       DEC     L	;
777)   1C95 28 45       		       JR      Z,STOP	;
778)   1C97 3E 08       		       LD      A,BS	;
779)   1C99 CD EC 17    		       CALL    MYOS_OSWRCH	;
780)   1C9C 2D          		       DEC     L	;
781)   1C9D D0          		       RET     NC	;
782)   1C9E 7E          		DELETE: LD     A,(HL)          ;DELETE RIGHT	;DELETE RIGHT
783)   1C9F FE 0D       		       CP      CR	;
784)   1CA1 28 39       		       JR      Z,STOP	;
785)   1CA3 54          		       LD      D,H	;
786)   1CA4 5D          		       LD      E,L	;
787)   1CA5 13          		DEL1:  INC     DE	;
788)   1CA6 1A          		       LD      A,(DE)	;
789)   1CA7 1B          		       DEC     DE	;
790)   1CA8 12          		       LD      (DE),A	;
791)   1CA9 13          		       INC     DE	;
792)   1CAA FE 0D       		       CP      CR	;
793)   1CAC 20 F7       		       JR      NZ,DEL1	;
794)   1CAE D1          		DEL2:  POP     DE              ;DITCH	;DITCH
795)   1CAF C3 DB 1B    		       JP      UPDATE	;
797)   1CB2 3E 0D       		INSERT: LD     A,CR            ;INSERT SPACE	;INSERT SPACE
798)   1CB4 BE          		       CP      (HL)	;
799)   1CB5 C8          		       RET     Z	;
800)   1CB6 54          		       LD      D,H	;
801)   1CB7 1E FE       		       LD      E,254	;
802)   1CB9 13          		INS1:  INC     DE	;
803)   1CBA 12          		       LD      (DE),A	;
804)   1CBB 1B          		       DEC     DE	;
805)   1CBC 7B          		       LD      A,E	;
806)   1CBD BD          		       CP      L	;
807)   1CBE 1B          		       DEC     DE	;
808)   1CBF 1A          		       LD      A,(DE)	;
809)   1CC0 20 F7       		       JR      NZ,INS1	;
810)   1CC2 36 20       		       LD      (HL),' '	;
811)   1CC4 18 E8       		       JR      DEL2	;
813)   1CC6 7E          		RIGHT: LD      A,(HL)          ;CURSOR RIGHT	;CURSOR RIGHT
814)   1CC7 FE 0D       		       CP      CR	;
815)   1CC9 28 11       		       JR      Z,STOP	;
816)   1CCB 56          		SAVECH: LD     D,(HL)          ;PRINTING CHARACTER	;PRINTING CHARACTER
817)   1CCC 77          		       LD      (HL),A	;
818)   1CCD 2C          		       INC     L	;
819)   1CCE 28 09       		       JR      Z,WONTGO        ;LINE TOO LONG	;LINE TOO LONG
820)   1CD0 CD EC 17    		       CALL    MYOS_OSWRCH	;
821)   1CD3 3E 0D       		       LD      A,CR	;
822)   1CD5 BA          		       CP      D	;
823)   1CD6 C0          		       RET     NZ	;
824)   1CD7 77          		       LD      (HL),A	;
825)   1CD8 C9          		       RET	;
827)   1CD9 2D          		WONTGO: DEC    L	;
828)   1CDA 36 0D       		       LD      (HL),CR	;
831)   1CDC 0E 00       		STOP:  LD      C,0             ;STOP REPEAT	;STOP REPEAT
832)   1CDE C9          		       RET	;
835)   1CDF 45 44 49 54 		EDITST: DEFM   'EDIT'	;
836)   1CE3 4C 49 53 54 		LISTST: DEFM   'LIST'	;
  4)   1CE7 	            		PORT_TAPE      EQU DEVTAP      ; SAVE/LOAD PORT 1 BYTE=0xDD 2ND BYTE=COMMAND 	; SAVE/LOAD PORT 1 BYTE=0xDD 2ND BYTE=COMMAND
 17)   1CE7 3E DD       		           LD A,0xDD	;
 18)   1CE9 CD 63 05    		           CALL RS_TX	;
 19)   1CEC 3E 0A       		           LD A,COMMD_SAVE	;
 20)   1CEE CD 63 05    		           CALL RS_TX	;
 22)   1CF1 7E          		OSSV_NXT:  LD A,(HL)	;
 23)   1CF2 CD 63 05    		           CALL RS_TX	;
 24)   1CF5 23          		           INC HL	;
 25)   1CF6 FE 0D       		           CP 0x0D	;
 26)   1CF8 20 F7       		           JR NZ,OSSV_NXT	;
 28)   1CFA 79          		           LD A,C	;
 29)   1CFB CD 63 05    		           CALL RS_TX	;
 30)   1CFE 78          		           LD A,B	;
 31)   1CFF CD 63 05    		           CALL RS_TX	;
 33)   1D02 2A DC 82    		           LD HL,(PAGE)	;
 34)   1D05 7E          		OSSV_NXT2: LD A,(HL)	;
 35)   1D06 CD 63 05    		           CALL RS_TX	;
 36)   1D09 23          		           INC HL	;
 37)   1D0A 0B          		           DEC BC	;
 38)   1D0B 78          		           LD A,B	;
 39)   1D0C B1          		           OR C	;
 40)   1D0D 20 F6       		           JR NZ,OSSV_NXT2                        	;
 41)   1D0F C9          		           RET              	;
 47)   1D10 3E DD       		           LD A,0xDD	;
 48)   1D12 CD 63 05    		           CALL RS_TX	;
 49)   1D15 3E 14       		           LD A,COMMD_LOAD	;
 50)   1D17 CD 63 05    		           CALL RS_TX	;
 52)   1D1A 7E          		OSLD_NXT:  LD A,(HL)	;
 53)   1D1B CD 63 05    		           CALL RS_TX	;
 54)   1D1E 23          		           INC HL	;
 55)   1D1F FE 0D       		           CP 0x0D	;
 56)   1D21 20 F7       		           JR NZ,OSLD_NXT	;
 58)   1D23 CD 7C 05    		           CALL RS_RX	;
 59)   1D26 4F          		           LD C,A	;
 60)   1D27 CD 7C 05    		           CALL RS_RX	;
 61)   1D2A 47          		           LD B,A	;
 62)   1D2B B7          		           OR A	;
 63)   1D2C 20 0A       		           JR NZ,OK1	;
 64)   1D2E 79          		           LD A,C	;
 65)   1D2F B7          		           OR A	;
 66)   1D30 20 06       		           JR NZ,OK1	;
 68)   1D32 CD 7C 05    		           CALL RS_RX ;GET THE ERRORCODE            	;GET THE ERRORCODE
 69)   1D35 C3 4F 1D    		           JP LDERR	;
 72)   1D38 2A DC 82    		           LD HL,(PAGE)                        	;
 73)   1D3B CD 7C 05    		OSLD_NXT2: CALL RS_RX	;
 74)   1D3E 77          		           LD (HL),A	;
 75)   1D3F 23          		           INC HL	;
 76)   1D40 0B          		           DEC BC	;
 77)   1D41 78          		           LD A,B	;
 78)   1D42 B1          		           OR C	;
 79)   1D43 20 F6       		           JR NZ,OSLD_NXT2                        	;
 80)   1D45 44          		           LD B,H	;
 81)   1D46 4D          		           LD C,L	;
 82)   1D47 21 DE 82    		           LD HL,TOP ;SAVE TOP OF BASIC 	;SAVE TOP OF BASIC
 83)   1D4A 71          		           LD (HL),C	;
 84)   1D4B 23          		           INC HL	;
 85)   1D4C 70          		           LD (HL),B            	;
 86)   1D4D 37          		           SCF       ;SET C = NO ERROR            	;SET C = NO ERROR
 87)   1D4E C9          		           RET   	;
 89)   1D4F FE 04       		LDERR:    CP 4	;
 90)   1D51 28 11       		           JR Z,FLNOTF	;
 91)   1D53 CD F0 46    		           CALL    EXTERR	;
 92)   1D56 45 72 72 6F 		         DEFM    'Error Loading'	;
 92)   1D5A 72 20 4C 6F 		         DEFM    'Error Loading'	;
 92)   1D5E 61 64 69 6E 		         DEFM    'Error Loading'	;
 92)   1D62 67          		         DEFM    'Error Loading'	;
 93)   1D63 00          		         DEFB    0   	;
 94)   1D64 CD F0 46    		FLNOTF:    CALL    EXTERR	;
 95)   1D67 57 72 6F 6E 		         DEFM    'Wrong Filename'	;
 95)   1D6B 67 20 46 69 		         DEFM    'Wrong Filename'	;
 95)   1D6F 6C 65 6E 61 		         DEFM    'Wrong Filename'	;
 95)   1D73 6D 65       		         DEFM    'Wrong Filename'	;
 96)   1D75 00          		         DEFB    0   	;
  9)   8300 00          		   @FLAGS   DEFS 1  ; Flags: B7=ESC PRESSED, B6=ESC DISABLED	; Flags: B7=ESC PRESSED, B6=ESC DISABLED
 10)   8301 00 00       		   @FCOLOR   DEFS 2 ;FOREGROUND COLOR FOR TEXT	;FOREGROUND COLOR FOR TEXT
 11)   8303 00 00       		   @BCOLOR   DEFS 2 ;BACKGROUND COLOR FOR TEXT	;BACKGROUND COLOR FOR TEXT
 12)   8305 00 00       		   @FGRCOL   DEFS 2 ;FOREGROUND COLOR FOR GRAPHICS	;FOREGROUND COLOR FOR GRAPHICS
 13)   8307 00 00       		   @BGRCOL   DEFS 2 ;BACKGROUND COLOR FOR GRAPHICS 	;BACKGROUND COLOR FOR GRAPHICS
 14)   8309 00 00       		   @FCOLTM   DEFS 2 ;TEMP FOREGROUND COLOR 	;TEMP FOREGROUND COLOR
 15)   830B 00 00       		   @BCOLTM   DEFS 2 ;TEMP BACKGROUND COLOR 	;TEMP BACKGROUND COLOR
 16)   830D 00          		   @CURSORX  DEFS 1    ;0-79	;0-79
 17)   830E 00          		   @CURSORY  DEFS 1    ;0-47	;0-47
 18)   830F 00          		   @LASTCHAR DEFS 1; 	;
 19)   8310 00 00       		   @EDPTR    DEFS 2	;
 20)   8312 00          		   @OPTVAL   DEFS 1	;
 21)   8313 00          		   @INKEY    DEFS 1	;
 22)   8314 00          		   @VDUMODE  DEFS 1    ;VDU 4 TEXT PRINT 5 GRAPH PRINT	;VDU 4 TEXT PRINT 5 GRAPH PRINT
 23)   8315 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   8319 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   831D 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   8321 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   8325 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   8329 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   832D 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 23)   8331 00 00 00 00 		   @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8335 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   8339 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   833D 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   8341 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   8345 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   8349 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   834D 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 24)   8351 00 00 00 00 		   @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8355 00 00       		   @GR_LASTX3 DEFS 2	;
 26)   8357 00 00       		   @GR_LASTY3 DEFS 2	;
 27)   8359 00 00       		   @GR_LASTX2 DEFS 2	;
 28)   835B 00 00       		   @GR_LASTY2 DEFS 2    	;
 29)   835D 00 00       		   @GR_LASTX DEFS 2	;
 30)   835F 00 00       		   @GR_LASTY DEFS 2	;
 31)   8361 00 00       		   @GR_PARAM1 DEFS 2	;
 32)   8363 00 00       		   @GR_PARAM2 DEFS 2	;
 33)   8365 00 00       		   @GR_PARAM3 DEFS 2	;
 34)   8367 00 00       		   @GR_PARAM4 DEFS 2	;
 36)   8369 00 00       		   @FILL_X   DEFS 2	;
 37)   836B 00 00       		   @FILL_Y   DEFS 2 	;
 38)   836D 00 00       		   @FILL_L   DEFS 2	;
 39)   836F 00 00       		   @FILL_X1  DEFS 2	;
 40)   8371 00 00       		   @FILL_X2  DEFS 2	;
 41)   8373 00 00       		   @FILL_DY  DEFS 2	;
 42)   8375 00 00       		   @FILL_Q   DEFS 2  ;START OF QUEUE	;START OF QUEUE
 43)   8377 00 00       		   @FILL_IDX DEFS 2  ;INDEX OF QUEUE	;INDEX OF QUEUE
 44)   8379 00 00       		   @FILL_PY  DEFS 2  ;FOR PUSH/POP	;FOR PUSH/POP
 45)   837B 00 00       		   @FILL_PXL DEFS 2	;
 46)   837D 00 00       		   @FILL_PXR DEFS 2	;
 47)   837F 00 00       		   @FILL_PDY DEFS 2    	;
 48)   8381 00 00       		   @FILL_OV  DEFS 2  ;OLD COLOR	;OLD COLOR
 49)   8383 00 00       		   @FILL_OLDSP DEFS 2; OLD SP	; OLD SP
 53)   8385 00          		   @FFSTAT   DEFS 1  ;FOR OUTPUT FLIP FLOPS DEVEPR, DEVKBD	;FOR OUTPUT FLIP FLOPS DEVEPR, DEVKBD
 54)   8386 00          		  @KEYCTR   DEFS 1  ;FOR USB KEYBOARD 	;FOR USB KEYBOARD
 55)   8387 00          		  @SERERR  DEFS 1;	;
 56)   8388 00          		  @SERER2  DEFS 1  ;AT RAM ADDRESS	;AT RAM ADDRESS
 57)   8389 00          		  @DISPCT   DEFS 1  ;	;
 58)   838A 00          		  @LCDCX    DEFS 1  ;DB 0  ;DISPLAY X POS (0..F  FOR 1..16)	;DB 0  ;DISPLAY X POS (0..F  FOR 1..16)
 59)   838B 00          		  @LCDCY    DEFS 1  ;DB 0  ;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)	;DB 0  ;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)
 60)   838C 00 00       		  @PRGEX   DEFS 2  ;2 BYTES	;2 BYTES
 61)   838E 00          		  @TVSTAT   DEFS 1  ;1 BYTE	;1 BYTE
 62)   838F 00 00 00 00 		   @MYNUM   DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   8393 00 00 00 00 		   @MYNUM   DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   8397 00 00 00 00 		   @MYNUM   DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   839B 00          		   @MYNUM   DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
