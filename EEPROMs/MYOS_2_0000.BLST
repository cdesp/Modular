  5)   0000 00          			NOP	;
  6)   0001 C3 00 02    			JP START	;
  7)   0004 C3 89 02    			JP MENU	;
  8)   0007 02          			VERSION DEFB 2 ; AT ADDR=7	; AT ADDR=7
  9)   0008 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   000C 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0010 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0014 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0018 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   001C 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0020 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0024 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0028 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   002C 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0030 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
  9)   0034 00 00 00 00 			DEFS $30 ;SKIP $30 BYTES	;SKIP $30 BYTES
 12)   0038 C3 00 A0    			JP $A000 ;TEMP I.S.	;TEMP I.S.
 14)   003B 00 00 00 00 			ALIGN 256	;
 14)   003F 00 00 00 00 			ALIGN 256	;
 14)   0043 00 00 00 00 			ALIGN 256	;
 14)   0047 00 00 00 00 			ALIGN 256	;
 14)   004B 00 00 00 00 			ALIGN 256	;
 14)   004F 00 00 00 00 			ALIGN 256	;
 14)   0053 00 00 00 00 			ALIGN 256	;
 14)   0057 00 00 00 00 			ALIGN 256	;
 14)   005B 00 00 00 00 			ALIGN 256	;
 14)   005F 00 00 00 00 			ALIGN 256	;
 14)   0063 00 00 00 00 			ALIGN 256	;
 14)   0067 00 00 00 00 			ALIGN 256	;
 14)   006B 00 00 00 00 			ALIGN 256	;
 14)   006F 00 00 00 00 			ALIGN 256	;
 14)   0073 00 00 00 00 			ALIGN 256	;
 14)   0077 00 00 00 00 			ALIGN 256	;
 14)   007B 00 00 00 00 			ALIGN 256	;
 14)   007F 00 00 00 00 			ALIGN 256	;
 14)   0083 00 00 00 00 			ALIGN 256	;
 14)   0087 00 00 00 00 			ALIGN 256	;
 14)   008B 00 00 00 00 			ALIGN 256	;
 14)   008F 00 00 00 00 			ALIGN 256	;
 14)   0093 00 00 00 00 			ALIGN 256	;
 14)   0097 00 00 00 00 			ALIGN 256	;
 14)   009B 00 00 00 00 			ALIGN 256	;
 14)   009F 00 00 00 00 			ALIGN 256	;
 14)   00A3 00 00 00 00 			ALIGN 256	;
 14)   00A7 00 00 00 00 			ALIGN 256	;
 14)   00AB 00 00 00 00 			ALIGN 256	;
 14)   00AF 00 00 00 00 			ALIGN 256	;
 14)   00B3 00 00 00 00 			ALIGN 256	;
 14)   00B7 00 00 00 00 			ALIGN 256	;
 14)   00BB 00 00 00 00 			ALIGN 256	;
 14)   00BF 00 00 00 00 			ALIGN 256	;
 14)   00C3 00 00 00 00 			ALIGN 256	;
 14)   00C7 00 00 00 00 			ALIGN 256	;
 14)   00CB 00 00 00 00 			ALIGN 256	;
 14)   00CF 00 00 00 00 			ALIGN 256	;
 14)   00D3 00 00 00 00 			ALIGN 256	;
 14)   00D7 00 00 00 00 			ALIGN 256	;
 14)   00DB 00 00 00 00 			ALIGN 256	;
 14)   00DF 00 00 00 00 			ALIGN 256	;
 14)   00E3 00 00 00 00 			ALIGN 256	;
 14)   00E7 00 00 00 00 			ALIGN 256	;
 14)   00EB 00 00 00 00 			ALIGN 256	;
 14)   00EF 00 00 00 00 			ALIGN 256	;
 14)   00F3 00 00 00 00 			ALIGN 256	;
 14)   00F7 00 00 00 00 			ALIGN 256	;
 14)   00FB 00 00 00 00 			ALIGN 256	;
 14)   00FF 00          			ALIGN 256	;
 17)   0100 C3 A9 12    		      JP MYOS_CLRSCN	;
 18)   0103 C3 AC 12    		      JP MYOS_PUTIME	;
 19)   0106 C3 AD 12    		      JP MYOS_GETIME	;
 20)   0109 C3 B4 12    		      JP MYOS_PUTCSR	;
 21)   010C C3 C6 12    		      JP MYOS_GETCSR	;
 22)   010F C3 D5 12    		      JP MYOS_OSRDCH	;
 23)   0112 C3 0B 13    		      JP MYOS_PROMPT	;
 24)   0115 C3 E0 12    		      JP MYOS_OSWRCH	;
 25)   0118 C3 39 13    		      JP MYOS_OSKEY	;
 26)   011B C3 75 13    		      JP MYOS_OSINIT	;
 27)   011E C3 07 15    		      JP MYOS_OSLINE	;
 28)   0121 C3 F2 13    		      JP MYOS_OSCLI	;
 29)   0124 C3 B4 14    		      JP MYOS_OSBPUT 	;
 30)   0127 C3 B4 14    		      JP MYOS_OSBGET 	;
 31)   012A C3 B4 14    		      JP MYOS_OSSTAT 	;
 32)   012D C3 B4 14    		      JP MYOS_OSSHUT 	;
 33)   0130 C3 B4 14    		      JP MYOS_OSOPEN 	;
 34)   0133 C3 B4 14    		      JP MYOS_OSCALL 	;
 35)   0136 C3 65 14    		      JP MYOS_OSSAVE 	;
 36)   0139 C3 88 14    		      JP MYOS_OSLOAD 	;
 37)   013C C3 B4 14    		      JP MYOS_GETPTR 	;
 38)   013F C3 B4 14    		      JP MYOS_PUTPTR 	;
 39)   0142 C3 B4 14    		      JP MYOS_GETEXT 	;
 40)   0145 C3 B4 14    		      JP MYOS_RESET 	;
 41)   0148 C3 65 13    		      JP MYOS_TRAP	;
 42)   014B C3 68 13    		      JP MYOS_LTRAP  	;
 43)   014E C3 B5 14    		      JP MYOS_CLG	;
 44)   0151 C3 C7 14    		      JP MYOS_COLOUR	;
 45)   0154 C3 D2 14    		      JP MYOS_DRAW	;
 46)   0157 C3 F8 14    		      JP MYOS_ENVEL	;
 47)   015A C3 BB 14    		      JP MYOS_GCOL	;
 48)   015D C3 F8 14    		      JP MYOS_MODE	;
 49)   0160 C3 DC 14    		      JP MYOS_MOVE	;
 50)   0163 C3 E6 14    		      JP MYOS_PLOT	;
 51)   0166 C3 F8 14    		      JP MYOS_SOUND	;
 52)   0169 C3 F8 14    		      JP MYOS_ADVAL	;
 53)   016C C3 F0 14    		      JP MYOS_POINT	;
 54)   016F C3 F8 14    		      JP MYOS_GETIMS	;
 55)   0172 C3 F8 14    		      JP MYOS_PUTIMS    	;
 57)   0175 00 00 00 00 		 	ALIGN 256     	;
 57)   0179 00 00 00 00 		 	ALIGN 256     	;
 57)   017D 00 00 00 00 		 	ALIGN 256     	;
 57)   0181 00 00 00 00 		 	ALIGN 256     	;
 57)   0185 00 00 00 00 		 	ALIGN 256     	;
 57)   0189 00 00 00 00 		 	ALIGN 256     	;
 57)   018D 00 00 00 00 		 	ALIGN 256     	;
 57)   0191 00 00 00 00 		 	ALIGN 256     	;
 57)   0195 00 00 00 00 		 	ALIGN 256     	;
 57)   0199 00 00 00 00 		 	ALIGN 256     	;
 57)   019D 00 00 00 00 		 	ALIGN 256     	;
 57)   01A1 00 00 00 00 		 	ALIGN 256     	;
 57)   01A5 00 00 00 00 		 	ALIGN 256     	;
 57)   01A9 00 00 00 00 		 	ALIGN 256     	;
 57)   01AD 00 00 00 00 		 	ALIGN 256     	;
 57)   01B1 00 00 00 00 		 	ALIGN 256     	;
 57)   01B5 00 00 00 00 		 	ALIGN 256     	;
 57)   01B9 00 00 00 00 		 	ALIGN 256     	;
 57)   01BD 00 00 00 00 		 	ALIGN 256     	;
 57)   01C1 00 00 00 00 		 	ALIGN 256     	;
 57)   01C5 00 00 00 00 		 	ALIGN 256     	;
 57)   01C9 00 00 00 00 		 	ALIGN 256     	;
 57)   01CD 00 00 00 00 		 	ALIGN 256     	;
 57)   01D1 00 00 00 00 		 	ALIGN 256     	;
 57)   01D5 00 00 00 00 		 	ALIGN 256     	;
 57)   01D9 00 00 00 00 		 	ALIGN 256     	;
 57)   01DD 00 00 00 00 		 	ALIGN 256     	;
 57)   01E1 00 00 00 00 		 	ALIGN 256     	;
 57)   01E5 00 00 00 00 		 	ALIGN 256     	;
 57)   01E9 00 00 00 00 		 	ALIGN 256     	;
 57)   01ED 00 00 00 00 		 	ALIGN 256     	;
 57)   01F1 00 00 00 00 		 	ALIGN 256     	;
 57)   01F5 00 00 00 00 		 	ALIGN 256     	;
 57)   01F9 00 00 00 00 		 	ALIGN 256     	;
 57)   01FD 00 00 00    		 	ALIGN 256     	;
 45)   0200 F3          		@START:	DI	;
 46)   0201 21 00 A0    		  LD HL,$A000 ;TEMPORARY INTERRUPT SERVICE IN RAM	;TEMPORARY INTERRUPT SERVICE IN RAM
 47)   0204 3E ED       		  LD A,$ED ;RETI	;RETI
 48)   0206 77          		  LD (HL),A	;
 49)   0207 23          		  INC HL	;
 50)   0208 3E 4D       		  LD A,$4D ;RETI	;RETI
 51)   020A 77          		  LD (HL),A	;
 61)   020B 06 05       		CN1:	LD B,5	;
 62)   020D 0E 00       		AGN1:	LD C,0	;
 63)   020F 3E 00       			LD A,0	;
 64)   0211 ED 79       			OUT (C),A	;
 65)   0213 0E 00       			LD C,0	;
 66)   0215 3E FF       			LD A,255	;
 67)   0217 ED 79       			OUT (C),A	;
 68)   0219 10 F2       			DJNZ AGN1	;
 73)   021B 11 01 00    			LD DE,1	;
 74)   021E 3E 00       			LD A,0		;WRITE 0	;WRITE 0
 75)   0220 4F          			LD C,A	;
 76)   0221 21 00 80    			LD HL,RAMAD		;
 77)   0224 06 08       			LD B,8	;
 78)   0226 77          		AGN2:	LD (HL),A	;
 79)   0227 4E          			LD C,(HL)	;
 80)   0228 B9          			CP C	;
 81)   0229 C2 43 02    			JP NZ, ERR	;
 82)   022C 19          			ADD HL,DE	;
 83)   022D C6 20       			ADD A,32	;WRITE +32	;WRITE +32
 84)   022F 4F          			LD C,A	;
 85)   0230 10 F4       			DJNZ AGN2	;
 87)   0232 06 05       			LD B,5	;
 88)   0234 0E 08       		AGN3:	LD C,00001000B  ;LLH ON 138 Y1 OUT	;LLH ON 138 Y1 OUT
 89)   0236 3E 40       			LD A,64	;
 90)   0238 ED 79       			OUT (C),A	;
 91)   023A C6 80       			ADD A,128	;
 92)   023C ED 79       			OUT (C),A		;
 93)   023E 10 F4       			DJNZ AGN3  	; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 8	; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 8
 94)   0240 C3 4C 02    			JP BOOT	;
 97)   0243 0E 38       		ERR:	LD C,00111000B  ;HHH ON 138 Y7 OUT	;HHH ON 138 Y7 OUT
 98)   0245 3E 40       			LD A,64	;
 99)   0247 ED 79       			OUT (C),A	;
101)   0249 C3 43 02    			JP ERR 	;DO AGAIN PORT 1	;DO AGAIN PORT 1
105)   024C F3          		@BOOT:	DI	;
106)   024D ED 56       		  IM 1 	;
107)   024F 31 F0 FF    			LD SP,STACKP		;
108)   0252 CD D7 03    			CALL EPROMOFF	;
109)   0255 CD 0A 0F    			CALL KEYBDATON 	;
112)   0258 CD 2A 05    			CALL RS_INI	;RS232 INITIALIZE	;RS232 INITIALIZE
113)   025B 21 F3 04    			LD HL,STR00	;
114)   025E CD 52 05    			CALL RS_TXT	;
122)   0261 CD D0 05    		  CALL LCD_INIT	;
123)   0264 21 3F 00    		  LD HL,COL_BLUE	;
124)   0267 22 03 83    		  LD (BCOLOR),HL	;
125)   026A 21 C0 FF    		  LD HL,COL_YELLOW	;
126)   026D 22 01 83    		  LD (FCOLOR),HL	;
127)   0270 21 E0 04    		  LD HL,STRSCR		;
128)   0273 CD 52 05    		  CALL RS_TXT	;
129)   0276 CD 82 0B    		  CALL LCD_CLRSCR  	;
130)   0279 3E 00       		  LD A,0	;
131)   027B 32 0D 83    		  LD (CURSORX),A	;
132)   027E 3E 00       		  LD A,0	;
133)   0280 32 0E 83    		  LD (CURSORY),A  	;
134)   0283 21 3C 04    			LD HL,STR0   ;LCD INIT MSG	;LCD INIT MSG
135)   0286 CD C2 0B    			CALL LCD_MSG	;
143)   0289 21 B1 04    			LD HL,STRMN	;
144)   028C CD 52 05    			CALL RS_TXT	;OUTPUT MENU COMMANDS AT RS232		;OUTPUT MENU COMMANDS AT RS232
145)   028F 21 09 05    			LD HL,STR01	;
146)   0292 CD 52 05    			CALL RS_TXT	;OUTPUT WAITING AT RS232	;OUTPUT WAITING AT RS232
153)   0295 21 07 04    			LD HL,SMENU	;
154)   0298 3E 05       		  LD A,5	;
155)   029A 32 0D 83    		  LD (CURSORX),A	;
156)   029D 3E 02       		  LD A,2	;
157)   029F 32 0E 83    		  LD (CURSORY),A  	;
158)   02A2 CD C2 0B    			CALL LCD_MSG	;
160)   02A5 CD DD 02    			CALL GET_CHAR	;TAKE A CHAR FROM RS232 OR PS2 KEYB	;TAKE A CHAR FROM RS232 OR PS2 KEYB
163)   02A8 FE 55       			CP 'U'		;UPLOAD PROGRAM	;UPLOAD PROGRAM
164)   02AA CC 0C 03    			CALL Z, UPLOD	;
165)   02AD FE 58       			CP 'X'	;
166)   02AF CA FE 02    			JP Z,EXEC	;
167)   02B2 FE 54       			CP 'T'	;
168)   02B4 CC 83 03    			CALL Z,RSTST	;
169)   02B7 FE 53       			CP 'S'	;
170)   02B9 CC B5 03    			CALL Z,TXTSCR	;
171)   02BC FE 49       			CP 'I'	;
172)   02BE CC 43 03    			CALL Z,UPLOD2	;
173)   02C1 FE 59       			CP 'Y'	;
174)   02C3 CC 99 03    			CALL Z,RSTST2	;
175)   02C6 FE 48       			CP 'H'	;
176)   02C8 CC A8 03    			CALL Z,XMTST	;
177)   02CB FE 4A       			CP 'J'	;
178)   02CD CC 68 03    			CALL Z,DNLOD	;
181)   02D0 FE 43       			CP 'C'	;
182)   02D2 CC 82 0B    			CALL Z,LCD_CLRSCR	;
183)   02D5 FE 42       			CP 'B'	;
184)   02D7 CA 00 40    			JP Z,BBCBASIC	;
186)   02DA C3 89 02    			JP MENU	;
191)   02DD AF          		@GET_CHAR:	XOR A	;
194)   02DE CD 80 05    			CALL RS_KEYRD	;CHAR IN RS232?	;CHAR IN RS232?
195)   02E1 28 04       			JR Z,GT_TST2	;
196)   02E3 CD 5C 05    			CALL RS_RX	; GET THAT CHAR	; GET THAT CHAR
197)   02E6 C9          			RET	;
204)   02E7 CD F7 0F    			CALL READCHAR	;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)	;GET THE KEY FROM USB KEYBOARD (HAS A TIMEOUT)
205)   02EA FE 00       			CP 0          ;IF KEY=0 THEN IT IS INVALID	;IF KEY=0 THEN IT IS INVALID
206)   02EC 28 EF       			JR Z,GET_CHAR	;
209)   02EE F5          			PUSH AF	;
210)   02EF CD 43 05    			CALL RS_TX	;
211)   02F2 3E 0A       			LD A,10	;
212)   02F4 CD 43 05    			CALL RS_TX	;
213)   02F7 3E 0D       			LD A,13	;
214)   02F9 CD 43 05    			CALL RS_TX	;
215)   02FC F1          			POP AF	;
216)   02FD C9          			RET	;
227)   02FE 3E 05       			LD A,5	;
228)   0300 CD 2D 12    			CALL SCPRN				;
230)   0303 11 6F 83    			LD DE,PRGEX	;
231)   0306 1A          			LD A,(DE)	;
232)   0307 6F          			LD L,A	;
233)   0308 13          			INC DE	;
234)   0309 1A          			LD A,(DE)	;
235)   030A 67          			LD H,A	;
236)   030B E9          			JP (HL)	;
243)   030C F3          		UPLOD: DI		;
248)   030D CD 5C 05    			CALL RS_RX 	;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
249)   0310 6F          			LD L,A	;
250)   0311 CD 5C 05    			CALL RS_RX	;
251)   0314 67          			LD H,A	;
252)   0315 CD 5C 05    			CALL RS_RX	;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
253)   0318 4F          			LD C,A	;
254)   0319 CD 5C 05    			CALL RS_RX	;
255)   031C 47          			LD B,A	;
257)   031D 11 6F 83    			LD DE,PRGEX 	;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
258)   0320 7D          			LD A,L	;
259)   0321 12          			LD (DE),A	;
260)   0322 13          			INC DE	;
261)   0323 7C          			LD A,H	;
262)   0324 12          			LD (DE),A	;
264)   0325 FE 80       			CP $80	;
265)   0327 DC E1 03    			CALL C,EPROMON  ;C ROM IN 0-8000 NC ROM IN 8000-FFFF ;SET ROM WRITABLE = '0'	;C ROM IN 0-8000 NC ROM IN 8000-FFFF ;SET ROM WRITABLE = '0'
267)   032A E5          		NORWR:	PUSH HL	;
268)   032B CD 5C 05    		NXB:	CALL RS_RX	;
269)   032E 77          			LD (HL),A	;
270)   032F 23          			INC HL	;
271)   0330 0B          			DEC BC	;
272)   0331 78          			LD A,B	;
273)   0332 B1          			OR C	;
274)   0333 20 F6       			JR NZ,NXB	;LOOP ALL BYTES		;LOOP ALL BYTES
275)   0335 CD D7 03    		  CALL EPROMOFF	;
280)   0338 3E 05       			LD A,5		;
281)   033A CD 2D 12    			CALL SCPRN				;
282)   033D CD 3A 12    			CALL DELAY	;
284)   0340 E1          			POP HL	;
287)   0341 FB          		  EI	;
288)   0342 C9          			RET	;
292)   0343 F3          		UPLOD2:	DI	;
297)   0344 CD 5C 05    			CALL RS_RX 	;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
298)   0347 6F          			LD L,A	;
299)   0348 CD 5C 05    			CALL RS_RX	;
300)   034B 67          			LD H,A	;
301)   034C CD 5C 05    			CALL RS_RX	;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
302)   034F 4F          			LD C,A	;
303)   0350 CD 5C 05    			CALL RS_RX	;
304)   0353 47          			LD B,A	;
306)   0354 11 6F 83    			LD DE,PRGEX 	;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
307)   0357 7D          			LD A,L	;
308)   0358 12          			LD (DE),A	;
309)   0359 13          			INC DE	;
310)   035A 7C          			LD A,H	;
311)   035B 12          			LD (DE),A	;
313)   035C CD 5C 05    		NXB2:	CALL RS_RX	;
314)   035F 77          			LD (HL),A	;
315)   0360 23          			INC HL	;
316)   0361 0B          			DEC BC	;
317)   0362 78          			LD A,B	;
318)   0363 B1          			OR C	;
319)   0364 20 F6       			JR NZ,NXB2	;LOOP ALL BYTES	  		;LOOP ALL BYTES
321)   0366 FB          			EI	;
323)   0367 C9          			RET	;
334)   0368 CD 5C 05    			CALL RS_RX 	;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
335)   036B 6F          			LD L,A	;
336)   036C CD 5C 05    			CALL RS_RX	;
337)   036F 67          			LD H,A	;
338)   0370 CD 5C 05    			CALL RS_RX	;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
339)   0373 4F          			LD C,A	;
340)   0374 CD 5C 05    			CALL RS_RX	;
341)   0377 47          			LD B,A	;
343)   0378 7E          		NXB3:	LD A,(HL)	;
344)   0379 CD 43 05    			CALL RS_TX	;SEND BYTE	;SEND BYTE
345)   037C 23          			INC HL	;
346)   037D 0B          			DEC BC	;
347)   037E 78          			LD A,B	;
348)   037F B1          			OR C	;
349)   0380 20 F6       			JR NZ,NXB3	;LOOP ALL BYTES	  			;LOOP ALL BYTES
350)   0382 C9          			RET	;
352)   0383 00          		RSTST:	NOP	;GET A KEY FROM RS232	;GET A KEY FROM RS232
353)   0384 06 0A       			LD B,10	;
354)   0386 C5          		TEN:	PUSH BC	;
355)   0387 CD 5C 05    			CALL RS_RX	;
357)   038A CD 43 05    			CALL RS_TX	;SEND BACK THE CHAR	;SEND BACK THE CHAR
359)   038D 3E 20       			LD A,' '	;
361)   038F 3E 52       			LD A,'R'	;
364)   0391 CD 47 12    			CALL DEL2	;
366)   0394 C1          			POP BC	;
367)   0395 10 EF       			DJNZ TEN	;
369)   0397 AF          			XOR A	;
370)   0398 C9          			RET	;
372)   0399 00          		RSTST2:	NOP	;TEST RECEIVING AND SENDING 255 BYTES	;TEST RECEIVING AND SENDING 255 BYTES
373)   039A 06 FF       			LD B,255	;
374)   039C C5          		TEN2:	PUSH BC	;
375)   039D CD 5C 05    			CALL RS_RX	;
377)   03A0 CD 43 05    			CALL RS_TX	;SEND BACK THE CHAR			;SEND BACK THE CHAR
379)   03A3 C1          			POP BC	;
380)   03A4 10 F6       			DJNZ TEN2	;
381)   03A6 AF          			XOR A	;
382)   03A7 C9          			RET	;
385)   03A8 00          		XMTST:	NOP	;TEST XMIT ALL 8 BITS	;TEST XMIT ALL 8 BITS
386)   03A9 06 FF       			LD B,255	;
387)   03AB C5          		TEN3:	PUSH BC	;
388)   03AC 78          			LD A,B	;
389)   03AD CD 43 05    			CALL RS_TX	;SEND  THE BYTE	;SEND  THE BYTE
390)   03B0 C1          			POP BC	;
391)   03B1 10 F8       			DJNZ TEN3	;
392)   03B3 AF          			XOR A	;
393)   03B4 C9          			RET	;
395)   03B5 C9          		TXTSCR: RET	;
402)   03B6 04          		@FF_OFF: INC B   ; DO 0-7 TO 1-8	; DO 0-7 TO 1-8
403)   03B7 AF          		       XOR A	;
404)   03B8 37          		       SCF	;
405)   03B9 17          		SBAGN: RLA         ; MOVE IT TO THE RIGHT PLACE	; MOVE IT TO THE RIGHT PLACE
406)   03BA 10 FD       		       DJNZ SBAGN	;
407)   03BC 2F          		       CPL	    ;INVERSE BITS ON A	;INVERSE BITS ON A
408)   03BD 47          		       LD B,A	;
409)   03BE 21 68 83    		       LD HL,FFSTAT	;
410)   03C1 7E          		       LD A,(HL)	;
411)   03C2 A0          		       AND B        ;ZERO THE BIT	;ZERO THE BIT
412)   03C3 77          		       LD (HL),A	;
413)   03C4 D3 08       		       OUT (DEVFFS),A	;
414)   03C6 C9          		       RET	;
417)   03C7 04          		@FF_ON: INC B   ; DO 0-7 TO 1-8	; DO 0-7 TO 1-8
418)   03C8 AF          		       XOR A	;
419)   03C9 37          		       SCF	;
420)   03CA 17          		SBAGN: RLA         ; MOVE IT TO THE RIGHT PLACE	; MOVE IT TO THE RIGHT PLACE
421)   03CB 10 FD       		       DJNZ SBAGN	;
422)   03CD 47          		       LD B,A	;
423)   03CE 21 68 83    		       LD HL,FFSTAT	;
424)   03D1 7E          		       LD A,(HL)	;
425)   03D2 B0          		       OR B        ;SET THE BIT	;SET THE BIT
426)   03D3 77          		       LD (HL),A	;
427)   03D4 D3 08       		       OUT (DEVFFS),A	;
428)   03D6 C9          		       RET	;
430)   03D7 E5          		@EPROMOFF: PUSH HL	;
431)   03D8 C5          		       PUSH BC	;
432)   03D9 06 00       		       LD B,0	;
433)   03DB CD B6 03    		       CALL FF_OFF	;
434)   03DE C1          		       POP BC	;
435)   03DF E1          		       POP HL	;
436)   03E0 C9          		       RET	;
438)   03E1 E5          		@EPROMON: PUSH HL	;
439)   03E2 C5          		          PUSH BC	;
440)   03E3 06 00       		      LD B,0	;
441)   03E5 CD C7 03    		      CALL FF_ON	;
442)   03E8 C1          		      POP BC	;
443)   03E9 E1          		      POP HL	;
444)   03EA C9          		      RET	;
450)   03EB F5          		SOUTAS:	PUSH AF  	;SERIAL PRINT ASCII IN DECIMAL	;SERIAL PRINT ASCII IN DECIMAL
451)   03EC 26 00       			LD H,0	;
452)   03EE 6F          			LD L,A	;
453)   03EF 11 72 83    			LD DE,MYNUM	;
454)   03F2 CD 61 12    			CALL OUTASC	;
456)   03F5 3E 0A       			LD A,10	;
457)   03F7 12          			LD (DE),A	;
458)   03F8 13          			INC DE	;
459)   03F9 3E 0D       			LD A,13	;
460)   03FB 12          			LD (DE),A	;
461)   03FC 13          			INC DE	;
462)   03FD AF          			XOR A	;
463)   03FE 12          			LD (DE),A	;
465)   03FF 21 72 83    			LD HL,MYNUM	;
466)   0402 CD 52 05    			CALL RS_TXT	;
467)   0405 F1          			POP AF	;
468)   0406 C9          			RET	;
473)   0407 55 49 3A 55 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   040B 50 20 4A 3A 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   040F 44 4E 20 58 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0413 3A 52 55 4E 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0417 20 54 59 48 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   041B 3A 52 53 20 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   041F 53 3A 44 49 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0423 53 50 20 43 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0427 3A 43 4C 53 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   042B 20 4C 3A 4C 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   042F 43 44 53 54 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0433 20 42 3A 42 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
473)   0437 41 53 49 43 		SMENU	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS L:LCDST B:BASIC"	;
474)   043B 00          			DB 0	;
476)   043C 4C 43 44 20 		STR0	DEFM "LCD INITIALIZED"	;
476)   0440 49 4E 49 54 		STR0	DEFM "LCD INITIALIZED"	;
476)   0444 49 41 4C 49 		STR0	DEFM "LCD INITIALIZED"	;
476)   0448 5A 45 44    		STR0	DEFM "LCD INITIALIZED"	;
477)   044B 00          			DB 0	;
479)   044C 52 53 32 33 		STR1	DEFM "RS232 INIT"	;
479)   0450 32 20 49 4E 		STR1	DEFM "RS232 INIT"	;
479)   0454 49 54       		STR1	DEFM "RS232 INIT"	;
480)   0456 00          			DB 0	;
482)   0457 50 52 4F 47 		STR2	DEFM "PROGRAM HALTED"	;
482)   045B 52 41 4D 20 		STR2	DEFM "PROGRAM HALTED"	;
482)   045F 48 41 4C 54 		STR2	DEFM "PROGRAM HALTED"	;
482)   0463 45 44       		STR2	DEFM "PROGRAM HALTED"	;
483)   0465 00          			DB 0	;
485)   0466 57 41 49 54 		STR02	DEFM "WAITING..."	;
485)   046A 49 4E 47 2E 		STR02	DEFM "WAITING..."	;
485)   046E 2E 2E       		STR02	DEFM "WAITING..."	;
486)   0470 00          			DB 0	;
488)   0471 50 52 47 20 		DATTR	DEFM "PRG TRANSFERED"	;
488)   0475 54 52 41 4E 		DATTR	DEFM "PRG TRANSFERED"	;
488)   0479 53 46 45 52 		DATTR	DEFM "PRG TRANSFERED"	;
488)   047D 45 44       		DATTR	DEFM "PRG TRANSFERED"	;
489)   047F 00          			DB 0	;
491)   0480 52 45 43 45 		DATST	DEFM "RECEIVING..."	;
491)   0484 49 56 49 4E 		DATST	DEFM "RECEIVING..."	;
491)   0488 47 2E 2E 2E 		DATST	DEFM "RECEIVING..."	;
492)   048C 00          			DB 0		;
494)   048D 50 52 47 20 		SPRGX	DEFM "PRG EXECUTE"	;
494)   0491 45 58 45 43 		SPRGX	DEFM "PRG EXECUTE"	;
494)   0495 55 54 45    		SPRGX	DEFM "PRG EXECUTE"	;
495)   0498 00          			DB 0	;
497)   0499 49 4D 41 47 		STIMG	DEFM "IMAGE COPY"	;
497)   049D 45 20 43 4F 		STIMG	DEFM "IMAGE COPY"	;
497)   04A1 50 59       		STIMG	DEFM "IMAGE COPY"	;
498)   04A3 00          			DB 0	;
500)   04A4 53 43 52 45 		TXTMES	DEFM "SCREEN READY"	;
500)   04A8 45 4E 20 52 		TXTMES	DEFM "SCREEN READY"	;
500)   04AC 45 41 44 59 		TXTMES	DEFM "SCREEN READY"	;
501)   04B0 00          			DB 0	;
503)   04B1 55 49 3A 55 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04B5 50 20 4A 3A 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04B9 44 4E 20 58 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04BD 3A 52 55 4E 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04C1 20 54 59 48 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04C5 3A 52 53 20 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04C9 53 3A 44 49 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04CD 53 50 20 43 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04D1 3A 43 4C 53 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04D5 20 42 3A 42 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
503)   04D9 41 53 49 43 		STRMN	DEFM "UI:UP J:DN X:RUN TYH:RS S:DISP C:CLS B:BASIC"	;
504)   04DD 0A 0D 00    			DB 10,13,0	;
506)   04E0 43 4C 45 41 		STRSCR	DEFM "CLEARING SCREEN."	;
506)   04E4 52 49 4E 47 		STRSCR	DEFM "CLEARING SCREEN."	;
506)   04E8 20 53 43 52 		STRSCR	DEFM "CLEARING SCREEN."	;
506)   04EC 45 45 4E 2E 		STRSCR	DEFM "CLEARING SCREEN."	;
507)   04F0 0A 0D 00    			DB 10,13,0	;
509)   04F3 0A 0D       		STR00	DB 10,13	;
510)   04F5 52 53 32 33 			DEFM "RS232 INITIALIZED"	;
510)   04F9 32 20 49 4E 			DEFM "RS232 INITIALIZED"	;
510)   04FD 49 54 49 41 			DEFM "RS232 INITIALIZED"	;
510)   0501 4C 49 5A 45 			DEFM "RS232 INITIALIZED"	;
510)   0505 44          			DEFM "RS232 INITIALIZED"	;
511)   0506 0A 0D 00    			DB 10,13,0	;
513)   0509 0A 0D       		STR01	DB 10,13	;
514)   050B 57 41 49 54 			DEFM "WAITING..."	;
514)   050F 49 4E 47 2E 			DEFM "WAITING..."	;
514)   0513 2E 2E       			DEFM "WAITING..."	;
515)   0515 0A 0D 00    			DB 10,13,0	;
516)   0518 00          			DB 0	;
518)   0519 0A 0D       		STR06	DB 10,13	;
519)   051B 4B 45 59 20 			DEFM "KEY PRESSED"	;
519)   051F 50 52 45 53 			DEFM "KEY PRESSED"	;
519)   0523 53 45 44    			DEFM "KEY PRESSED"	;
520)   0526 0A 0D 00    			DB 10,13,0	;
521)   0529 00          			DB 0	;
 15)   052A 	            			RBR EQU DEVSER+0	;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)	;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)
 16)   052A 	            			THR EQU DEVSER+0	;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)	;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)
 17)   052A 	            			IER EQU DEVSER+1	;INTERRUPT ENABLE REGISTER (DLAB = 0)	;INTERRUPT ENABLE REGISTER (DLAB = 0)
 22)   052A 	            			IIR EQU DEVSER+2	;INTERRUPT IDENT. REGISTER (READ ONLY)	;INTERRUPT IDENT. REGISTER (READ ONLY)
 27)   052A 	            			FCR EQU DEVSER+2	;FIFO CONTROL REGISTER (WRITE ONLY)	;FIFO CONTROL REGISTER (WRITE ONLY)
 35)   052A 	            			LCR EQU DEVSER+3	;LINE CONTROL REGISTER	;LINE CONTROL REGISTER
 43)   052A 	            			MCR EQU DEVSER+4	;MODEM CONTROL REGISTER 	;MODEM CONTROL REGISTER
 44)   052A 	            			LSR EQU DEVSER+5	;LINE STATUS REGISTER	;LINE STATUS REGISTER
 53)   052A 	            			MSR EQU DEVSER+6	;MODEM STATUS REGISTER	;MODEM STATUS REGISTER
 54)   052A 	            			SCR EQU DEVSER+7	;SCRATCH REGISTER	;SCRATCH REGISTER
 55)   052A 	            			DLL EQU DEVSER+0	;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)
 56)   052A 	            			DLM EQU DEVSER+1	;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)
 62)   052A 3E 80       			LD      A,$80          	; Mask to set DLAB on	; Mask to set DLAB on
 63)   052C D3 23       			OUT     (LCR),A         ; Send to LINe Control Register	; Send to LINe Control Register
 64)   052E 3E 0C       			LD      A,12           ; Divisor of 12 = 9600 bps with 1.8432 MHz clock	; Divisor of 12 = 9600 bps with 1.8432 MHz clock
 69)   0530 D3 20       			OUT     (DLL),A        	; Set LSB of divisor	; Set LSB of divisor
 70)   0532 3E 00       			LD      A,00            ; This will be the MSB of the divisior	; This will be the MSB of the divisior
 71)   0534 D3 21       			OUT     (DLM),A        	; Send to the MSB register	; Send to the MSB register
 72)   0536 3E 03       			LD      A,$03          	; 8 bits, 1 stop, no parity (and clear DLAB)	; 8 bits, 1 stop, no parity (and clear DLAB)
 73)   0538 D3 23       			OUT     (LCR),A        	; Write new value to LCR	; Write new value to LCR
 75)   053A 3E 00       		  LD A, 0								;
 76)   053C D3 22       		  OUT 	(FCR),A						;//was commented	;//was commented
 77)   053E 3E 00       			LD      A,$00          	; 5 A=0 Disable all INterrupts	; 5 A=0 Disable all INterrupts
 78)   0540 D3 21       			OUT     (IER),A        	; Send to INterrupt Enable Register		; Send to INterrupt Enable Register
 79)   0542 C9          			RET	;
 82)   0543 CD 49 05    		RS_TX:	CALL    RSTXRD	;
 83)   0546 D3 20       		        OUT     (THR),A	;
 85)   0548 C9          		        RET	;
 89)   0549 F5          		RSTXRD: PUSH    AF	;
 90)   054A DB 25       		RSTXLP: IN      A,(LSR)        	; fetch the control register	; fetch the control register
 91)   054C CB 6F       		        BIT     5,A             ; bit will be set if UART is ready	; bit will be set if UART is ready
 92)   054E 28 FA       		        JR      Z,RSTXLP	;
 93)   0550 F1          		        POP     AF	;
 94)   0551 C9          		        RET			;
 97)   0552 7E          		RS_TXT: LD A,(HL)	;
 98)   0553 23          			INC HL		;
 99)   0554 FE 00       			CP 0	;
100)   0556 C8          			RET Z	;
101)   0557 CD 43 05    		        CALL RS_TX	;
102)   055A 18 F6       			JR RS_TXT	;
109)   055C 3E 01       		RS_RX:  LD A,1					;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
110)   055E D3 24       		        OUT (MCR),A	;
111)   0560 CD 77 05    						CALL    RSRXRD              	;
112)   0563 AF          		RS_GTCH: XOR A						;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
113)   0564 D3 24       		        OUT (MCR),A        	;
115)   0566 DB 20       			      IN A,(RBR)	;
116)   0568 C9          		        RET	;
118)   0569 3E 01       		RS_RXNW:LD A,1					;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
119)   056B D3 24       		        OUT (MCR),A	;
120)   056D DB 25       						IN      A,(LSR)        	; fetch the conrtol register	; fetch the conrtol register
121)   056F CB 47       		        BIT     0,A                    	;
122)   0571 28 02       		        JR Z,RS_NOCHAR	;
123)   0573 18 EE       		        JR RS_GTCH	;
125)   0575 AF          		RS_NOCHAR: XOR A  ;RETURN ZERO	;RETURN ZERO
126)   0576 C9          		        RET	;
133)   0577 F5          		RSRXRD: PUSH    AF	;
134)   0578 DB 25       		RSRXLP: IN      A,(LSR)        	; fetch the conrtol register	; fetch the conrtol register
135)   057A CB 47       		        BIT     0,A             ; bit will be set if UART has data	; bit will be set if UART has data
136)   057C 28 FA       		        JR      Z,RSRXLP	;
137)   057E F1          		        POP     AF	;
138)   057F C9          		        RET			;
142)   0580 DB 25       		RS_KEYRD:IN      A,(LSR)        	; fetch the conrtol register	; fetch the conrtol register
143)   0582 CB 47       		         BIT     0,A             ; bit will be set if UART has data        	; bit will be set if UART has data
144)   0584 C9          		         RET		;
146)   0585 F5          		SHLCD:	PUSH AF	;
148)   0586 F1          			POP AF	;
150)   0587 C9          			RET	;
154)   0588 F5          		CHKERR: PUSH AF	;
155)   0589 E5          			PUSH HL	;
156)   058A C5          			PUSH BC	;
157)   058B DB 25       			IN A,(LSR) 		;FETCH LINE STATUS REGISTER	;FETCH LINE STATUS REGISTER
158)   058D CB 67       			BIT 4,A	;
159)   058F 28 04       			JR Z,LBLPE	;
160)   0591 3E 42       			LD A,'B' ;$20		;BREAK	;$20		;BREAK
161)   0593 18 1A       			JR EXIT	;
162)   0595 CB 57       		LBLPE:	BIT 2,A		;
163)   0597 28 04       			JR Z,LBLFE	;
164)   0599 3E 50       			LD A,'P' ;$40		;PARITY	;$40		;PARITY
165)   059B 18 12       			JR EXIT	;
166)   059D CB 5F       		LBLFE:	BIT 3,A	;
167)   059F 28 04       			JR Z,LBLOE	;
168)   05A1 3E 46       			LD A,'F' ;$60		;FRAME		;$60		;FRAME
169)   05A3 18 0A       			JR EXIT	;
170)   05A5 CB 4F       		LBLOE:	BIT 1,A	;
171)   05A7 28 04       			JR Z,LBLNE	;
172)   05A9 3E 4F       			LD A,'O'  ;$80		;OVERRUN	;$80		;OVERRUN
173)   05AB 18 02       			JR EXIT	;
174)   05AD 3E 4E       		LBLNE:	LD A,'N'		;NO ERROR	;NO ERROR
175)   05AF 21 6A 83    		EXIT:	LD HL,SERERR	;
176)   05B2 77          			LD (HL),A	;
178)   05B3 C1          			POP BC	;
179)   05B4 E1          			POP HL	;
180)   05B5 F1          			POP AF	;
181)   05B6 C9          			RET	;
 19)   05B7 	            		       LCD_RS EQU DEVTFT;  ;PORT TO CONTROL RS PIN 17=cs+rs+low = COMMAND  A0 CONNECT TO RS	;  ;PORT TO CONTROL RS PIN 17=cs+rs+low = COMMAND  A0 CONNECT TO RS
 20)   05B7 	            		       LCD_CS EQU DEVTFT+1;  ;PORT TO CONTROL CS PIN 16=cs+rs_high  = DATA	;  ;PORT TO CONTROL CS PIN 16=cs+rs_high  = DATA
 33)   05B7 7B          		    LD A,E	;
 34)   05B8 D3 11       		    OUT (LCD_CS),A	;
 39)   05BA DB 11       		    IN A,(LCD_CS)	;
 40)   05BC C9          		    RET	;
 47)   05BD 7A          		    LD A,D  	;
 48)   05BE D3 11       		    OUT (LCD_CS),A	;
 49)   05C0 C9          		    RET	;
 55)   05C1 7A          		    LD A,D  	;
 56)   05C2 D3 10       		    OUT (LCD_RS),A	;
 57)   05C4 C9          		    RET	;
 64)   05C5 AF          		    XOR A	;
 65)   05C6 D3 10       		    OUT (LCD_RS),A  ;RS LOW = COMMAND BYTE      	;RS LOW = COMMAND BYTE
 66)   05C8 CD BD 05    		    CALL LCD_WR_BUS	;
 67)   05CB 3E 01       		    LD A,1	;
 68)   05CD D3 10       		    OUT (LCD_RS),A  ;RS HIGH  = DATA BYTE	;RS HIGH  = DATA BYTE
 69)   05CF C9          		    RET	;
 73)   05D0 16 E2       		    LD D,0xE2         ;PLL multiplier, set PLL clock to 120M	;PLL multiplier, set PLL clock to 120M
 74)   05D2 CD C1 05    		    CALL LCD_WR_COM   ;N=0x36 for 6.5M, 0x23 for 10M crystal	;N=0x36 for 6.5M, 0x23 for 10M crystal
 75)   05D5 16 23       		    LD D,0x23 ;1E	;1E
 76)   05D7 CD BD 05    		    CALL LCD_WR_DAT	;
 77)   05DA 16 02       		    LD D,0x02	;
 78)   05DC CD BD 05    		    CALL LCD_WR_DAT	;
 79)   05DF 16 54       		    LD D,0x54	;
 80)   05E1 CD BD 05    		    CALL LCD_WR_DAT	;
 81)   05E4 16 E0       		    LD D,0xE0         ; PLL enable    	; PLL enable
 82)   05E6 CD C1 05    		    CALL LCD_WR_COM	;
 83)   05E9 16 01       		    LD D,0x01	;
 84)   05EB CD BD 05    		    CALL LCD_WR_DAT	;
 85)   05EE 06 0A       		    LD B,10        ;delay(10);	;delay(10);
 86)   05F0 CD 34 12    		    CALL DELAYMICRO	;
 87)   05F3 16 E0       		    LD D,0xE0         ; PLL enable    	; PLL enable
 88)   05F5 CD C1 05    		    CALL LCD_WR_COM   	;
 89)   05F8 16 03       		    LD D,0x03	;
 90)   05FA CD BD 05    		    CALL LCD_WR_DAT	;
 91)   05FD 06 0A       		    LD B,10        ;delay(10);	;delay(10);
 92)   05FF CD 34 12    		    CALL DELAYMICRO    	;
 94)   0602 16 01       		    LD D,0x01         ; software reset  	; software reset
 95)   0604 CD C1 05    		    CALL LCD_WR_COM   	;
 96)   0607 06 14       		    LD B,20       ;delay(20); MICROSECS	;delay(20); MICROSECS
 97)   0609 CD 34 12    		    CALL DELAYMICRO        	;
 98)   060C 16 E6       		    LD D,0xE6         ;PLL setting for PCLK, depends on resolution  	;PLL setting for PCLK, depends on resolution
 99)   060E CD C1 05    		    CALL LCD_WR_COM           	;
100)   0611 16 03       		    LD D,0x03	;
101)   0613 CD BD 05    		    CALL LCD_WR_DAT   	;
102)   0616 16 33       		    LD D,0x33 ;FF	;FF
103)   0618 CD BD 05    		    CALL LCD_WR_DAT       	;
104)   061B 16 33       		    LD D,0x33 ;FF	;FF
105)   061D CD BD 05    		    CALL LCD_WR_DAT   	;
107)   0620 16 B0       		    LD D,0xB0         ;LCD SPECIFICATION	;LCD SPECIFICATION
108)   0622 CD C1 05    		    CALL LCD_WR_COM       	;
109)   0625 16 20       		    LD D,0x20	;
110)   0627 CD BD 05    		    CALL LCD_WR_DAT   	;
111)   062A 16 00       		    LD D,0x00	;
112)   062C CD BD 05    		    CALL LCD_WR_DAT       	;
113)   062F 16 03       		    LD D,0x03         ;Set HDP  799	;Set HDP  799
114)   0631 CD BD 05    		    CALL LCD_WR_DAT   	;
115)   0634 16 1F       		    LD D,0x1F	;
116)   0636 CD BD 05    		    CALL LCD_WR_DAT   	;
117)   0639 16 01       		    LD D,0x01         ;Set VDP  479	;Set VDP  479
118)   063B CD BD 05    		    CALL LCD_WR_DAT   	;
119)   063E 16 DF       		    LD D,0xDF	;
120)   0640 CD BD 05    		    CALL LCD_WR_DAT 	;
121)   0643 16 00       		    LD D,0x00	;
122)   0645 CD BD 05    		    CALL LCD_WR_DAT     	;
125)   0648 16 B4       		    LD D,0xB4         ;HSYNC	;HSYNC
126)   064A CD C1 05    		    CALL LCD_WR_COM       	;
127)   064D 16 04       		    LD D,0x04 ;03         ;Set HT 928	;03         ;Set HT 928
128)   064F CD BD 05    		    CALL LCD_WR_DAT   	;
129)   0652 16 1F       		    LD D,0x1F ;A0	;A0
130)   0654 CD BD 05    		    CALL LCD_WR_DAT       	;
131)   0657 16 00       		    LD D,0x00         ;Set HPS  46	;Set HPS  46
132)   0659 CD BD 05    		    CALL LCD_WR_DAT   	;
133)   065C 16 D2       		    LD D,0xD2 ;2E	;2E
134)   065E CD BD 05    		    CALL LCD_WR_DAT   	;
135)   0661 16 00       		    LD D,0x00 ;30         ;Set HPW  48	;30         ;Set HPW  48
136)   0663 CD BD 05    		    CALL LCD_WR_DAT   	;
137)   0666 16 00       		    LD D,0x00         ;Set LPS  15	;Set LPS  15
138)   0668 CD BD 05    		    CALL LCD_WR_DAT 	;
139)   066B 16 00       		    LD D,0x00 ;0F	;0F
140)   066D CD BD 05    		    CALL LCD_WR_DAT   	;
141)   0670 16 00       		    LD D,0x00	;
142)   0672 CD BD 05    		    CALL LCD_WR_DAT     	;
144)   0675 16 B6       		    LD D,0xB6         ;VSYNC	;VSYNC
145)   0677 CD C1 05    		    CALL LCD_WR_COM       	;
146)   067A 16 02       		    LD D,0x02         ;Set VT 525	;Set VT 525
147)   067C CD BD 05    		    CALL LCD_WR_DAT   	;
148)   067F 16 0C       		    LD D,0x0C ;0D	;0D
149)   0681 CD BD 05    		    CALL LCD_WR_DAT       	;
150)   0684 16 00       		    LD D,0x00         ;Set VPS  16	;Set VPS  16
151)   0686 CD BD 05    		    CALL LCD_WR_DAT   	;
152)   0689 16 22       		    LD D,0x22 ;10	;10
153)   068B CD BD 05    		    CALL LCD_WR_DAT   	;
154)   068E 16 00       		    LD D,0x00 ;10         ;Set VPW  16	;10         ;Set VPW  16
155)   0690 CD BD 05    		    CALL LCD_WR_DAT   	;
156)   0693 16 00       		    LD D,0x00         ;Set FPS  8	;Set FPS  8
157)   0695 CD BD 05    		    CALL LCD_WR_DAT 	;
158)   0698 16 00       		    LD D,0x00 ; 08	; 08
159)   069A CD BD 05    		    CALL LCD_WR_DAT   	;
161)   069D 16 B8       		    LD D,0xB8         	;
162)   069F CD C1 05    		    CALL LCD_WR_COM           	;
163)   06A2 16 0F       		    LD D,0x0F ;07         ;GPIO3=input, GPIO[2:0]=output	;07         ;GPIO3=input, GPIO[2:0]=output
164)   06A4 CD BD 05    		    CALL LCD_WR_DAT         	;
165)   06A7 16 01       		    LD D,0x01         ;GPIO0 normal	;GPIO0 normal
166)   06A9 CD BD 05    		    CALL LCD_WR_DAT 	;
168)   06AC 16 BA       		    LD D,0xBA         	;
169)   06AE CD C1 05    		    CALL LCD_WR_COM           	;
170)   06B1 16 01       		    LD D,0x01 ;0F	;0F
171)   06B3 CD BD 05    		    CALL LCD_WR_DAT   ;GPIO[3:0] out 1	;GPIO[3:0] out 1
173)   06B6 16 36       		    LD D,0x36         ;rotation	;rotation
174)   06B8 CD C1 05    		    CALL LCD_WR_COM           	;
175)   06BB 16 08       		    LD D,0x08 ;2A         	;2A
176)   06BD CD BD 05    		    CALL LCD_WR_DAT         	;
178)   06C0 16 F0       		    LD D,0xF0         ;pixel data interface	;pixel data interface
179)   06C2 CD C1 05    		    CALL LCD_WR_COM           	;
180)   06C5 16 06       		    LD D,0x06         ;CHANGE THIS FOR 8 BIT INTERFACE  6=9BIT SEND 2 BYTES 	;CHANGE THIS FOR 8 BIT INTERFACE  6=9BIT SEND 2 BYTES
181)   06C7 CD BD 05    		    CALL LCD_WR_DAT     	;
183)   06CA 06 05       		    LD B,5       ;delay(5);	;delay(5);
184)   06CC CD 34 12    		    CALL DELAYMICRO        	;
186)   06CF 16 BC       		    LD D,0xBC         	;
187)   06D1 CD C1 05    		    CALL LCD_WR_COM           	;
188)   06D4 16 40       		    LD D,0x40	;
189)   06D6 CD BD 05    		    CALL LCD_WR_DAT   	;
190)   06D9 16 80       		    LD D,0x80	;
191)   06DB CD BD 05    		    CALL LCD_WR_DAT   	;
192)   06DE 16 40       		    LD D,0x40	;
193)   06E0 CD BD 05    		    CALL LCD_WR_DAT   	;
194)   06E3 16 01       		    LD D,0x01	;
195)   06E5 CD BD 05    		    CALL LCD_WR_DAT       	;
196)   06E8 06 05       		    LD B,5       ;delay(5);	;delay(5);
197)   06EA CD 34 12    		    CALL DELAYMICRO  	;
199)   06ED 16 29       		    LD D,0x29         ;display on 	;display on
200)   06EF CD C1 05    		    CALL LCD_WR_COM       	;
201)   06F2 16 BE       		    LD D,0xBE         ;set PWM for B/L	;set PWM for B/L
202)   06F4 CD C1 05    		    CALL LCD_WR_COM                 	;
203)   06F7 16 06       		    LD D,0x06	;
204)   06F9 CD BD 05    		    CALL LCD_WR_DAT                 	;
205)   06FC 16 F0       		    LD D,0xF0         	;
206)   06FE CD BD 05    		    CALL LCD_WR_DAT   	;
207)   0701 16 01       		    LD D,0x01         	;
208)   0703 CD BD 05    		    CALL LCD_WR_DAT   	;
209)   0706 16 F0       		    LD D,0xF0         	;
210)   0708 CD BD 05    		    CALL LCD_WR_DAT   	;
211)   070B 16 00       		    LD D,0x00         	;
212)   070D CD BD 05    		    CALL LCD_WR_DAT   	;
213)   0710 16 00       		    LD D,0x00         	;
214)   0712 CD BD 05    		    CALL LCD_WR_DAT                   	;
216)   0715 16 D0       		    LD D,0xD0         	;
217)   0717 CD C1 05    		    CALL LCD_WR_COM                 	;
218)   071A 16 0D       		    LD D,0x0D         	;
219)   071C CD BD 05    		    CALL LCD_WR_DAT         	;
222)   071F 21 00 00    		    LD HL,0	;
223)   0722 E5          		    PUSH HL	;
224)   0723 E5          		    PUSH HL	;
225)   0724 21 1F 03    		    LD HL,799	;
226)   0727 E5          		    PUSH HL	;
227)   0728 21 DF 01    		    LD HL,479	;
228)   072B E5          		    PUSH HL	;
229)   072C CD 35 07    		    CALL LCD_SETXY	;
230)   072F 21 08 00    		    LD HL,8       ;REMOVE 4 PARAMS FROM STACK	;REMOVE 4 PARAMS FROM STACK
231)   0732 39          		    ADD HL,SP	;
232)   0733 F9          		    LD SP,HL	;
233)   0734 C9          		    RET	;
250)   0735 DD 21 02 00 		    LD IX,2	;
251)   0739 DD 39       		    ADD IX,SP         	;
252)   073B 16 2A       		    LD D,0x2A         ;SEND IX PARAMS	;SEND IX PARAMS
253)   073D CD C1 05    		    CALL LCD_WR_COM    	;
254)   0740 DD 56 07    		    LD D,(IX+7)	;
255)   0743 CD BD 05    		    CALL LCD_WR_DAT	;
256)   0746 DD 56 06    		    LD D,(IX+6)	;
257)   0749 CD BD 05    		    CALL LCD_WR_DAT	;
258)   074C DD 56 03    		    LD D,(IX+3)	;
259)   074F CD BD 05    		    CALL LCD_WR_DAT	;
260)   0752 DD 56 02    		    LD D,(IX+2)	;
261)   0755 CD BD 05    		    CALL LCD_WR_DAT       	;
262)   0758 16 2B       		    LD D,0x2B         ;SEND Y PARAMS	;SEND Y PARAMS
263)   075A CD C1 05    		    CALL LCD_WR_COM   	;
264)   075D DD 56 05    		    LD D,(IX+5)	;
265)   0760 CD BD 05    		    CALL LCD_WR_DAT	;
266)   0763 DD 56 04    		    LD D,(IX+4)	;
267)   0766 CD BD 05    		    CALL LCD_WR_DAT	;
268)   0769 DD 56 01    		    LD D,(IX+1)	;
269)   076C CD BD 05    		    CALL LCD_WR_DAT	;
270)   076F DD 56 00    		    LD D,(IX)	;
271)   0772 CD BD 05    		    CALL LCD_WR_DAT       	;
272)   0775 16 2C       		    LD D,0x2C         ;SEND DATA	;SEND DATA
273)   0777 CD C1 05    		    CALL LCD_WR_COM           	;
274)   077A C9          		    RET	;
280)   077B 54          		    LD D,H        	;
281)   077C CD BD 05    		    CALL LCD_WR_DAT 	;
282)   077F 55          		    LD D,L	;
283)   0780 CD BD 05    		    CALL LCD_WR_DAT 	;
284)   0783 C9          		    RET	;
289)   0784 16 2E       		    LD D,0x2E         ;READ DATA	;READ DATA
290)   0786 CD C1 05    		    CALL LCD_WR_COM           	;
291)   0789 CD BA 05    		    CALL LCD_RD_DAT 	;
292)   078C 67          		    LD H,A	;
293)   078D CD BA 05    		    CALL LCD_RD_DAT 	;
294)   0790 6F          		    LD L,A	;
295)   0791 C9          		    RET    	;
298)   0792 DD 21 02 00 		    LD IX,2     ;setXY(x, y, x, y);	;setXY(x, y, x, y);
299)   0796 DD 39       		    ADD IX,SP	;
300)   0798 DD 66 03    		    LD H,(IX+3)   ;X	;X
301)   079B DD 6E 02    		    LD L,(IX+2)   ;X	;X
302)   079E DD 56 01    		    LD D,(IX+1) ;Y	;Y
303)   07A1 DD 5E 00    		    LD E,(IX) ;Y	;Y
304)   07A4 E5          		    PUSH HL	;
305)   07A5 D5          		    PUSH DE	;
306)   07A6 E5          		    PUSH HL	;
307)   07A7 D5          		    PUSH DE	;
308)   07A8 CD 35 07    		    CALL LCD_SETXY	;
309)   07AB 21 08 00    		    LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
310)   07AE 39          		    ADD HL,SP	;
311)   07AF F9          		    LD SP,HL	;
312)   07B0 CD 84 07    		    CALL LCD_GETPIXEL	;
313)   07B3 E5          		    PUSH HL    	;
314)   07B4 CD E1 07    		    CALL LCD_CLRXY	;
315)   07B7 E1          		    POP HL	;
316)   07B8 C9          		    RET	;
320)   07B9 DD 21 02 00 		    LD IX,2     ;setXY(x, y, x, y);	;setXY(x, y, x, y);
321)   07BD DD 39       		    ADD IX,SP	;
322)   07BF DD 66 03    		    LD H,(IX+3)   ;X	;X
323)   07C2 DD 6E 02    		    LD L,(IX+2)   ;X	;X
324)   07C5 DD 56 01    		    LD D,(IX+1) ;Y	;Y
325)   07C8 DD 5E 00    		    LD E,(IX) ;Y	;Y
326)   07CB E5          		    PUSH HL	;
327)   07CC D5          		    PUSH DE	;
328)   07CD E5          		    PUSH HL	;
329)   07CE D5          		    PUSH DE	;
330)   07CF CD 35 07    		    CALL LCD_SETXY	;
331)   07D2 21 08 00    		    LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
332)   07D5 39          		    ADD HL,SP	;
333)   07D6 F9          		    LD SP,HL	;
334)   07D7 2A 01 83    		    LD HL,(FCOLOR)	;
335)   07DA CD 7B 07    		    CALL LCD_SETPIXEL	;
336)   07DD CD E1 07    		    CALL LCD_CLRXY	;
337)   07E0 C9          		    RET	;
340)   07E1 21 00 00    		     LD HL,0	;
341)   07E4 E5          		     PUSH HL	;
342)   07E5 E5          		     PUSH HL	;
343)   07E6 21 1F 03    		     LD HL,LCD_WIDTH	;
344)   07E9 E5          		     PUSH HL	;
345)   07EA 21 DF 01    		     LD HL,LCD_HEIGHT	;
346)   07ED E5          		     PUSH HL	;
347)   07EE CD 35 07    		     CALL LCD_SETXY	;
348)   07F1 21 08 00    		     LD HL,8        ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
349)   07F4 39          		     ADD HL,SP	;
350)   07F5 F9          		     LD SP,HL	;
351)   07F6 C9          		     RET	;
355)   07F7 DD 21 02 00 		      LD IX,2	;
356)   07FB DD 39       		      ADD IX,SP	;
357)   07FD DD 66 05    		      LD H,(IX+5)   ;X  	;X
358)   0800 DD 6E 04    		      LD L,(IX+4)   ;X	;X
359)   0803 DD 56 03    		      LD D,(IX+3)   ;Y	;Y
360)   0806 DD 5E 02    		      LD E,(IX+2)   ;Y	;Y
361)   0809 DD 46 01    		      LD B,(IX+1)   ;LENGTH	;LENGTH
362)   080C DD 4E 00    		      LD C,(IX)     ;LENGTH	;LENGTH
365)   080F E5          		      PUSH HL	;
366)   0810 21 00 00    		      LD HL,0	;
367)   0813 B7          		      OR A           ;CLEAR CARRY	;CLEAR CARRY
368)   0814 ED 42       		      SBC HL,BC      ;CHECK IF LENGTH<0	;CHECK IF LENGTH<0
369)   0816 38 0A       		      JR C,POSH1	;
370)   0818 AF          		      XOR A          ;l=-l	;l=-l
371)   0819 91          					SUB C	;
372)   081A 4F          					LD C,A	;
373)   081B 9F          					SBC A,A	;
374)   081C 90          					SUB B	;
375)   081D 47          					LD B,A	;
376)   081E E1          					POP HL	;
377)   081F ED 42       		      SBC HL,BC       ;x -= l;	;x -= l;
378)   0821 E5          		      PUSH HL                    	;
379)   0822 E1          		POSH1: POP HL	;
380)   0823 E5          					PUSH HL	;
381)   0824 D5          		      PUSH DE	;
382)   0825 09          		      ADD HL,BC	;
383)   0826 E5          		      PUSH HL	;
384)   0827 D5          		      PUSH DE	;
385)   0828 CD 35 07    		      CALL LCD_SETXY   ;setXY(x, y, x+l, y);	;setXY(x, y, x+l, y);
386)   082B 21 08 00    		      LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
387)   082E 39          		      ADD HL,SP	;
388)   082F F9          		      LD SP,HL	;
389)   0830 2A 01 83    		      LD HL,(FCOLOR)    	;
390)   0833 CD 7B 07    		NXTH1: CALL LCD_SETPIXEL	;
391)   0836 0B          		      DEC BC	;
392)   0837 79          		      LD A,C	;
393)   0838 B0          		      OR B	;
394)   0839 20 F8       		      JR NZ, NXTH1     	;
395)   083B CD E1 07    		      CALL LCD_CLRXY	;
396)   083E C9          		      RET	;
401)   083F DD 21 02 00 		      LD IX,2	;
402)   0843 DD 39       		      ADD IX,SP	;
403)   0845 DD 56 05    		      LD D,(IX+5)   ;X  	;X
404)   0848 DD 5E 04    		      LD E,(IX+4)   ;X	;X
405)   084B DD 66 03    		      LD H,(IX+3)   ;Y	;Y
406)   084E DD 6E 02    		      LD L,(IX+2)   ;Y	;Y
407)   0851 DD 46 01    		      LD B,(IX+1)   ;LENGTH	;LENGTH
408)   0854 DD 4E 00    		      LD C,(IX)     ;LENGTH     	;LENGTH
409)   0857 E5          		      PUSH HL	;
410)   0858 21 00 00    		      LD HL,0	;
411)   085B B7          		      OR A           ;CLEAR CARRY	;CLEAR CARRY
412)   085C ED 42       		      SBC HL,BC      ;CHECK IF LENGTH<0	;CHECK IF LENGTH<0
413)   085E 38 0A       		      JR C,POSV1	;
414)   0860 AF          		      XOR A          ;l=-l	;l=-l
415)   0861 91          					SUB C	;
416)   0862 4F          					LD C,A	;
417)   0863 9F          					SBC A,A	;
418)   0864 90          					SUB B	;
419)   0865 47          					LD B,A	;
420)   0866 E1          					POP HL	;
421)   0867 ED 42       		      SBC HL,BC       ;Y -= l;	;Y -= l;
422)   0869 E5          		      PUSH HL                   	;
423)   086A E1          		POSV1: POP HL	;
424)   086B D5          					PUSH DE	;
425)   086C E5          		      PUSH HL	;
426)   086D D5          		      PUSH DE	;
427)   086E 09          		      ADD HL,BC	;
428)   086F E5          		      PUSH HL	;
429)   0870 CD 35 07    		      CALL LCD_SETXY   ;setXY(x, y, x, y+l);	;setXY(x, y, x, y+l);
430)   0873 21 08 00    		      LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
431)   0876 39          		      ADD HL,SP	;
432)   0877 F9          		      LD SP,HL	;
433)   0878 2A 01 83    		      LD HL,(FCOLOR)    	;
434)   087B CD 7B 07    		NXTV1: CALL LCD_SETPIXEL	;
435)   087E 0B          		      DEC BC	;
436)   087F 79          		      LD A,C	;
437)   0880 B0          		      OR B	;
438)   0881 20 F8       		      JR NZ, NXTV1     	;
439)   0883 CD E1 07    		      CALL LCD_CLRXY	;
440)   0886 C9          		      RET	;
444)   0887 DD 21 02 00 		      LD IX,2	;
445)   088B DD 39       		      ADD IX,SP	;
455)   088D DD 66 05    		      LD H,(IX+5)   ;Y1	;Y1
456)   0890 DD 6E 04    		      LD L,(IX+4)   ;Y1	;Y1
457)   0893 DD 56 01    		      LD D,(IX+1)   ;Y2	;Y2
458)   0896 DD 5E 00    		      LD E,(IX)     ;Y2	;Y2
459)   0899 B7          		      OR A	;
460)   089A ED 52       		      SBC HL,DE	;
461)   089C 20 1A       		      JR NZ,YNOTEQ	;
463)   089E DD 46 07    		      LD B,(IX+7)   ;X1	;X1
464)   08A1 DD 4E 06    		      LD C,(IX+6)   ;X1	;X1
465)   08A4 C5          		      PUSH BC       ;X1 1ST PARAM ON STACK	;X1 1ST PARAM ON STACK
466)   08A5 D5          		      PUSH DE				;Y 2ND PARAM ON STACK	;Y 2ND PARAM ON STACK
467)   08A6 DD 66 03    		      LD H,(IX+3)   ;X2	;X2
468)   08A9 DD 6E 02    		      LD L,(IX+2)   ;X2       	;X2
469)   08AC ED 42       		      SBC HL,BC  	  ;X2-X1 = LENGTH OF HORIZ LINE	;X2-X1 = LENGTH OF HORIZ LINE
470)   08AE E5          		      PUSH HL       ;LENGTH 3RD PARAM ON STACK 	;LENGTH 3RD PARAM ON STACK
471)   08AF CD F7 07    		      CALL LCD_DRAWHLINE	;
472)   08B2 21 06 00    		      LD HL,6       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
473)   08B5 39          		      ADD HL,SP	;
474)   08B6 F9          		      LD SP,HL      	;
475)   08B7 C9          		      RET	;
477)   08B8 DD 66 07    		      LD H,(IX+7)   ;X1	;X1
478)   08BB DD 6E 06    		      LD L,(IX+6)   ;X1	;X1
479)   08BE DD 56 03    		      LD D,(IX+3)   ;X2	;X2
480)   08C1 DD 5E 02    		      LD E,(IX+2)   ;X2 	;X2
481)   08C4 B7          		      OR A	;
482)   08C5 ED 52       		      SBC HL,DE	;
483)   08C7 20 1A       		      JR NZ,XNOTEQ	;
485)   08C9 D5          		      PUSH DE       ;X2=X1 1ST PARAM ON STACK	;X2=X1 1ST PARAM ON STACK
486)   08CA DD 46 05    		      LD B,(IX+5)   ;Y1	;Y1
487)   08CD DD 4E 04    		      LD C,(IX+4)   ;Y1	;Y1
488)   08D0 C5          		      PUSH BC       ;Y1 2ND PARAM ON STACK	;Y1 2ND PARAM ON STACK
489)   08D1 DD 66 01    		      LD H,(IX+1)   ;Y2	;Y2
490)   08D4 DD 6E 00    		      LD L,(IX)   ;Y2       	;Y2
491)   08D7 ED 42       		      SBC HL,BC  	  ;Y2-Y1 = LENGTH OF VERT LINE	;Y2-Y1 = LENGTH OF VERT LINE
492)   08D9 E5          		      PUSH HL       ;LENGTH 3RD PARAM ON STACK 	;LENGTH 3RD PARAM ON STACK
493)   08DA CD 3F 08    		      CALL LCD_DRAWVLINE	;
494)   08DD 21 06 00    		      LD HL,6       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
495)   08E0 39          		      ADD HL,SP	;
496)   08E1 F9          		      LD SP,HL	;
497)   08E2 C9          		      RET	;
500)   08E3 38 04       		      JR C,X2GTX1	;
502)   08E5 AF          		      XOR A			;
503)   08E6 3D          		      DEC A  ;XSTEP=-1	;XSTEP=-1
504)   08E7 18 0D       		      JR DLNXT1	;
507)   08E9 D5          		      PUSH DE	;
508)   08EA E1          		      POP HL	;
509)   08EB DD 56 07    		      LD D,(IX+7)   ;X1	;X1
510)   08EE DD 5E 06    		      LD E,(IX+6)   ;X1 	;X1
511)   08F1 B7          		      OR A     	;
512)   08F2 ED 52       		      SBC HL,DE     ;X2-X1 ON HL	;X2-X1 ON HL
514)   08F4 3E 01       		      LD A,1        ;XSTEP=1	;XSTEP=1
516)   08F6 06 00       		      LD B,0	;
517)   08F8 0E 00       		      LD C,0	;
518)   08FA C5          		      PUSH BC       ;T	;T
519)   08FB E5          		      PUSH HL       ;DX	;DX
520)   08FC FE 01       		      CP 1	;
521)   08FE 28 02       		      JR Z,DLXMINUS1	;
522)   0900 06 FF       		      LD B,0XFF	;
523)   0902 4F          		DLXMINUS1:LD C,A      	;
524)   0903 C5          		      PUSH BC       ;XSTEP	;XSTEP
525)   0904 DD 66 05    		      LD H,(IX+5)   ;Y1	;Y1
526)   0907 DD 6E 04    		      LD L,(IX+4)   ;Y1	;Y1
527)   090A DD 56 01    		      LD D,(IX+1)   ;Y2	;Y2
528)   090D DD 5E 00    		      LD E,(IX)     ;Y2      	;Y2
529)   0910 B7          		      OR A	;
530)   0911 ED 52       		      SBC HL,DE	;
531)   0913 38 04       		      JR C,Y2GTY1  ;HL=Y1-Y2	;HL=Y1-Y2
532)   0915 AF          		      XOR A	;
533)   0916 3D          		      DEC A         ;YSTEP=-1	;YSTEP=-1
534)   0917 18 0F       		      JR DLNXT2	;
537)   0919 D5          		      PUSH DE	;
538)   091A E1          		      POP HL	;
539)   091B DD 56 05    		      LD D,(IX+5)   ;Y1	;Y1
540)   091E DD 5E 04    		      LD E,(IX+4)   ;Y1  	;Y1
541)   0921 B7          		      OR A	;
542)   0922 ED 52       		      SBC HL,DE  ;HL=Y2-Y1    HL=DY      	;HL=Y2-Y1    HL=DY
543)   0924 06 00       		      LD B,0	;
544)   0926 3E 01       		      LD A,1        ;YSTEP=1	;YSTEP=1
546)   0928 FE 01       		      CP 1	;
547)   092A 28 02       		      JR Z,DLYMINUS1	;
548)   092C 06 FF       		      LD B,0XFF	;
550)   092E 4F          		      LD C,A      	;
551)   092F E5          		      PUSH HL       ;DY	;DY
552)   0930 C5          		      PUSH BC       ;YSTEP   	;YSTEP
553)   0931 FD 21 00 00 		      LD IY,0	;
554)   0935 FD 39       		      ADD IY,SP	;
569)   0937 FD 56 07    		      LD D,(IY+7)    ;DX	;DX
570)   093A FD 5E 06    		      LD E,(IY+6)    ;DX	;DX
571)   093D B7          		      OR A	;
572)   093E ED 52       		      SBC HL,DE      ;DY-DX	;DY-DX
573)   0940 DA DA 09    		      JP C,DXGTDY	;
574)   0943 CA DA 09    		      JP Z,DXGTDY	;
576)   0946 19          		      ADD HL,DE      ;HL=DY	;HL=DY
577)   0947 44          		      LD B,H	;
578)   0948 4D          		      LD C,L	;
579)   0949 CB 38       		      SRL B	;
580)   094B CB 19       		      RR C           ;(dy >> 1)	;(dy >> 1)
581)   094D 21 00 00    		      LD HL,0	;
582)   0950 ED 42       		      SBC HL,BC      ;t = - (dy >> 1);	;t = - (dy >> 1);
583)   0952 FD 74 09    		      LD (IY+9),H    ;SAVE T	;SAVE T
584)   0955 FD 75 08    		      LD (IY+8),L    ;SAVE T	;SAVE T
586)   0958 DD 56 05    		      LD D,(IX+5)   ;ROW	;ROW
587)   095B DD 5E 04    		      LD E,(IX+4)   ;ROW=Y1	;ROW=Y1
588)   095E DD 66 07    		      LD H,(IX+7)   ;COL	;COL
589)   0961 DD 6E 06    		      LD L,(IX+6)   ;COL=X1	;COL=X1
590)   0964 D5          		      PUSH DE	;
591)   0965 DD E5       		      PUSH IX	;
592)   0967 E5          		      PUSH HL	;
593)   0968 D5          		      PUSH DE	;
594)   0969 E5          		      PUSH HL	;
595)   096A D5          		      PUSH DE	;
596)   096B CD 35 07    		      CALL LCD_SETXY	;
597)   096E 21 08 00    		      LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
598)   0971 39          		      ADD HL,SP     ;	;
599)   0972 F9          		      LD SP,HL      	;
600)   0973 2A 01 83    		      LD HL,(FCOLOR)    	;
601)   0976 CD 7B 07    		      CALL LCD_SETPIXEL	;
602)   0979 DD E1       		      POP IX	;
603)   097B D1          		      POP DE	;
604)   097C DD 66 01    		      LD H,(IX+1)   ;Y2	;Y2
605)   097F DD 6E 00    		      LD L,(IX)     ;Y2 	;Y2
606)   0982 ED 52       		      SBC HL,DE     ; ROW=Y2	; ROW=Y2
607)   0984 CA 6D 0A    		      JP Z,DLEXIT	;
608)   0987 FD 46 01    		      LD B,(IY+1)   ;YSTEP HI	;YSTEP HI
609)   098A FD 4E 00    		      LD C,(IY)     ;YSTEP LO	;YSTEP LO
610)   098D EB          		      EX DE,HL	;
611)   098E 09          		      ADD HL,BC     ;row += ystep;	;row += ystep;
612)   098F DD 74 05    		      LD (IX+5),H   ;SAVE ROW	;SAVE ROW
613)   0992 DD 75 04    		      LD (IX+4),L   ;   	;
615)   0995 FD 56 09    		      LD D,(IY+9)   ; T	; T
616)   0998 FD 5E 08    		      LD E,(IY+8)   ; T      	; T
617)   099B FD 66 07    		      LD H,(IY+7)   ;DX	;DX
618)   099E FD 6E 06    		      LD L,(IY+6)   ;DX	;DX
619)   09A1 19          		      ADD HL,DE	;
620)   09A2 FD 74 09    		      LD (IY+9),H   ;t += dx;	;t += dx;
621)   09A5 FD 75 08    		      LD (IY+8),L	;
622)   09A8 EB          		      EX DE,HL	;
623)   09A9 21 00 80    		      LD HL,$8000	;
624)   09AC ED 52       		      SBC HL,DE     ;CHECK IF T<0	;CHECK IF T<0
625)   09AE 38 A8       		      JR C,DLAGN1   ; CARRY SET IF NEGATIVE	; CARRY SET IF NEGATIVE
626)   09B0 FD 46 05    		      LD B,(IY+5)   ;XSTEP HI	;XSTEP HI
627)   09B3 FD 4E 04    		      LD C,(IY+4)   ;XSTEP LO	;XSTEP LO
628)   09B6 DD 66 07    		      LD H,(IX+7)   ;COL HI	;COL HI
629)   09B9 DD 6E 06    		      LD L,(IX+6)   ;COL LO	;COL LO
630)   09BC 09          		      ADD HL,BC     ;col += xstep;	;col += xstep;
631)   09BD DD 74 07    		      LD (IX+7),H   ;SAVE COL	;SAVE COL
632)   09C0 DD 75 06    		      LD (IX+6),L   ;         	;
634)   09C3 FD 66 09    		      LD H,(IY+9)   ; T	; T
635)   09C6 FD 6E 08    		      LD L,(IY+8)   ; T      	; T
636)   09C9 FD 46 03    		      LD B,(IY+3)   ;DY	;DY
637)   09CC FD 4E 02    		      LD C,(IY+2)   ;DY	;DY
638)   09CF ED 42       		      SBC HL,BC	;
639)   09D1 FD 74 09    		      LD (IY+9),H   ;t -= dY;	;t -= dY;
640)   09D4 FD 75 08    		      LD (IY+8),L								;
641)   09D7 C3 58 09    		      JP DLAGN1	;
643)   09DA 19          		      ADD HL,DE      ;HL=DY DE=DX	;HL=DY DE=DX
644)   09DB 42          		      LD B,D	;
645)   09DC 4B          		      LD C,E	;
646)   09DD CB 38       		      SRL B	;
647)   09DF CB 19       		      RR C           ;(dX >> 1)	;(dX >> 1)
648)   09E1 21 00 00    		      LD HL,0	;
649)   09E4 ED 42       		      SBC HL,BC      ;t = - (dX >> 1);	;t = - (dX >> 1);
650)   09E6 FD 74 09    		      LD (IY+9),H    ;SAVE T	;SAVE T
651)   09E9 FD 75 08    		      LD (IY+8),L    ;SAVE T	;SAVE T
653)   09EC DD 56 05    		      LD D,(IX+5)   ;ROW	;ROW
654)   09EF DD 5E 04    		      LD E,(IX+4)   ;ROW=Y1	;ROW=Y1
655)   09F2 DD 66 07    		      LD H,(IX+7)   ;COL	;COL
656)   09F5 DD 6E 06    		      LD L,(IX+6)   ;COL=X1	;COL=X1
657)   09F8 E5          		      PUSH HL       ;SAVE COL	;SAVE COL
658)   09F9 DD E5       		      PUSH IX	;
659)   09FB E5          		      PUSH HL	;
660)   09FC D5          		      PUSH DE	;
661)   09FD E5          		      PUSH HL	;
662)   09FE D5          		      PUSH DE	;
663)   09FF CD 35 07    		      CALL LCD_SETXY	;
664)   0A02 21 08 00    		      LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
665)   0A05 39          		      ADD HL,SP     ;	;
666)   0A06 F9          		      LD SP,HL      	;
667)   0A07 2A 01 83    		      LD HL,(FCOLOR)    	;
668)   0A0A CD 7B 07    		      CALL LCD_SETPIXEL	;
669)   0A0D DD E1       		      POP IX	;
670)   0A0F D1          		      POP DE        ;RETRIEVE COL	;RETRIEVE COL
671)   0A10 DD 66 03    		      LD H,(IX+3)   ;X2	;X2
672)   0A13 DD 6E 02    		      LD L,(IX+2)   ;X2 	;X2
673)   0A16 ED 52       		      SBC HL,DE     ; COL=X2?	; COL=X2?
674)   0A18 28 53       		      JR Z,DLEXIT	;
675)   0A1A EB          		      EX DE,HL      ;HL=COL	;HL=COL
676)   0A1B FD 46 05    		      LD B,(IY+5)   ;XSTEP HI	;XSTEP HI
677)   0A1E FD 4E 04    		      LD C,(IY+4)   ;XSTEP LO	;XSTEP LO
678)   0A21 09          		      ADD HL,BC     ;col += xstep;	;col += xstep;
679)   0A22 DD 74 07    		      LD (IX+7),H   ;SAVE COL	;SAVE COL
680)   0A25 DD 75 06    		      LD (IX+6),L   ;   	;
681)   0A28 FD 56 09    		      LD D,(IY+9)   ; T	; T
682)   0A2B FD 5E 08    		      LD E,(IY+8)   ; T      	; T
683)   0A2E FD 66 03    		      LD H,(IY+3)   ;DY	;DY
684)   0A31 FD 6E 02    		      LD L,(IY+2)   ;DY	;DY
685)   0A34 19          		      ADD HL,DE	;
686)   0A35 FD 74 09    		      LD (IY+9),H   ;t += dY;	;t += dY;
687)   0A38 FD 75 08    		      LD (IY+8),L	;
688)   0A3B EB          		      EX DE,HL      ;T=DE	;T=DE
689)   0A3C 21 00 80    		      LD HL,$8000  	;
690)   0A3F ED 52       		      SBC HL,DE    ;CHECK IF T<0	;CHECK IF T<0
691)   0A41 38 A9       		      JR C,DLAGN2  ;CARRY SET IF NEGATIVE    	;CARRY SET IF NEGATIVE
692)   0A43 FD 46 01    		      LD B,(IY+1)   ;YSTEP HI	;YSTEP HI
693)   0A46 FD 4E 00    		      LD C,(IY)     ;YSTEP LO	;YSTEP LO
694)   0A49 DD 66 05    		      LD H,(IX+5)   ;ROW HI	;ROW HI
695)   0A4C DD 6E 04    		      LD L,(IX+4)   ;ROW LO	;ROW LO
696)   0A4F 09          		      ADD HL,BC     ;ROW += Ystep;	;ROW += Ystep;
697)   0A50 DD 74 05    		      LD (IX+5),H   ;SAVE COL	;SAVE COL
698)   0A53 DD 75 04    		      LD (IX+4),L   ;         	;
700)   0A56 FD 66 09    		      LD H,(IY+9)   ; T	; T
701)   0A59 FD 6E 08    		      LD L,(IY+8)   ; T      	; T
702)   0A5C FD 46 07    		      LD B,(IY+7)   ;DX	;DX
703)   0A5F FD 4E 06    		      LD C,(IY+6)   ;DX	;DX
704)   0A62 ED 42       		      SBC HL,BC	;
705)   0A64 FD 74 09    		      LD (IY+9),H   ;t -= dX;	;t -= dX;
706)   0A67 FD 75 08    		      LD (IY+8),L								;
707)   0A6A C3 EC 09    		      JP DLAGN2	;
710)   0A6D 21 0A 00    		      LD HL,10      ;REMOVE 10 IY PARAMS FROM STACK	;REMOVE 10 IY PARAMS FROM STACK
711)   0A70 39          		      ADD HL,SP     ;	;
712)   0A71 F9          		      LD SP,HL           	;
713)   0A72 C9          		      RET          	;
719)   0A73 FE 08       		      CP 0X08   ;BACKSPACE	;BACKSPACE
720)   0A75 CA 85 0A    		      JP Z,PRCH_DOBCKSPC	;
721)   0A78 FE 0A       		      CP 0X0A   ;LINE FEED JUST IGNORE IT	;LINE FEED JUST IGNORE IT
722)   0A7A C8          		      RET Z	;
723)   0A7B FE 0D       		      CP 0X0D   ;CHECK FOR ENTER	;CHECK FOR ENTER
724)   0A7D 20 3A       		      JR NZ,PRCH_DOPRN	;
725)   0A7F 21 0D 83    		      LD HL,CURSORX	;
726)   0A82 C3 2A 0B    		      JP PRCH_NEWLN 	;
728)   0A85 21 0D 83    		      LD HL,CURSORX      	;
729)   0A88 7E          		      LD A,(HL)	;
730)   0A89 38 05       		      JR C,DOREALBCKSPC	;
732)   0A8B FE 01       		      CP 1      ;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0	;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0
733)   0A8D C8          		      RET Z	;
734)   0A8E 35          		      DEC (HL)	;
735)   0A8F C9          		      RET      	;
737)   0A90 FE 01       		      CP 1      ;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0	;COMPARE WITH COLUMN 1 CAUSE OF THE PROMPT ON COLUMN 0
738)   0A92 28 0A       		      JR Z,PRCH_DOBCKSPC2     ;IF 0 WE ARE ON THE 1ST COLUMN SO NOTHING TO DO JUST DELETE THE 8=BS FROM BUFFER	;IF 0 WE ARE ON THE 1ST COLUMN SO NOTHING TO DO JUST DELETE THE 8=BS FROM BUFFER
739)   0A94 35          		      DEC (HL)  ;GO 1 POSITION BACK	;GO 1 POSITION BACK
740)   0A95 E5          		      PUSH HL	;
741)   0A96 3E 20       		      LD A,32   ;PRINT SPACE	;PRINT SPACE
742)   0A98 CD B9 0A    		      CALL PRCH_DOPRN ;THIS FORWARDS THE CURSOR SO WE SHOULD GO BACK AGAIN	;THIS FORWARDS THE CURSOR SO WE SHOULD GO BACK AGAIN
743)   0A9B E1          		      POP HL	;
744)   0A9C 35          		      DEC (HL)  ;GO 1 POSITION BACK	;GO 1 POSITION BACK
745)   0A9D B7          		      OR A      	;
749)   0A9E DD 21 02 00 		      LD IX,2	;
750)   0AA2 DD 39       		      ADD IX,SP	;
751)   0AA4 DD 66 01    		      LD H,(IX+1);POSITION IN ACCS FOR THE NEW CHARACTER      	;POSITION IN ACCS FOR THE NEW CHARACTER
752)   0AA7 DD 6E 00    		      LD L,(IX) ;POSITION IN ACCS FOR THE NEW CHARACTER  	;POSITION IN ACCS FOR THE NEW CHARACTER
753)   0AAA 3E 00       		      LD A,0    ;NOT XOR WE DONT WANT TO MESS WITH ZERO FLAG	;NOT XOR WE DONT WANT TO MESS WITH ZERO FLAG
754)   0AAC 28 02       		      JR Z,PRCH_SKIP1  ;WE ARE ON COLUMN 1	;WE ARE ON COLUMN 1
755)   0AAE 2B          		      DEC HL     ;PREVIOUS POSITION DELETE BACKSPACE	;PREVIOUS POSITION DELETE BACKSPACE
756)   0AAF 77          		      LD (HL),A  ;PUT 0 ON LAST POSITION	;PUT 0 ON LAST POSITION
758)   0AB0 2B          		      DEC HL     ;PREVIOUS POSITION DELETE PREVIOUS CHAR	;PREVIOUS POSITION DELETE PREVIOUS CHAR
759)   0AB1 77          		      LD (HL),A  ;PUT 0 ON LAST POSITION      	;PUT 0 ON LAST POSITION
760)   0AB2 DD 74 01    		      LD (IX+1),H ;PUT POSITION BACK ON STACK IT WILL POPED	;PUT POSITION BACK ON STACK IT WILL POPED
761)   0AB5 DD 75 00    		      LD (IX),L	;
762)   0AB8 C9          		      RET	;
765)   0AB9 F5          		      PUSH AF  ;SAVE CHAR TO STACK	;SAVE CHAR TO STACK
766)   0ABA 32 0F 83    		      LD (LASTCHAR),A ;SAVE LAST PRINTED CHAR	;SAVE LAST PRINTED CHAR
767)   0ABD 3A 0D 83    		      LD A,(CURSORX)	;
768)   0AC0 06 08       		      LD B,FONT_WIDTH	;
769)   0AC2 16 00       		      LD D,0	;
770)   0AC4 5F          		      LD E,A	;
771)   0AC5 21 00 00    		      LD HL,0	;
772)   0AC8 B7          		      OR A          ; CLEAR CARRY	; CLEAR CARRY
774)   0AC9 ED 5A       		      ADC HL,DE	;
775)   0ACB 10 FC       		      DJNZ PRCH_AGN1 ;HL=DE*B	;HL=DE*B
776)   0ACD E5          		      PUSH HL       ;1ST PARAM X1	;1ST PARAM X1
777)   0ACE 11 08 00    		      LD DE,FONT_WIDTH 	;
778)   0AD1 ED 5A       		      ADC HL,DE      	;
779)   0AD3 2B          		      DEC HL	;
780)   0AD4 E5          		      PUSH HL       ;SAVE 3RD PARAM X2	;SAVE 3RD PARAM X2
781)   0AD5 3A 0E 83    		      LD A,(CURSORY)	;
782)   0AD8 06 0A       		      LD B,FONT_HEIGHT 	;
783)   0ADA 16 00       		      LD D,0	;
784)   0ADC 5F          		      LD E,A	;
785)   0ADD 21 00 00    		      LD HL,0	;
787)   0AE0 ED 5A       		      ADC HL,DE	;
788)   0AE2 10 FC       		      DJNZ PRCH_AGN2      	;
789)   0AE4 D1          		      POP DE        ;RETREIVE 3RD PARAM X2	;RETREIVE 3RD PARAM X2
790)   0AE5 E5          		      PUSH HL       ;2ND PARAM Y1	;2ND PARAM Y1
791)   0AE6 D5          		      PUSH DE       ;3RD PARAM X2	;3RD PARAM X2
792)   0AE7 11 0A 00    		      LD DE,FONT_HEIGHT	;
793)   0AEA ED 5A       		      ADC HL,DE     ;CALC 4TH PARAM      	;CALC 4TH PARAM
794)   0AEC 2B          		      DEC HL        ;4TH PARAM -1  	;4TH PARAM -1
795)   0AED E5          		      PUSH HL				;4TH PARAM Y2	;4TH PARAM Y2
796)   0AEE CD 35 07    		      CALL LCD_SETXY	;
797)   0AF1 21 08 00    		      LD HL,8	;
798)   0AF4 39          		      ADD HL,SP	;
799)   0AF5 F9          		      LD SP,HL      ;SKIP 4 PARAMS 8 BYTES	;SKIP 4 PARAMS 8 BYTES
800)   0AF6 F1          		      POP AF        ;CHAR TO PRINT FROM STACK	;CHAR TO PRINT FROM STACK
801)   0AF7 21 00 75    		      LD HL,FONT_ADDR	;
802)   0AFA 16 00       		      LD D,0	;
803)   0AFC 5F          		      LD E,A	;
804)   0AFD ED 5A       		      ADC HL,DE     ;THIS IS THE CHAR ADDRESS	;THIS IS THE CHAR ADDRESS
805)   0AFF E5          		      PUSH HL	;
806)   0B00 D1          		      POP DE        ; CHAR ADDRESS ON DE	; CHAR ADDRESS ON DE
807)   0B01 0E 0A       		      LD C,FONT_HEIGHT   ; TOTAL FONT LINES	; TOTAL FONT LINES
809)   0B03 1A          		      LD A,(DE)           ;FONT 8BIT PATTERN FOR A LINE	;FONT 8BIT PATTERN FOR A LINE
810)   0B04 06 08       		      LD B,FONT_WIDTH      	;
812)   0B06 CB 27       		      SLA A               ;CHECK BIT FOR 1=FCOLOR OR 0=BCOLOR	;CHECK BIT FOR 1=FCOLOR OR 0=BCOLOR
813)   0B08 38 05       		      JR C,FORECOLOR	;
814)   0B0A 2A 03 83    		      LD HL,(BCOLOR)	;
815)   0B0D 18 03       		      JR PRCH_CONT	;
817)   0B0F 2A 01 83    		      LD HL,(FCOLOR)      	;
819)   0B12 F5          		      PUSH AF	;
820)   0B13 D5          		      PUSH DE             ;TODO:PROBABLY NOT NEEDED HERE 	;TODO:PROBABLY NOT NEEDED HERE
821)   0B14 CD 7B 07    		      CALL LCD_SETPIXEL	;
822)   0B17 D1          		      POP DE	;
823)   0B18 F1          		      POP AF      	;
824)   0B19 10 EB       		      DJNZ PRCH_AGN4	;
825)   0B1B 14          		      INC D             ;ADD 256 FOR NEXT CHAR PATTERN	;ADD 256 FOR NEXT CHAR PATTERN
826)   0B1C 0D          		      DEC C	;
827)   0B1D 20 E4       		      JR NZ,PRCH_AGN3	;
829)   0B1F 21 0D 83    		      LD HL,CURSORX	;
830)   0B22 7E          		      LD A,(HL)	;
831)   0B23 3C          		      INC A	;
832)   0B24 FE 50       		      CP 80	;
833)   0B26 28 02       		      JR Z,PRCH_NEWLN  ;NEW LINE	;NEW LINE
834)   0B28 77          		      LD (HL),A	;
835)   0B29 C9          		      RET	;
838)   0B2A AF          		      XOR A  	;
839)   0B2B 77          		      LD (HL),A   	;
840)   0B2C 23          		      INC HL	;
841)   0B2D 7E          		      LD A,(HL)	;
842)   0B2E 3C          		      INC A       	;
844)   0B2F FE 2F       		      CP 47         ;47 LINES MAX THEN WRAP OR BETTER SCROLL THE SCREEN!!!	;47 LINES MAX THEN WRAP OR BETTER SCROLL THE SCREEN!!!
845)   0B31 20 01       		      JR NZ,PRCH_NOTYET	;
846)   0B33 AF          		      XOR A	;
848)   0B34 77          		      LD (HL),A                             	;
849)   0B35 C9          		      RET	;
862)   0B36 2A 03 83    		      LD HL,(BCOLOR);      	;
863)   0B39 18 03       		      JR LCD_SETCURS	;
874)   0B3B 2A 01 83    		      LD HL,(FCOLOR)      ;COLOR PARAM      	;COLOR PARAM
877)   0B3E E5          		      PUSH HL             ;COLOR PARAM	;COLOR PARAM
878)   0B3F 3A 0D 83    		      LD A,(CURSORX)	;
879)   0B42 06 08       		      LD B,FONT_WIDTH	;
880)   0B44 16 00       		      LD D,0	;
881)   0B46 5F          		      LD E,A	;
882)   0B47 21 00 00    		      LD HL,0	;
883)   0B4A B7          		      OR A                ;CLEAR CARRY	;CLEAR CARRY
885)   0B4B ED 5A       		      ADC HL,DE	;
886)   0B4D 10 FC       		      DJNZ SCUR_AGN1      ;HL = DE * B 	;HL = DE * B
887)   0B4F E5          		      PUSH HL             ;1ST PARAM X1	;1ST PARAM X1
888)   0B50 01 08 00    		      LD BC,FONT_WIDTH	;
889)   0B53 ED 4A       		      ADC HL,BC           ;NEXT CHAR	;NEXT CHAR
890)   0B55 2B          		      DEC HL              ;MINUS 1	;MINUS 1
891)   0B56 E5          		      PUSH HL             ;SAVE 3RD PARAM X2      	;SAVE 3RD PARAM X2
892)   0B57 3A 0E 83    		      LD A,(CURSORY)      	;
893)   0B5A 06 0A       		      LD B,FONT_HEIGHT 	;
894)   0B5C 16 00       		      LD D,0	;
895)   0B5E 5F          		      LD E,A	;
896)   0B5F 21 00 00    		      LD HL,0	;
898)   0B62 ED 5A       		      ADC HL,DE	;
899)   0B64 10 FC       		      DJNZ SCUR_AGN2      ;HL=B*DE	;HL=B*DE
900)   0B66 0E 08       		      LD C,FONT_HEIGHT-2  ;2 PIXEL HEIGTH CURSOR       	;2 PIXEL HEIGTH CURSOR
901)   0B68 06 00       		      LD B,0	;
902)   0B6A ED 4A       		      ADC HL,BC           ;ADD FONT_HEIGHT-2 PIXELS	;ADD FONT_HEIGHT-2 PIXELS
903)   0B6C D1          		      POP DE              ;RETREIVE 3RD PARAM ON DE	;RETREIVE 3RD PARAM ON DE
904)   0B6D E5          		      PUSH HL             ;2ND PARAM Y1	;2ND PARAM Y1
905)   0B6E D5          		      PUSH DE             ;3RD PARAM X2	;3RD PARAM X2
907)   0B6F 23          		      INC HL              ; Y2 ADD THE LAST +2 PIXELS  	; Y2 ADD THE LAST +2 PIXELS
908)   0B70 E5          		      PUSH HL             ;4TH PARAM Y2	;4TH PARAM Y2
909)   0B71 CD 35 07    		      CALL LCD_SETXY	;
910)   0B74 21 08 00    		      LD HL,8	;
911)   0B77 39          		      ADD HL,SP	;
912)   0B78 F9          		      LD SP,HL            ;SKIP 4 PARAMS 8 BYTES            	;SKIP 4 PARAMS 8 BYTES
914)   0B79 E1          		      POP HL              ;GET THE COLOR	;GET THE COLOR
915)   0B7A 06 10       		      LD B,2*FONT_WIDTH   ;2*8=16	;2*8=16
917)   0B7C CD 7B 07    		      CALL LCD_SETPIXEL   ;DESTROYS D,A	;DESTROYS D,A
918)   0B7F 10 FB       		      DJNZ SCUR_AGN3                            	;
923)   0B81 C9          		      RET	;
926)   0B82 CD E1 07    		     CALL LCD_CLRXY;	;
927)   0B85 2A 03 83    		     LD HL,(BCOLOR)     	;
929)   0B88 01 DF 01    		     LD BC,LCD_HEIGHT	;
930)   0B8B C5          		CS_AGNA2: PUSH BC	;
931)   0B8C 01 1F 03    		     LD BC,LCD_WIDTH	;
932)   0B8F CD 7B 07    		CS_AGNA1:  CALL LCD_SETPIXEL         ;DESTROYS D,A, HL HAS COLOR INFO	;DESTROYS D,A, HL HAS COLOR INFO
933)   0B92 0B          		     DEC BC	;
934)   0B93 78          		     LD A,B	;
935)   0B94 B1          		     OR C	;
936)   0B95 20 F8       		     JR NZ,CS_AGNA1	;
937)   0B97 C1          		     POP BC	;
938)   0B98 0B          		     DEC BC	;
939)   0B99 78          		     LD A,B	;
940)   0B9A B1          		     OR C     	;
941)   0B9B 20 EE       		     JR NZ,CS_AGNA2	;
942)   0B9D 21 00 00    		     LD HL,0                   ;RESET CURSOR AT 0,0	;RESET CURSOR AT 0,0
943)   0BA0 22 0D 83    		     LD (CURSORX),HL       	;
944)   0BA3 C9          				 RET	;
949)   0BA4 06 DF       		     LD B,LCD_HEIGHT.AND.0xFF   ;lsb	;lsb
950)   0BA6 0E 02       		     LD C,LCD_HEIGHT.SHR.8+1      ;MSB+1	;MSB+1
952)   0BA8 C5          		     PUSH BC          	;
954)   0BA9 06 1F       		     LD B,LCD_WIDTH.AND.0xFF   ;lsb	;lsb
955)   0BAB 0E 04       		     LD C,LCD_WIDTH.SHR.8+1      ;MSV+1          	;MSV+1
957)   0BAD CD 7B 07    		     CALL LCD_SETPIXEL         ;DESTROYS D,A, HL HAS COLOR INFO	;DESTROYS D,A, HL HAS COLOR INFO
958)   0BB0 10 FB       		     DJNZ CS_AGN1	;
959)   0BB2 0D          		     DEC C	;
960)   0BB3 20 F8       		     JR NZ,CS_AGN1     	;
961)   0BB5 C1          		     POP BC	;
962)   0BB6 10 F0       		     DJNZ CS_AGN2	;
963)   0BB8 0D          		     DEC C	;
964)   0BB9 20 ED       		     JR NZ,CS_AGN2 	;
965)   0BBB 21 00 00    		     LD HL,0                   ;RESET CURSOR AT 0,0	;RESET CURSOR AT 0,0
966)   0BBE 22 0D 83    		     LD (CURSORX),HL       	;
967)   0BC1 C9          		     RET	;
973)   0BC2 7E          		     LD A,(HL)	;
974)   0BC3 FE 00       		     CP 0	;
975)   0BC5 C8          		     RET Z	;
976)   0BC6 E5          		     PUSH HL	;
977)   0BC7 CD 73 0A    		     CALL LCD_PRINTCHAR     	;
978)   0BCA E1          		     POP HL	;
979)   0BCB 23          		     INC HL	;
980)   0BCC 18 F4       		     JR LCD_MSG	;
990)   0BCE FE 01       		     CP 1          ;IS IT FOR GRAPHICS?	;IS IT FOR GRAPHICS?
991)   0BD0 28 0E       		     JR Z,GRCOLS	;
992)   0BD2 21 03 83    		     LD HL,BCOLOR	;
993)   0BD5 22 66 83    		     LD (GR_PARAM4),HL	;
994)   0BD8 21 01 83    		     LD HL,FCOLOR	;
995)   0BDB 22 64 83    		     LD (GR_PARAM3),HL	;
996)   0BDE 18 0C       		     JR BS_DOCOL	;
997)   0BE0 21 07 83    		GRCOLS: LD HL,BGRCOL	;
998)   0BE3 22 66 83    		     LD (GR_PARAM4),HL	;
999)   0BE6 21 05 83    		     LD HL,FGRCOL	;
1000)   0BE9 22 64 83    		     LD (GR_PARAM3),HL         	;
1001)   0BEC CD 94 5E    		BS_DOCOL: CALL EXPRI    ;GET 1ST PARAM	;GET 1ST PARAM
1002)   0BEF D9          		     EXX	;
1003)   0BF0 FD 7E 00    		     LD A,(IY)	;
1004)   0BF3 FE 0D       		     CP 0x0D       ;FINISHED COMD LINE	;FINISHED COMD LINE
1005)   0BF5 28 2E       		     JR Z,COLSEL	;
1006)   0BF7 FE 2C       		     CP ','        ;CHECK FOR ','	;CHECK FOR ','
1007)   0BF9 C2 EE 0E    		     JP NZ,GRPHERR	;
1009)   0BFC E5          		     PUSH HL       ;SAVE 1ST PARAM	;SAVE 1ST PARAM
1010)   0BFD FD 23       		     INC IY        ;NEXT PARAM	;NEXT PARAM
1011)   0BFF CD 94 5E    		     CALL EXPRI    ;GET 2ND PARAM	;GET 2ND PARAM
1012)   0C02 D9          		     EXX	;
1013)   0C03 D1          		     POP DE        ;RESTORE 1ST PARAM ON DE HL HAS THE 2ND	;RESTORE 1ST PARAM ON DE HL HAS THE 2ND
1014)   0C04 7B          		     LD A,E	;
1015)   0C05 D6 80       		     SUB 128	;
1016)   0C07 38 07       		     JR C,COLFC	;
1017)   0C09 5F          		     LD E,A	;
1018)   0C0A DD 21 34 83 		     LD IX,BCOLPAL	;
1019)   0C0E 18 04       		     JR DOPALCOL	;
1020)   0C10 DD 21 14 83 		COLFC: LD IX,FCOLPAL	;
1022)   0C14 7B          		     LD A,E	;
1023)   0C15 FE 0F       		     CP 15			  ;MAX 16 COLORS	;MAX 16 COLORS
1024)   0C17 D2 EE 0E    		     JP NC,GRPHERR	;
1025)   0C1A DD 19       		     ADD IX,DE     	;
1026)   0C1C DD 19       		     ADD IX,DE     ;2*DE CAUSE ITS A 2 BYTE ARRAY	;2*DE CAUSE ITS A 2 BYTE ARRAY
1027)   0C1E DD 75 00    		     LD (IX),L    ;SAVE THE NEW COLOR 	;SAVE THE NEW COLOR
1028)   0C21 DD 74 01    		     LD (IX+1),H  	;
1029)   0C24 C9          		     RET  	;
1032)   0C25 E5          		     PUSH HL	;
1033)   0C26 D1          		     POP DE     	;
1034)   0C27 7B          		     LD A,E	;
1035)   0C28 D6 80       		     SUB 128        ;CHECK MSB	;CHECK MSB
1036)   0C2A 38 11       		     JR C,CFC	;
1037)   0C2C 5F          		     LD E,A	;
1038)   0C2D DD 21 66 83 		     LD IX,GR_PARAM4	;
1039)   0C31 DD 6E 00    		     LD L,(IX)	;
1040)   0C34 DD 66 01    		     LD H,(IX+1)     	;
1041)   0C37 DD 21 34 83 		     LD IX,BCOLPAL  ;BACKCOLOR	;BACKCOLOR
1042)   0C3B 18 0E       		     JR SFC	;
1043)   0C3D DD 21 64 83 		CFC: LD IX,GR_PARAM3	;
1044)   0C41 DD 6E 00    		     LD L,(IX)	;
1045)   0C44 DD 66 01    		     LD H,(IX+1)     	;
1046)   0C47 DD 21 14 83 		     LD IX,FCOLPAL  ;FRONTCOLOR	;FRONTCOLOR
1047)   0C4B 7B          		SFC: LD A,E	;
1048)   0C4C FE 10       		     CP 16			  ;MAX 16 COLORS	;MAX 16 COLORS
1049)   0C4E D2 EE 0E    		     JP NC,GRPHERR	;
1050)   0C51 DD 19       		     ADD IX,DE	;
1051)   0C53 DD 19       		     ADD IX,DE	;
1052)   0C55 DD 56 00    		     LD D,(IX)	;
1053)   0C58 DD 5E 01    		     LD E,(IX+1)     	;
1054)   0C5B 72          		     LD (HL),D  ;SAVE AGAIN 	;SAVE AGAIN
1055)   0C5C 23          		     INC HL     	;
1056)   0C5D 73          		     LD (HL),E       	;
1057)   0C5E C9          		     RET          	;
1063)   0C5F AF          		     XOR A	;
1064)   0C60 21 60 83    		     LD HL,GR_PARAM1	;
1066)   0C63 F5          		     PUSH AF	;
1067)   0C64 E5          		     PUSH HL	;
1068)   0C65 CD 94 5E    		     CALL EXPRI    ;GET 1ST PARAM	;GET 1ST PARAM
1069)   0C68 D9          		     EXX           ;HL HAS THE PARAM     	;HL HAS THE PARAM
1070)   0C69 D1          		     POP DE        ;GET PARAM ADDRESS	;GET PARAM ADDRESS
1071)   0C6A EB          		     EX DE,HL	;
1072)   0C6B 73          		     LD (HL),E	;
1073)   0C6C 23          		     INC HL	;
1074)   0C6D 72          		     LD (HL),D	;
1075)   0C6E 23          		     INC HL        ;PARAM SAVED     	;PARAM SAVED
1076)   0C6F F1          		     POP AF	;
1077)   0C70 3C          		     INC A          	;
1078)   0C71 FE 04       		     CP 4	;
1079)   0C73 C8          		     RET Z     	;
1080)   0C74 F5          		     PUSH AF	;
1081)   0C75 FD 7E 00    		     LD A,(IY)     	;
1082)   0C78 FE 0D       		     CP 0x0D       ;FINISHED COMD LINE	;FINISHED COMD LINE
1083)   0C7A 28 09       		     JR Z,NOMORE 	;
1084)   0C7C FE 2C       		     CP ','        ;CHECK FOR ','	;CHECK FOR ','
1085)   0C7E 20 05       		     JR NZ,NOMORE	;
1086)   0C80 FD 23       		     INC IY        ;NEXT PARAM	;NEXT PARAM
1087)   0C82 F1          		     POP AF    	;
1088)   0C83 18 DE       		     JR GBP_NXT     	;
1089)   0C85 F1          		NOMORE:POP AF     	;
1090)   0C86 C9          		     RET	;
1095)   0C87 01 08 00    		     LD BC,8					;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD	;8 BYTES SHIFT UP KEEPS 2 LAST POSITIONS NEEDED IN PLOT COMMD
1096)   0C8A 11 54 83    		     LD DE,GR_LASTX3	;
1097)   0C8D 21 58 83    		     LD HL,GR_LASTX2	;
1098)   0C90 ED B0       		     LDIR     	;
1099)   0C92 2A 60 83    		     LD HL,(GR_PARAM1)	;
1100)   0C95 22 5C 83    		     LD (GR_LASTX),HL  ;SAVE TO LAST		     		     	;SAVE TO LAST
1101)   0C98 2A 62 83    		     LD HL,(GR_PARAM2)	;
1102)   0C9B 22 5E 83    		     LD (GR_LASTY),HL  ;SAVE TO LAST     	;SAVE TO LAST
1103)   0C9E C9          				 RET	;
1107)   0C9F CD 5F 0C    		     CALL GETBASICPARAMS	;
1108)   0CA2 FE 02       		     CP 2	;
1109)   0CA4 C2 EE 0E    		     JP NZ,GRPHERR          	;
1110)   0CA7 CD BA 0D    		BAS_DODRAW: CALL GRPH_SAVECOLORS	;
1111)   0CAA FD E5       		     PUSH IY	;
1114)   0CAC 2A 5C 83    		     LD HL,(GR_LASTX)	;
1115)   0CAF E5          		     PUSH HL	;
1116)   0CB0 2A 5E 83    		     LD HL,(GR_LASTY)	;
1117)   0CB3 E5          		     PUSH HL	;
1118)   0CB4 CD 87 0C    		     CALL GRPH_SAVELASTPOS	;
1119)   0CB7 2A 60 83    		     LD HL,(GR_PARAM1)	;
1120)   0CBA E5          		     PUSH HL	;
1121)   0CBB 2A 62 83    		     LD HL,(GR_PARAM2)	;
1122)   0CBE E5          		     PUSH HL 	;
1123)   0CBF CD 87 08    		     CALL LCD_DRAWLINE 	;
1124)   0CC2 21 08 00    		     LD HL,8       ;REMOVE PARAMS FROM STACK	;REMOVE PARAMS FROM STACK
1125)   0CC5 39          		     ADD HL,SP	;
1126)   0CC6 F9          		     LD SP,HL     	;
1128)   0CC7 FD E1       		     POP IY	;
1129)   0CC9 CD D1 0D    		     CALL GRPH_RESTORECOLORS	;
1130)   0CCC C9          		     RET           ;RETURN TO BASIC  	;RETURN TO BASIC
1134)   0CCD CD 5F 0C    		@BAS_MOVE:  CALL GETBASICPARAMS	;
1135)   0CD0 FE 02       		          CP 2	;
1136)   0CD2 C2 EE 0E    		          JP NZ,GRPHERR   	;
1138)   0CD5 CD 87 0C    		          CALL GRPH_SAVELASTPOS	;
1139)   0CD8 C9          		          RET	;
1145)   0CD9 CD 5F 0C    		@BAS_POINT:CALL GETBASICPARAMS	;
1146)   0CDC FE 02       		           CP 2	;
1147)   0CDE C2 EE 0E    		           JP NZ,GRPHERR   	;
1150)   0CE1 2A 60 83    		           LD HL,(GR_PARAM1)	;
1151)   0CE4 E5          		           PUSH HL	;
1152)   0CE5 2A 62 83    		           LD HL,(GR_PARAM2)	;
1153)   0CE8 E5          		           PUSH HL           	;
1154)   0CE9 CD 92 07    		           CALL LCD_READPIXEL	;
1155)   0CEC EB          		           EX DE,HL	;
1156)   0CED 21 04 00    		           LD HL,4       ;REMOVE 2 PARAMS FROM STACK	;REMOVE 2 PARAMS FROM STACK
1157)   0CF0 39          		           ADD HL,SP	;
1158)   0CF1 F9          		           LD SP,HL     	;
1159)   0CF2 EB          		           EX DE,HL	;
1163)   0CF3 FD 7E 00    		           LD A,(IY)  	;
1164)   0CF6 FE 29       		           CP ')'	;
1165)   0CF8 C2 EE 0E    		           JP NZ,GRPHERR 	;
1166)   0CFB FD 23       		           INC IY 	;
1169)   0CFD 01 00 00    		           LD BC,0	;
1170)   0D00 F3          		           DI	;
1171)   0D01 E5          		           PUSH HL	;
1172)   0D02 D9          		           EXX	;
1173)   0D03 E1          		           POP HL	;
1174)   0D04 D9          		           EXX           	;
1175)   0D05 21 00 00    		           LD HL,0	;
1176)   0D08 FB          		           EI	;
1177)   0D09 C9          		           RET	;
1183)   0D0A FE 00       		GRPH_GETGROUP: CP 0	;
1185)   0D0C 21 5E 0E    							LD HL,PLOT00	;
1186)   0D0F C8          							RET Z	;
1187)   0D10 FE 0A       		          CP 80.SHR.3	;
1188)   0D12 21 6E 0E    							LD HL,PLOT80	;
1189)   0D15 C8          							RET Z	;
1190)   0D16 FE 0C       		          CP 96.SHR.3	;
1191)   0D18 21 7E 0E    							LD HL,PLOT96	;
1192)   0D1B C8          							RET Z       	;
1193)   0D1C FE 10       		          CP 128.SHR.3	;
1194)   0D1E 21 8E 0E    							LD HL,PLOT128	;
1195)   0D21 C8          							RET Z                   	;
1196)   0D22 FE 12       			        CP 144.SHR.3	;
1197)   0D24 21 9E 0E    							LD HL,PLOT144	;
1198)   0D27 C8          							RET Z                   	;
1199)   0D28 FE 13       		          CP 152.SHR.3	;
1200)   0D2A 21 AE 0E    							LD HL,PLOT152	;
1201)   0D2D C8          							RET Z                   	;
1202)   0D2E FE 14       		          CP 160.SHR.3	;
1203)   0D30 21 BE 0E    							LD HL,PLOT160	;
1204)   0D33 C8          							RET Z                   	;
1205)   0D34 FE 18       		          CP 192.SHR.3	;
1206)   0D36 21 CE 0E    							LD HL,PLOT192	;
1207)   0D39 C8          							RET Z                   	;
1208)   0D3A FE 19       		          CP 200.SHR.3	;
1209)   0D3C 21 DE 0E    		          LD HL,PLOT200	;
1210)   0D3F C8          		          RET Z 	;
1211)   0D40 21 00 00    							LD HL,0	;
1212)   0D43 C9          							RET                    		            	;
1215)   0D44 CD 5F 0C    		@BAS_PLOT:CALL GETBASICPARAMS	;
1216)   0D47 FE 03       		          CP 3	;
1217)   0D49 C2 EE 0E    		          JP NZ,GRPHERR   	;
1218)   0D4C 3A 60 83    		          LD A,(GR_PARAM1)	;
1220)   0D4F 01 04 00    		          LD BC,4	;
1221)   0D52 21 62 83    		          LD HL,GR_PARAM2	;
1222)   0D55 11 60 83    		          LD DE,GR_PARAM1	;
1223)   0D58 ED B0       		          LDIR                    	;
1224)   0D5A 47          		          LD B,A  ;COMMAND GROUP 5 BITS	;COMMAND GROUP 5 BITS
1225)   0D5B CB 38       		          SRL B	;
1226)   0D5D CB 38       		          SRL B	;
1227)   0D5F CB 38       		          SRL B          	;
1228)   0D61 E6 07       		          AND 7			;
1229)   0D63 4F          		          LD C,A  ;SPECIFIC COMMAND IN GROUP	;SPECIFIC COMMAND IN GROUP
1230)   0D64 78          		          LD A,B	;
1231)   0D65 CD 0A 0D    		          CALL GRPH_GETGROUP	;
1232)   0D68 7C          		          LD A,H	;
1233)   0D69 FE 00       		          CP 0	;
1234)   0D6B C8          		          RET Z ;RET IF HL=0 GROUP NOT IMPLEMENTED	;RET IF HL=0 GROUP NOT IMPLEMENTED
1235)   0D6C 06 00       		          LD B,0	;
1236)   0D6E CB 21       		          SLA C      ;C=C*2 2BYTE ADDRESSES	;C=C*2 2BYTE ADDRESSES
1237)   0D70 09          		          ADD HL,BC  ;C IS 0-7 SPECIFIC COMMD	;C IS 0-7 SPECIFIC COMMD
1238)   0D71 5E          		          LD E,(HL)	;
1239)   0D72 23          		          INC HL	;
1240)   0D73 56          		          LD D,(HL)	;
1241)   0D74 EB          		          EX DE,HL	;
1242)   0D75 E9          		          JP (HL)	;
1244)   0D76 C9          		GRPH_NOTIMPL:RET	;
1247)   0D77 2A 60 83    		GRPH_CALCREL: LD HL,(GR_PARAM1)	;
1248)   0D7A ED 5B 5C 83 		         LD DE,(GR_LASTX)	;
1249)   0D7E 19          		         ADD HL,DE	;
1250)   0D7F 22 60 83    		         LD (GR_PARAM1),HL	;
1251)   0D82 2A 62 83    		         LD HL,(GR_PARAM2)	;
1252)   0D85 ED 5B 5E 83 		         LD DE,(GR_LASTY)	;
1253)   0D89 19          		         ADD HL,DE	;
1254)   0D8A 22 62 83    		         LD (GR_PARAM2),HL	;
1255)   0D8D C9          						 RET	;
1258)   0D8E CD 77 0D    		         CALL GRPH_CALCREL	;
1259)   0D91 CD 87 0C    		         CALL GRPH_SAVELASTPOS         	;
1260)   0D94 C9          		         RET	;
1263)   0D95 CD 77 0D    		         CALL GRPH_CALCREL	;
1264)   0D98 CD A7 0C    		         CALL BAS_DODRAW	;
1265)   0D9B C9          		         RET	;
1268)   0D9C 2A 01 83    		         LD HL,(FCOLOR)	;
1269)   0D9F E5          		         PUSH HL	;
1270)   0DA0 2A 03 83    		         LD HL,(BCOLOR)	;
1271)   0DA3 22 01 83    		         LD (FCOLOR),HL	;
1272)   0DA6 E1          		         POP HL	;
1273)   0DA7 22 03 83    		         LD (BCOLOR),HL	;
1274)   0DAA C9          		         RET	;
1277)   0DAB 2A 05 83    		         LD HL,(FGRCOL)	;
1278)   0DAE E5          		         PUSH HL	;
1279)   0DAF 2A 07 83    		         LD HL,(BGRCOL)	;
1280)   0DB2 22 05 83    		         LD (FGRCOL),HL	;
1281)   0DB5 E1          		         POP HL	;
1282)   0DB6 22 07 83    		         LD (BGRCOL),HL	;
1283)   0DB9 C9          		         RET	;
1287)   0DBA 01 04 00    		         LD BC,4 ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
1288)   0DBD 21 01 83    		         LD HL,FCOLOR	;
1289)   0DC0 11 09 83    		         LD DE,FCOLTM 	;
1290)   0DC3 ED B0       		         LDIR	;
1291)   0DC5 01 04 00    		         LD BC,4 ;2 FGRCOL + 2 BGRCOL	;2 FGRCOL + 2 BGRCOL
1292)   0DC8 21 05 83    		         LD HL,FGRCOL	;
1293)   0DCB 11 01 83    		         LD DE,FCOLOR	;
1294)   0DCE ED B0       		         LDIR         	;
1295)   0DD0 C9          						 RET	;
1299)   0DD1 01 04 00    		         LD BC,4 ;2 FCOLOR + 2 BCOLOR	;2 FCOLOR + 2 BCOLOR
1300)   0DD4 21 09 83    		         LD HL,FCOLTM	;
1301)   0DD7 11 01 83    		         LD DE,FCOLOR 	;
1302)   0DDA ED B0       		         LDIR	;
1303)   0DDC C9          						 RET	;
1307)   0DDD CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1308)   0DE0 CD 77 0D    		         CALL GRPH_CALCREL	;
1309)   0DE3 CD A7 0C    		         CALL BAS_DODRAW	;
1310)   0DE6 CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1311)   0DE9 C9          		         RET	;
1314)   0DEA CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1315)   0DED CD A7 0C    		         CALL BAS_DODRAW	;
1316)   0DF0 CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1317)   0DF3 C9          		         RET	;
1320)   0DF4 CD A7 0C    		         CALL BAS_DODRAW  ;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT	;FROM LASTX=2ND PT TO GR_PARAM1=3RD PT
1321)   0DF7 2A 54 83    		         LD HL,(GR_LASTX3)	;
1322)   0DFA 22 60 83    		         LD (GR_PARAM1),HL	;
1323)   0DFD 2A 56 83    		         LD HL,(GR_LASTY3)	;
1324)   0E00 22 62 83    		         LD (GR_PARAM2),HL	;
1325)   0E03 CD A7 0C    		         CALL BAS_DODRAW  ;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT	;FROM LASTX=3RD PT TO GR_PARAM1=1ST PT
1326)   0E06 2A 54 83    		         LD HL,(GR_LASTX3)	;
1327)   0E09 22 60 83    		         LD (GR_PARAM1),HL	;
1328)   0E0C 2A 56 83    		         LD HL,(GR_LASTY3)	;
1329)   0E0F 22 62 83    		         LD (GR_PARAM2),HL	;
1330)   0E12 CD A7 0C    		         CALL BAS_DODRAW  ;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT	;FROM LASTX=1ST PT TO GR_PARAM1=2ND PT
1331)   0E15 C9          						 RET	;
1333)   0E16 CD AB 0D    		GRPH_TRIANGLEBC:CALL GRPH_SWAPGRCOLS	;
1334)   0E19 CD F4 0D    		         CALL GRPH_TRIANGLE	;
1335)   0E1C CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1336)   0E1F C9          						 RET	;
1339)   0E20 21 60 83    		GRPH_RECT:LD HL,GR_PARAM1	;
1340)   0E23 11 64 83    		         LD DE,GR_PARAM3	;
1341)   0E26 01 04 00    		         LD BC,4	;
1342)   0E29 ED B0       		         LDIR               ;COPY PARAM1,2 TO 3,4         	;COPY PARAM1,2 TO 3,4
1343)   0E2B 2A 5E 83    		         LD HL,(GR_LASTY)	;
1344)   0E2E E5          		         PUSH HL            ;PT1_Y	;PT1_Y
1345)   0E2F 2A 5C 83    		         LD HL,(GR_LASTX)	;
1346)   0E32 E5          		         PUSH HL            ;PT1_X         	;PT1_X
1347)   0E33 2A 5E 83    		         LD HL,(GR_LASTY)         	;
1348)   0E36 22 62 83    		         LD (GR_PARAM2),HL         	;
1349)   0E39 CD A7 0C    		         CALL BAS_DODRAW    ;PT1_X,PT1_Y TO PT2_X,PT1_Y	;PT1_X,PT1_Y TO PT2_X,PT1_Y
1350)   0E3C 2A 66 83    		         LD HL,(GR_PARAM4)	;
1351)   0E3F 22 62 83    		         LD (GR_PARAM2),HL	;
1352)   0E42 CD A7 0C    		         CALL BAS_DODRAW    ;PT2_X,PT1_Y TO PT2_X,PT2_Y	;PT2_X,PT1_Y TO PT2_X,PT2_Y
1353)   0E45 E1          		         POP HL             ;PT1_X	;PT1_X
1354)   0E46 22 60 83    		         LD (GR_PARAM1),HL         	;
1355)   0E49 CD A7 0C    		         CALL BAS_DODRAW    ;PT2_X,PT2_Y TO PT1_X,PT2_Y	;PT2_X,PT2_Y TO PT1_X,PT2_Y
1356)   0E4C E1          		         POP HL             ;PT1_Y	;PT1_Y
1357)   0E4D 22 62 83    		         LD (GR_PARAM2),HL	;
1358)   0E50 CD A7 0C    		         CALL BAS_DODRAW    ;PT1_X,PT2_Y TO PT1_X,PT1_Y	;PT1_X,PT2_Y TO PT1_X,PT1_Y
1359)   0E53 C9          		         RET	;
1361)   0E54 CD AB 0D    		GRPH_RECTBC:CALL GRPH_SWAPGRCOLS	;
1362)   0E57 CD 20 0E    		         CALL GRPH_RECT	;
1363)   0E5A CD AB 0D    		         CALL GRPH_SWAPGRCOLS	;
1364)   0E5D C9          						 RET	;
1367)   0E5E 8E 0D       		PLOT00:  DW GRPH_MOVEREL	;
1368)   0E60 95 0D       						 DW GRPH_LINEREL	;
1369)   0E62 76 0D       						 DW GRPH_NOTIMPL	;
1370)   0E64 DD 0D       						 DW GRPH_LINERELBC	;
1371)   0E66 87 0C       						 DW GRPH_SAVELASTPOS	;
1372)   0E68 A7 0C       						 DW BAS_DODRAW	;
1373)   0E6A 76 0D       						 DW GRPH_NOTIMPL				 	;
1374)   0E6C EA 0D       						 DW GRPH_DRAWBC	;
1376)   0E6E 76 0D       		PLOT80:  DW GRPH_NOTIMPL	;
1377)   0E70 F4 0D       						 DW GRPH_TRIANGLE	;
1378)   0E72 76 0D       						 DW GRPH_NOTIMPL	;
1379)   0E74 16 0E       						 DW GRPH_TRIANGLEBC	;
1380)   0E76 76 0D       						 DW GRPH_NOTIMPL	;
1381)   0E78 F4 0D       						 DW GRPH_TRIANGLE	;
1382)   0E7A 76 0D       						 DW GRPH_NOTIMPL				 	;
1383)   0E7C 16 0E       						 DW GRPH_TRIANGLEBC	;
1385)   0E7E 76 0D       		PLOT96:  DW GRPH_NOTIMPL	;
1386)   0E80 20 0E       						 DW GRPH_RECT	;
1387)   0E82 76 0D       						 DW GRPH_NOTIMPL	;
1388)   0E84 54 0E       						 DW GRPH_RECTBC	;
1389)   0E86 76 0D       						 DW GRPH_NOTIMPL	;
1390)   0E88 20 0E       						 DW GRPH_RECT	;
1391)   0E8A 76 0D       						 DW GRPH_NOTIMPL				 	;
1392)   0E8C 54 0E       						 DW GRPH_RECTBC	;
1394)   0E8E 76 0D       		PLOT128: DW GRPH_NOTIMPL	;
1395)   0E90 76 0D       						 DW GRPH_NOTIMPL	;
1396)   0E92 76 0D       						 DW GRPH_NOTIMPL	;
1397)   0E94 76 0D       						 DW GRPH_NOTIMPL	;
1398)   0E96 76 0D       						 DW GRPH_NOTIMPL	;
1399)   0E98 76 0D       						 DW GRPH_NOTIMPL	;
1400)   0E9A 76 0D       						 DW GRPH_NOTIMPL				 	;
1401)   0E9C 76 0D       						 DW GRPH_NOTIMPL	;
1403)   0E9E 76 0D       		PLOT144: DW GRPH_NOTIMPL	;
1404)   0EA0 76 0D       						 DW GRPH_NOTIMPL	;
1405)   0EA2 76 0D       						 DW GRPH_NOTIMPL	;
1406)   0EA4 76 0D       						 DW GRPH_NOTIMPL	;
1407)   0EA6 76 0D       						 DW GRPH_NOTIMPL	;
1408)   0EA8 76 0D       						 DW GRPH_NOTIMPL	;
1409)   0EAA 76 0D       						 DW GRPH_NOTIMPL				 	;
1410)   0EAC 76 0D       						 DW GRPH_NOTIMPL	;
1412)   0EAE 76 0D       		PLOT152: DW GRPH_NOTIMPL	;
1413)   0EB0 76 0D       						 DW GRPH_NOTIMPL	;
1414)   0EB2 76 0D       						 DW GRPH_NOTIMPL	;
1415)   0EB4 76 0D       						 DW GRPH_NOTIMPL	;
1416)   0EB6 76 0D       						 DW GRPH_NOTIMPL	;
1417)   0EB8 76 0D       						 DW GRPH_NOTIMPL	;
1418)   0EBA 76 0D       						 DW GRPH_NOTIMPL				 	;
1419)   0EBC 76 0D       						 DW GRPH_NOTIMPL	;
1421)   0EBE 76 0D       		PLOT160: DW GRPH_NOTIMPL	;
1422)   0EC0 76 0D       						 DW GRPH_NOTIMPL	;
1423)   0EC2 76 0D       						 DW GRPH_NOTIMPL	;
1424)   0EC4 76 0D       						 DW GRPH_NOTIMPL	;
1425)   0EC6 76 0D       						 DW GRPH_NOTIMPL	;
1426)   0EC8 76 0D       						 DW GRPH_NOTIMPL	;
1427)   0ECA 76 0D       						 DW GRPH_NOTIMPL				 	;
1428)   0ECC 76 0D       						 DW GRPH_NOTIMPL	;
1430)   0ECE 76 0D       		PLOT192: DW GRPH_NOTIMPL	;
1431)   0ED0 76 0D       						 DW GRPH_NOTIMPL	;
1432)   0ED2 76 0D       						 DW GRPH_NOTIMPL	;
1433)   0ED4 76 0D       						 DW GRPH_NOTIMPL	;
1434)   0ED6 76 0D       						 DW GRPH_NOTIMPL	;
1435)   0ED8 76 0D       						 DW GRPH_NOTIMPL	;
1436)   0EDA 76 0D       						 DW GRPH_NOTIMPL				 	;
1437)   0EDC 76 0D       						 DW GRPH_NOTIMPL	;
1439)   0EDE 76 0D       		PLOT200: DW GRPH_NOTIMPL	;
1440)   0EE0 76 0D       						 DW GRPH_NOTIMPL	;
1441)   0EE2 76 0D       						 DW GRPH_NOTIMPL	;
1442)   0EE4 76 0D       						 DW GRPH_NOTIMPL	;
1443)   0EE6 76 0D       						 DW GRPH_NOTIMPL	;
1444)   0EE8 76 0D       						 DW GRPH_NOTIMPL	;
1445)   0EEA 76 0D       						 DW GRPH_NOTIMPL				 	;
1446)   0EEC 76 0D       						 DW GRPH_NOTIMPL	;
1449)   0EEE AF          				 XOR     A	;
1450)   0EEF CD F0 46    				 CALL    EXTERR	;
1451)   0EF2 70 61 72 61 				 DEFM    'param error'	;
1451)   0EF6 6D 20 65 72 				 DEFM    'param error'	;
1451)   0EFA 72 6F 72    				 DEFM    'param error'	;
1452)   0EFD 00          				 DEFB    0     	;
 14)   0EFE 	            		DEVKBI EQU DEVINP; INPUT FROM THE KEYBOARD IS ROUTED TO BITS 7,6(DAT,CLK) OF THE INPUT DEVICE 74LS257 CHIP	; INPUT FROM THE KEYBOARD IS ROUTED TO BITS 7,6(DAT,CLK) OF THE INPUT DEVICE 74LS257 CHIP
 17)   0EFE 06 01       		@KEYBCLKON: LD B,UKB_OUT_CLK	;
 18)   0F00 CD B6 03    		       CALL FF_OFF	;
 19)   0F03 C9          		       RET	;
 21)   0F04 06 01       		@KEYBCLKOFF: LD B,UKB_OUT_CLK	;
 22)   0F06 CD C7 03    		      CALL FF_ON	;
 23)   0F09 C9          		      RET	;
 25)   0F0A 06 02       		@KEYBDATON: LD B,UKB_OUT_DAT	;
 26)   0F0C CD B6 03    		       CALL FF_OFF	;
 27)   0F0F C9          		       RET	;
 29)   0F10 06 02       		@KEYBDATOFF: LD B,UKB_OUT_DAT	;
 30)   0F12 CD C7 03    		      CALL FF_ON	;
 31)   0F15 C9          		      RET	;
 33)   0F16 CD FE 0E    		PS2ISK:CALL KEYBCLKON ;KEYBOARD ENABLED	;KEYBOARD ENABLED
 34)   0F19 06 1E       		    LD B,30 ;CHECK SEVERAL TIMES 0.2 MS (30 ON 10mHZ)	;CHECK SEVERAL TIMES 0.2 MS (30 ON 10mHZ)
 35)   0F1B DB 18       		CHAG: IN A,(DEVKBI)	;
 36)   0F1D 57          		    LD D,A	;
 37)   0F1E CB 77       		    BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK	;CHECK BIT 6=CLOCK
 38)   0F20 28 08       		    JR Z,KEYOK	;
 39)   0F22 10 F7       		    DJNZ CHAG	;
 41)   0F24 3E 01       		PS2NTP: LD A,1 ;SET A TO 1 MEANS NO KEY AVAILABLE   	;SET A TO 1 MEANS NO KEY AVAILABLE
 42)   0F26 CD 04 0F    		    CALL KEYBCLKOFF	;
 43)   0F29 C9          		    RET	;
 44)   0F2A AF          		KEYOK: XOR A	;SET A TO 0 MEANS WE HAVE A KEY	;SET A TO 0 MEANS WE HAVE A KEY
 45)   0F2B C9          		    RET	;
 49)   0F2C 06 32       		    LD B,50	;
 50)   0F2E B7          		    OR A   ;CLEAR CARRY	;CLEAR CARRY
 51)   0F2F DB 18       		WH1:IN A,(DEVKBI)	;
 52)   0F31 57          		    LD D,A    	;
 53)   0F32 CB 77       		    BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK	;CHECK BIT 6=CLOCK
 54)   0F34 C0          		    RET NZ	;
 55)   0F35 10 F8       		    DJNZ WH1	;
 56)   0F37 37          		    SCF	;
 57)   0F38 C9          		    RET	;
 60)   0F39 06 32       		   LD B,50	;
 61)   0F3B B7          		   OR A    ;CLEAR CARRY	;CLEAR CARRY
 62)   0F3C DB 18       		WL1:IN A,(DEVKBI)	;
 63)   0F3E 57          		    LD D,A    	;
 64)   0F3F CB 77       		    BIT UKB_IN_CLK,A ;CHECK BIT 6=CLOCK    	;CHECK BIT 6=CLOCK
 65)   0F41 C8          		    RET Z	;
 66)   0F42 10 F8       		    DJNZ WL1	;
 67)   0F44 37          		    SCF	;
 68)   0F45 C9          		    RET	;
 70)   0F46 CD 39 0F    		WAITFORLOW:CALL WAITFORLOW1	;
 71)   0F49 D8          		           RET C	;
 72)   0F4A DB 18       		            IN A,(DEVKBI);SOME MORE TIMES TO BE SURE	;SOME MORE TIMES TO BE SURE
 73)   0F4C DB 18       		            IN A,(DEVKBI)	;
 74)   0F4E 57          		            LD D,A	;
 75)   0F4F C9          		            RET	;
 79)   0F50 7A          		    LD A,D ;BIT 7 HAS THE DATA	;BIT 7 HAS THE DATA
 80)   0F51 CB 7F       		    BIT UKB_IN_DAT,A	;
 81)   0F53 20 2C       		    JR NZ,ERROR0 ;ALWAYS START WITH 0	;ALWAYS START WITH 0
 82)   0F55 06 08       		    LD B,8	;
 83)   0F57 48          		NXTBIT: LD C,B ;SAVE B	;SAVE B
 84)   0F58 CD 2C 0F    		    CALL WAITFORHIGH 	;
 85)   0F5B D8          		    RET C	;
 86)   0F5C CD 46 0F    		    CALL WAITFORLOW	;
 87)   0F5F D8          		    RET C	;
 88)   0F60 CB 27       		    SLA A ;BIT 7=DATA IS ON C FLAG	;BIT 7=DATA IS ON C FLAG
 89)   0F62 CB 1B       		    RR E ;CARRY GOES TO BIT 7 OF E  	;CARRY GOES TO BIT 7 OF E
 90)   0F64 41          		    LD B,C  ;RESTORE C	;RESTORE C
 91)   0F65 10 F0       		    DJNZ NXTBIT	;
 92)   0F67 CD 2C 0F    		    CALL WAITFORHIGH 	;
 93)   0F6A D8          		    RET C	;
 94)   0F6B CD 46 0F    		    CALL WAITFORLOW     	;
 95)   0F6E D8          		    RET C	;
 97)   0F6F CD 2C 0F    		    CALL WAITFORHIGH 	;
 98)   0F72 D8          		    RET C	;
 99)   0F73 CD 46 0F    		    CALL WAITFORLOW 	;
100)   0F76 D8          		    RET C	;
101)   0F77 CB 7F       		    BIT UKB_IN_DAT,A	;
102)   0F79 28 0E       		    JR Z,ERROR1 ;ALWAYS ENDS WITH 1  	;ALWAYS ENDS WITH 1
103)   0F7B CD 2C 0F    		    CALL WAITFORHIGH    ;WAIT FOR END OF TRANSMITION	;WAIT FOR END OF TRANSMITION
104)   0F7E D8          		    RET C	;
106)   0F7F 7B          		    LD A,E	;
107)   0F80 C9          		    RET	;
108)   0F81 21 94 0F    		ERROR0: LD HL,MSER4	;
109)   0F84 CD 52 05    		    CALL RS_TXT	;
110)   0F87 37          		    SCF ;FLAGS AN ERROR OCCURED	;FLAGS AN ERROR OCCURED
111)   0F88 C9          		    RET	;
112)   0F89 D5          		ERROR1:PUSH DE	;
113)   0F8A 21 B7 0F    		    LD HL,MSER5	;
114)   0F8D CD 52 05    		    CALL RS_TXT	;
115)   0F90 37          		    SCF ;FLAGS AN ERROR OCCURED	;FLAGS AN ERROR OCCURED
116)   0F91 D1          		    POP DE	;
117)   0F92 7B          		    LD A,E ;MAYBE IGNORE THIS	;MAYBE IGNORE THIS
118)   0F93 C9          		    RET	;
119)   0F94 45 52 52 4F 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0F98 52 20 53 54 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0F9C 41 52 54 20 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0FA0 42 49 54 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0FA4 4E 4F 54 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0FA8 41 53 20 45 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0FAC 58 50 45 43 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
119)   0FB0 54 45 44 2E 		MSER4 DEFM "ERROR START BIT NOT AS EXPECTED."	;
120)   0FB4 0A 0D 00    		    DB 10,13,0	;
121)   0FB7 45 52 52 4F 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FBB 52 20 53 54 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FBF 4F 50 20 42 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FC3 49 54 2E 4E 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FC7 4F 54 2E 41 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FCB 53 20 45 58 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FCF 50 45 43 54 		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
121)   0FD3 45 44 2E    		MSER5 DEFM "ERROR STOP BIT NOT AS EXPECTED."	;
122)   0FD6 0A 0D 00    		    DB 10,13,0	;
124)   0FD9 01 0A 00    		PS2KEY: LD BC,10        	;
125)   0FDC 0B          		PS2AGN  DEC BC	;
126)   0FDD 78          		        LD A,B	;
127)   0FDE B1          		        OR C	;
128)   0FDF 28 0F       		        JR Z,PS2TIMEOUT	;
129)   0FE1 C5          		        PUSH BC	;
130)   0FE2 CD 16 0F    		        CALL PS2ISK	;
131)   0FE5 B7          		        OR A	;
132)   0FE6 C1          		        POP BC	;
133)   0FE7 20 F3       		        JR NZ, PS2AGN ;NO KEY YET	;NO KEY YET
135)   0FE9 CD 50 0F    		        CALL NEWBYTE 	;
136)   0FEC 38 02       		        JR C,PS2TIMEOUT ;ERROR SO INVALIDATE A	;ERROR SO INVALIDATE A
137)   0FEE 18 01       		        JR PS2EX	;
138)   0FF0 AF          		PS2TIMEOUT:XOR A ;0 CODE IS INVALID	;0 CODE IS INVALID
139)   0FF1 F5          		PS2EX   PUSH AF       	;
140)   0FF2 CD 04 0F    		        CALL KEYBCLKOFF	;
141)   0FF5 F1          		        POP AF	;
142)   0FF6 C9          		        RET	;
145)   0FF7 CD FE 0F    		READCHAR:CALL GTKEY	;
146)   0FFA CD BD 10    		       CALL PS2LOK	;
147)   0FFD C9          		       RET	;
150)   0FFE CD D9 0F    		@GTKEY:	CALL PS2KEY	;GET A KEY FROM PS2	;GET A KEY FROM PS2
151)   1001 FE E1       			CP $E1		;BREAK KEY	;BREAK KEY
152)   1003 CC 2A 10    			CALL Z,GTBRK	;
153)   1006 FE F0       			CP $F0		;240 KEY RELEASED	;240 KEY RELEASED
154)   1008 CC 6E 10    			CALL Z,GTREL	;
155)   100B FE E0       			CP $E0		;224 EXTENDED KEYS	;224 EXTENDED KEYS
156)   100D CC 34 10    			CALL Z,GTEXT	;
159)   1010 FE 12       			CP 18		;LEFT SHIFT	;LEFT SHIFT
160)   1012 CC 99 10    			CALL Z,SHFTOG	;
161)   1015 FE 59       			CP 89		;RIGHT SHIFT	;RIGHT SHIFT
162)   1017 CC 99 10    			CALL Z,SHFTOG	;
163)   101A FE 14       			CP 20		;RIGHT CONTROL	;RIGHT CONTROL
164)   101C CC A2 10    			CALL Z,CTRTOG		;
165)   101F FE 11       			CP 17		;LEFT ALT	;LEFT ALT
166)   1021 CC AB 10    			CALL Z,ALTTOG	;
167)   1024 FE 58       			CP $58  ;CAPS LOCK	;CAPS LOCK
168)   1026 CC B4 10    			CALL Z,CAPSTOG	;
171)   1029 C9          			RET	;
173)   102A CD D9 0F    		GTBRK:	CALL PS2KEY	;$14 OR $F0	;$14 OR $F0
174)   102D FE F0       			CP $F0	;
175)   102F C8          			RET Z	;
176)   1030 CD D9 0F    			CALL PS2KEY	;$77	;$77
177)   1033 C9          			RET	;
179)   1034 CD D9 0F    		GTEXT:	CALL PS2KEY	; THIS IS THE EXTENDED KEY	; THIS IS THE EXTENDED KEY
180)   1037 FE 6B       			CP $6B  ;LEFT	;LEFT
181)   1039 C8          			RET Z	;
182)   103A FE 72       			CP $72	;DOWN	;DOWN
183)   103C C8          			RET Z	;
184)   103D FE 74       			CP $74	;RIGHT	;RIGHT
185)   103F C8          			RET Z	;
186)   1040 FE 75       			CP $75	;UP	;UP
187)   1042 C8          			RET Z	;
188)   1043 FE 70       			CP $70	;INSERT	;INSERT
189)   1045 C8          			RET Z	;
190)   1046 FE 6C       			CP $6C	;HOME	;HOME
191)   1048 C8          			RET Z	;
192)   1049 FE 7D       			CP $7D	;PG UP	;PG UP
193)   104B C8          			RET Z	;
194)   104C FE 7A       			CP $7A	;PG DN	;PG DN
195)   104E C8          			RET Z	;
196)   104F FE 69       			CP $69	;END	;END
197)   1051 C8          			RET Z	;
198)   1052 FE 71       			CP $71	;DEL	;DEL
199)   1054 C8          			RET Z	;
200)   1055 FE 66       		  CP $66  ;BACKSPACE	;BACKSPACE
201)   1057 C8          			RET Z	;
202)   1058 FE 5A       			CP $5A	;ENTER NUM	;ENTER NUM
203)   105A C8          			RET Z	;
204)   105B FE 11       			CP $11	;RIGHT ALT	;RIGHT ALT
205)   105D C8          			RET Z	;
206)   105E FE 14       			CP $14	;LEFT ALT	;LEFT ALT
207)   1060 C8          			RET Z	;
208)   1061 FE 4A       			CP $4A  ;NUMLOCK /	;NUMLOCK /
209)   1063 C8          			RET Z	;
210)   1064 FE F0       			CP $F0	;
211)   1066 C2 6C 10    			JP NZ, 	EXGTEX	;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY	;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY
212)   1069 CD D9 0F    			CALL PS2KEY	; THIS IS THE EXTENDED RELEASED KEY JUST IGNORE IT	; THIS IS THE EXTENDED RELEASED KEY JUST IGNORE IT
214)   106C AF          		EXGTEX	XOR A	;NOT VALID EXTENDED KEY	;NOT VALID EXTENDED KEY
215)   106D C9          			RET	;
218)   106E CD D9 0F    		GTREL:	CALL PS2KEY	; THIS IS THE RELEASED KEY	; THIS IS THE RELEASED KEY
219)   1071 FE 12       			CP 18		; LSHIFT RELEASED	; LSHIFT RELEASED
220)   1073 CC 87 10    			CALL Z,SHFRES	; RESET SHIFT	; RESET SHIFT
221)   1076 FE 14       			CP 20		; LCTRL RELEASED	; LCTRL RELEASED
222)   1078 CC 8D 10    			CALL Z,CTRRES	; RESET CONTROL	; RESET CONTROL
223)   107B FE 11       			CP 17		; LALT RELEASED	; LALT RELEASED
224)   107D CC 93 10    			CALL Z,ALTRES	; RESET ALT	; RESET ALT
225)   1080 FE 59       			CP 89		; RSHIFT RELEASED	; RSHIFT RELEASED
226)   1082 CC 87 10    			CALL Z,SHFRES	; RESET SHIFT	; RESET SHIFT
227)   1085 AF          			XOR A		; NO KEY	; NO KEY
228)   1086 C9          			RET	;
230)   1087 21 69 83    		SHFRES:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH 	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
231)   108A CB B6       			RES 6,(HL)  	; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
232)   108C C9          			RET	;
234)   108D 21 69 83    		CTRRES:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
235)   1090 CB BE       			RES 7,(HL)	; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
236)   1092 C9          			RET	;
238)   1093 21 69 83    		ALTRES:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
239)   1096 CB AE       			RES 5,(HL)	; BIT 5 IS SHIFT $20=32 	; BIT 5 IS SHIFT $20=32
240)   1098 C9          			RET	;
242)   1099 21 69 83    		SHFTOG:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH 	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
243)   109C 3E 40       			LD A,$40	; MASK	; MASK
244)   109E AE          			XOR (HL)  	; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
245)   109F 77          			LD (HL),A	; SAVE	; SAVE
246)   10A0 AF          			XOR A		; NO KEY	; NO KEY
247)   10A1 C9          			RET	;
249)   10A2 21 69 83    		CTRTOG:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
250)   10A5 3E 80       			LD A,$80	; MASK	; MASK
251)   10A7 AE          			XOR (HL)	; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
252)   10A8 77          			LD (HL),A	; SAVE	; SAVE
253)   10A9 AF          			XOR A		; NO KEY	; NO KEY
254)   10AA C9          			RET	;
256)   10AB 21 69 83    		ALTTOG:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
257)   10AE 3E 20       			LD A,$20	;
258)   10B0 AE          			XOR (HL)	; BIT 5 IS ALT $20=32 	; BIT 5 IS ALT $20=32
259)   10B1 77          			LD (HL),A	; SAVE	; SAVE
260)   10B2 AF          			XOR A		; NO KEY	; NO KEY
261)   10B3 C9          			RET	;
263)   10B4 21 69 83    		CAPSTOG:	LD HL,KEYCTR	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS
264)   10B7 3E 10       			LD A,$10	;
265)   10B9 AE          			XOR (HL)	; BIT 4 IS CAPS $10=16 	; BIT 4 IS CAPS $10=16
266)   10BA 77          			LD (HL),A	; SAVE	; SAVE
267)   10BB AF          			XOR A		; NO KEY	; NO KEY
268)   10BC C9          			RET	;
272)   10BD 21 69 83    			LD HL,KEYCTR	;
273)   10C0 47          			LD B,A   ; SAVE A	; SAVE A
274)   10C1 7E          			LD A,(HL); GET KEYBFLAGS ON A SHIFT	; GET KEYBFLAGS ON A SHIFT
275)   10C2 4F          			LD C,A   ;CAPS ON C	;CAPS ON C
276)   10C3 CB 1F       			RR A	;
277)   10C5 CB 1F       			RR A     ;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6	;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6
278)   10C7 A9          			XOR C    ;XOR SHIFT WITH CAPS	;XOR SHIFT WITH CAPS
279)   10C8 CB 67       			BIT 4,A  ;CHECK IF BIT 4 IS 0 = UNSHIFTED	;CHECK IF BIT 4 IS 0 = UNSHIFTED
280)   10CA 78          			LD A,B   ;RESTORE A	;RESTORE A
285)   10CB 21 D9 10    		  LD HL,PS2TAB1	;UNSHIFTED	;UNSHIFTED
286)   10CE 28 03       			JR Z,PLK1	;
287)   10D0 21 83 11    			LD HL,PS2TAB2	;SHIFTED	;SHIFTED
288)   10D3 06 00       		PLK1:   LD B,0	;
289)   10D5 4F          			LD C,A	;
290)   10D6 09          			ADD HL,BC        	;
291)   10D7 7E          			LD A,(HL)	;GET THE CHAR	;GET THE CHAR
292)   10D8 C9          			RET	;
296)   10D9 00 00 00 00 		PS2TAB1	DB 0,0,0,0,0,0,0,0,0,0	;
296)   10DD 00 00 00 00 		PS2TAB1	DB 0,0,0,0,0,0,0,0,0,0	;
296)   10E1 00 00       		PS2TAB1	DB 0,0,0,0,0,0,0,0,0,0	;
297)   10E3 00 00 00 00 			      DB 0,0,0,0,'`',0,0,0,0,0	;
297)   10E7 60 00 00 00 			      DB 0,0,0,0,'`',0,0,0,0,0	;
297)   10EB 00 00       			      DB 0,0,0,0,'`',0,0,0,0,0	;
298)   10ED 00 71 31 00 			      DB 0,'q','1',0,0,0,'z','s','a','w'	;
298)   10F1 00 00 7A 73 			      DB 0,'q','1',0,0,0,'z','s','a','w'	;
298)   10F5 61 77       			      DB 0,'q','1',0,0,0,'z','s','a','w'	;
299)   10F7 32 00 00 63 			      DB '2',0,0,'c','x','d','e','4','3',0	;
299)   10FB 78 64 65 34 			      DB '2',0,0,'c','x','d','e','4','3',0	;
299)   10FF 33 00       			      DB '2',0,0,'c','x','d','e','4','3',0	;
300)   1101 00 20 76 66 			      DB 0,' ','v','f','t','r','5',0,0,'n'	    ;40-49	;40-49
300)   1105 74 72 35 00 			      DB 0,' ','v','f','t','r','5',0,0,'n'	    ;40-49	;40-49
300)   1109 00 6E       			      DB 0,' ','v','f','t','r','5',0,0,'n'	    ;40-49	;40-49
301)   110B 62 68 67 6D 			      DB 'b','h','g','m','6',0,0,44,'m','j'	    ;50-59	;50-59
301)   110F 36 00 00 2C 			      DB 'b','h','g','m','6',0,0,44,'m','j'	    ;50-59	;50-59
301)   1113 6D 6A       			      DB 'b','h','g','m','6',0,0,44,'m','j'	    ;50-59	;50-59
302)   1115 75 37 38 00 			      DB 'u','7','8',0,0,',','k','i','o','0'	  ;60-69	;60-69
302)   1119 00 2C 6B 69 			      DB 'u','7','8',0,0,',','k','i','o','0'	  ;60-69	;60-69
302)   111D 6F 30       			      DB 'u','7','8',0,0,',','k','i','o','0'	  ;60-69	;60-69
303)   111F 39 00 00 2E 			      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
303)   1123 2F 6C 3B 70 			      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
303)   1127 2D 00       			      DB '9',0,0,'.','/','l',59,'p','-',0       ;70-79	;70-79
304)   1129 00 00 27 00 			      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
304)   112D 5B 3D 00 00 			      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
304)   1131 00 00       			      DB 0,0,39,0,'[','=',0,0,0,0               ;80-89	;80-89
305)   1133 0D 5D 00 5C 			      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
305)   1137 00 00 00 00 			      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
305)   113B 00 00       			      DB 13,']',0,'\',0,0,0,0,0,0               ;90-99	;90-99
306)   113D 00 00 06 00 			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
306)   1141 00 08 00 04 			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
306)   1145 09 00       			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
307)   1147 00 00 01 07 			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
307)   114B 0A 00 03 0B 			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
307)   114F 1B 00       			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
308)   1151 00 00 2B 2D 			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
308)   1155 2A 39 00 00 			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
308)   1159 00 00       			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
309)   115B 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
309)   115F 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
309)   1163 00 00       			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
310)   1165 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
310)   1169 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
310)   116D 00 00       			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
311)   116F 00 00 00 00 		        DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
311)   1173 00 00 00 00 		        DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
311)   1177 00 00       		        DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
312)   1179 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
312)   117D 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
312)   1181 00 00       			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
315)   1183 00 00 00 00 		PS2TAB2	DB 0,0,0,0,0,0,0,0,0,0	;
315)   1187 00 00 00 00 		PS2TAB2	DB 0,0,0,0,0,0,0,0,0,0	;
315)   118B 00 00       		PS2TAB2	DB 0,0,0,0,0,0,0,0,0,0	;
316)   118D 00 00 00 00 			      DB 0,0,0,0,'~',0,0,0,0,0	;
316)   1191 7E 00 00 00 			      DB 0,0,0,0,'~',0,0,0,0,0	;
316)   1195 00 00       			      DB 0,0,0,0,'~',0,0,0,0,0	;
317)   1197 00 51 21 00 			      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
317)   119B 00 00 5A 53 			      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
317)   119F 41 57       			      DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
318)   11A1 40 00 00 43 			      DB '@',0,0,'C','X','D','E','$','#',0	;
318)   11A5 58 44 45 24 			      DB '@',0,0,'C','X','D','E','$','#',0	;
318)   11A9 23 00       			      DB '@',0,0,'C','X','D','E','$','#',0	;
319)   11AB 00 20 56 46 			      DB 0,' ','V','F','T','R','%',0,0,'N'	    ;40-49	;40-49
319)   11AF 54 52 25 00 			      DB 0,' ','V','F','T','R','%',0,0,'N'	    ;40-49	;40-49
319)   11B3 00 4E       			      DB 0,' ','V','F','T','R','%',0,0,'N'	    ;40-49	;40-49
320)   11B5 42 48 47 59 			      DB 'B','H','G','Y','^',0,0,'"','M','J'	  ;50-59	;50-59
320)   11B9 5E 00 00 22 			      DB 'B','H','G','Y','^',0,0,'"','M','J'	  ;50-59	;50-59
320)   11BD 4D 4A       			      DB 'B','H','G','Y','^',0,0,'"','M','J'	  ;50-59	;50-59
321)   11BF 55 5E 2A 00 			      DB 'U','^','*',0,0,'<','K','I','O',')'	  ;60-69	;60-69
321)   11C3 00 3C 4B 49 			      DB 'U','^','*',0,0,'<','K','I','O',')'	  ;60-69	;60-69
321)   11C7 4F 29       			      DB 'U','^','*',0,0,'<','K','I','O',')'	  ;60-69	;60-69
322)   11C9 28 00 00 3E 			      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
322)   11CD 3F 4C 3A 50 			      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
322)   11D1 5F 00       			      DB '(',0,0,'>','?','L',':','P','_',0      ;70-79	;70-79
323)   11D3 00 00 22 00 			      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
323)   11D7 7B 2B 00 00 			      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
323)   11DB 00 00       			      DB 0,0,34,0,'{','+',0,0,0,0               ;80-89	;80-89
324)   11DD 0D 7D 00 7C 			      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
324)   11E1 00 00 00 00 			      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
324)   11E5 00 00       			      DB 13,'}',0,'|',0,0,0,0,0,0               ;90-99	;90-99
325)   11E7 00 00 06 00 			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
325)   11EB 00 08 00 04 			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
325)   11EF 09 00       			      DB 0,0,6,0,0,8,0,4,9,0                    ;100-109   	;100-109
326)   11F1 00 00 01 07 			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
326)   11F5 0A 00 03 0B 			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
326)   11F9 1B 00       			      DB 0,0,1,7,10,0,3,11,ESC,0                ;110-119 	;110-119
327)   11FB 00 00 2B 2D 			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
327)   11FF 2A 39 00 00 			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
327)   1203 00 00       			      DB 0,0,'+','-','*','9',0,0,0,0            ;120-129	;120-129
328)   1205 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
328)   1209 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
328)   120D 00 00       			      DB 0,0,0,0,0,0,0,0,0,0			              ;130-139	;130-139
329)   120F 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
329)   1213 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
329)   1217 00 00       			      DB 0,0,0,0,0,0,0,0,0,0                    ;140-149	;140-149
330)   1219 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
330)   121D 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
330)   1221 00 00       			      DB 0,0,0,0,0,0,0,0,0,0		                ;150-159	;150-159
331)   1223 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
331)   1227 00 00 00 00 			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
331)   122B 00 00       			      DB 0,0,0,0,0,0,0,0,0,0                    ;160-169	;160-169
 14)   122D C9          		      RET		;
 17)   122E F5          		DELAYMICROSEC:	PUSH AF	;
 18)   122F D5          			PUSH DE	;
 19)   1230 1B          		  DEC DE	;
 20)   1231 D1          			POP DE	;
 21)   1232 F1          			POP AF	;
 22)   1233 C9          			RET	;
 25)   1234 CD 2E 12    		S21:	CALL DELAYMICROSEC	;
 26)   1237 10 FB       			DJNZ S21		;
 27)   1239 C9          			RET	;
 31)   123A F5          		DELAYMILISEC:	PUSH AF	;
 32)   123B D5          			PUSH DE	;
 33)   123C 11 2C 01    			LD DE,300	;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS	;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS
 34)   123F 1B          		DEL1:	DEC DE	;
 35)   1240 7A          			LD A,D            ;TEST FOR DE=00	;TEST FOR DE=00
 36)   1241 B3          			OR E	;
 37)   1242 20 FB       			JR NZ,DEL1 		;
 38)   1244 D1          			POP DE	;
 39)   1245 F1          			POP AF	;
 40)   1246 C9          			RET	;
 42)   1247 06 50       		DEL2:LD B,80	;
 44)   1249 CD 3A 12    		S1:	CALL DELAYMILISEC	;
 45)   124C 10 FB       			DJNZ S1		;
 46)   124E C9          			RET	;
 51)   124F C5          		@DELAYSEC:PUSH BC 	;
 52)   1250 01 E8 03    		         LD BC,1000 	;
 53)   1253 C5          		MYDLAGN: PUSH BC	;
 54)   1254 CD 3A 12    		         CALL DELAY  ;1MS ON 8 MHZ	;1MS ON 8 MHZ
 55)   1257 C1          		      	 POP BC	;
 56)   1258 0B          			       DEC BC	;
 57)   1259 78          		         LD A,B	;
 58)   125A B1          		         OR C	;
 59)   125B 20 F6       		         JR NZ,MYDLAGN	;
 60)   125D C1          		         POP BC	;
 61)   125E 10 EF       		         DJNZ DELAYSEC	;
 62)   1260 C9          		         RET	;
 67)   1261 F5          		OUTASC	PUSH AF	;
 68)   1262 D5          			PUSH DE	;
 69)   1263 CD 6C 12    			CALL B2Bcd	;
 70)   1266 D1          			POP DE	;
 71)   1267 CD 83 12    			CALL BCD2HA	;
 72)   126A F1          			POP AF	;
 73)   126B C9          			RET		;
 86)   126C 01 00 10    		LD BC, 16*256+0 ; handle 16 bits, one bit per iteration	; handle 16 bits, one bit per iteration
 87)   126F 11 00 00    		LD DE, 0	;
 89)   1272 29          		ADD HL, HL	;
 90)   1273 7B          		LD A, E	;
 91)   1274 8F          		ADC A, A	;
 92)   1275 27          		DAA	;
 93)   1276 5F          		LD E, A	;
 94)   1277 7A          		LD A, D	;
 95)   1278 8F          		ADC A, A	;
 96)   1279 27          		DAA	;
 97)   127A 57          		LD D, A	;
 98)   127B 79          		LD A, C	;
 99)   127C 8F          		ADC A, A	;
100)   127D 27          		DAA	;
101)   127E 4F          		LD C, A	;
102)   127F 10 F1       		DJNZ cvtLp	;
103)   1281 EB          		EX DE,HL	;
104)   1282 C9          		RET	;
115)   1283 79          		LD A, C	;
116)   1284 CD 9A 12    		CALL cvtUN	;
117)   1287 79          		LD A, C	;
118)   1288 CD 9E 12    		CALL cvtLN	;
119)   128B 7C          		LD A, H	;
120)   128C CD 9A 12    		CALL cvtUN	;
121)   128F 7C          		LD A, H	;
122)   1290 CD 9E 12    		CALL cvtLN	;
123)   1293 7D          		LD A, L	;
124)   1294 CD 9A 12    		CALL cvtUN	;
125)   1297 7D          		LD A, L	;
126)   1298 18 04       		JR cvtLN	;
128)   129A 1F          		RRA ; move upper nibble into lower nibble	; move upper nibble into lower nibble
129)   129B 1F          		RRA	;
130)   129C 1F          		RRA	;
131)   129D 1F          		RRA	;
133)   129E E6 0F       		AND  0Fh ; isolate lower nibble	; isolate lower nibble
134)   12A0 C6 90       		ADD A, 90h ; old trick	; old trick
135)   12A2 27          		DAA ; for converting	; for converting
136)   12A3 CE 40       		ADC A, 40h ; one nibble	; one nibble
137)   12A5 27          		DAA ; to hex ASCII	; to hex ASCII
138)   12A6 12          		LD (DE), A	;
139)   12A7 13          		INC DE	;
140)   12A8 C9          		RET	;
 27)   12A9 	            		    PORT_TAPE       EQU DEVTAP      ; SAVE/LOAD PORT 1 BYTE=0xDD 2ND BYTE=COMMAND 	; SAVE/LOAD PORT 1 BYTE=0xDD 2ND BYTE=COMMAND
 39)   12A9 C3 82 0B    		@MYOS_CLRSCN:JP LCD_CLRSCR        ; CLRSCN: clears the screen.	; CLRSCN: clears the screen.
 42)   12AC C9          				       RET	;
 44)   12AD 11 00 00    		       		 LD DE, 0	;
 45)   12B0 21 00 00    		 	  		   LD HL, 0	;
 46)   12B3 C9          					     RET		       	;
 48)   12B4 63          		           LD H,E	;
 49)   12B5 E5          		           PUSH HL	;
 50)   12B6 CD 36 0B    		           CALL LCD_RMVCURS	;
 51)   12B9 E1          		           POP HL	;
 52)   12BA 7C          		           LD A,H	;
 53)   12BB 32 0D 83    		           LD (CURSORX),A	;
 54)   12BE 7D          		           LD A,L	;
 55)   12BF 32 0E 83    		           LD (CURSORY),A	;
 56)   12C2 CD 3B 0B    		           CALL LCD_PRNCURS                      	;
 57)   12C5 C9          		           RET	;
 59)   12C6 16 00       		           LD D,0	;
 60)   12C8 3A 0D 83    		           LD A,(CURSORX)	;
 61)   12CB 5F          		           LD E,A	;
 62)   12CC 26 00       		           LD H,0	;
 63)   12CE 3A 0E 83    		           LD A,(CURSORY)	;
 64)   12D1 6F          					     LD L,A	;
 65)   12D2 C9          					     RET	;
 66)   12D3 06 50       		KEYGET:		LD      B,80 ;SCREEN WIDTH IN CHARS	     	;SCREEN WIDTH IN CHARS
 68)   12D5 E5          		        	 PUSH    HL	;
 69)   12D6 ED 62       		           SBC     HL,HL           ;HL=0	;HL=0
 70)   12D8 CD 39 13    		           CALL    MYOS_OSKEY	;
 71)   12DB E1          		           POP     HL	;
 72)   12DC D8          		           RET     C	;
 73)   12DD 18 F6       		           JR      MYOS_OSRDCH           	;
 74)   12DF C9          					     RET			;
 76)   12E0 F5          					     PUSH    AF	;
 77)   12E1 D5          		           PUSH    DE	;
 78)   12E2 E5          		           PUSH    HL	;
 79)   12E3 DD E5       		           PUSH    IX	;
 80)   12E5 FD E5       		           PUSH    IY	;
 82)   12E7 5F          		           LD      E,A	;
 83)   12E8 CD 58 13    		           CALL    ESCTEST	;
 84)   12EB CD F6 12    		           CALL    EDPUT	;
 85)   12EE FD E1       		           POP     IY	;
 86)   12F0 DD E1       		           POP     IX	;
 87)   12F2 E1          		           POP     HL	;
 88)   12F3 D1          		           POP     DE	;
 89)   12F4 F1          		           POP     AF	;
 90)   12F5 C9          		           RET	;
 92)   12F6 3A 00 83    		EDPUT:  LD      A,(FLAGS)	;
 93)   12F9 CB 5F       		        BIT     3,A	;
 94)   12FB 28 10       		        JR      Z,WRCH	;
 95)   12FD 7B          		        LD      A,E	;
 96)   12FE FE 20       		        CP      ' '	;
 97)   1300 D8          		        RET     C	;
 98)   1301 2A 10 83    		        LD      HL,(EDPTR)	;
 99)   1304 73          		        LD      (HL),E	;
100)   1305 2C          		        INC     L	;
101)   1306 C8          		        RET     Z	;
102)   1307 22 10 83    		        LD      (EDPTR),HL	;
103)   130A C9          		        RET           	;
106)   130B 1E 3E       		           LD E,'>'			     	;
107)   130D 7B          		WRCH:      LD A,E	;
109)   130E F5          		           PUSH AF	;
110)   130F C5          		           PUSH BC	;
111)   1310 D5          		           PUSH DE	;
112)   1311 E5          							 PUSH HL	;
113)   1312 DD E5       							 PUSH IX	;
114)   1314 FD E5       							 PUSH IY	;
116)   1316 F5          		           PUSH AF	;
117)   1317 C5          		           PUSH BC	;
118)   1318 D5          		           PUSH DE	;
119)   1319 E5          							 PUSH HL	;
120)   131A CD 36 0B    							 CALL LCD_RMVCURS	;
121)   131D E1          		           POP HL	;
122)   131E D1          		           POP DE	;
123)   131F C1          		           POP BC	;
124)   1320 F1          		           POP AF	;
125)   1321 CD 73 0A    		           CALL LCD_PRINTCHAR	;
126)   1324 CD 3B 0B    		           CALL LCD_PRNCURS	;
128)   1327 FD E1       		           POP IY	;
129)   1329 DD E1       		           POP IX	;
130)   132B E1          		           POP HL	;
131)   132C D1          		           POP DE	;
132)   132D C1          		           POP BC	;
133)   132E F1          		           POP AF	;
134)   132F C9          					     RET 	;
136)   1330 3A 00 83    		TOGGLE: LD      A,(FLAGS)	;
137)   1333 EE 04       		        XOR     00000100B	;
138)   1335 32 00 83    		        LD      (FLAGS),A	;
139)   1338 C9          		        RET	;
148)   1339 E5          		@MYOS_OSKEY:	PUSH    HL	;
149)   133A 21 13 83    		            LD      HL,INKEY	;
150)   133D 7E          		            LD      A,(HL)	;
151)   133E 36 00       		            LD      (HL),0	;
152)   1340 E1          		            POP     HL	;
153)   1341 B7          		            OR      A	;
154)   1342 37          		            SCF	;
155)   1343 C0          		            RET     NZ			;
157)   1344 CD 02 15    		            CALL    GETKEY	;
159)   1347 D0          		            RET     NC	;
160)   1348 FE 1B       		            CP      ESC	;
161)   134A 37          		            SCF	;
162)   134B C0          		            RET     NZ                        	;
163)   134C E5          		ESCSET: 		PUSH    HL	;
164)   134D 21 00 83    		        		LD      HL,FLAGS	;
165)   1350 CB 76       		        		BIT     6,(HL)          ; ESC DISABLED?	; ESC DISABLED?
166)   1352 20 02       		        		JR      NZ,ESCDIS	;
167)   1354 CB FE       		        		SET     7,(HL)          ; SET ESCAPE FLAG	; SET ESCAPE FLAG
168)   1356 E1          		ESCDIS: 		POP     HL	;
169)   1357 C9          		        		RET		;
170)   1358 CD 69 05    		ESCTEST:		CALL RS_RXNW	;
171)   135B B7          				      	OR A	;
172)   135C C8          				      	RET Z	;
173)   135D FE 1B       				      	CP 0x1B			; ESC		; ESC
174)   135F 28 EB       			      		JR Z,ESCSET	;
175)   1361 32 13 83    			      		LD (INKEY),A	;
176)   1364 C9          			       		RET	;
178)   1365 CD 58 13    		@MYOS_TRAP:			CALL ESCTEST	;
179)   1368 3A 00 83    		@MYOS_LTRAP:			LD A,(FLAGS)	;
180)   136B B7          					          OR A	;
181)   136C F0          				           	RET P	;
182)   136D 21 00 83    		ABORT:       		LD HL,FLAGS 	;
183)   1370 CB BE       				          	RES 7,(HL)	;
184)   1372 C3 C2 4D    				          	JP ESCAPE          	;
193)   1375 F3          		            DI	;
194)   1376 21 F6 82    		            LD HL,RANDOM    ; SET RANDOM SEED TO NON 0	; SET RANDOM SEED TO NON 0
195)   1379 3E 06       		            LD A,0x06	;
196)   137B 77          		            LD (HL),A	;
197)   137C 3E BB       		            LD A,0xBB	;
198)   137E 77          		            LD (HL),A	;
199)   137F 21 00 00    		            LD HL,0	;
200)   1382 22 0D 83    		            LD (CURSORX),HL  ; CURSOR X 7 Y ZEROED            	; CURSOR X 7 Y ZEROED
201)   1385 11 FF FF    		            LD DE,COL_WHITE   ; SET FCOLOR AND BCOLOR DEFAULT VALUES	; SET FCOLOR AND BCOLOR DEFAULT VALUES
202)   1388 21 01 83    		            LD HL,FCOLOR	;
203)   138B 73          		            LD (HL),E	;
204)   138C 23          		            INC HL	;
205)   138D 72          		            LD (HL),D	;
206)   138E 23          		            INC HL	;
207)   138F 11 00 00    		            LD DE,COL_BLACK	;
208)   1392 73          		            LD (HL),E	;
209)   1393 23          		            INC HL	;
210)   1394 72          		            LD (HL),D     	;
211)   1395 01 04 00    		            LD BC,4					; COPY SAME COLORS TO GRAPHICS	; COPY SAME COLORS TO GRAPHICS
212)   1398 11 05 83    		            LD DE,FGRCOL	;
213)   139B 21 01 83    		            LD HL,FCOLOR	;
214)   139E ED B0       		            LDIR                                          	;
215)   13A0 11 14 83    		            LD DE,FCOLPAL	;
216)   13A3 CD AE 13    		            CALL COPYPAL	;
217)   13A6 11 34 83    		            LD DE,BCOLPAL            	;
218)   13A9 CD AE 13    		            CALL COPYPAL	;
219)   13AC 18 09       		            JR OSFINSH;	;
220)   13AE 21 E2 13    		COPYPAL:    LD HL,COL_PALET   	;
221)   13B1 01 10 00    		            LD BC,8*2         ;SHOULD ADD 8 MORE COLORS 	;SHOULD ADD 8 MORE COLORS
222)   13B4 ED B0       		            LDIR	;
223)   13B6 C9          		            RET	;
225)   13B7 CD 2B 4C    		OSFINSH:    CALL    TELL	;
226)   13BA 43 44 45 53 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13BE 50 20 4D 6F 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13C2 64 75 6C 61 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13C6 72 20 43 6F 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13CA 6D 70 75 74 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13CE 65 72 20 31 								DEFM	"CDESP Modular Computer 1.0"	;
226)   13D2 2E 30       								DEFM	"CDESP Modular Computer 1.0"	;
227)   13D4 0A 0D 0A 0D 								DEFB	0AH,0DH,0AH,0DH,00H	;
227)   13D8 00          								DEFB	0AH,0DH,0AH,0DH,00H	;
228)   13D9 AF          		            XOR A	;
229)   13DA 11 FF FF    		         		LD DE,0xFFFF		;DE = HIMEM	;DE = HIMEM
230)   13DD 5F          		         		LD E,A             	;PAGE BOUNDARY	;PAGE BOUNDARY
231)   13DE 21 7F 83    		         		LD HL,@USER         			;
232)   13E1 C9          		         		RET		;
233)   13E2 00 00       		COL_PALET:  DW COL_BLACK	;
234)   13E4 00 F8       		            DW COL_RED	;
235)   13E6 C0 07       		            DW COL_GREEN	;
236)   13E8 C0 FF       		            DW COL_YELLOW	;
237)   13EA 3F 00       		            DW COL_BLUE	;
238)   13EC 3F F8       		            DW COL_MAGENTA	;
239)   13EE FF 07       		            DW COL_CYAN	;
240)   13F0 FF FF       		            DW COL_WHITE            	;
246)   13F2 CD 4C 14    		      CALL    SKIPSP	;
247)   13F5 FE 0D       					CP      CR	;
248)   13F7 C8          					RET     Z	;
249)   13F8 FE 7C       					CP      '|'	;
250)   13FA C8          					RET     Z	;
251)   13FB FE 2E       					CP      '.'	;
252)   13FD CA 5B 14    					JP      Z,DOT           ;*.	;*.
253)   1400 EB          					EX      DE,HL	;
254)   1401 21 5F 14    					LD      HL,COMDS	;
255)   1404 1A          		OSCLI0:			LD      A,(DE)	;
256)   1405 CD 53 14    					CALL    UPPRC	;
257)   1408 BE          					CP      (HL)	;
258)   1409 28 0B       					JR      Z,OSCLI2	;
259)   140B 38 2E       					JR      C,HUH	;
260)   140D CB 7E       		OSCLI1:			BIT     7,(HL)	;
261)   140F 23          					INC     HL	;
262)   1410 28 FB       					JR      Z,OSCLI1	;
263)   1412 23          					INC     HL	;
264)   1413 23          					INC     HL	;
265)   1414 18 EE       					JR      OSCLI0	;
267)   1416 D5          		OSCLI2:			PUSH    DE	;
268)   1417 13          		OSCLI3:			INC     DE	;
269)   1418 23          					INC     HL	;
270)   1419 1A          					LD      A,(DE)	;
271)   141A CD 53 14    					CALL    UPPRC	;
272)   141D FE 2E       					CP      '.'             ;ABBREVIATED?	;ABBREVIATED?
273)   141F 28 0A       					JR      Z,OSCLI4	;
274)   1421 AE          					XOR     (HL)	;
275)   1422 28 F3       					JR      Z,OSCLI3	;
276)   1424 FE 80       					CP      80H	;
277)   1426 28 03       					JR      Z,OSCLI4	;
278)   1428 D1          					POP     DE	;
279)   1429 18 E2       					JR      OSCLI1	;
281)   142B F1          		OSCLI4:			POP     AF	;
282)   142C 13          				        INC     DE	;
283)   142D CB 7E       		OSCLI5:			BIT     7,(HL)	;
284)   142F 23          					INC     HL	;
285)   1430 28 FB       					JR      Z,OSCLI5	;
286)   1432 7E          					LD      A,(HL)	;
287)   1433 23          					INC     HL	;
288)   1434 66          					LD      H,(HL)	;
289)   1435 6F          					LD      L,A	;
290)   1436 E5          					PUSH    HL	;
291)   1437 EB          					EX      DE,HL	;
292)   1438 C3 4C 14    					JP      SKIPSP	;
294)   143B 3E FE       		HUH:    		LD      A,254	;
295)   143D CD F0 46    		        		CALL    EXTERR	;
296)   1440 42 61 64 20 		        		DEFM    'Bad command'	;
296)   1444 63 6F 6D 6D 		        		DEFM    'Bad command'	;
296)   1448 61 6E 64    		        		DEFM    'Bad command'	;
297)   144B 00          		        		DEFB    0				;
299)   144C 7E          		SKIPSP:			LD      A,(HL)	;
300)   144D FE 20       		        		CP      ' '	;
301)   144F C0          		        		RET     NZ	;
302)   1450 23          		        		INC     HL	;
303)   1451 18 F9       		        		JR      SKIPSP		;
305)   1453 E6 7F       		UPPRC:  		AND     7FH	;
306)   1455 FE 60       					CP      '`'	;
307)   1457 D8          					RET     C	;
308)   1458 E6 5F       					AND     5FH             ;CONVERT TO UPPER CASE	;CONVERT TO UPPER CASE
309)   145A C9          					RET						;
312)   145B C9          		DOT:			RET	;
316)   145C C3 00 00    		BYE:			JP 0	;
318)   145F 42 59       		COMDS:  		DEFM    'BY'	;
319)   1461 C5          					DEFB    'E'+80H	;
320)   1462 5C 14       					DEFW    BYE	;
321)   1464 FF          					DEFB	0FFH	;
332)   1465 3E DD       		            LD A,0xDD	;
333)   1467 D3 28       		            OUT (PORT_TAPE),A	;
334)   1469 3E 0A       		            LD A,COMMD_SAVE	;
335)   146B D3 28       		            OUT (PORT_TAPE),A	;
337)   146D 7E          		OSSV_NXT:   LD A,(HL)	;
338)   146E D3 28       		            OUT (PORT_TAPE),A	;
339)   1470 23          		            INC HL	;
340)   1471 FE 0D       		            CP 0x0D	;
341)   1473 20 F8       		            JR NZ,OSSV_NXT	;
343)   1475 79          		            LD A,C	;
344)   1476 D3 28       		            OUT (PORT_TAPE),A	;
345)   1478 78          		            LD A,B	;
346)   1479 D3 28       		            OUT (PORT_TAPE),A	;
348)   147B 2A DC 82    		            LD HL,(PAGE)	;
349)   147E 7E          		OSSV_NXT2:  LD A,(HL)	;
350)   147F D3 28       		            OUT (PORT_TAPE),A	;
351)   1481 23          		            INC HL	;
352)   1482 0B          		            DEC BC	;
353)   1483 78          		            LD A,B	;
354)   1484 B1          		            OR C	;
355)   1485 20 F7       		            JR NZ,OSSV_NXT2                        	;
356)   1487 C9          		            RET              	;
362)   1488 3E DD       		            LD A,0xDD	;
363)   148A D3 28       		            OUT (PORT_TAPE),A	;
364)   148C 3E 14       		            LD A,COMMD_LOAD	;
365)   148E D3 28       		            OUT (PORT_TAPE),A	;
367)   1490 7E          		OSLD_NXT:   LD A,(HL)	;
368)   1491 D3 28       		            OUT (PORT_TAPE),A	;
369)   1493 23          		            INC HL	;
370)   1494 FE 0D       		            CP 0x0D	;
371)   1496 20 F8       		            JR NZ,OSLD_NXT	;
373)   1498 DB 28       		            IN A,(PORT_TAPE)	;
374)   149A 4F          		            LD C,A	;
375)   149B DB 28       		            IN A,(PORT_TAPE)	;
376)   149D 47          		            LD B,A	;
378)   149E 2A DC 82    		            LD HL,(PAGE)                        	;
379)   14A1 DB 28       		OSLD_NXT2:  IN A,(PORT_TAPE)	;
380)   14A3 77          		            LD (HL),A	;
381)   14A4 23          		            INC HL	;
382)   14A5 0B          		            DEC BC	;
383)   14A6 78          		            LD A,B	;
384)   14A7 B1          		            OR C	;
385)   14A8 20 F7       		            JR NZ,OSLD_NXT2                        	;
386)   14AA 44          		            LD B,H	;
387)   14AB 4D          		            LD C,L	;
388)   14AC 21 DE 82    		            LD HL,TOP ;SAVE TOP OF BASIC 	;SAVE TOP OF BASIC
389)   14AF 71          		            LD (HL),C	;
390)   14B0 23          		            INC HL	;
391)   14B1 70          		            LD (HL),B            	;
392)   14B2 37          		            SCF       ;SET C = NO ERROR            	;SET C = NO ERROR
393)   14B3 C9          		            RET   	;
407)   14B4 C9          		            RET	;
409)   14B5 CD 82 0B    		@MYOS_CLG: CALL LCD_CLRSCR	;
410)   14B8 C3 E8 4C    		           JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
413)   14BB DD E5       		@MYOS_GCOL:   PUSH IX	;
414)   14BD 3E 01       		              LD A,1	;
415)   14BF CD CE 0B    		              CALL BAS_COLOUR     	;
416)   14C2 DD E1       		              POP IX	;
417)   14C4 C3 E8 4C    		              JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
419)   14C7 DD E5       		@MYOS_COLOUR: PUSH IX	;
420)   14C9 AF          		              XOR A   	;
421)   14CA CD CE 0B    		              CALL BAS_COLOUR     	;
422)   14CD DD E1       		              POP IX	;
423)   14CF C3 E8 4C    		              JP XEQ           ;RETURN TO BASIC              	;RETURN TO BASIC
425)   14D2 DD E5       		@MYOS_DRAW: PUSH IX 	;
426)   14D4 CD 9F 0C    		            CALL BAS_DRAW	;
427)   14D7 DD E1       		            POP IX	;
428)   14D9 C3 E8 4C    		            JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
430)   14DC DD E5       		@MYOS_MOVE:PUSH IX	;
431)   14DE CD CD 0C    		           CALL BAS_MOVE	;
432)   14E1 DD E1       		           POP IX	;
433)   14E3 C3 E8 4C    		           JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
435)   14E6 DD E5       		@MYOS_PLOT:PUSH IX	;
436)   14E8 CD 44 0D    		           CALL BAS_PLOT	;
437)   14EB DD E1       		           POP IX	;
438)   14ED C3 E8 4C    		           JP XEQ           ;RETURN TO BASIC    	;RETURN TO BASIC
440)   14F0 DD E5       		@MYOS_POINT:PUSH IX	;
441)   14F2 CD D9 0C    		           CALL BAS_POINT ;RETURNS A VALUE TO BASIC	;RETURNS A VALUE TO BASIC
442)   14F5 DD E1       		           POP IX	;
443)   14F7 C9          		           RET	;
453)   14F8 AF          					XOR     A	;
454)   14F9 CD F0 46    					CALL    EXTERR	;
455)   14FC 53 6F 72 72 					DEFM    'Sorry'	;
455)   1500 79          					DEFM    'Sorry'	;
456)   1501 00          					DEFB    0            	;
463)   1502 CD DD 02    		GETKEY:		  CALL GET_CHAR	;
464)   1505 37          		            SCF	;
465)   1506 C9          					      RET       	;
477)   1507 3A 00 83    		        LD      A,(FLAGS)	;
478)   150A CB 5F       		        BIT     3,A             ;EDIT MODE?	;EDIT MODE?
479)   150C 28 09       		        JR      Z,OSLIN1	;
480)   150E CB 9F       		        RES     3,A	;
481)   1510 32 00 83    		        LD      (FLAGS),A	;
482)   1513 2A 10 83    		        LD      HL,(EDPTR)	;
483)   1516 BD          		        CP      L	;
484)   1517 3E 0D       		OSLIN1: LD      A,CR	;
485)   1519 77          		        LD      (HL),A	;
486)   151A C4 E0 12    		        CALL    NZ,MYOS_OSWRCH	;
487)   151D 2E 00       		        LD      L,0	;
488)   151F 4D          		        LD      C,L             ;REPEAT FLAG	;REPEAT FLAG
489)   1520 28 20       		        JR      Z,OSWAIT        ;SUPPRESS UNWANTED SPACE	;SUPPRESS UNWANTED SPACE
490)   1522 06 00       		UPDATE: LD      B,0	;
491)   1524 7E          		UPD1:   LD      A,(HL)	;
492)   1525 04          		        INC     B	;
493)   1526 23          		        INC     HL	;
494)   1527 FE 0D       		        CP      CR	;
495)   1529 F5          		        PUSH    AF	;
496)   152A E5          		        PUSH    HL	;
497)   152B 5F          		        LD      E,A	;
498)   152C C4 0D 13    		        CALL    NZ,WRCH         ;FAST WRCH	;FAST WRCH
499)   152F E1          		        POP     HL	;
500)   1530 F1          		        POP     AF	;
501)   1531 20 F1       		        JR      NZ,UPD1	;
502)   1533 3E 20       		        LD      A,' '	;
503)   1535 CD E0 12    		        CALL    MYOS_OSWRCH	;
504)   1538 1E 08       		        LD      E,BS	;
505)   153A E5          		UPD2:   PUSH    HL	;
506)   153B CD 0D 13    		        CALL    WRCH            ;FAST WRCH	;FAST WRCH
507)   153E E1          		        POP     HL	;
508)   153F 2B          		        DEC     HL	;
509)   1540 10 F8       		        DJNZ    UPD2	;
510)   1542 79          		OSWAIT: LD      A,C	;
511)   1543 05          		        DEC     B	;
512)   1544 28 01       		        JR      Z,LIMIT	;
513)   1546 B7          		        OR      A               ;REPEAT COMMAND?	;REPEAT COMMAND?
514)   1547 CC D3 12    		LIMIT:  CALL    Z,KEYGET        ;READ KEYBOARD	;READ KEYBOARD
515)   154A 4F          		        LD      C,A             ;SAVE FOR REPEAT	;SAVE FOR REPEAT
516)   154B 11 42 15    		        LD      DE,OSWAIT       ;RETURN ADDRESS	;RETURN ADDRESS
517)   154E D5          		        PUSH    DE	;
518)   154F 3A 00 83    		        LD      A,(FLAGS)	;
519)   1552 B7          		        OR      A               ;TEST FOR ESCAPE	;TEST FOR ESCAPE
520)   1553 79          		        LD      A,C	;
521)   1554 FA 96 15    		        JP      M,OSEXIT	;
522)   1557 FE 0B       		        CP      11         ;CURSOR UP     (IX-11)	;CURSOR UP     (IX-11)
523)   1559 CA DA 15    		        JP      Z,LEFT	;
524)   155C FE 0A       		        CP      10         ;CURSOR DOWN   (IX-10)	;CURSOR DOWN   (IX-10)
525)   155E CA 0D 16    		        JP      Z,RIGHT	;
526)   1561 06 00       		        LD      B,0	;
527)   1563 FE 05       		        CP      5          ;CLEAR LEFT    (IX-5)	;CLEAR LEFT    (IX-5)
528)   1565 28 72       		        JR      Z,BACK	;
529)   1567 FE 09       		        CP      9          ;START OF LINE (IX-9)	;START OF LINE (IX-9)
530)   1569 28 6F       		        JR      Z,LEFT	;
531)   156B FE 07       		        CP      7          ;CLEAR RIGHT   (IX-7)	;CLEAR RIGHT   (IX-7)
532)   156D 28 76       		        JR      Z,DELETE	;
533)   156F FE 08       		        CP      8          ;END OF LINE   (IX-8)	;END OF LINE   (IX-8)
534)   1571 CA 0D 16    		        JP      Z,RIGHT	;
535)   1574 0E 00       		        LD      C,0             ;INHIBIT REPEAT	;INHIBIT REPEAT
536)   1576 FE 10       		        CP      'P' AND 1FH	;
537)   1578 CA 30 13    		        JP      Z,TOGGLE	;
538)   157B FE 06       		        CP      6          ;DELETE LEFT   (IX-6)	;DELETE LEFT   (IX-6)
539)   157D 28 5A       		        JR      Z,BACK	;
540)   157F FE 04       		        CP      4          ;CURSOR LEFT   (IX-4)	;CURSOR LEFT   (IX-4)
541)   1581 28 57       		        JR      Z,LEFT	;
542)   1583 FE 02       		        CP      2          ;DELETE RIGHT  (IX-2)	;DELETE RIGHT  (IX-2)
543)   1585 28 5E       		        JR      Z,DELETE	;
544)   1587 FE 01       		        CP      1          ;INSERT SPACE  (IX-1)	;INSERT SPACE  (IX-1)
545)   1589 28 6E       		        JR      Z,INSERT	;
546)   158B FE 03       		        CP      3          ;CURSOR RIGHT  (IX-3)	;CURSOR RIGHT  (IX-3)
547)   158D 28 7E       		        JR      Z,RIGHT	;
548)   158F FE 20       		        CP      ' '             ;PRINTING CHARACTER	;PRINTING CHARACTER
549)   1591 30 7F       		        JR      NC,SAVECH	;
550)   1593 FE 0D       		        CP      CR              ;ENTER LINE	;ENTER LINE
551)   1595 C0          		        RET     NZ	;
552)   1596 7E          		OSEXIT: LD      A,(HL)	;
553)   1597 CD E0 12    		        CALL    MYOS_OSWRCH          ;WRITE REST OF LINE	;WRITE REST OF LINE
554)   159A 23          		        INC     HL	;
555)   159B D6 0D       		        SUB     CR	;
556)   159D 20 F7       		        JR      NZ,OSEXIT	;
557)   159F D1          		        POP     DE              ;DITCH RETURN ADDRESS	;DITCH RETURN ADDRESS
558)   15A0 B9          		        CP      C	;
559)   15A1 C2 6D 13    		        JP      NZ,ABORT        ;ESCAPE	;ESCAPE
560)   15A4 3E 0A       		        LD      A,LF	;
561)   15A6 CD E0 12    		        CALL    MYOS_OSWRCH	;
562)   15A9 ED 5B F4 82 		        LD      DE,(ERRLIN)	;
563)   15AD AF          		        XOR     A	;
564)   15AE 6F          		        LD      L,A	;
565)   15AF 22 10 83    		        LD      (EDPTR),HL	;
566)   15B2 BA          		        CP      D	;
567)   15B3 C0          		        RET     NZ	;
568)   15B4 BB          		        CP      E	;
569)   15B5 C0          		        RET     NZ	;
570)   15B6 11 26 16    		        LD      DE,EDITST	;
571)   15B9 06 04       		        LD      B,4	;
572)   15BB 1A          		CMPARE: LD      A,(DE)	;
573)   15BC BE          		        CP      (HL)	;
574)   15BD 3E 00       		        LD      A,0	;
575)   15BF C0          		        RET     NZ	;
576)   15C0 23          		        INC     HL	;
577)   15C1 13          		        INC     DE	;
578)   15C2 7E          		        LD      A,(HL)	;
579)   15C3 FE 2E       		        CP      '.'	;
580)   15C5 28 02       		        JR      Z,ABBR	;
581)   15C7 10 F2       		        DJNZ    CMPARE	;
582)   15C9 AF          		ABBR:   XOR     A	;
583)   15CA 47          		        LD      B,A	;
584)   15CB 4D          		        LD      C,L	;
585)   15CC 6F          		        LD      L,A	;
586)   15CD 11 2A 16    		        LD      DE,LISTST	;
587)   15D0 EB          		        EX      DE,HL	;
588)   15D1 ED B0       		        LDIR	;
589)   15D3 21 00 83    		        LD      HL,FLAGS	;
590)   15D6 CB DE       		        SET     3,(HL)	;
591)   15D8 C9          		        RET	;
593)   15D9 37          		BACK:   SCF                     ;DELETE LEFT	;DELETE LEFT
594)   15DA 2C          		LEFT:   INC     L               ;CURSOR LEFT	;CURSOR LEFT
595)   15DB 2D          		        DEC     L	;
596)   15DC 28 45       		        JR      Z,STOP	;
597)   15DE 3E 08       		        LD      A,BS	;
598)   15E0 CD E0 12    		        CALL    MYOS_OSWRCH	;
599)   15E3 2D          		        DEC     L	;
600)   15E4 D0          		        RET     NC	;
601)   15E5 7E          		DELETE: LD      A,(HL)          ;DELETE RIGHT	;DELETE RIGHT
602)   15E6 FE 0D       		        CP      CR	;
603)   15E8 28 39       		        JR      Z,STOP	;
604)   15EA 54          		        LD      D,H	;
605)   15EB 5D          		        LD      E,L	;
606)   15EC 13          		DEL1:   INC     DE	;
607)   15ED 1A          		        LD      A,(DE)	;
608)   15EE 1B          		        DEC     DE	;
609)   15EF 12          		        LD      (DE),A	;
610)   15F0 13          		        INC     DE	;
611)   15F1 FE 0D       		        CP      CR	;
612)   15F3 20 F7       		        JR      NZ,DEL1	;
613)   15F5 D1          		DEL2:   POP     DE              ;DITCH	;DITCH
614)   15F6 C3 22 15    		        JP      UPDATE	;
616)   15F9 3E 0D       		INSERT: LD      A,CR            ;INSERT SPACE	;INSERT SPACE
617)   15FB BE          		        CP      (HL)	;
618)   15FC C8          		        RET     Z	;
619)   15FD 54          		        LD      D,H	;
620)   15FE 1E FE       		        LD      E,254	;
621)   1600 13          		INS1:   INC     DE	;
622)   1601 12          		        LD      (DE),A	;
623)   1602 1B          		        DEC     DE	;
624)   1603 7B          		        LD      A,E	;
625)   1604 BD          		        CP      L	;
626)   1605 1B          		        DEC     DE	;
627)   1606 1A          		        LD      A,(DE)	;
628)   1607 20 F7       		        JR      NZ,INS1	;
629)   1609 36 20       		        LD      (HL),' '	;
630)   160B 18 E8       		        JR      DEL2	;
632)   160D 7E          		RIGHT:  LD      A,(HL)          ;CURSOR RIGHT	;CURSOR RIGHT
633)   160E FE 0D       		        CP      CR	;
634)   1610 28 11       		        JR      Z,STOP	;
635)   1612 56          		SAVECH: LD      D,(HL)          ;PRINTING CHARACTER	;PRINTING CHARACTER
636)   1613 77          		        LD      (HL),A	;
637)   1614 2C          		        INC     L	;
638)   1615 28 09       		        JR      Z,WONTGO        ;LINE TOO LONG	;LINE TOO LONG
639)   1617 CD E0 12    		        CALL    MYOS_OSWRCH	;
640)   161A 3E 0D       		        LD      A,CR	;
641)   161C BA          		        CP      D	;
642)   161D C0          		        RET     NZ	;
643)   161E 77          		        LD      (HL),A	;
644)   161F C9          		        RET	;
646)   1620 2D          		WONTGO: DEC     L	;
647)   1621 36 0D       		        LD      (HL),CR	;
650)   1623 0E 00       		STOP:   LD      C,0             ;STOP REPEAT	;STOP REPEAT
651)   1625 C9          		        RET	;
654)   1626 45 44 49 54 		EDITST: DEFM    'EDIT'	;
655)   162A 4C 49 53 54 		LISTST: DEFM    'LIST'	;
  9)   8300 00          		    @FLAGS		 DEFS	1		; Flags: B7=ESC PRESSED, B6=ESC DISABLED	; Flags: B7=ESC PRESSED, B6=ESC DISABLED
 10)   8301 00 00       		    @FCOLOR   DEFS 2 ;FOREGROUND COLOR FOR TEXT	;FOREGROUND COLOR FOR TEXT
 11)   8303 00 00       		    @BCOLOR   DEFS 2 ;BACKGROUND COLOR FOR TEXT	;BACKGROUND COLOR FOR TEXT
 12)   8305 00 00       		    @FGRCOL   DEFS 2 ;FOREGROUND COLOR FOR GRAPHICS	;FOREGROUND COLOR FOR GRAPHICS
 13)   8307 00 00       		    @BGRCOL   DEFS 2 ;BACKGROUND COLOR FOR GRAPHICS 	;BACKGROUND COLOR FOR GRAPHICS
 14)   8309 00 00       		    @FCOLTM   DEFS 2 ;TEMP FOREGROUND COLOR 	;TEMP FOREGROUND COLOR
 15)   830B 00 00       		    @BCOLTM   DEFS 2 ;TEMP BACKGROUND COLOR 	;TEMP BACKGROUND COLOR
 16)   830D 00          		    @CURSORX  DEFS 1    ;0-79	;0-79
 17)   830E 00          		    @CURSORY  DEFS 1    ;0-47	;0-47
 20)   830F 00          		    @LASTCHAR DEFS 1; 	;
 21)   8310 00 00       		    @EDPTR    DEFS 2	;
 22)   8312 00          		    @OPTVAL   DEFS 1	;
 23)   8313 00          		    @INKEY    DEFS 1	;
 24)   8314 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8318 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   831C 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8320 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8324 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8328 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   832C 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 24)   8330 00 00 00 00 		    @FCOLPAL DEFS 16*2    ; FORECOLOR PALETTE	; FORECOLOR PALETTE
 25)   8334 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8338 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   833C 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8340 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8344 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8348 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   834C 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 25)   8350 00 00 00 00 		    @BCOLPAL DEFS 16*2    ; BACKCOLOR PALETTE	; BACKCOLOR PALETTE
 26)   8354 00 00       		    @GR_LASTX3 DEFS 2	;
 27)   8356 00 00       		    @GR_LASTY3 DEFS 2	;
 28)   8358 00 00       		    @GR_LASTX2 DEFS 2	;
 29)   835A 00 00       		    @GR_LASTY2 DEFS 2    	;
 30)   835C 00 00       		    @GR_LASTX DEFS 2	;
 31)   835E 00 00       		    @GR_LASTY DEFS 2	;
 32)   8360 00 00       		    @GR_PARAM1 DEFS 2	;
 33)   8362 00 00       		    @GR_PARAM2 DEFS 2	;
 34)   8364 00 00       		    @GR_PARAM3 DEFS 2	;
 35)   8366 00 00       		    @GR_PARAM4 DEFS 2	;
 37)   8368 00          		    @FFSTAT   DEFS 1  ;FOR OUTPUT FLIP FLOPS DEVEPR, DEVKBD	;FOR OUTPUT FLIP FLOPS DEVEPR, DEVKBD
 38)   8369 00          			  @KEYCTR   DEFS 1		;FOR USB KEYBOARD 	;FOR USB KEYBOARD
 39)   836A 00          			  @SERERR 	DEFS 1;	;
 40)   836B 00          			  @SERER2 	DEFS 1		;AT RAM ADDRESS	;AT RAM ADDRESS
 41)   836C 00          			  @DISPCT   DEFS 1 	;	;
 42)   836D 00          			  @LCDCX 	  DEFS 1		;DB 0		;DISPLAY X POS (0..F  FOR 1..16)	;DB 0		;DISPLAY X POS (0..F  FOR 1..16)
 43)   836E 00          			  @LCDCY 	  DEFS 1 	;DB 0		;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)	;DB 0		;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)
 44)   836F 00 00       			  @PRGEX	  DEFS 2 	;2 BYTES	;2 BYTES
 45)   8371 00          			  @TVSTAT	  DEFS 1 	;1 BYTE	;1 BYTE
 46)   8372 00 00 00 00 		    @MYNUM	  DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 46)   8376 00 00 00 00 		    @MYNUM	  DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 46)   837A 00 00 00 00 		    @MYNUM	  DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 46)   837E 00          		    @MYNUM	  DEFS 13 ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED    	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
