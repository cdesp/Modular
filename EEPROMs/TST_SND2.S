INCLUDE MYOS_2_0000.SYM

ORG $C000

	

		
		
		CALL TESTSND2
		;CALL MYDELAY
		;CALL PLAYSONG2
		CALL PLAYASONG
		CALL SND_MUTEALL
		JP 4
		
		nDEL equ 10
		nNON EQU 0	

;Em = E,G,B

	

SONG   DW 	nG4,nDEL,nE4,nDEL,nG4,nDEL,nG4,nDEL,nE4,nDEL,nG4,nDEL
        DW	nA4,nDEL,nG4,nDEL,nF4,nDEL,nE4,nDEL,nD4,nDEL,nE4,nDEL,nF4,nDEL
	DW	nE4,nDEL,nF4,nDEL,nG4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nD4,nDEL,nE4,nDEL,nF4,nDEL,nG4,nDEL
	DW	nG4,nDEL,nD4,nDEL,nD4,nDEL,nF4,nDEL,nE4,nDEL,nD4,nDEL,nC4,nDEL
        DW 	nG4,nDEL,nE4,nDEL,nG4,nDEL,nG4,nDEL,nE4,nDEL,nG4,nDEL
        DW	nA4,nDEL,nG4,nDEL,nF4,nDEL,nE4,nDEL,nD4,nDEL,nE4,nDEL,nF4,nDEL
	DW	nE4,nDEL,nF4,nDEL,nG4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nC4,nDEL,nD4,nDEL,nE4,nDEL,nF4,nDEL,nG4,nDEL
	DW	nG4,nDEL,nD4,nDEL,nD4,nDEL,nF4,nDEL,nE4,nDEL,nD4,nDEL,nC4,nDEL
	DW	nEND,nNON

		DEFCHN EQU 1
                @SNDVOLHI EQU 0
                @SNDVOLM1 EQU 1
                @SNDVOLM2 EQU 2
                @SNDVOLLO EQU 3
                @SNDMUTE EQU 4



PLAYASONG:	LD HL,SONG
		LD (CHANDATA),HL
		XOR A
		LD (CHANCN),A
		CALL SND_ENABLE
		EI

PS_NXTNOTE:	CALL SND_PLAYMUSIC
		
		;PUSH AF
	 	;LD B,255
                ;CALL DELAYMILI
	 	;LD B,250
                ;CALL DELAYMILI
	 	;LD B,50
                ;CALL DELAYMILI

;		POP AF
		RET Z			;NO MORE NOTES TO PLAY
		JR PS_NXTNOTE


DOBEEP:         LD A,DEFCHN
                LD C,SNDVOLHI
                CALL SND_SETVOLUME 
		;LD A,$91	;FULL VOLUME
		;CALL SND_OUT
               
                LD A,DEFCHN
                CALL SND_NOTE
                LD B,160
		CALL DELAYMILI
                LD A,DEFCHN
                LD C,SNDMUTE
                CALL SND_SETVOLUME
                RET

BEEP:            LD HL,nC6             ;NOTE C6 ON CHANNEL2
                CALL DOBEEP
                RET


TESTSND2:	CALL BEEP
		RET


cntr		DB 0

MYDELAY:  	PUSH AF
		LD B,250
		CALL DELAYMILI
		POP AF
		RET

PLAYSONG2:	LD A,$91	;FULL VOLUME
		CALL SND_OUT
		LD A,0		
		CALL SND_ENABLE
		CALL MYDELAY
		LD HL,SONG
		LD (CHANDATA),HL
		XOR A
		LD (CHANCN),A
		LD (CNTR),A
PLNXTNOTE:	CALL MYDELAY
		LD A,(CNTR)
		INC A
		LD (CNTR),A	
		CP 10
		JR NZ,PN2NXT				
		LD A,0		
		CALL SND_DISABLE		
PN2NXT:		CP 20
		JR NZ,P2NXT2
		LD A,0		
		CALL SND_ENABLE		
P2NXT2:		CALL SND_PLAYMUSIC		
		JR NZ,PLNXTNOTE		
		CALL SND_MUTEALL
		RET
		
		


PLAYSONG:	LD DE,SONG		
NXTNT:		LD A,(DE)
		LD L,A
		INC DE
		LD A,(DE)
		LD H,A
		INC DE
		OR A
		RET Z
		XOR A
		PUSH DE
		CALL SND_NOTE
		CALL MYDELAY
		POP DE
		JR NXTNT


TESTSND: 	LD A,$91	;FULL VOLUME
		CALL SND_OUT
		XOR A		;CHANNEL 0
	 	LD HL,$842A	;C4 NOTE
	 	CALL SND_NOTE   ;PLAY NOTE
		CALL MYDELAY
	 	LD HL,$840A	;D4 NOTE
	 	CALL SND_NOTE   ;PLAY NOTE
		CALL MYDELAY
		LD HL,$842A	;C4 NOTE
	 	CALL SND_NOTE   ;PLAY NOTE
		CALL MYDELAY
		RET