ORG $4000

INCLUDE MYOS_2_0000_HARD.SYM

DVKBI	EQU $78

	CALL RESETFF		;RESET KB
LP:	LD HL,MES1
	CALL RS_TXT

	CALL RS_RX
	CP 'G'
	CALL Z,NGTKEY
	CP 'M'
	JP Z,4
	CP '1'
	CALL Z, SETFF
	CP '2'
	CALL Z,RESETFF
	JR LP

SETFF:	LD A,2
	OUT (DVKBI),A
	RET

RESETFF: XOR A
	OUT (DVKBI),A
	RET

NGTKEY:	IN A,(DVKBI)		;GET KEY
        CALL REVBITS
	LD C,A
	XOR A
	OUT (DVKBI),A		;RESET FOR NEXT KEY
	;LD B,A
;DAGN:	DJNZ DAGN
	OUT (DVKBI),A		;RESET FOR NEXT KEY
        OUT (DVKBI),A		;RESET FOR NEXT KEY	
	LD A,C
	CALL SOUTAS
	LD A,13
	CALL RS_TX
	RET

REVBITS:  ld b,8
  ld l,a
REVLOOP:
  rl l
  rra
  djnz REVLOOP
RET








MES1 	DEFM "G: GET CHAR FROM KEYB"	
	DB 13,0



